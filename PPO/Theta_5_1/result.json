{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95466167666018, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 1e-07, "total_loss": 2.185326994210482, "policy_loss": -0.001773743546800688, "vf_loss": 9.88552775979042, "vf_explained_var": 5.695968866348267e-06, "kl": 0.00023241959233928356, "entropy": 2.8432768151164054, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "env_runners": {"episode_reward_max": 164.72072220836534, "episode_reward_min": 91.25197634314301, "episode_reward_mean": 131.99061104351188, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 900, "policy_reward_min": {"tplp_policy": 91.25197634314301}, "policy_reward_max": {"tplp_policy": 164.72072220836534}, "policy_reward_mean": {"tplp_policy": 131.99061104351188}, "custom_metrics": {"mean_episode_reward_mean": 131.99061104351188, "mean_episode_reward_min": 91.25197634314301, "mean_episode_reward_max": 164.72072220836534}, "hist_stats": {"episode_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6392405252410405, "mean_inference_ms": 1.843933542455992, "mean_action_processing_ms": 0.3312852920477061, "mean_env_wait_ms": 2.0194924738590987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01672771241929796, "StateBufferConnector_ms": 0.008299615648057725, "ViewRequirementAgentConnector_ms": 0.20584000481499565}, "num_episodes": 18, "episode_return_max": 164.72072220836534, "episode_return_min": 91.25197634314301, "episode_return_mean": 131.99061104351188, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 507.6168273363966, "num_env_steps_trained_throughput_per_sec": 507.6168273363966, "timesteps_total": 1024, "num_env_steps_sampled_lifetime": 1024, "num_agent_steps_sampled_lifetime": 1024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 2017.27, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2017.27, "sample_time_ms": 876.196, "learn_time_ms": 1125.318, "learn_throughput": 909.965, "synch_weights_time_ms": 15.756}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "training_iteration": 1, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-19", "timestamp": 1744110079, "time_this_iter_s": 2.0233042240142822, "time_total_s": 2.0233042240142822, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C209A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2.0233042240142822, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 31.03333333333333, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1669033732265235, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 1e-07, "total_loss": 2.1658376172184943, "policy_loss": -0.00024738729116506873, "vf_loss": 9.801711839437484, "vf_explained_var": 6.312504410743713e-06, "kl": 2.435015717061617e-06, "entropy": 2.843431954085827, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "env_runners": {"episode_reward_max": 164.72072220836534, "episode_reward_min": 91.25197634314301, "episode_reward_mean": 128.99771270927488, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 1800, "policy_reward_min": {"tplp_policy": 91.25197634314301}, "policy_reward_max": {"tplp_policy": 164.72072220836534}, "policy_reward_mean": {"tplp_policy": 128.99771270927488}, "custom_metrics": {"mean_episode_reward_mean": 128.99771270927488, "mean_episode_reward_min": 91.25197634314301, "mean_episode_reward_max": 164.72072220836534}, "hist_stats": {"episode_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6377790338320213, "mean_inference_ms": 1.841974340622927, "mean_action_processing_ms": 0.33308684857031884, "mean_env_wait_ms": 2.029492767591262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013911724090576172, "StateBufferConnector_ms": 0.004149807824028863, "ViewRequirementAgentConnector_ms": 0.21418068144056532}, "num_episodes": 18, "episode_return_max": 164.72072220836534, "episode_return_min": 91.25197634314301, "episode_return_mean": 128.99771270927488, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 441.5706397600223, "num_env_steps_trained_throughput_per_sec": 441.5706397600223, "timesteps_total": 2048, "num_env_steps_sampled_lifetime": 2048, "num_agent_steps_sampled_lifetime": 2048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 2168.132, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2168.132, "sample_time_ms": 866.9, "learn_time_ms": 1284.294, "learn_throughput": 797.325, "synch_weights_time_ms": 16.937}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "training_iteration": 2, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-21", "timestamp": 1744110081, "time_this_iter_s": 2.324488401412964, "time_total_s": 4.347792625427246, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22FC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4.347792625427246, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 32.35, "ram_util_percent": 88.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0253535766154527, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 1e-07, "total_loss": 2.1757547579705716, "policy_loss": -0.00012015652609989047, "vf_loss": 9.84125412106514, "vf_explained_var": 7.996708154678344e-06, "kl": 9.115268003512256e-07, "entropy": 2.844386379420757, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "env_runners": {"episode_reward_max": 169.8006588336209, "episode_reward_min": 91.25197634314301, "episode_reward_mean": 131.71681540712004, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"tplp_policy": 91.25197634314301}, "policy_reward_max": {"tplp_policy": 169.8006588336209}, "policy_reward_mean": {"tplp_policy": 131.71681540712004}, "custom_metrics": {"mean_episode_reward_mean": 131.71681540712004, "mean_episode_reward_min": 91.25197634314301, "mean_episode_reward_max": 169.8006588336209}, "hist_stats": {"episode_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6618864359357833, "mean_inference_ms": 1.8756249659950028, "mean_action_processing_ms": 0.3400717665472849, "mean_env_wait_ms": 2.0641069283201334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010010004043579102, "StateBufferConnector_ms": 0.030827124913533527, "ViewRequirementAgentConnector_ms": 0.21960576375325522}, "num_episodes": 24, "episode_return_max": 169.8006588336209, "episode_return_min": 91.25197634314301, "episode_return_mean": 131.71681540712004, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 468.4461023842289, "num_env_steps_trained_throughput_per_sec": 468.4461023842289, "timesteps_total": 3072, "num_env_steps_sampled_lifetime": 3072, "num_agent_steps_sampled_lifetime": 3072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 2174.072, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2174.072, "sample_time_ms": 905.355, "learn_time_ms": 1251.675, "learn_throughput": 818.104, "synch_weights_time_ms": 17.042}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "training_iteration": 3, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-24", "timestamp": 1744110084, "time_this_iter_s": 2.1912899017333984, "time_total_s": 6.5390825271606445, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6.5390825271606445, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.36666666666667, "ram_util_percent": 88.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.549455606751144, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 1e-07, "total_loss": 2.1708274193108084, "policy_loss": -0.00026691941893659533, "vf_loss": 9.822426760196686, "vf_explained_var": 5.538761615753174e-06, "kl": 1.38900469344172e-06, "entropy": 2.845123440027237, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "env_runners": {"episode_reward_max": 169.8006588336209, "episode_reward_min": 91.25197634314301, "episode_reward_mean": 132.350388288884, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3900, "policy_reward_min": {"tplp_policy": 91.25197634314301}, "policy_reward_max": {"tplp_policy": 169.8006588336209}, "policy_reward_mean": {"tplp_policy": 132.350388288884}, "custom_metrics": {"mean_episode_reward_mean": 132.350388288884, "mean_episode_reward_min": 91.25197634314301, "mean_episode_reward_max": 169.8006588336209}, "hist_stats": {"episode_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.51078704348637, 91.25197634314301, 120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6632240675312107, "mean_inference_ms": 1.874934234671834, "mean_action_processing_ms": 0.3395221784856586, "mean_env_wait_ms": 2.0650834223960786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010256583874042217, "StateBufferConnector_ms": 0.023713173010410406, "ViewRequirementAgentConnector_ms": 0.19634564717610678}, "num_episodes": 18, "episode_return_max": 169.8006588336209, "episode_return_min": 91.25197634314301, "episode_return_mean": 132.350388288884, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 522.2750225145418, "num_env_steps_trained_throughput_per_sec": 522.2750225145418, "timesteps_total": 4096, "num_env_steps_sampled_lifetime": 4096, "num_agent_steps_sampled_lifetime": 4096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 2120.717, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2120.717, "sample_time_ms": 884.631, "learn_time_ms": 1219.439, "learn_throughput": 839.731, "synch_weights_time_ms": 16.647}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "training_iteration": 4, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-26", "timestamp": 1744110086, "time_this_iter_s": 1.9653270244598389, "time_total_s": 8.504409551620483, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8.504409551620483, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.500000000000004, "ram_util_percent": 88.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9285340499132873, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 1e-07, "total_loss": 2.1618482276797293, "policy_loss": -0.0001327191130258143, "vf_loss": 9.78599692583084, "vf_explained_var": 2.9906630516052244e-06, "kl": 6.878160487389096e-07, "entropy": 2.8451828941702844, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "env_runners": {"episode_reward_max": 169.8006588336209, "episode_reward_min": 99.0110312274345, "episode_reward_mean": 132.3346957744855, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 99.0110312274345}, "policy_reward_max": {"tplp_policy": 169.8006588336209}, "policy_reward_mean": {"tplp_policy": 132.3346957744855}, "custom_metrics": {"mean_episode_reward_mean": 132.3346957744855, "mean_episode_reward_min": 99.0110312274345, "mean_episode_reward_max": 169.8006588336209}, "hist_stats": {"episode_reward": [120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [120.31331250535972, 99.150100846157, 133.91211143844833, 124.39112460233653, 117.21107333706227, 135.33860947550133, 164.72072220836534, 136.25551666691084, 131.97083717333916, 145.26528657116498, 159.85380511287875, 137.8572919907966, 148.6134087801304, 139.78188395234815, 110.20119101990453, 132.23195971588086, 125.29717988914871, 126.47054584341998, 142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6610967549631619, "mean_inference_ms": 1.863097324649188, "mean_action_processing_ms": 0.3371731424588917, "mean_env_wait_ms": 2.0569768790290204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010995864868164062, "StateBufferConnector_ms": 0.022499799728393555, "ViewRequirementAgentConnector_ms": 0.1954784393310547}, "num_episodes": 24, "episode_return_max": 169.8006588336209, "episode_return_min": 99.0110312274345, "episode_return_mean": 132.3346957744855, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 513.1122743602953, "num_env_steps_trained_throughput_per_sec": 513.1122743602953, "timesteps_total": 5120, "num_env_steps_sampled_lifetime": 5120, "num_agent_steps_sampled_lifetime": 5120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 2095.706, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2095.706, "sample_time_ms": 865.552, "learn_time_ms": 1213.574, "learn_throughput": 843.789, "synch_weights_time_ms": 16.581}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "training_iteration": 5, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-28", "timestamp": 1744110088, "time_this_iter_s": 2.002699851989746, "time_total_s": 10.50710940361023, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.50710940361023, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 27.3, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0365867033600806, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 1e-07, "total_loss": 2.195238155126572, "policy_loss": -0.0001186720561236143, "vf_loss": 9.919565087556839, "vf_explained_var": 3.450363874435425e-06, "kl": 5.950441441693321e-07, "entropy": 2.845344400405884, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "env_runners": {"episode_reward_max": 169.8006588336209, "episode_reward_min": 95.48115448692765, "episode_reward_mean": 132.23075647361998, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 95.48115448692765}, "policy_reward_max": {"tplp_policy": 169.8006588336209}, "policy_reward_mean": {"tplp_policy": 132.23075647361998}, "custom_metrics": {"mean_episode_reward_mean": 132.23075647361998, "mean_episode_reward_min": 95.48115448692765, "mean_episode_reward_max": 169.8006588336209}, "hist_stats": {"episode_reward": [142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [142.7001538434756, 119.95701163760141, 128.57919883190513, 109.31324142789242, 133.84542217501007, 121.47642510919206, 102.54196879533977, 136.8611222393751, 125.07611821743343, 108.47737566404717, 140.90684587007476, 134.55478828268394, 132.15091924745684, 128.54396800940077, 142.60909896082836, 108.72527470639555, 99.0110312274345, 134.35757634315155, 129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6611427537697478, "mean_inference_ms": 1.866335472154332, "mean_action_processing_ms": 0.339187517925641, "mean_env_wait_ms": 2.063115433166314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009988784790039062, "StateBufferConnector_ms": 0.023524761199951172, "ViewRequirementAgentConnector_ms": 0.1909322738647461}, "num_episodes": 18, "episode_return_max": 169.8006588336209, "episode_return_min": 95.48115448692765, "episode_return_mean": 132.23075647361998, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 470.96599161027183, "num_env_steps_trained_throughput_per_sec": 470.96599161027183, "timesteps_total": 6144, "num_env_steps_sampled_lifetime": 6144, "num_agent_steps_sampled_lifetime": 6144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 2108.798, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2108.798, "sample_time_ms": 875.167, "learn_time_ms": 1217.041, "learn_throughput": 841.385, "synch_weights_time_ms": 16.424}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "training_iteration": 6, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-30", "timestamp": 1744110090, "time_this_iter_s": 2.1800293922424316, "time_total_s": 12.687138795852661, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.687138795852661, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.0, "ram_util_percent": 88.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0146855443716047, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 1e-07, "total_loss": 2.1807656310498715, "policy_loss": -0.00020424161339178682, "vf_loss": 9.862048733234406, "vf_explained_var": 2.754107117652893e-06, "kl": 8.488278984475351e-07, "entropy": 2.845423159003258, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "env_runners": {"episode_reward_max": 172.21769020842368, "episode_reward_min": 95.48115448692765, "episode_reward_mean": 133.55950446631954, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 95.48115448692765}, "policy_reward_max": {"tplp_policy": 172.21769020842368}, "policy_reward_mean": {"tplp_policy": 133.55950446631954}, "custom_metrics": {"mean_episode_reward_mean": 133.55950446631954, "mean_episode_reward_min": 95.48115448692765, "mean_episode_reward_max": 172.21769020842368}, "hist_stats": {"episode_reward": [129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [129.89906958259553, 134.82832781161062, 127.93387245725238, 131.3748361762405, 145.24528164287938, 121.49546994889229, 123.56787143719878, 128.72555712378718, 139.57258994782654, 157.55445354734766, 122.0827055885265, 140.61374990267348, 160.39270612867782, 169.8006588336209, 167.91066422356457, 134.26860292318207, 135.59340054327964, 114.19334799620617, 133.32265360451888, 135.81640761496212, 131.44569819493714, 140.0847340929409, 141.8821022050781, 130.12958514791742, 123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6604666825172483, "mean_inference_ms": 1.8704126144189361, "mean_action_processing_ms": 0.3414529656185661, "mean_env_wait_ms": 2.0671760771159904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012000322341918945, "StateBufferConnector_ms": 0.008517265319824219, "ViewRequirementAgentConnector_ms": 0.17869162559509277}, "num_episodes": 18, "episode_return_max": 172.21769020842368, "episode_return_min": 95.48115448692765, "episode_return_mean": 133.55950446631954, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 468.63629574830713, "num_env_steps_trained_throughput_per_sec": 468.63629574830713, "timesteps_total": 7168, "num_env_steps_sampled_lifetime": 7168, "num_agent_steps_sampled_lifetime": 7168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 2119.693, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2119.693, "sample_time_ms": 881.186, "learn_time_ms": 1221.248, "learn_throughput": 838.486, "synch_weights_time_ms": 17.044}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "training_iteration": 7, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-32", "timestamp": 1744110092, "time_this_iter_s": 2.189887046813965, "time_total_s": 14.877025842666626, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.877025842666626, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.166666666666664, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.039902972429991, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 1e-07, "total_loss": 2.1698157764971255, "policy_loss": -0.00016204877465497702, "vf_loss": 9.818016469478607, "vf_explained_var": 5.942955613136291e-06, "kl": 7.505789845208e-07, "entropy": 2.845262664556503, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "env_runners": {"episode_reward_max": 172.21769020842368, "episode_reward_min": 95.48115448692765, "episode_reward_mean": 132.90296405783533, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 95.48115448692765}, "policy_reward_max": {"tplp_policy": 172.21769020842368}, "policy_reward_mean": {"tplp_policy": 132.90296405783533}, "custom_metrics": {"mean_episode_reward_mean": 132.90296405783533, "mean_episode_reward_min": 95.48115448692765, "mean_episode_reward_max": 172.21769020842368}, "hist_stats": {"episode_reward": [123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [123.69631726565434, 126.59463503781032, 124.48944473551254, 142.314370916861, 123.27400798779561, 138.69000504114248, 140.4534390053246, 141.80694392822633, 123.27644511166767, 165.2294865595574, 103.48166814363614, 145.1241009275971, 145.90452503815374, 120.71177148129914, 154.781248777602, 128.48126479491432, 141.61819704401378, 143.94617499046794, 125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6477503850719046, "mean_inference_ms": 1.8565545595664878, "mean_action_processing_ms": 0.3402830306051217, "mean_env_wait_ms": 2.057740546410996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014079093933105469, "StateBufferConnector_ms": 0.013077735900878906, "ViewRequirementAgentConnector_ms": 0.1867828369140625}, "num_episodes": 24, "episode_return_max": 172.21769020842368, "episode_return_min": 95.48115448692765, "episode_return_mean": 132.90296405783533, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.649311377483, "num_env_steps_trained_throughput_per_sec": 486.649311377483, "timesteps_total": 8192, "num_env_steps_sampled_lifetime": 8192, "num_agent_steps_sampled_lifetime": 8192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 2117.754, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2117.754, "sample_time_ms": 877.761, "learn_time_ms": 1223.091, "learn_throughput": 837.223, "synch_weights_time_ms": 16.715}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "training_iteration": 8, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-34", "timestamp": 1744110094, "time_this_iter_s": 2.1098403930664062, "time_total_s": 16.986866235733032, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C218A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16.986866235733032, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 32.96666666666667, "ram_util_percent": 88.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8018372815102337, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 1e-07, "total_loss": 2.184073378145695, "policy_loss": -0.0001313193526584655, "vf_loss": 9.87499229311943, "vf_explained_var": 3.6597251892089843e-06, "kl": 5.506373295549593e-07, "entropy": 2.8454337432980537, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "env_runners": {"episode_reward_max": 172.21769020842368, "episode_reward_min": 95.48115448692765, "episode_reward_mean": 131.99603773007752, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 95.48115448692765}, "policy_reward_max": {"tplp_policy": 172.21769020842368}, "policy_reward_mean": {"tplp_policy": 131.99603773007752}, "custom_metrics": {"mean_episode_reward_mean": 131.99603773007752, "mean_episode_reward_min": 95.48115448692765, "mean_episode_reward_max": 172.21769020842368}, "hist_stats": {"episode_reward": [125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [125.02193430268063, 139.4534458648707, 118.16103405903812, 143.87205111994123, 118.63803662068042, 144.28030134418137, 119.21756945070129, 118.33292753938444, 125.92481305274565, 132.00696462606166, 132.9310146494292, 130.21873993179565, 154.1875870641792, 129.5090018827614, 130.5217412317378, 139.2421868667402, 106.09073512213057, 147.49603351901624, 129.08205918422357, 118.86327299114933, 120.70304722812331, 139.5831846161729, 134.22814199908305, 124.4109612236765, 145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6426183092521197, "mean_inference_ms": 1.8518076875922886, "mean_action_processing_ms": 0.34101674610846805, "mean_env_wait_ms": 2.055173400937702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016073226928710938, "StateBufferConnector_ms": 0.01692342758178711, "ViewRequirementAgentConnector_ms": 0.1955714225769043}, "num_episodes": 18, "episode_return_max": 172.21769020842368, "episode_return_min": 95.48115448692765, "episode_return_mean": 131.99603773007752, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 451.42615447468677, "num_env_steps_trained_throughput_per_sec": 451.42615447468677, "timesteps_total": 9216, "num_env_steps_sampled_lifetime": 9216, "num_agent_steps_sampled_lifetime": 9216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 2134.489, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2134.489, "sample_time_ms": 870.087, "learn_time_ms": 1247.314, "learn_throughput": 820.964, "synch_weights_time_ms": 16.922}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "training_iteration": 9, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-37", "timestamp": 1744110097, "time_this_iter_s": 2.2762510776519775, "time_total_s": 19.26311731338501, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19.26311731338501, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 29.899999999999995, "ram_util_percent": 88.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1717192720621825, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 1e-07, "total_loss": 2.1559978291392325, "policy_loss": -0.00016459568287245928, "vf_loss": 9.762841939926147, "vf_explained_var": 3.3833086490631105e-06, "kl": 8.021454649398407e-07, "entropy": 2.8454806238412855, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "env_runners": {"episode_reward_max": 172.21769020842368, "episode_reward_min": 91.89016218491527, "episode_reward_mean": 133.52254328581787, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 91.89016218491527}, "policy_reward_max": {"tplp_policy": 172.21769020842368}, "policy_reward_mean": {"tplp_policy": 133.52254328581787}, "custom_metrics": {"mean_episode_reward_mean": 133.52254328581787, "mean_episode_reward_min": 91.89016218491527, "mean_episode_reward_max": 172.21769020842368}, "hist_stats": {"episode_reward": [145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.03751891123636, 139.3225989610531, 126.2344234006221, 157.03451598724757, 138.6753252121242, 148.0228411072836, 95.48115448692765, 121.52803226632653, 136.30866790208196, 130.30863361061049, 149.0973849191561, 130.68961015719722, 115.22217600741119, 151.71842480026015, 134.85140342561905, 100.27021666468625, 126.22576479496684, 129.56347945257235, 128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6435556460327929, "mean_inference_ms": 1.868090840302442, "mean_action_processing_ms": 0.3457551366067762, "mean_env_wait_ms": 2.0739241208937096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026767969131469727, "StateBufferConnector_ms": 0.012919902801513672, "ViewRequirementAgentConnector_ms": 0.19424653053283691}, "num_episodes": 24, "episode_return_max": 172.21769020842368, "episode_return_min": 91.89016218491527, "episode_return_mean": 133.52254328581787, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 424.81955130405265, "num_env_steps_trained_throughput_per_sec": 424.81955130405265, "timesteps_total": 10240, "num_env_steps_sampled_lifetime": 10240, "num_agent_steps_sampled_lifetime": 10240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 2162.084, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2162.084, "sample_time_ms": 895.382, "learn_time_ms": 1249.541, "learn_throughput": 819.501, "synch_weights_time_ms": 17.011}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "training_iteration": 10, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-39", "timestamp": 1744110099, "time_this_iter_s": 2.417046546936035, "time_total_s": 21.680163860321045, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21.680163860321045, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 44.9, "ram_util_percent": 88.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.837781197205186, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 1e-07, "total_loss": 2.160273124277592, "policy_loss": -7.120747468434275e-05, "vf_loss": 9.779740363359451, "vf_explained_var": 4.789233207702636e-06, "kl": 6.090522570501023e-07, "entropy": 2.8459076181054117, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "env_runners": {"episode_reward_max": 172.21769020842368, "episode_reward_min": 91.89016218491527, "episode_reward_mean": 134.04435587458974, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 91.89016218491527}, "policy_reward_max": {"tplp_policy": 172.21769020842368}, "policy_reward_mean": {"tplp_policy": 134.04435587458974}, "custom_metrics": {"mean_episode_reward_mean": 134.04435587458974, "mean_episode_reward_min": 91.89016218491527, "mean_episode_reward_max": 172.21769020842368}, "hist_stats": {"episode_reward": [128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [128.56468052787335, 140.3061405792614, 122.57817566879407, 150.27098126983424, 115.38193167687565, 126.3347412535475, 144.62529904565324, 121.81898253090293, 137.1916877217177, 107.78882820525087, 131.43129787770266, 123.31260573145617, 172.21769020842368, 120.47005244166364, 140.41455284463893, 144.06544802752057, 108.9820250748183, 157.27685427438718, 171.19795942212352, 138.33108470126572, 145.8449706553823, 130.69053459607883, 114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6466695986156563, "mean_inference_ms": 1.8771638442894485, "mean_action_processing_ms": 0.3485391486096955, "mean_env_wait_ms": 2.0838504455940194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02476024627685547, "StateBufferConnector_ms": 0.01239633560180664, "ViewRequirementAgentConnector_ms": 0.21164441108703613}, "num_episodes": 18, "episode_return_max": 172.21769020842368, "episode_return_min": 91.89016218491527, "episode_return_mean": 134.04435587458974, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.21408933501937, "num_env_steps_trained_throughput_per_sec": 486.21408933501937, "timesteps_total": 11264, "num_env_steps_sampled_lifetime": 11264, "num_agent_steps_sampled_lifetime": 11264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 2170.964, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2170.964, "sample_time_ms": 898.032, "learn_time_ms": 1255.798, "learn_throughput": 815.418, "synch_weights_time_ms": 16.983}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "training_iteration": 11, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-41", "timestamp": 1744110101, "time_this_iter_s": 2.110457181930542, "time_total_s": 23.790621042251587, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23.790621042251587, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4613498240709304, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 1e-07, "total_loss": 2.161415246129036, "policy_loss": -0.00025676393997855487, "vf_loss": 9.785429614782334, "vf_explained_var": 4.2282044887542725e-07, "kl": 1.569060368045161e-06, "entropy": 2.8468537792563438, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "env_runners": {"episode_reward_max": 169.7880226923536, "episode_reward_min": 91.89016218491527, "episode_reward_mean": 131.98831693802313, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 91.89016218491527}, "policy_reward_max": {"tplp_policy": 169.7880226923536}, "policy_reward_mean": {"tplp_policy": 131.98831693802313}, "custom_metrics": {"mean_episode_reward_mean": 131.98831693802313, "mean_episode_reward_min": 91.89016218491527, "mean_episode_reward_max": 169.7880226923536}, "hist_stats": {"episode_reward": [114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [114.81438277685115, 150.4038393081076, 116.01367670055447, 156.25440367773945, 133.7689665914649, 136.35613402074597, 104.2579696772181, 151.34859229888866, 118.60082925435553, 169.7880226923536, 151.37689504778953, 120.97674167973685, 99.71629397273749, 142.90992387470357, 119.3763038692644, 121.8336004787966, 141.27064755708977, 130.6896536248395, 138.5622876872087, 114.17057746935566, 108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6481256843093499, "mean_inference_ms": 1.8816899888402228, "mean_action_processing_ms": 0.35086941684133643, "mean_env_wait_ms": 2.0878452458500067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02171492576599121, "StateBufferConnector_ms": 0.011399030685424805, "ViewRequirementAgentConnector_ms": 0.19772839546203613}, "num_episodes": 22, "episode_return_max": 169.7880226923536, "episode_return_min": 91.89016218491527, "episode_return_mean": 131.98831693802313, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 500.04410154779674, "num_env_steps_trained_throughput_per_sec": 500.04410154779674, "timesteps_total": 12288, "num_env_steps_sampled_lifetime": 12288, "num_agent_steps_sampled_lifetime": 12288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 2143.846, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2143.846, "sample_time_ms": 893.813, "learn_time_ms": 1233.063, "learn_throughput": 830.453, "synch_weights_time_ms": 16.821}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "training_iteration": 12, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-43", "timestamp": 1744110103, "time_this_iter_s": 2.0538394451141357, "time_total_s": 25.844460487365723, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.844460487365723, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 28.299999999999997, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2371840465813877, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 1e-07, "total_loss": 2.1566292069852353, "policy_loss": -0.00017382559017278253, "vf_loss": 9.766190683841705, "vf_explained_var": 2.1830201148986816e-06, "kl": 9.298439259008972e-07, "entropy": 2.847446306049824, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "env_runners": {"episode_reward_max": 168.2516611018182, "episode_reward_min": 91.89016218491527, "episode_reward_mean": 131.59158642233072, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 91.89016218491527}, "policy_reward_max": {"tplp_policy": 168.2516611018182}, "policy_reward_mean": {"tplp_policy": 131.59158642233072}, "custom_metrics": {"mean_episode_reward_mean": 131.59158642233072, "mean_episode_reward_min": 91.89016218491527, "mean_episode_reward_max": 168.2516611018182}, "hist_stats": {"episode_reward": [108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [108.56613809371385, 118.3976290832249, 134.1366227102334, 149.31402851913268, 121.95214714109454, 138.18304025831216, 129.45285066895244, 102.48747050006894, 119.40782111406439, 126.92617874495645, 168.2516611018182, 130.4848639218929, 130.69434214790283, 145.78075465014936, 126.71575333979325, 139.69724685958172, 147.8136949702741, 122.44350008473228, 154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6500006182571032, "mean_inference_ms": 1.886919900001741, "mean_action_processing_ms": 0.3537127164780644, "mean_env_wait_ms": 2.0930576790922344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018676042556762695, "StateBufferConnector_ms": 0.006012439727783203, "ViewRequirementAgentConnector_ms": 0.19970417022705078}, "num_episodes": 20, "episode_return_max": 168.2516611018182, "episode_return_min": 91.89016218491527, "episode_return_mean": 131.59158642233072, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.70688548183216, "num_env_steps_trained_throughput_per_sec": 467.70688548183216, "timesteps_total": 13312, "num_env_steps_sampled_lifetime": 13312, "num_agent_steps_sampled_lifetime": 13312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 2144.191, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2144.191, "sample_time_ms": 884.896, "learn_time_ms": 1242.21, "learn_throughput": 824.337, "synch_weights_time_ms": 16.936}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "training_iteration": 13, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-46", "timestamp": 1744110106, "time_this_iter_s": 2.195122480392456, "time_total_s": 28.03958296775818, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.03958296775818, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.53333333333333, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.321609316393733, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 1e-07, "total_loss": 2.1774301059544086, "policy_loss": -0.00025364296161569657, "vf_loss": 9.850073033571244, "vf_explained_var": 1.792237162590027e-06, "kl": 1.7250290841874794e-06, "entropy": 2.8483450964093207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "env_runners": {"episode_reward_max": 164.98328240684586, "episode_reward_min": 91.89016218491527, "episode_reward_mean": 132.04217531693192, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 91.89016218491527}, "policy_reward_max": {"tplp_policy": 164.98328240684586}, "policy_reward_mean": {"tplp_policy": 132.04217531693192}, "custom_metrics": {"mean_episode_reward_mean": 132.04217531693192, "mean_episode_reward_min": 91.89016218491527, "mean_episode_reward_max": 164.98328240684586}, "hist_stats": {"episode_reward": [154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [154.30806547620418, 136.09518960496248, 134.28500818582623, 134.2487786510955, 117.25375787321309, 136.7968388335952, 117.40537894676152, 151.49996938934038, 145.42889477017522, 121.62220316542836, 136.32001795743614, 91.89016218491527, 147.21564272780492, 147.16537914172588, 160.97250523894635, 144.0808530188664, 142.4636546520974, 127.7926598442647, 164.6913364810439, 146.7454470950904, 125.53746749569672, 120.55093527504236, 141.4468110282833, 136.90339040726022, 137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6516955765648634, "mean_inference_ms": 1.8933798818359557, "mean_action_processing_ms": 0.35660954911683596, "mean_env_wait_ms": 2.101517976617296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189359188079834, "StateBufferConnector_ms": 0.007521390914916992, "ViewRequirementAgentConnector_ms": 0.19892072677612305}, "num_episodes": 18, "episode_return_max": 164.98328240684586, "episode_return_min": 91.89016218491527, "episode_return_mean": 132.04217531693192, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 442.5731280121865, "num_env_steps_trained_throughput_per_sec": 442.5731280121865, "timesteps_total": 14336, "num_env_steps_sampled_lifetime": 14336, "num_agent_steps_sampled_lifetime": 14336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 2179.5, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2179.5, "sample_time_ms": 890.667, "learn_time_ms": 1271.479, "learn_throughput": 805.361, "synch_weights_time_ms": 17.193}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "training_iteration": 14, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-48", "timestamp": 1744110108, "time_this_iter_s": 2.3192272186279297, "time_total_s": 30.35881018638611, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C239C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.35881018638611, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 42.23333333333333, "ram_util_percent": 88.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.175616820901632, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 1e-07, "total_loss": 2.17421211078763, "policy_loss": -0.0001357865345198661, "vf_loss": 9.837127029895782, "vf_explained_var": 1.924857497215271e-06, "kl": 9.062195705178411e-07, "entropy": 2.849338573217392, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "env_runners": {"episode_reward_max": 164.98328240684586, "episode_reward_min": 93.8680810409955, "episode_reward_mean": 131.2579090348535, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 93.8680810409955}, "policy_reward_max": {"tplp_policy": 164.98328240684586}, "policy_reward_mean": {"tplp_policy": 131.2579090348535}, "custom_metrics": {"mean_episode_reward_mean": 131.2579090348535, "mean_episode_reward_min": 93.8680810409955, "mean_episode_reward_max": 164.98328240684586}, "hist_stats": {"episode_reward": [137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.3557422742864, 145.19956451700423, 150.65156149983238, 135.58846220702526, 123.76014515616006, 119.07861386180554, 130.06686803305067, 103.39491162376281, 144.88594435754672, 128.6557439187124, 110.6906323550609, 155.16906898155838, 132.35560154313927, 149.3677303465607, 143.859385070319, 139.343253763202, 129.52852760833295, 130.84375465361512, 93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6505318085329622, "mean_inference_ms": 1.8918484909156366, "mean_action_processing_ms": 0.35783200435357243, "mean_env_wait_ms": 2.1013300910575547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007250785827636719, "StateBufferConnector_ms": 0.009515762329101562, "ViewRequirementAgentConnector_ms": 0.20446205139160156}, "num_episodes": 24, "episode_return_max": 164.98328240684586, "episode_return_min": 93.8680810409955, "episode_return_mean": 131.2579090348535, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 487.21250794633204, "num_env_steps_trained_throughput_per_sec": 487.21250794633204, "timesteps_total": 15360, "num_env_steps_sampled_lifetime": 15360, "num_agent_steps_sampled_lifetime": 15360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 2190.109, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2190.109, "sample_time_ms": 904.512, "learn_time_ms": 1268.384, "learn_throughput": 807.326, "synch_weights_time_ms": 17.052}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "training_iteration": 15, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-50", "timestamp": 1744110110, "time_this_iter_s": 2.1064841747283936, "time_total_s": 32.4652943611145, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 32.4652943611145, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 41.63333333333333, "ram_util_percent": 88.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2669321194291117, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 1e-07, "total_loss": 2.171156080812216, "policy_loss": -0.00017246348434127868, "vf_loss": 9.825293081998826, "vf_explained_var": 1.7508864402770996e-06, "kl": 1.2704092311688343e-06, "entropy": 2.8499471694231033, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "env_runners": {"episode_reward_max": 164.98328240684586, "episode_reward_min": 93.8680810409955, "episode_reward_mean": 131.6439384155153, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 93.8680810409955}, "policy_reward_max": {"tplp_policy": 164.98328240684586}, "policy_reward_mean": {"tplp_policy": 131.6439384155153}, "custom_metrics": {"mean_episode_reward_mean": 131.6439384155153, "mean_episode_reward_min": 93.8680810409955, "mean_episode_reward_max": 164.98328240684586}, "hist_stats": {"episode_reward": [93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [93.8680810409955, 102.76279870657531, 137.21341692263513, 140.03450697895923, 122.54014678856397, 127.59779985323915, 131.12867683578392, 128.6127647726087, 110.09716702214737, 129.6421631904255, 123.37781519307717, 122.66359438543161, 124.53842904772478, 117.47798032207245, 144.94074453485072, 120.62707269891168, 131.53681334394744, 136.50816238710348, 129.0740411013855, 138.8781732901277, 135.91683892824935, 146.38244102072113, 102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6496438710342853, "mean_inference_ms": 1.8893689920862355, "mean_action_processing_ms": 0.35799499625726944, "mean_env_wait_ms": 2.1011281650422045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073931217193603516, "StateBufferConnector_ms": 0.007520437240600586, "ViewRequirementAgentConnector_ms": 0.18285751342773438}, "num_episodes": 18, "episode_return_max": 164.98328240684586, "episode_return_min": 93.8680810409955, "episode_return_mean": 131.6439384155153, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.5601974458064, "num_env_steps_trained_throughput_per_sec": 467.5601974458064, "timesteps_total": 16384, "num_env_steps_sampled_lifetime": 16384, "num_agent_steps_sampled_lifetime": 16384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 2191.693, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2191.693, "sample_time_ms": 901.788, "learn_time_ms": 1272.618, "learn_throughput": 804.641, "synch_weights_time_ms": 17.21}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "training_iteration": 16, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-52", "timestamp": 1744110112, "time_this_iter_s": 2.1964340209960938, "time_total_s": 34.661728382110596, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 34.661728382110596, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 88.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3431847736239435, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 1e-07, "total_loss": 2.179841201007366, "policy_loss": -0.0001823821454308927, "vf_loss": 9.860657924413681, "vf_explained_var": 1.7862766981124878e-06, "kl": 1.4608166547303013e-06, "entropy": 2.851408949494362, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "env_runners": {"episode_reward_max": 165.72121785374136, "episode_reward_min": 101.06100223809493, "episode_reward_mean": 133.68047711049195, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.06100223809493}, "policy_reward_max": {"tplp_policy": 165.72121785374136}, "policy_reward_mean": {"tplp_policy": 133.68047711049195}, "custom_metrics": {"mean_episode_reward_mean": 133.68047711049195, "mean_episode_reward_min": 101.06100223809493, "mean_episode_reward_max": 165.72121785374136}, "hist_stats": {"episode_reward": [102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [102.12662289296253, 137.1335145418508, 130.79820418714706, 137.09286935794879, 122.81187448660651, 118.2870525495824, 136.61277215369898, 118.23072536196341, 142.36904823350773, 125.18517017531278, 113.2085735904731, 125.20851687727863, 126.86762324477824, 128.22212195550063, 132.97920905053596, 120.423402048465, 148.6564600796102, 144.3036499543623, 164.98328240684586, 141.16786298364764, 122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6502578467490846, "mean_inference_ms": 1.8909619691981698, "mean_action_processing_ms": 0.3584219153454994, "mean_env_wait_ms": 2.104772885852142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073931217193603516, "StateBufferConnector_ms": 0.008509635925292969, "ViewRequirementAgentConnector_ms": 0.19601154327392578}, "num_episodes": 22, "episode_return_max": 165.72121785374136, "episode_return_min": 101.06100223809493, "episode_return_mean": 133.68047711049195, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 456.442638167142, "num_env_steps_trained_throughput_per_sec": 456.442638167142, "timesteps_total": 17408, "num_env_steps_sampled_lifetime": 17408, "num_agent_steps_sampled_lifetime": 17408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 2197.53, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2197.53, "sample_time_ms": 904.018, "learn_time_ms": 1276.772, "learn_throughput": 802.022, "synch_weights_time_ms": 16.714}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "training_iteration": 17, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-55", "timestamp": 1744110115, "time_this_iter_s": 2.2489888668060303, "time_total_s": 36.910717248916626, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.910717248916626, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 44.26666666666666, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.364741766452789, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 1e-07, "total_loss": 2.1555168703198433, "policy_loss": -0.00023129074252210559, "vf_loss": 9.764116042852402, "vf_explained_var": 1.107528805732727e-06, "kl": 1.6091925835279297e-06, "entropy": 2.85280851572752, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "env_runners": {"episode_reward_max": 165.72121785374136, "episode_reward_min": 101.06100223809493, "episode_reward_mean": 133.98808729353476, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.06100223809493}, "policy_reward_max": {"tplp_policy": 165.72121785374136}, "policy_reward_mean": {"tplp_policy": 133.98808729353476}, "custom_metrics": {"mean_episode_reward_mean": 133.98808729353476, "mean_episode_reward_min": 101.06100223809493, "mean_episode_reward_max": 165.72121785374136}, "hist_stats": {"episode_reward": [122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [122.3365542270304, 155.51042656005478, 130.7546673493317, 118.76946651083048, 137.5495676530298, 138.51507519919835, 142.82127416964738, 123.25122007621121, 113.87747409081742, 160.08555958026596, 108.53597087596143, 103.6320443650181, 133.1609325240686, 142.8427470067105, 134.2946881092357, 133.6758196821134, 120.43870225307145, 123.64091077361144, 146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6508768084771718, "mean_inference_ms": 1.8919517623201543, "mean_action_processing_ms": 0.3589691057468943, "mean_env_wait_ms": 2.1076966754449615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009168863296508789, "StateBufferConnector_ms": 0.009119033813476562, "ViewRequirementAgentConnector_ms": 0.22264766693115234}, "num_episodes": 20, "episode_return_max": 165.72121785374136, "episode_return_min": 101.06100223809493, "episode_return_mean": 133.98808729353476, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 501.82994600408875, "num_env_steps_trained_throughput_per_sec": 501.82994600408875, "timesteps_total": 18432, "num_env_steps_sampled_lifetime": 18432, "num_agent_steps_sampled_lifetime": 18432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 2191.165, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2191.165, "sample_time_ms": 907.937, "learn_time_ms": 1266.518, "learn_throughput": 808.516, "synch_weights_time_ms": 16.683}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "training_iteration": 18, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-57", "timestamp": 1744110117, "time_this_iter_s": 2.0450901985168457, "time_total_s": 38.95580744743347, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C223E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.95580744743347, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 37.23333333333333, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.326893984153867, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 1e-07, "total_loss": 2.1658316008746623, "policy_loss": -0.00020678488072007896, "vf_loss": 9.805515956878661, "vf_explained_var": 8.832663297653198e-07, "kl": 8.338782094829966e-07, "entropy": 2.853405995666981, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "env_runners": {"episode_reward_max": 165.72121785374136, "episode_reward_min": 101.06100223809493, "episode_reward_mean": 134.571753937937, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.06100223809493}, "policy_reward_max": {"tplp_policy": 165.72121785374136}, "policy_reward_mean": {"tplp_policy": 134.571753937937}, "custom_metrics": {"mean_episode_reward_mean": 134.571753937937, "mean_episode_reward_min": 101.06100223809493, "mean_episode_reward_max": 165.72121785374136}, "hist_stats": {"episode_reward": [146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [146.34246807111748, 122.073693030279, 163.84922810416109, 130.02533670512426, 149.45071137563232, 104.90502971161585, 118.02258371818372, 138.53871885186916, 134.96106698935728, 144.7695744640121, 153.134785517047, 125.02408516485636, 133.45740473272784, 145.2284351572297, 124.54742870557861, 149.95217931608036, 101.06100223809493, 129.2186615886358, 122.74057245039117, 122.79650248002304, 164.68751865836865, 135.42711918016283, 138.5952764576421, 130.800104640446, 144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6507763185711817, "mean_inference_ms": 1.8923131261363637, "mean_action_processing_ms": 0.3593057275004867, "mean_env_wait_ms": 2.108077781623644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005917549133300781, "StateBufferConnector_ms": 0.009755611419677734, "ViewRequirementAgentConnector_ms": 0.21295809745788574}, "num_episodes": 18, "episode_return_max": 165.72121785374136, "episode_return_min": 101.06100223809493, "episode_return_mean": 134.571753937937, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 503.6992323893621, "num_env_steps_trained_throughput_per_sec": 503.6992323893621, "timesteps_total": 19456, "num_env_steps_sampled_lifetime": 19456, "num_agent_steps_sampled_lifetime": 19456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 2167.624, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2167.624, "sample_time_ms": 911.986, "learn_time_ms": 1239.267, "learn_throughput": 826.295, "synch_weights_time_ms": 16.344}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "training_iteration": 19, "trial_id": "b517c_00000", "date": "2025-04-08_19-01-59", "timestamp": 1744110119, "time_this_iter_s": 2.038203239440918, "time_total_s": 40.99401068687439, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.99401068687439, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 29.63333333333333, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2235205247998238, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 1e-07, "total_loss": 2.162496715784073, "policy_loss": -0.00010389063390903175, "vf_loss": 9.791866618394852, "vf_explained_var": 9.253621101379395e-07, "kl": 6.93508062733772e-07, "entropy": 2.853660325706005, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "env_runners": {"episode_reward_max": 165.72121785374136, "episode_reward_min": 96.04962397643897, "episode_reward_mean": 134.08969305594414, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 96.04962397643897}, "policy_reward_max": {"tplp_policy": 165.72121785374136}, "policy_reward_mean": {"tplp_policy": 134.08969305594414}, "custom_metrics": {"mean_episode_reward_mean": 134.08969305594414, "mean_episode_reward_min": 96.04962397643897, "mean_episode_reward_max": 165.72121785374136}, "hist_stats": {"episode_reward": [144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.10918621191485, 126.80892324141207, 147.07276188586914, 152.27497813873936, 144.39854016728182, 128.0177430538158, 127.6453337420373, 139.38452390921944, 131.60860693172333, 124.78871144002444, 142.2884582120747, 133.17791380966804, 108.90572404567256, 132.42883237564394, 153.52944007907846, 142.56339149489278, 113.77534708131782, 142.81539129324776, 136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6500930731999641, "mean_inference_ms": 1.8893377095047494, "mean_action_processing_ms": 0.3587230073783567, "mean_env_wait_ms": 2.10370626187904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009524106979370117, "StateBufferConnector_ms": 0.009765386581420898, "ViewRequirementAgentConnector_ms": 0.23080921173095703}, "num_episodes": 24, "episode_return_max": 165.72121785374136, "episode_return_min": 96.04962397643897, "episode_return_mean": 134.08969305594414, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 483.94755658708345, "num_env_steps_trained_throughput_per_sec": 483.94755658708345, "timesteps_total": 20480, "num_env_steps_sampled_lifetime": 20480, "num_agent_steps_sampled_lifetime": 20480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 2138.174, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2138.174, "sample_time_ms": 880.055, "learn_time_ms": 1241.693, "learn_throughput": 824.68, "synch_weights_time_ms": 16.399}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "training_iteration": 20, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-01", "timestamp": 1744110121, "time_this_iter_s": 2.1219234466552734, "time_total_s": 43.11593413352966, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 43.11593413352966, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 29.133333333333336, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3325688283890487, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 1e-07, "total_loss": 2.1735499888658523, "policy_loss": -0.0002270881086587906, "vf_loss": 9.836744505167008, "vf_explained_var": 5.874782800674438e-07, "kl": 9.018836433782873e-07, "entropy": 2.8540904983878135, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "env_runners": {"episode_reward_max": 165.72121785374136, "episode_reward_min": 96.04962397643897, "episode_reward_mean": 133.5677776732073, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 96.04962397643897}, "policy_reward_max": {"tplp_policy": 165.72121785374136}, "policy_reward_mean": {"tplp_policy": 133.5677776732073}, "custom_metrics": {"mean_episode_reward_mean": 133.5677776732073, "mean_episode_reward_min": 96.04962397643897, "mean_episode_reward_max": 165.72121785374136}, "hist_stats": {"episode_reward": [136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [136.17512660339236, 151.1054201778803, 125.87534172460678, 116.52474659550299, 127.84797733085284, 138.00728906424285, 133.76176091429784, 165.72121785374136, 121.15922109380642, 126.16604077369993, 148.20887925131308, 161.98862656156146, 131.0754273914906, 135.76470073061313, 145.26398355898294, 128.74560241963252, 137.4898600354722, 144.14352768546152, 121.23578638946147, 146.22222333262698, 159.61276669263708, 120.33789122991944, 124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6502111550846172, "mean_inference_ms": 1.8893074898248656, "mean_action_processing_ms": 0.35833244626584565, "mean_env_wait_ms": 2.103774952130986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009382009506225586, "StateBufferConnector_ms": 0.010763406753540039, "ViewRequirementAgentConnector_ms": 0.23824715614318848}, "num_episodes": 18, "episode_return_max": 165.72121785374136, "episode_return_min": 96.04962397643897, "episode_return_mean": 133.5677776732073, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 413.4619714613763, "num_env_steps_trained_throughput_per_sec": 413.4619714613763, "timesteps_total": 21504, "num_env_steps_sampled_lifetime": 21504, "num_agent_steps_sampled_lifetime": 21504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 2175.232, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2175.232, "sample_time_ms": 891.545, "learn_time_ms": 1267.22, "learn_throughput": 808.068, "synch_weights_time_ms": 16.44}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "training_iteration": 21, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-03", "timestamp": 1744110123, "time_this_iter_s": 2.483330011367798, "time_total_s": 45.59926414489746, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.59926414489746, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 52.9, "ram_util_percent": 88.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.387351965904236, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 1e-07, "total_loss": 2.173354984819889, "policy_loss": -0.0002296617196407169, "vf_loss": 9.835799473524094, "vf_explained_var": 1.426786184310913e-07, "kl": 8.719038965293579e-07, "entropy": 2.853652314841747, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "env_runners": {"episode_reward_max": 163.39962582321252, "episode_reward_min": 96.04962397643897, "episode_reward_mean": 133.82482061814548, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 96.04962397643897}, "policy_reward_max": {"tplp_policy": 163.39962582321252}, "policy_reward_mean": {"tplp_policy": 133.82482061814548}, "custom_metrics": {"mean_episode_reward_mean": 133.82482061814548, "mean_episode_reward_min": 96.04962397643897, "mean_episode_reward_max": 163.39962582321252}, "hist_stats": {"episode_reward": [124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [124.3602851409464, 154.39443409743018, 126.97363222295327, 129.31844143644858, 117.90191641871192, 123.53550235804931, 123.40011689970179, 163.39962582321252, 128.9148354835823, 141.77170194149636, 141.95930634307854, 119.43376881031438, 120.50670286421155, 137.1247644657377, 142.71762373203438, 136.79087531367597, 132.52928315679142, 102.44610000542606, 140.32568601237898, 144.54168908872307, 121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6502920073958797, "mean_inference_ms": 1.8890941973105564, "mean_action_processing_ms": 0.3578108270949808, "mean_env_wait_ms": 2.1024690523946195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008493900299072266, "StateBufferConnector_ms": 0.01086735725402832, "ViewRequirementAgentConnector_ms": 0.2153306007385254}, "num_episodes": 22, "episode_return_max": 163.39962582321252, "episode_return_min": 96.04962397643897, "episode_return_mean": 133.82482061814548, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 480.6320909579938, "num_env_steps_trained_throughput_per_sec": 480.6320909579938, "timesteps_total": 22528, "num_env_steps_sampled_lifetime": 22528, "num_agent_steps_sampled_lifetime": 22528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 2183.503, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2183.503, "sample_time_ms": 903.166, "learn_time_ms": 1263.626, "learn_throughput": 810.366, "synch_weights_time_ms": 16.481}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "training_iteration": 22, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-06", "timestamp": 1744110126, "time_this_iter_s": 2.135551929473877, "time_total_s": 47.73481607437134, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C231A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 47.73481607437134, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 29.375000000000004, "ram_util_percent": 87.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.126303069666028, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 1e-07, "total_loss": 2.1828943021595477, "policy_loss": -0.00014270314713940024, "vf_loss": 9.873362869024277, "vf_explained_var": -1.0803341865539551e-07, "kl": 5.3697929272567e-07, "entropy": 2.853036975860596, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "env_runners": {"episode_reward_max": 160.73249613262394, "episode_reward_min": 96.04962397643897, "episode_reward_mean": 134.83838405703477, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 96.04962397643897}, "policy_reward_max": {"tplp_policy": 160.73249613262394}, "policy_reward_mean": {"tplp_policy": 134.83838405703477}, "custom_metrics": {"mean_episode_reward_mean": 134.83838405703477, "mean_episode_reward_min": 96.04962397643897, "mean_episode_reward_max": 160.73249613262394}, "hist_stats": {"episode_reward": [121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [121.91955618746402, 120.61970671941559, 144.96501602045893, 121.2600265747893, 134.0620744572889, 134.52031945765486, 106.37477706164753, 150.35770387987293, 131.79096913742262, 142.91307059098062, 110.31788026653614, 155.48572177848962, 144.438968881821, 150.116882264278, 114.7161151208013, 133.3336019464056, 159.28056668891753, 137.06264325658876, 137.57143600033672, 110.24573486024465, 136.4976609170126, 150.81172769387513, 148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6500724371613793, "mean_inference_ms": 1.8880321000527758, "mean_action_processing_ms": 0.3568179757077699, "mean_env_wait_ms": 2.100543646121115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008712053298950195, "StateBufferConnector_ms": 0.012217044830322266, "ViewRequirementAgentConnector_ms": 0.2205040454864502}, "num_episodes": 20, "episode_return_max": 160.73249613262394, "episode_return_min": 96.04962397643897, "episode_return_mean": 134.83838405703477, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 517.5320960908376, "num_env_steps_trained_throughput_per_sec": 517.5320960908376, "timesteps_total": 23552, "num_env_steps_sampled_lifetime": 23552, "num_agent_steps_sampled_lifetime": 23552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 2162.424, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2162.424, "sample_time_ms": 895.961, "learn_time_ms": 1250.098, "learn_throughput": 819.136, "synch_weights_time_ms": 16.136}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "training_iteration": 23, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-08", "timestamp": 1744110128, "time_this_iter_s": 1.9833483695983887, "time_total_s": 49.71816444396973, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.71816444396973, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 42.099999999999994, "ram_util_percent": 87.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.998252997174859, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 1e-07, "total_loss": 2.1674490168690683, "policy_loss": -5.2649161079898474e-05, "vf_loss": 9.811380940675736, "vf_explained_var": -2.212822437286377e-07, "kl": 7.837754922190853e-07, "entropy": 2.853435555100441, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "env_runners": {"episode_reward_max": 160.73249613262394, "episode_reward_min": 96.04962397643897, "episode_reward_mean": 135.41978141749422, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 96.04962397643897}, "policy_reward_max": {"tplp_policy": 160.73249613262394}, "policy_reward_mean": {"tplp_policy": 135.41978141749422}, "custom_metrics": {"mean_episode_reward_mean": 135.41978141749422, "mean_episode_reward_min": 96.04962397643897, "mean_episode_reward_max": 160.73249613262394}, "hist_stats": {"episode_reward": [148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.97905499742262, 149.58525848667662, 128.95478207894018, 126.40232049184624, 140.86574667567325, 140.93261974211697, 113.49836263210015, 151.3719648349812, 149.97556497687205, 122.35971264590042, 117.26558487354202, 140.60301694531154, 151.64562348088734, 124.7075543784993, 115.58804808860216, 103.80454787104097, 127.34424251552262, 96.04962397643897, 149.2742478595288, 138.1640773635961, 123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6509099522602171, "mean_inference_ms": 1.8869504779271877, "mean_action_processing_ms": 0.35579788381479505, "mean_env_wait_ms": 2.0991063147718934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010706901550292969, "StateBufferConnector_ms": 0.00807642936706543, "ViewRequirementAgentConnector_ms": 0.22483587265014648}, "num_episodes": 22, "episode_return_max": 160.73249613262394, "episode_return_min": 96.04962397643897, "episode_return_mean": 135.41978141749422, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 468.9364926318543, "num_env_steps_trained_throughput_per_sec": 468.9364926318543, "timesteps_total": 24576, "num_env_steps_sampled_lifetime": 24576, "num_agent_steps_sampled_lifetime": 24576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 2149.417, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2149.417, "sample_time_ms": 893.674, "learn_time_ms": 1239.176, "learn_throughput": 826.355, "synch_weights_time_ms": 16.348}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "training_iteration": 24, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-10", "timestamp": 1744110130, "time_this_iter_s": 2.190399646759033, "time_total_s": 51.90856409072876, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C20C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.90856409072876, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 29.325, "ram_util_percent": 87.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.067958753183484, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 1e-07, "total_loss": 2.1729112483561037, "policy_loss": -0.0001330193888861686, "vf_loss": 9.833974266052246, "vf_explained_var": -7.748603820800781e-07, "kl": 7.999121778567986e-07, "entropy": 2.854493056237698, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "env_runners": {"episode_reward_max": 160.73249613262394, "episode_reward_min": 104.71001651511015, "episode_reward_mean": 136.563913176597, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 104.71001651511015}, "policy_reward_max": {"tplp_policy": 160.73249613262394}, "policy_reward_mean": {"tplp_policy": 136.563913176597}, "custom_metrics": {"mean_episode_reward_mean": 136.563913176597, "mean_episode_reward_min": 104.71001651511015, "mean_episode_reward_max": 160.73249613262394}, "hist_stats": {"episode_reward": [123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [123.71283407859862, 138.07959708428132, 116.37414179077919, 113.14620559081524, 104.71001651511015, 143.73941800470467, 152.4690507306464, 133.97441011098405, 136.84442478866887, 128.2309105925727, 138.96714656768347, 138.89826090165022, 129.4302082821886, 140.44302946691582, 127.89752379424723, 129.04676531698223, 124.15615885131551, 149.55683738209868, 126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6515956218554382, "mean_inference_ms": 1.8882209905103253, "mean_action_processing_ms": 0.3552413446389535, "mean_env_wait_ms": 2.100553062253687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008087635040283203, "StateBufferConnector_ms": 0.00807642936706543, "ViewRequirementAgentConnector_ms": 0.2167825698852539}, "num_episodes": 20, "episode_return_max": 160.73249613262394, "episode_return_min": 104.71001651511015, "episode_return_mean": 136.563913176597, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.44193646724614, "num_env_steps_trained_throughput_per_sec": 467.44193646724614, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 25600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 2158.306, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2158.306, "sample_time_ms": 891.4, "learn_time_ms": 1250.3, "learn_throughput": 819.004, "synch_weights_time_ms": 16.388}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "training_iteration": 25, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-12", "timestamp": 1744110132, "time_this_iter_s": 2.19647479057312, "time_total_s": 54.10503888130188, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C216C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.10503888130188, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 39.666666666666664, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3185349315404893, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 1e-07, "total_loss": 2.1841788560152056, "policy_loss": -0.00022735765669494866, "vf_loss": 9.879683643579483, "vf_explained_var": -1.1689960956573487e-06, "kl": 1.2139058824800486e-06, "entropy": 2.855146822333336, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "env_runners": {"episode_reward_max": 178.5161538931506, "episode_reward_min": 113.55253765200119, "episode_reward_mean": 137.74417178396578, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 113.55253765200119}, "policy_reward_max": {"tplp_policy": 178.5161538931506}, "policy_reward_mean": {"tplp_policy": 137.74417178396578}, "custom_metrics": {"mean_episode_reward_mean": 137.74417178396578, "mean_episode_reward_min": 113.55253765200119, "mean_episode_reward_max": 178.5161538931506}, "hist_stats": {"episode_reward": [126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [126.78044491334023, 154.29278183657135, 131.7084726896621, 134.76444888030102, 134.6463159500021, 133.11054483596016, 134.72862682783386, 147.11403907527085, 153.76017351285864, 124.69172469208151, 147.23400881944318, 128.0563151692211, 137.09291281217392, 147.8417881156788, 136.23698132235614, 153.47579164635883, 125.35258748190486, 130.92800015368206, 149.13945503715306, 143.46930189974492, 160.73249613262394, 137.82965103537197, 148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6514383929979028, "mean_inference_ms": 1.886151371517726, "mean_action_processing_ms": 0.3545621213612558, "mean_env_wait_ms": 2.097079760227255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008091211318969727, "StateBufferConnector_ms": 0.00908660888671875, "ViewRequirementAgentConnector_ms": 0.21497225761413574}, "num_episodes": 18, "episode_return_max": 178.5161538931506, "episode_return_min": 113.55253765200119, "episode_return_mean": 137.74417178396578, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 500.4966894717768, "num_env_steps_trained_throughput_per_sec": 500.4966894717768, "timesteps_total": 26624, "num_env_steps_sampled_lifetime": 26624, "num_agent_steps_sampled_lifetime": 26624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 2143.894, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2143.894, "sample_time_ms": 883.999, "learn_time_ms": 1243.468, "learn_throughput": 823.503, "synch_weights_time_ms": 16.223}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "training_iteration": 26, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-14", "timestamp": 1744110134, "time_this_iter_s": 2.050739288330078, "time_total_s": 56.15577816963196, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.15577816963196, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 28.566666666666666, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.982626632228494, "cur_kl_coeff": 2.980232238769531e-09, "cur_lr": 1e-07, "total_loss": 2.1791643634438516, "policy_loss": -0.0001394223771058023, "vf_loss": 9.859537744522095, "vf_explained_var": -1.705065369606018e-06, "kl": 6.927322801275615e-07, "entropy": 2.8558065414428713, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "env_runners": {"episode_reward_max": 178.5161538931506, "episode_reward_min": 110.49099629777106, "episode_reward_mean": 136.5603112042478, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.49099629777106}, "policy_reward_max": {"tplp_policy": 178.5161538931506}, "policy_reward_mean": {"tplp_policy": 136.5603112042478}, "custom_metrics": {"mean_episode_reward_mean": 136.5603112042478, "mean_episode_reward_min": 110.49099629777106, "mean_episode_reward_max": 178.5161538931506}, "hist_stats": {"episode_reward": [148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.21963016386766, 144.67618083836348, 141.36502182460282, 155.84916288578535, 113.55253765200119, 138.7032862945169, 125.3142512500267, 118.96767132884419, 144.83460820112475, 141.79981596807002, 120.52824080309665, 139.86979655216038, 127.20815682785914, 125.06936028694952, 138.172138655124, 152.47766508260005, 132.7736026347242, 145.75936108612018, 131.09495172642343, 115.88374988236684, 153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6505548344086123, "mean_inference_ms": 1.8819533350376032, "mean_action_processing_ms": 0.3534622757988871, "mean_env_wait_ms": 2.0919844944392256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009976625442504883, "StateBufferConnector_ms": 0.005510091781616211, "ViewRequirementAgentConnector_ms": 0.22181916236877441}, "num_episodes": 22, "episode_return_max": 178.5161538931506, "episode_return_min": 110.49099629777106, "episode_return_mean": 136.5603112042478, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 523.4465366892504, "num_env_steps_trained_throughput_per_sec": 523.4465366892504, "timesteps_total": 27648, "num_env_steps_sampled_lifetime": 27648, "num_agent_steps_sampled_lifetime": 27648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 2115.176, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2115.176, "sample_time_ms": 871.406, "learn_time_ms": 1227.315, "learn_throughput": 834.341, "synch_weights_time_ms": 16.252}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "training_iteration": 27, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-16", "timestamp": 1744110136, "time_this_iter_s": 1.9618964195251465, "time_total_s": 58.117674589157104, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.117674589157104, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 38.85, "ram_util_percent": 87.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.836407931149006, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 1e-07, "total_loss": 2.187376885861158, "policy_loss": -0.0001207440800499171, "vf_loss": 9.892271149158478, "vf_explained_var": -1.743808388710022e-06, "kl": 4.842251952630327e-07, "entropy": 2.855701541900635, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "env_runners": {"episode_reward_max": 178.5161538931506, "episode_reward_min": 110.49099629777106, "episode_reward_mean": 136.64444725354994, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.49099629777106}, "policy_reward_max": {"tplp_policy": 178.5161538931506}, "policy_reward_mean": {"tplp_policy": 136.64444725354994}, "custom_metrics": {"mean_episode_reward_mean": 136.64444725354994, "mean_episode_reward_min": 110.49099629777106, "mean_episode_reward_max": 178.5161538931506}, "hist_stats": {"episode_reward": [153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [153.17418790296983, 130.07596822830578, 126.50314366596551, 157.0303769582064, 132.07691431404612, 132.46395773897663, 141.4786585137428, 130.7033365126924, 144.63079683772517, 153.34826420757605, 151.3325056238879, 134.48930821513662, 122.63511219257394, 125.37907494638792, 138.79098758353985, 148.49715105383856, 138.47172070230778, 132.32780488357832, 137.98159340809707, 128.43233070990354, 126.51767754236757, 136.9168060338152, 149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6502005631141816, "mean_inference_ms": 1.8796126255677696, "mean_action_processing_ms": 0.35256028742373396, "mean_env_wait_ms": 2.0895658968434327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010093927383422852, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.21788454055786133}, "num_episodes": 20, "episode_return_max": 178.5161538931506, "episode_return_min": 110.49099629777106, "episode_return_mean": 136.64444725354994, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 460.3365633593528, "num_env_steps_trained_throughput_per_sec": 460.3365633593528, "timesteps_total": 28672, "num_env_steps_sampled_lifetime": 28672, "num_agent_steps_sampled_lifetime": 28672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 2133.569, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2133.569, "sample_time_ms": 872.305, "learn_time_ms": 1244.516, "learn_throughput": 822.81, "synch_weights_time_ms": 16.545}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "training_iteration": 28, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-19", "timestamp": 1744110139, "time_this_iter_s": 2.2305526733398438, "time_total_s": 60.34822726249695, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.34822726249695, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 35.800000000000004, "ram_util_percent": 87.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1252399675548075, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 1e-07, "total_loss": 2.175646635890007, "policy_loss": -0.00010196993825957179, "vf_loss": 9.845343756675721, "vf_explained_var": -1.5806406736373902e-06, "kl": 8.716251711282652e-07, "entropy": 2.8558734133839607, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "env_runners": {"episode_reward_max": 178.5161538931506, "episode_reward_min": 88.45331157338894, "episode_reward_mean": 135.59834250942103, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 88.45331157338894}, "policy_reward_max": {"tplp_policy": 178.5161538931506}, "policy_reward_mean": {"tplp_policy": 135.59834250942103}, "custom_metrics": {"mean_episode_reward_mean": 135.59834250942103, "mean_episode_reward_min": 88.45331157338894, "mean_episode_reward_max": 178.5161538931506}, "hist_stats": {"episode_reward": [149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [149.10947141538023, 151.1083373633884, 147.44965045900463, 117.02163585152775, 144.88782361821265, 143.85289911501823, 127.47092340085062, 147.14557041616604, 124.54349633618646, 141.12110997915295, 141.5308484430771, 134.1906424388912, 145.32752999835944, 136.5999972223925, 137.76653722886766, 121.11727271535332, 150.89532003055166, 127.2115812172123, 120.15240450639376, 136.55314196455438, 127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6503631469257417, "mean_inference_ms": 1.8796969122712779, "mean_action_processing_ms": 0.3522835069380894, "mean_env_wait_ms": 2.088192401194082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00911569595336914, "StateBufferConnector_ms": 0.005504131317138672, "ViewRequirementAgentConnector_ms": 0.23831629753112793}, "num_episodes": 22, "episode_return_max": 178.5161538931506, "episode_return_min": 88.45331157338894, "episode_return_mean": 135.59834250942103, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 481.79618755531726, "num_env_steps_trained_throughput_per_sec": 481.79618755531726, "timesteps_total": 29696, "num_env_steps_sampled_lifetime": 29696, "num_agent_steps_sampled_lifetime": 29696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 2142.811, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2142.811, "sample_time_ms": 882.348, "learn_time_ms": 1243.652, "learn_throughput": 823.382, "synch_weights_time_ms": 16.608}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "training_iteration": 29, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-21", "timestamp": 1744110141, "time_this_iter_s": 2.130824089050293, "time_total_s": 62.47905135154724, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.47905135154724, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 41.766666666666666, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.124948186799884, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 1e-07, "total_loss": 2.1882164970040323, "policy_loss": -0.00020470684394240378, "vf_loss": 9.89598415493965, "vf_explained_var": -1.455843448638916e-06, "kl": 8.753366951497199e-07, "entropy": 2.855748437345028, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "env_runners": {"episode_reward_max": 178.5161538931506, "episode_reward_min": 88.45331157338894, "episode_reward_mean": 135.03318524192886, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 88.45331157338894}, "policy_reward_max": {"tplp_policy": 178.5161538931506}, "policy_reward_mean": {"tplp_policy": 135.03318524192886}, "custom_metrics": {"mean_episode_reward_mean": 135.03318524192886, "mean_episode_reward_min": 88.45331157338894, "mean_episode_reward_max": 178.5161538931506}, "hist_stats": {"episode_reward": [127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [127.07185148262353, 139.58368675608745, 148.89308710645665, 131.3728432751516, 145.13390028790027, 151.0138532140489, 114.41674667231189, 119.4682271114073, 125.15458795718222, 178.5161538931506, 134.74092886758572, 151.63038840277358, 136.22725176587633, 140.39151952365395, 135.73384116020583, 151.6483866397572, 130.1279413138949, 145.82254966632306, 135.16141277941563, 122.48925200418287, 134.53947550056765, 140.38193353173162, 147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6501671349603741, "mean_inference_ms": 1.87858115151945, "mean_action_processing_ms": 0.35211682047333775, "mean_env_wait_ms": 2.086941781612788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010512351989746094, "StateBufferConnector_ms": 0.007509946823120117, "ViewRequirementAgentConnector_ms": 0.23184490203857422}, "num_episodes": 20, "episode_return_max": 178.5161538931506, "episode_return_min": 88.45331157338894, "episode_return_mean": 135.03318524192886, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 495.71017527037185, "num_env_steps_trained_throughput_per_sec": 495.71017527037185, "timesteps_total": 30720, "num_env_steps_sampled_lifetime": 30720, "num_agent_steps_sampled_lifetime": 30720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 2137.79, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2137.79, "sample_time_ms": 890.228, "learn_time_ms": 1231.067, "learn_throughput": 831.799, "synch_weights_time_ms": 16.276}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "training_iteration": 30, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-23", "timestamp": 1744110143, "time_this_iter_s": 2.069981813430786, "time_total_s": 64.54903316497803, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD8A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.54903316497803, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 36.333333333333336, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2939050525426863, "cur_kl_coeff": 1.862645149230957e-10, "cur_lr": 1e-07, "total_loss": 2.176721104234457, "policy_loss": -0.00014125898305792362, "vf_loss": 9.849518257379533, "vf_explained_var": -1.6648322343826293e-06, "kl": 6.680578470863451e-07, "entropy": 2.8551719307899477, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "env_runners": {"episode_reward_max": 169.685475029451, "episode_reward_min": 88.45331157338894, "episode_reward_mean": 135.04429780430502, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 88.45331157338894}, "policy_reward_max": {"tplp_policy": 169.685475029451}, "policy_reward_mean": {"tplp_policy": 135.04429780430502}, "custom_metrics": {"mean_episode_reward_mean": 135.04429780430502, "mean_episode_reward_min": 88.45331157338894, "mean_episode_reward_max": 169.685475029451}, "hist_stats": {"episode_reward": [147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.81710875530678, 110.49099629777106, 128.98277046164424, 137.89480215877913, 133.24260315276183, 139.58779752901106, 133.88675966623802, 144.40548755503053, 138.78689435036938, 136.49296116561592, 137.89801053352048, 140.1410636022737, 118.8847225355761, 134.39690962289257, 132.02228549948552, 131.14706718540452, 120.3743039503658, 143.03454058587508, 144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6503003193782093, "mean_inference_ms": 1.8780000937234822, "mean_action_processing_ms": 0.35212463436410346, "mean_env_wait_ms": 2.0858628633792216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01353311538696289, "StateBufferConnector_ms": 0.004504680633544922, "ViewRequirementAgentConnector_ms": 0.23935961723327637}, "num_episodes": 22, "episode_return_max": 169.685475029451, "episode_return_min": 88.45331157338894, "episode_return_mean": 135.04429780430502, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.3810343699047, "num_env_steps_trained_throughput_per_sec": 486.3810343699047, "timesteps_total": 31744, "num_env_steps_sampled_lifetime": 31744, "num_agent_steps_sampled_lifetime": 31744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 2100.66, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2100.66, "sample_time_ms": 871.4, "learn_time_ms": 1212.628, "learn_throughput": 844.447, "synch_weights_time_ms": 16.414}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "training_iteration": 31, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-25", "timestamp": 1744110145, "time_this_iter_s": 2.111771583557129, "time_total_s": 66.66080474853516, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.66080474853516, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 32.46666666666666, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1545488994568585, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 1e-07, "total_loss": 2.1817465208470823, "policy_loss": -0.00014829639112576843, "vf_loss": 9.869813692569732, "vf_explained_var": -1.2103468179702758e-06, "kl": 8.678879298340547e-07, "entropy": 2.855585916340351, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "env_runners": {"episode_reward_max": 169.685475029451, "episode_reward_min": 88.45331157338894, "episode_reward_mean": 136.81187522411454, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 88.45331157338894}, "policy_reward_max": {"tplp_policy": 169.685475029451}, "policy_reward_mean": {"tplp_policy": 136.81187522411454}, "custom_metrics": {"mean_episode_reward_mean": 136.81187522411454, "mean_episode_reward_min": 88.45331157338894, "mean_episode_reward_max": 169.685475029451}, "hist_stats": {"episode_reward": [144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.7034011156752, 151.77649761005807, 122.06457454985635, 153.06779387125806, 119.62089149739438, 147.80312342941068, 130.90690725532443, 133.28936401521364, 143.5955462628823, 137.51116857234283, 114.47397954221081, 148.51844109643795, 131.19158436640802, 134.50585202333966, 149.884367181008, 130.68756142974655, 128.8015281049973, 124.72136841503834, 140.18794923891235, 131.24610771801363, 139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6506539498441221, "mean_inference_ms": 1.879426842059308, "mean_action_processing_ms": 0.352768982300177, "mean_env_wait_ms": 2.0863921631558022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012537956237792969, "StateBufferConnector_ms": 0.007497310638427734, "ViewRequirementAgentConnector_ms": 0.23918604850769043}, "num_episodes": 18, "episode_return_max": 169.685475029451, "episode_return_min": 88.45331157338894, "episode_return_mean": 136.81187522411454, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.77092246443823, "num_env_steps_trained_throughput_per_sec": 465.77092246443823, "timesteps_total": 32768, "num_env_steps_sampled_lifetime": 32768, "num_agent_steps_sampled_lifetime": 32768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 2107.458, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2107.458, "sample_time_ms": 870.776, "learn_time_ms": 1220.358, "learn_throughput": 839.098, "synch_weights_time_ms": 16.308}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "training_iteration": 32, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-27", "timestamp": 1744110147, "time_this_iter_s": 2.204904317855835, "time_total_s": 68.86570906639099, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.86570906639099, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 44.63333333333333, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.161508135870099, "cur_kl_coeff": 4.656612873077392e-11, "cur_lr": 1e-07, "total_loss": 2.1733860060572625, "policy_loss": -0.00017452038009651004, "vf_loss": 9.83678263425827, "vf_explained_var": -2.9567629098892214e-06, "kl": 1.0445624993055124e-06, "entropy": 2.8563512325286866, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "env_runners": {"episode_reward_max": 186.2065390592189, "episode_reward_min": 88.45331157338894, "episode_reward_mean": 137.81337927536748, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 88.45331157338894}, "policy_reward_max": {"tplp_policy": 186.2065390592189}, "policy_reward_mean": {"tplp_policy": 137.81337927536748}, "custom_metrics": {"mean_episode_reward_mean": 137.81337927536748, "mean_episode_reward_min": 88.45331157338894, "mean_episode_reward_max": 186.2065390592189}, "hist_stats": {"episode_reward": [139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.39477479195816, 144.43700841000333, 131.56726569728917, 150.45675273964397, 126.64016974213095, 133.45772985190033, 138.02893948908462, 150.5294479192748, 151.36875276048653, 134.35717355417043, 106.48680634190505, 136.90605732777567, 122.10395244672625, 146.15228579296922, 130.35420671867493, 88.45331157338894, 131.86233648582692, 128.1669037192473, 138.77652918554887, 117.7127418578188, 159.19130408138395, 150.26068753778722, 139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6508052614266489, "mean_inference_ms": 1.8799588475572193, "mean_action_processing_ms": 0.3531577328267349, "mean_env_wait_ms": 2.0862001050654224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015459060668945312, "StateBufferConnector_ms": 0.010544061660766602, "ViewRequirementAgentConnector_ms": 0.22317147254943848}, "num_episodes": 20, "episode_return_max": 186.2065390592189, "episode_return_min": 88.45331157338894, "episode_return_mean": 137.81337927536748, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 478.14938591569364, "num_env_steps_trained_throughput_per_sec": 478.14938591569364, "timesteps_total": 33792, "num_env_steps_sampled_lifetime": 33792, "num_agent_steps_sampled_lifetime": 33792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 2123.755, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2123.755, "sample_time_ms": 876.228, "learn_time_ms": 1230.986, "learn_throughput": 831.853, "synch_weights_time_ms": 16.525}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "training_iteration": 33, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-30", "timestamp": 1744110150, "time_this_iter_s": 2.148242950439453, "time_total_s": 71.01395201683044, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.01395201683044, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.03333333333333, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1310295671224595, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 1e-07, "total_loss": 2.1740212738513947, "policy_loss": -0.00014958348474465312, "vf_loss": 9.839334636926651, "vf_explained_var": -3.6399811506271363e-06, "kl": 7.415328317605941e-07, "entropy": 2.8566279366612433, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "env_runners": {"episode_reward_max": 186.2065390592189, "episode_reward_min": 111.20134612767183, "episode_reward_mean": 139.99719306680038, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.20134612767183}, "policy_reward_max": {"tplp_policy": 186.2065390592189}, "policy_reward_mean": {"tplp_policy": 139.99719306680038}, "custom_metrics": {"mean_episode_reward_mean": 139.99719306680038, "mean_episode_reward_min": 111.20134612767183, "mean_episode_reward_max": 186.2065390592189}, "hist_stats": {"episode_reward": [139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.14797043687128, 116.23771776205682, 120.9864883353827, 151.853171296716, 113.11381684888414, 123.29487633543137, 126.79426936928056, 134.64071023603805, 145.69964814000107, 127.69782246218928, 157.4926893486892, 127.61053165945889, 120.51640546251242, 137.59574949151371, 123.39741000314596, 142.67207620228317, 140.23423993267656, 130.10288202901685, 111.6679442446429, 120.93396636950325, 127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6501866378768628, "mean_inference_ms": 1.878289848564428, "mean_action_processing_ms": 0.3531093935501375, "mean_env_wait_ms": 2.0853142813036216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013444662094116211, "StateBufferConnector_ms": 0.013553857803344727, "ViewRequirementAgentConnector_ms": 0.19379258155822754}, "num_episodes": 22, "episode_return_max": 186.2065390592189, "episode_return_min": 111.20134612767183, "episode_return_mean": 139.99719306680038, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 495.09669513811343, "num_env_steps_trained_throughput_per_sec": 495.09669513811343, "timesteps_total": 34816, "num_env_steps_sampled_lifetime": 34816, "num_agent_steps_sampled_lifetime": 34816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 2112.217, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2112.217, "sample_time_ms": 874.273, "learn_time_ms": 1221.964, "learn_throughput": 837.995, "synch_weights_time_ms": 15.964}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "training_iteration": 34, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-32", "timestamp": 1744110152, "time_this_iter_s": 2.0730834007263184, "time_total_s": 73.08703541755676, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C21EE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.08703541755676, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 28.900000000000002, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1315377566963436, "cur_kl_coeff": 1.164153218269348e-11, "cur_lr": 1e-07, "total_loss": 2.1939030297100546, "policy_loss": -0.0001491723582148552, "vf_loss": 9.919054865837097, "vf_explained_var": -2.8368085622787476e-06, "kl": 1.650484764015303e-06, "entropy": 2.8571151554584504, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "env_runners": {"episode_reward_max": 186.2065390592189, "episode_reward_min": 111.20134612767183, "episode_reward_mean": 141.44740788713668, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.20134612767183}, "policy_reward_max": {"tplp_policy": 186.2065390592189}, "policy_reward_mean": {"tplp_policy": 141.44740788713668}, "custom_metrics": {"mean_episode_reward_mean": 141.44740788713668, "mean_episode_reward_min": 111.20134612767183, "mean_episode_reward_max": 186.2065390592189}, "hist_stats": {"episode_reward": [127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [127.47412921355883, 151.85296299349082, 166.054202286398, 156.21409539749152, 131.30989921772462, 125.49231571647843, 136.98330086760342, 152.179402643706, 169.685475029451, 150.74156839303708, 152.3614345278627, 141.08713415349706, 146.72730662184918, 124.03730762349305, 111.74424398701385, 125.95372218914679, 132.76950846908048, 132.73947430294075, 143.68500369314233, 128.9366772087956, 167.28900272934493, 127.88551995378198, 144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6494461459125028, "mean_inference_ms": 1.876496261605628, "mean_action_processing_ms": 0.3529251170910736, "mean_env_wait_ms": 2.0834385483402205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009563446044921875, "StateBufferConnector_ms": 0.014556646347045898, "ViewRequirementAgentConnector_ms": 0.1956038475036621}, "num_episodes": 20, "episode_return_max": 186.2065390592189, "episode_return_min": 111.20134612767183, "episode_return_mean": 141.44740788713668, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.23314132207645, "num_env_steps_trained_throughput_per_sec": 467.23314132207645, "timesteps_total": 35840, "num_env_steps_sampled_lifetime": 35840, "num_agent_steps_sampled_lifetime": 35840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 2112.314, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2112.314, "sample_time_ms": 866.757, "learn_time_ms": 1229.112, "learn_throughput": 833.122, "synch_weights_time_ms": 16.429}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "training_iteration": 35, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-34", "timestamp": 1744110154, "time_this_iter_s": 2.196906328201294, "time_total_s": 75.28394174575806, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.28394174575806, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 87.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.230229764431715, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 1e-07, "total_loss": 2.1574250355362894, "policy_loss": -0.00015757991350255905, "vf_loss": 9.773685985803604, "vf_explained_var": -2.9403716325759886e-06, "kl": 1.3389594877732946e-06, "entropy": 2.8583886712789535, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "env_runners": {"episode_reward_max": 186.2065390592189, "episode_reward_min": 105.86722871365983, "episode_reward_mean": 139.51093828134583, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 105.86722871365983}, "policy_reward_max": {"tplp_policy": 186.2065390592189}, "policy_reward_mean": {"tplp_policy": 139.51093828134583}, "custom_metrics": {"mean_episode_reward_mean": 139.51093828134583, "mean_episode_reward_min": 105.86722871365983, "mean_episode_reward_max": 186.2065390592189}, "hist_stats": {"episode_reward": [144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.60069724342955, 149.71096962826275, 126.14565293106371, 124.17475959784406, 143.61041892438146, 147.61304854414234, 144.6759835971321, 149.28423634311895, 120.24712172013123, 151.46853690304772, 146.9681299134358, 145.22001382111912, 135.93619910228938, 155.75716710972418, 150.66141444577423, 154.99595408084954, 129.17314782303438, 166.81507374876514, 158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6489311122010157, "mean_inference_ms": 1.876291852767091, "mean_action_processing_ms": 0.35289780920473746, "mean_env_wait_ms": 2.0836982121720786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007535696029663086, "StateBufferConnector_ms": 0.017557859420776367, "ViewRequirementAgentConnector_ms": 0.19116759300231934}, "num_episodes": 22, "episode_return_max": 186.2065390592189, "episode_return_min": 105.86722871365983, "episode_return_mean": 139.51093828134583, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 472.25560185173987, "num_env_steps_trained_throughput_per_sec": 472.25560185173987, "timesteps_total": 36864, "num_env_steps_sampled_lifetime": 36864, "num_agent_steps_sampled_lifetime": 36864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 2124.549, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2124.549, "sample_time_ms": 877.613, "learn_time_ms": 1230.509, "learn_throughput": 832.176, "synch_weights_time_ms": 16.412}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "training_iteration": 36, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-36", "timestamp": 1744110156, "time_this_iter_s": 2.173814296722412, "time_total_s": 77.45775604248047, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C227A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.45775604248047, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 45.4, "ram_util_percent": 87.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.945259239524603, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 1e-07, "total_loss": 2.1757797241210937, "policy_loss": -8.665207424201072e-05, "vf_loss": 9.847145015001297, "vf_explained_var": -3.891810774803162e-06, "kl": 7.508256754107379e-07, "entropy": 2.8591985642910003, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "env_runners": {"episode_reward_max": 186.2065390592189, "episode_reward_min": 97.50391964138106, "episode_reward_mean": 137.90858944419594, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.50391964138106}, "policy_reward_max": {"tplp_policy": 186.2065390592189}, "policy_reward_mean": {"tplp_policy": 137.90858944419594}, "custom_metrics": {"mean_episode_reward_mean": 137.90858944419594, "mean_episode_reward_min": 97.50391964138106, "mean_episode_reward_max": 186.2065390592189}, "hist_stats": {"episode_reward": [158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [158.54301783619317, 145.57584340450964, 147.6551015221945, 131.17171707559072, 120.16658371141565, 142.827445763581, 137.53339264681284, 171.6859910266239, 127.80925333009631, 134.73752775265982, 114.33843489111473, 130.03782512557103, 151.52729196258798, 137.15860325126974, 119.99606597854321, 127.22024187847526, 186.2065390592189, 138.52931463256593, 127.73708047879846, 146.5575262911511, 141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6481329826198824, "mean_inference_ms": 1.874922458031059, "mean_action_processing_ms": 0.3526780827527141, "mean_env_wait_ms": 2.082429315974347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0065457820892333984, "StateBufferConnector_ms": 0.015697717666625977, "ViewRequirementAgentConnector_ms": 0.18547677993774414}, "num_episodes": 18, "episode_return_max": 186.2065390592189, "episode_return_min": 97.50391964138106, "episode_return_mean": 137.90858944419594, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 504.40287710303545, "num_env_steps_trained_throughput_per_sec": 504.40287710303545, "timesteps_total": 37888, "num_env_steps_sampled_lifetime": 37888, "num_agent_steps_sampled_lifetime": 37888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 2131.935, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2131.935, "sample_time_ms": 879.432, "learn_time_ms": 1235.906, "learn_throughput": 828.542, "synch_weights_time_ms": 16.465}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "training_iteration": 37, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-38", "timestamp": 1744110158, "time_this_iter_s": 2.034423828125, "time_total_s": 79.49217987060547, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 79.49217987060547, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 32.0, "ram_util_percent": 87.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.294326466694474, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 1e-07, "total_loss": 2.1806562021374702, "policy_loss": -0.0001575625967234373, "vf_loss": 9.867289632558823, "vf_explained_var": -4.259869456291199e-06, "kl": 1.0608791348953873e-06, "entropy": 2.8600862711668014, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "env_runners": {"episode_reward_max": 171.34521377537095, "episode_reward_min": 97.50391964138106, "episode_reward_mean": 137.03861820567914, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.50391964138106}, "policy_reward_max": {"tplp_policy": 171.34521377537095}, "policy_reward_mean": {"tplp_policy": 137.03861820567914}, "custom_metrics": {"mean_episode_reward_mean": 137.03861820567914, "mean_episode_reward_min": 97.50391964138106, "mean_episode_reward_max": 171.34521377537095}, "hist_stats": {"episode_reward": [141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.13491225615667, 142.02511185458076, 171.34521377537095, 136.36067022473952, 164.93434121883683, 150.40399794998314, 156.14952113139475, 147.9588597561656, 145.52257600756985, 151.9596364297183, 158.2268091238259, 140.28630766173015, 146.15721364733886, 111.20134612767183, 123.85310937151405, 129.1496361023255, 123.25805419449055, 162.7431757617843, 154.5174875819845, 143.56393022115483, 147.11504494362222, 130.4894512861364, 131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6473641319045231, "mean_inference_ms": 1.8730566516862979, "mean_action_processing_ms": 0.3525371918753204, "mean_env_wait_ms": 2.080725930339044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035076141357421875, "StateBufferConnector_ms": 0.013143539428710938, "ViewRequirementAgentConnector_ms": 0.20751142501831055}, "num_episodes": 20, "episode_return_max": 171.34521377537095, "episode_return_min": 97.50391964138106, "episode_return_mean": 137.03861820567914, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 484.2389229361992, "num_env_steps_trained_throughput_per_sec": 484.2389229361992, "timesteps_total": 38912, "num_env_steps_sampled_lifetime": 38912, "num_agent_steps_sampled_lifetime": 38912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 2120.955, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2120.955, "sample_time_ms": 874.977, "learn_time_ms": 1229.431, "learn_throughput": 832.906, "synch_weights_time_ms": 16.315}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "training_iteration": 38, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-40", "timestamp": 1744110160, "time_this_iter_s": 2.118940830230713, "time_total_s": 81.61112070083618, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 81.61112070083618, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 33.63333333333333, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.478648769855499, "cur_kl_coeff": 7.275957614183425e-13, "cur_lr": 1e-07, "total_loss": 2.1481896050274374, "policy_loss": -0.00023708310327492655, "vf_loss": 9.738092184066772, "vf_explained_var": -3.493949770927429e-06, "kl": 1.4627599485290966e-06, "entropy": 2.8609636217355727, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "env_runners": {"episode_reward_max": 163.58287736386032, "episode_reward_min": 97.50391964138106, "episode_reward_mean": 135.05269895264476, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.50391964138106}, "policy_reward_max": {"tplp_policy": 163.58287736386032}, "policy_reward_mean": {"tplp_policy": 135.05269895264476}, "custom_metrics": {"mean_episode_reward_mean": 135.05269895264476, "mean_episode_reward_min": 97.50391964138106, "mean_episode_reward_max": 163.58287736386032}, "hist_stats": {"episode_reward": [131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [131.08403500547857, 138.395682739499, 156.58534693689575, 146.48195355640806, 127.66176422923127, 147.23837054016892, 145.33699770009224, 142.70279341174125, 155.66636834277634, 119.60281779725172, 122.72896211450646, 129.56396432410446, 131.6546417839259, 126.96501973119298, 131.04481676644284, 133.70520949564968, 137.5548262096165, 155.13380108518297, 155.59028579884077, 132.08112146238273, 135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6468861249060603, "mean_inference_ms": 1.8724986574856342, "mean_action_processing_ms": 0.3524035191958353, "mean_env_wait_ms": 2.080120840793171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008160829544067383, "StateBufferConnector_ms": 0.01214909553527832, "ViewRequirementAgentConnector_ms": 0.2064204216003418}, "num_episodes": 22, "episode_return_max": 163.58287736386032, "episode_return_min": 97.50391964138106, "episode_return_mean": 135.05269895264476, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 443.02132903491065, "num_env_steps_trained_throughput_per_sec": 443.02132903491065, "timesteps_total": 39936, "num_env_steps_sampled_lifetime": 39936, "num_agent_steps_sampled_lifetime": 39936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 2139.557, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2139.549, "sample_time_ms": 871.884, "learn_time_ms": 1250.997, "learn_throughput": 818.547, "synch_weights_time_ms": 16.434}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "training_iteration": 39, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-43", "timestamp": 1744110163, "time_this_iter_s": 2.3181240558624268, "time_total_s": 83.92924475669861, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.92924475669861, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 88.175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4272896338254215, "cur_kl_coeff": 3.6379788070917126e-13, "cur_lr": 1e-07, "total_loss": 2.1840095430612565, "policy_loss": -0.00017756422166712583, "vf_loss": 9.88150355219841, "vf_explained_var": -4.800036549568176e-06, "kl": 1.1250387642380843e-06, "entropy": 2.8618878945708275, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "env_runners": {"episode_reward_max": 163.58287736386032, "episode_reward_min": 97.50391964138106, "episode_reward_mean": 134.01051231202123, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.50391964138106}, "policy_reward_max": {"tplp_policy": 163.58287736386032}, "policy_reward_mean": {"tplp_policy": 134.01051231202123}, "custom_metrics": {"mean_episode_reward_mean": 134.01051231202123, "mean_episode_reward_min": 97.50391964138106, "mean_episode_reward_max": 163.58287736386032}, "hist_stats": {"episode_reward": [135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.1915978990184, 149.95949126953838, 133.2560838311812, 128.07284530733023, 142.45180971427004, 136.71243872244295, 127.96593107503303, 139.33497520851796, 134.55128226582366, 105.86722871365983, 139.61996940621088, 115.09927674415793, 138.2718050415367, 112.12789969598549, 151.16444907438833, 120.84530066322395, 116.01582545064177, 147.08357896534284, 124.72567632289073, 123.56785400738505, 124.63310668326913, 141.34808935765102, 152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.646785281084222, "mean_inference_ms": 1.8726290899212712, "mean_action_processing_ms": 0.3524808152274542, "mean_env_wait_ms": 2.0800751121428984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010981321334838867, "StateBufferConnector_ms": 0.009140491485595703, "ViewRequirementAgentConnector_ms": 0.21100187301635742}, "num_episodes": 20, "episode_return_max": 163.58287736386032, "episode_return_min": 97.50391964138106, "episode_return_mean": 134.01051231202123, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 480.81051007162955, "num_env_steps_trained_throughput_per_sec": 480.81051007162955, "timesteps_total": 40960, "num_env_steps_sampled_lifetime": 40960, "num_agent_steps_sampled_lifetime": 40960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 2145.959, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2145.95, "sample_time_ms": 876.434, "learn_time_ms": 1252.911, "learn_throughput": 817.297, "synch_weights_time_ms": 16.388}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "training_iteration": 40, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-45", "timestamp": 1744110165, "time_this_iter_s": 2.1346068382263184, "time_total_s": 86.06385159492493, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 86.06385159492493, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 40.96666666666667, "ram_util_percent": 88.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3290566474199297, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 1e-07, "total_loss": 2.158035796135664, "policy_loss": -0.00019788698991760612, "vf_loss": 9.777892678976059, "vf_explained_var": -3.992766141891479e-06, "kl": 1.0348215149724727e-06, "entropy": 2.862394964694977, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "env_runners": {"episode_reward_max": 164.9487110204986, "episode_reward_min": 97.50391964138106, "episode_reward_mean": 134.39959579581262, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.50391964138106}, "policy_reward_max": {"tplp_policy": 164.9487110204986}, "policy_reward_mean": {"tplp_policy": 134.39959579581262}, "custom_metrics": {"mean_episode_reward_mean": 134.39959579581262, "mean_episode_reward_min": 97.50391964138106, "mean_episode_reward_max": 164.9487110204986}, "hist_stats": {"episode_reward": [152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.46842370862325, 133.33402720745877, 142.61780433817327, 133.87694252273513, 119.80615488930793, 133.6388149719497, 163.58287736386032, 147.35875499312212, 144.65587044193802, 97.50391964138106, 134.69891654072745, 135.6013299498318, 139.75326688723652, 134.9646710315474, 126.20741657658331, 120.77325465715978, 122.57456405289743, 134.51503551796628, 151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6462809778101055, "mean_inference_ms": 1.8716879972764686, "mean_action_processing_ms": 0.35233991844434387, "mean_env_wait_ms": 2.079026670463913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012129545211791992, "StateBufferConnector_ms": 0.008017539978027344, "ViewRequirementAgentConnector_ms": 0.20493459701538086}, "num_episodes": 22, "episode_return_max": 164.9487110204986, "episode_return_min": 97.50391964138106, "episode_return_mean": 134.39959579581262, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 508.0441082640184, "num_env_steps_trained_throughput_per_sec": 508.0441082640184, "timesteps_total": 41984, "num_env_steps_sampled_lifetime": 41984, "num_agent_steps_sampled_lifetime": 41984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 2136.981, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2136.973, "sample_time_ms": 877.345, "learn_time_ms": 1243.316, "learn_throughput": 823.604, "synch_weights_time_ms": 16.094}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "training_iteration": 41, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-47", "timestamp": 1744110167, "time_this_iter_s": 2.020310878753662, "time_total_s": 88.08416247367859, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.08416247367859, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 31.333333333333332, "ram_util_percent": 88.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2212615184485913, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 1e-07, "total_loss": 2.191630806773901, "policy_loss": -0.0001517726923339069, "vf_loss": 9.912272828817368, "vf_explained_var": -5.2478164434432985e-06, "kl": 1.2092506431304884e-06, "entropy": 2.8628560677170753, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "env_runners": {"episode_reward_max": 164.9487110204986, "episode_reward_min": 101.80946182886912, "episode_reward_mean": 133.42292830545787, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.80946182886912}, "policy_reward_max": {"tplp_policy": 164.9487110204986}, "policy_reward_mean": {"tplp_policy": 133.42292830545787}, "custom_metrics": {"mean_episode_reward_mean": 133.42292830545787, "mean_episode_reward_min": 101.80946182886912, "mean_episode_reward_max": 164.9487110204986}, "hist_stats": {"episode_reward": [151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.97759288132235, 143.29731312624918, 142.60979652289024, 125.36825196157109, 120.17203190983722, 124.11929985716596, 121.54671164832743, 141.96043407816867, 144.51377727186528, 138.46211113654624, 140.25280886031626, 119.37226074930747, 135.77895130582806, 124.83324166517387, 160.19742583308258, 127.26887017298368, 138.6979598520027, 152.49923536379086, 146.9186867566419, 136.06439252386735, 112.87282892799522, 141.77258202269815, 141.293170365291, 112.66079613983418, 120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6457003829796423, "mean_inference_ms": 1.8708569093268022, "mean_action_processing_ms": 0.3520170936967803, "mean_env_wait_ms": 2.0778620506926933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013128042221069336, "StateBufferConnector_ms": 0.01004338264465332, "ViewRequirementAgentConnector_ms": 0.1956784725189209}, "num_episodes": 18, "episode_return_max": 164.9487110204986, "episode_return_min": 101.80946182886912, "episode_return_mean": 133.42292830545787, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 527.6061480404104, "num_env_steps_trained_throughput_per_sec": 527.6061480404104, "timesteps_total": 43008, "num_env_steps_sampled_lifetime": 43008, "num_agent_steps_sampled_lifetime": 43008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 2111.215, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2111.206, "sample_time_ms": 864.375, "learn_time_ms": 1230.562, "learn_throughput": 832.14, "synch_weights_time_ms": 16.001}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "training_iteration": 42, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-49", "timestamp": 1744110169, "time_this_iter_s": 1.9465043544769287, "time_total_s": 90.03066682815552, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.03066682815552, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 28.200000000000003, "ram_util_percent": 88.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.935000663995743, "cur_kl_coeff": 4.547473508864641e-14, "cur_lr": 1e-07, "total_loss": 2.1647731445729734, "policy_loss": -7.149470620788634e-05, "vf_loss": 9.804941856861115, "vf_explained_var": -3.8016587495803833e-06, "kl": 7.161587345039244e-07, "entropy": 2.863908314704895, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "env_runners": {"episode_reward_max": 165.56285030385152, "episode_reward_min": 101.80946182886912, "episode_reward_mean": 133.2283764621131, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.80946182886912}, "policy_reward_max": {"tplp_policy": 165.56285030385152}, "policy_reward_mean": {"tplp_policy": 133.2283764621131}, "custom_metrics": {"mean_episode_reward_mean": 133.2283764621131, "mean_episode_reward_min": 101.80946182886912, "mean_episode_reward_max": 165.56285030385152}, "hist_stats": {"episode_reward": [120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [120.98828867001875, 145.09248625053542, 147.6437817460921, 143.35404124518809, 148.66233845891261, 105.71022211616304, 135.29491947562087, 128.9264814586967, 143.964342647609, 138.15089352610124, 134.10830415003716, 148.34074488925233, 140.3678923069911, 153.9520526443287, 123.10094772347637, 130.5242872793076, 130.67990124013815, 141.2444582723725, 137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6457682628126586, "mean_inference_ms": 1.8702463439328634, "mean_action_processing_ms": 0.3517636345155131, "mean_env_wait_ms": 2.076786135741415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013339042663574219, "StateBufferConnector_ms": 0.011040210723876953, "ViewRequirementAgentConnector_ms": 0.19951725006103516}, "num_episodes": 24, "episode_return_max": 165.56285030385152, "episode_return_min": 101.80946182886912, "episode_return_mean": 133.2283764621131, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.5258673998474, "num_env_steps_trained_throughput_per_sec": 466.5258673998474, "timesteps_total": 44032, "num_env_steps_sampled_lifetime": 44032, "num_agent_steps_sampled_lifetime": 44032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 2116.551, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2116.542, "sample_time_ms": 867.303, "learn_time_ms": 1233.064, "learn_throughput": 830.452, "synch_weights_time_ms": 15.907}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "training_iteration": 43, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-51", "timestamp": 1744110171, "time_this_iter_s": 2.2010719776153564, "time_total_s": 92.23173880577087, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C232E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.23173880577087, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 45.23333333333334, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3755074493587016, "cur_kl_coeff": 2.2737367544323204e-14, "cur_lr": 1e-07, "total_loss": 2.18438918069005, "policy_loss": -0.00024609941174276174, "vf_loss": 9.884324902296067, "vf_explained_var": -4.5515596866607664e-06, "kl": 1.119576803110256e-06, "entropy": 2.864459401369095, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "env_runners": {"episode_reward_max": 178.2681146479872, "episode_reward_min": 101.80946182886912, "episode_reward_mean": 133.58263192088612, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.80946182886912}, "policy_reward_max": {"tplp_policy": 178.2681146479872}, "policy_reward_mean": {"tplp_policy": 133.58263192088612}, "custom_metrics": {"mean_episode_reward_mean": 133.58263192088612, "mean_episode_reward_min": 101.80946182886912, "mean_episode_reward_max": 178.2681146479872}, "hist_stats": {"episode_reward": [137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.60965624435488, 153.46397584065534, 129.29195696848967, 101.80946182886912, 141.67275789934763, 150.67062450976715, 137.0045787533104, 103.4725242423475, 155.37847508817794, 132.00239154443528, 134.25778086028873, 137.0156326997163, 151.03067747271936, 125.45569710734235, 116.46190158483357, 125.09396239912193, 136.36737927210166, 122.5763211406477, 130.33661102848367, 104.26675824646627, 140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.645643137236132, "mean_inference_ms": 1.870762373481383, "mean_action_processing_ms": 0.3518508881621076, "mean_env_wait_ms": 2.0769852080395355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01148533821105957, "StateBufferConnector_ms": 0.011139392852783203, "ViewRequirementAgentConnector_ms": 0.20209574699401855}, "num_episodes": 18, "episode_return_max": 178.2681146479872, "episode_return_min": 101.80946182886912, "episode_return_mean": 133.58263192088612, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 470.32611598998324, "num_env_steps_trained_throughput_per_sec": 470.32611598998324, "timesteps_total": 45056, "num_env_steps_sampled_lifetime": 45056, "num_agent_steps_sampled_lifetime": 45056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 2127.444, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2127.435, "sample_time_ms": 882.689, "learn_time_ms": 1228.535, "learn_throughput": 833.513, "synch_weights_time_ms": 15.942}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "training_iteration": 44, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-53", "timestamp": 1744110173, "time_this_iter_s": 2.1828572750091553, "time_total_s": 94.41459608078003, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 94.41459608078003, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 46.800000000000004, "ram_util_percent": 88.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1348620375618337, "cur_kl_coeff": 1.1368683772161602e-14, "cur_lr": 1e-07, "total_loss": 2.1996148765087127, "policy_loss": -0.00016591426101513206, "vf_loss": 9.944750589132308, "vf_explained_var": -3.777816891670227e-06, "kl": 8.126248623410714e-07, "entropy": 2.8640684127807616, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "env_runners": {"episode_reward_max": 178.2681146479872, "episode_reward_min": 104.42851239934521, "episode_reward_mean": 135.1945164463934, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 104.42851239934521}, "policy_reward_max": {"tplp_policy": 178.2681146479872}, "policy_reward_mean": {"tplp_policy": 135.1945164463934}, "custom_metrics": {"mean_episode_reward_mean": 135.1945164463934, "mean_episode_reward_min": 104.42851239934521, "mean_episode_reward_max": 178.2681146479872}, "hist_stats": {"episode_reward": [140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [140.1752061101617, 133.54331758453876, 145.80140401229002, 127.47140318000963, 133.6953096465947, 159.557966138087, 139.17730987607032, 125.85669278463072, 124.86226531598024, 122.385104172347, 123.73024107101207, 113.60112776599667, 123.85237026527619, 135.61600962026384, 164.9487110204986, 122.2959505504099, 142.11184429405253, 140.79500581052875, 156.12886296732196, 116.56539233761342, 122.74343700842837, 142.5743725923608, 142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6453353632252247, "mean_inference_ms": 1.8702117545242907, "mean_action_processing_ms": 0.3516112550108615, "mean_env_wait_ms": 2.0759856797383796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010152339935302734, "StateBufferConnector_ms": 0.01213693618774414, "ViewRequirementAgentConnector_ms": 0.19434070587158203}, "num_episodes": 20, "episode_return_max": 178.2681146479872, "episode_return_min": 104.42851239934521, "episode_return_mean": 135.1945164463934, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 513.5416765260644, "num_env_steps_trained_throughput_per_sec": 513.5416765260644, "timesteps_total": 46080, "num_env_steps_sampled_lifetime": 46080, "num_agent_steps_sampled_lifetime": 46080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 2107.681, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2107.672, "sample_time_ms": 879.004, "learn_time_ms": 1213.021, "learn_throughput": 844.173, "synch_weights_time_ms": 15.379}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "training_iteration": 45, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-55", "timestamp": 1744110175, "time_this_iter_s": 1.9987618923187256, "time_total_s": 96.41335797309875, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23C40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.41335797309875, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 26.900000000000002, "ram_util_percent": 88.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.255933853983879, "cur_kl_coeff": 5.684341886080801e-15, "cur_lr": 1e-07, "total_loss": 2.176414853334427, "policy_loss": -0.0001637450070120394, "vf_loss": 9.851912182569503, "vf_explained_var": -5.492940545082092e-06, "kl": 1.0458182443606746e-06, "entropy": 2.863994541764259, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "env_runners": {"episode_reward_max": 178.2681146479872, "episode_reward_min": 104.42851239934521, "episode_reward_mean": 135.43326810477, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 104.42851239934521}, "policy_reward_max": {"tplp_policy": 178.2681146479872}, "policy_reward_mean": {"tplp_policy": 135.43326810477}, "custom_metrics": {"mean_episode_reward_mean": 135.43326810477, "mean_episode_reward_min": 104.42851239934521, "mean_episode_reward_max": 178.2681146479872}, "hist_stats": {"episode_reward": [142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [142.13902923994516, 138.91343337884928, 119.91708705054783, 124.33586013886804, 149.06725267856646, 116.06637783147838, 126.42998329072934, 114.85799065502994, 110.38121614251887, 139.59911102536003, 143.73101110558127, 123.08144161166614, 115.66022271784001, 130.5650926032752, 112.06347919414412, 148.13889799183767, 108.51079656036606, 165.56285030385152, 133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6450411159763315, "mean_inference_ms": 1.8692773121832718, "mean_action_processing_ms": 0.35131699353587675, "mean_env_wait_ms": 2.0745933542427655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011632204055786133, "StateBufferConnector_ms": 0.009125232696533203, "ViewRequirementAgentConnector_ms": 0.19687461853027344}, "num_episodes": 22, "episode_return_max": 178.2681146479872, "episode_return_min": 104.42851239934521, "episode_return_mean": 135.43326810477, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 518.0790827505854, "num_env_steps_trained_throughput_per_sec": 518.0790827505854, "timesteps_total": 47104, "num_env_steps_sampled_lifetime": 47104, "num_agent_steps_sampled_lifetime": 47104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 2088.502, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2088.494, "sample_time_ms": 866.49, "learn_time_ms": 1206.27, "learn_throughput": 848.898, "synch_weights_time_ms": 15.466}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "training_iteration": 46, "trial_id": "b517c_00000", "date": "2025-04-08_19-02-57", "timestamp": 1744110177, "time_this_iter_s": 1.9818675518035889, "time_total_s": 98.39522552490234, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C232E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.39522552490234, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 28.666666666666668, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.408957568183541, "cur_kl_coeff": 2.8421709430404005e-15, "cur_lr": 1e-07, "total_loss": 2.1680993899703025, "policy_loss": -0.00017311745905317365, "vf_loss": 9.818892216682434, "vf_explained_var": -1.1702254414558411e-05, "kl": 8.56888443823145e-07, "entropy": 2.8645055487751963, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "env_runners": {"episode_reward_max": 178.2681146479872, "episode_reward_min": 104.42851239934521, "episode_reward_mean": 137.6913444246527, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 104.42851239934521}, "policy_reward_max": {"tplp_policy": 178.2681146479872}, "policy_reward_mean": {"tplp_policy": 137.6913444246527}, "custom_metrics": {"mean_episode_reward_mean": 137.6913444246527, "mean_episode_reward_min": 104.42851239934521, "mean_episode_reward_max": 178.2681146479872}, "hist_stats": {"episode_reward": [133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [133.89391777595154, 127.73175265026822, 154.21953903805172, 123.51350300863653, 129.24072416983995, 144.28678593339512, 143.805514690026, 130.9560782503755, 161.4565114294849, 104.42851239934521, 139.8339007701548, 137.29424812912555, 156.07337687452102, 107.12142332659732, 131.80157629938253, 146.8434214008765, 120.65658043919838, 137.58261103914163, 153.85237504607798, 125.09039476334885, 121.22483309214674, 120.07411920811946, 117.48997626922709, 143.82258547360271, 136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6452795882117661, "mean_inference_ms": 1.8695485074251048, "mean_action_processing_ms": 0.35139318847022855, "mean_env_wait_ms": 2.074609853732189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01038980484008789, "StateBufferConnector_ms": 0.0061032772064208984, "ViewRequirementAgentConnector_ms": 0.19614887237548828}, "num_episodes": 18, "episode_return_max": 178.2681146479872, "episode_return_min": 104.42851239934521, "episode_return_mean": 137.6913444246527, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 472.48507546342665, "num_env_steps_trained_throughput_per_sec": 472.48507546342665, "timesteps_total": 48128, "num_env_steps_sampled_lifetime": 48128, "num_agent_steps_sampled_lifetime": 48128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 2102.216, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2102.208, "sample_time_ms": 872.666, "learn_time_ms": 1213.88, "learn_throughput": 843.576, "synch_weights_time_ms": 15.51}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "training_iteration": 47, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-00", "timestamp": 1744110180, "time_this_iter_s": 2.174851894378662, "time_total_s": 100.570077419281, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C20B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.570077419281, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 44.43333333333334, "ram_util_percent": 88.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.230549164861441, "cur_kl_coeff": 1.4210854715202003e-15, "cur_lr": 1e-07, "total_loss": 2.169311624020338, "policy_loss": -0.00019384869374334813, "vf_loss": 9.823607128858566, "vf_explained_var": -3.604218363761902e-06, "kl": 7.785154544803774e-07, "entropy": 2.8639630287885667, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "env_runners": {"episode_reward_max": 178.2681146479872, "episode_reward_min": 106.27569991461385, "episode_reward_mean": 138.92235943584697, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.27569991461385}, "policy_reward_max": {"tplp_policy": 178.2681146479872}, "policy_reward_mean": {"tplp_policy": 138.92235943584697}, "custom_metrics": {"mean_episode_reward_mean": 138.92235943584697, "mean_episode_reward_min": 106.27569991461385, "mean_episode_reward_max": 178.2681146479872}, "hist_stats": {"episode_reward": [136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [136.06358248760085, 158.48129849374178, 115.4626704021002, 166.25572725948942, 129.9833791428551, 108.39513148235685, 141.97536933928248, 154.7041996299237, 123.50106547996755, 163.6453271747918, 143.548000762414, 123.55460882211753, 119.80148805817096, 118.99777402514198, 151.58163102737396, 178.2681146479872, 129.7662924234897, 156.23478854115018, 122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.645575119933413, "mean_inference_ms": 1.8702248966611978, "mean_action_processing_ms": 0.3514728538617976, "mean_env_wait_ms": 2.0749663146375457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015572547912597656, "StateBufferConnector_ms": 0.005843400955200195, "ViewRequirementAgentConnector_ms": 0.19760942459106445}, "num_episodes": 24, "episode_return_max": 178.2681146479872, "episode_return_min": 106.27569991461385, "episode_return_mean": 138.92235943584697, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 479.5899475841603, "num_env_steps_trained_throughput_per_sec": 479.5899475841603, "timesteps_total": 49152, "num_env_steps_sampled_lifetime": 49152, "num_agent_steps_sampled_lifetime": 49152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 2104.266, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2104.258, "sample_time_ms": 881.271, "learn_time_ms": 1207.465, "learn_throughput": 848.058, "synch_weights_time_ms": 15.471}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "training_iteration": 48, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-02", "timestamp": 1744110182, "time_this_iter_s": 2.140723943710327, "time_total_s": 102.71080136299133, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDA80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.71080136299133, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 42.6, "ram_util_percent": 88.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1721861131489275, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 1e-07, "total_loss": 2.1799119651317596, "policy_loss": -0.00010446801315993071, "vf_loss": 9.86538760662079, "vf_explained_var": -6.765127182006836e-06, "kl": 4.918899469741334e-07, "entropy": 2.8633046954870225, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "env_runners": {"episode_reward_max": 168.31643576401484, "episode_reward_min": 106.27569991461385, "episode_reward_mean": 138.9017839616691, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.27569991461385}, "policy_reward_max": {"tplp_policy": 168.31643576401484}, "policy_reward_mean": {"tplp_policy": 138.9017839616691}, "custom_metrics": {"mean_episode_reward_mean": 138.9017839616691, "mean_episode_reward_min": 106.27569991461385, "mean_episode_reward_max": 168.31643576401484}, "hist_stats": {"episode_reward": [122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [122.62338236566816, 145.73020773425895, 138.0921449349333, 141.8375363398315, 138.46458266145896, 161.35079570900547, 128.42628322773663, 131.18865626026604, 113.56511119420752, 152.8679923371734, 138.64437379238083, 152.13262707535765, 151.87422779825485, 140.50757417194126, 126.37072773360983, 139.61613621723401, 148.51135057596898, 128.62278618827239, 127.58071234466804, 127.1382577261953, 139.63002566596853, 142.10236092601647, 134.74672260307688, 136.55179570597676, 120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.645368421470184, "mean_inference_ms": 1.8695980654611037, "mean_action_processing_ms": 0.35124451866808815, "mean_env_wait_ms": 2.0743843660460537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01481008529663086, "StateBufferConnector_ms": 0.004858732223510742, "ViewRequirementAgentConnector_ms": 0.20188426971435547}, "num_episodes": 18, "episode_return_max": 168.31643576401484, "episode_return_min": 106.27569991461385, "episode_return_mean": 138.9017839616691, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 506.3176183486658, "num_env_steps_trained_throughput_per_sec": 506.3176183486658, "timesteps_total": 50176, "num_env_steps_sampled_lifetime": 50176, "num_agent_steps_sampled_lifetime": 50176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 2075.371, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2075.371, "sample_time_ms": 876.77, "learn_time_ms": 1183.237, "learn_throughput": 865.423, "synch_weights_time_ms": 15.113}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "training_iteration": 49, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-04", "timestamp": 1744110184, "time_this_iter_s": 2.0585203170776367, "time_total_s": 104.76932168006897, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 104.76932168006897, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 32.6, "ram_util_percent": 88.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.118865328282118, "cur_kl_coeff": 3.5527136788005006e-16, "cur_lr": 1e-07, "total_loss": 2.188972170650959, "policy_loss": -0.00017289193347096442, "vf_loss": 9.902062052488327, "vf_explained_var": -7.127225399017334e-06, "kl": 1.3530784910509298e-06, "entropy": 2.8637044444680213, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "env_runners": {"episode_reward_max": 168.31643576401484, "episode_reward_min": 106.27569991461385, "episode_reward_mean": 138.68873830445523, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.27569991461385}, "policy_reward_max": {"tplp_policy": 168.31643576401484}, "policy_reward_mean": {"tplp_policy": 138.68873830445523}, "custom_metrics": {"mean_episode_reward_mean": 138.68873830445523, "mean_episode_reward_min": 106.27569991461385, "mean_episode_reward_max": 168.31643576401484}, "hist_stats": {"episode_reward": [120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [120.5934260317211, 153.23944323118224, 114.154642001569, 148.46219866179274, 139.58928648681248, 126.29375516365909, 140.98309338443315, 138.2127238547448, 119.80232307514676, 124.58080360069917, 151.7582659843881, 124.1121069134732, 158.18391815706016, 124.01704336581696, 132.94836895289728, 156.68319612483677, 140.14028336424943, 155.41676913770473, 145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6456839842236259, "mean_inference_ms": 1.8690675748051673, "mean_action_processing_ms": 0.35099655450080997, "mean_env_wait_ms": 2.0739334517519428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013822078704833984, "StateBufferConnector_ms": 0.00785064697265625, "ViewRequirementAgentConnector_ms": 0.19558382034301758}, "num_episodes": 24, "episode_return_max": 168.31643576401484, "episode_return_min": 106.27569991461385, "episode_return_mean": 138.68873830445523, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.7443925372393, "num_env_steps_trained_throughput_per_sec": 486.7443925372393, "timesteps_total": 51200, "num_env_steps_sampled_lifetime": 51200, "num_agent_steps_sampled_lifetime": 51200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 2072.774, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2072.774, "sample_time_ms": 864.194, "learn_time_ms": 1192.647, "learn_throughput": 858.595, "synch_weights_time_ms": 15.583}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "training_iteration": 50, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-06", "timestamp": 1744110186, "time_this_iter_s": 2.111478567123413, "time_total_s": 106.88080024719238, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD6C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.88080024719238, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 28.7, "ram_util_percent": 87.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3570623748004436, "cur_kl_coeff": 1.7763568394002503e-16, "cur_lr": 1e-07, "total_loss": 2.1752666890621186, "policy_loss": -0.00017316456069238484, "vf_loss": 9.847621703147889, "vf_explained_var": -7.970258593559265e-06, "kl": 1.164852103341385e-06, "entropy": 2.8646557956933973, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "env_runners": {"episode_reward_max": 180.59773686533362, "episode_reward_min": 106.27569991461385, "episode_reward_mean": 139.63442263616764, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.27569991461385}, "policy_reward_max": {"tplp_policy": 180.59773686533362}, "policy_reward_mean": {"tplp_policy": 139.63442263616764}, "custom_metrics": {"mean_episode_reward_mean": 139.63442263616764, "mean_episode_reward_min": 106.27569991461385, "mean_episode_reward_max": 180.59773686533362}, "hist_stats": {"episode_reward": [145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.8920511224466, 119.27274231267994, 132.56838595223635, 142.57446278895966, 153.99731610479677, 160.99945891810233, 155.68395443993768, 140.4638783662771, 131.83931442537474, 147.48426664209364, 120.89088220360068, 129.95556493742362, 147.6809218328075, 153.00376319232154, 143.57955764235615, 133.38519212535329, 114.54565346994497, 141.69455336642108, 114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6457063903671927, "mean_inference_ms": 1.869578267794459, "mean_action_processing_ms": 0.35107740678580884, "mean_env_wait_ms": 2.0751374771518596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01232290267944336, "StateBufferConnector_ms": 0.009851932525634766, "ViewRequirementAgentConnector_ms": 0.1941516399383545}, "num_episodes": 18, "episode_return_max": 180.59773686533362, "episode_return_min": 106.27569991461385, "episode_return_mean": 139.63442263616764, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 442.7978455220683, "num_env_steps_trained_throughput_per_sec": 442.7978455220683, "timesteps_total": 52224, "num_env_steps_sampled_lifetime": 52224, "num_agent_steps_sampled_lifetime": 52224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 2102.474, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2102.474, "sample_time_ms": 872.518, "learn_time_ms": 1213.807, "learn_throughput": 843.627, "synch_weights_time_ms": 15.798}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "training_iteration": 51, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-09", "timestamp": 1744110189, "time_this_iter_s": 2.317843437194824, "time_total_s": 109.1986436843872, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 109.1986436843872, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 46.93333333333334, "ram_util_percent": 87.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3875454060733317, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 1e-07, "total_loss": 2.1660439141094683, "policy_loss": -0.00032808121177367865, "vf_loss": 9.81178213953972, "vf_explained_var": -9.313598275184631e-06, "kl": 2.357175224462771e-06, "entropy": 2.86573533564806, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "env_runners": {"episode_reward_max": 180.59773686533362, "episode_reward_min": 106.27569991461385, "episode_reward_mean": 139.1237409082796, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.27569991461385}, "policy_reward_max": {"tplp_policy": 180.59773686533362}, "policy_reward_mean": {"tplp_policy": 139.1237409082796}, "custom_metrics": {"mean_episode_reward_mean": 139.1237409082796, "mean_episode_reward_min": 106.27569991461385, "mean_episode_reward_max": 180.59773686533362}, "hist_stats": {"episode_reward": [114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [114.12087826089667, 137.99493891108114, 140.65798622511778, 168.26019231902563, 134.20208663949526, 146.4534392795858, 139.70726553158013, 146.1395291773123, 142.4906983910405, 163.0713031994611, 123.79181099796999, 133.4105900802681, 134.97734118393478, 106.27569991461385, 129.52001980752544, 150.09717805646815, 128.3432765229772, 144.9288055346734, 168.31643576401484, 141.80359057282197, 134.6755715353475, 149.9169178547476, 140.85984062603498, 140.7981857770165, 139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6456644888489201, "mean_inference_ms": 1.869339858707409, "mean_action_processing_ms": 0.35103764195881487, "mean_env_wait_ms": 2.0754380658649345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009325742721557617, "StateBufferConnector_ms": 0.010849475860595703, "ViewRequirementAgentConnector_ms": 0.1960897445678711}, "num_episodes": 18, "episode_return_max": 180.59773686533362, "episode_return_min": 106.27569991461385, "episode_return_mean": 139.1237409082796, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 475.09496673148436, "num_env_steps_trained_throughput_per_sec": 475.09496673148436, "timesteps_total": 53248, "num_env_steps_sampled_lifetime": 53248, "num_agent_steps_sampled_lifetime": 53248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 2123.926, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2123.926, "sample_time_ms": 875.22, "learn_time_ms": 1231.985, "learn_throughput": 831.179, "synch_weights_time_ms": 16.182}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "training_iteration": 52, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-11", "timestamp": 1744110191, "time_this_iter_s": 2.1614880561828613, "time_total_s": 111.36013174057007, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDE40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.36013174057007, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.666666666666664, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.086440258100629, "cur_kl_coeff": 4.440892098500626e-17, "cur_lr": 1e-07, "total_loss": 2.1767058216035364, "policy_loss": -0.0001273463014513254, "vf_loss": 9.853946685791016, "vf_explained_var": -8.499994874000549e-06, "kl": 7.020251071132578e-07, "entropy": 2.866535073518753, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "env_runners": {"episode_reward_max": 180.59773686533362, "episode_reward_min": 102.84593723488764, "episode_reward_mean": 137.3959103771874, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 102.84593723488764}, "policy_reward_max": {"tplp_policy": 180.59773686533362}, "policy_reward_mean": {"tplp_policy": 137.3959103771874}, "custom_metrics": {"mean_episode_reward_mean": 137.3959103771874, "mean_episode_reward_min": 102.84593723488764, "mean_episode_reward_max": 180.59773686533362}, "hist_stats": {"episode_reward": [139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.44706614612616, 148.86415051553465, 143.8078268535364, 129.30517290200834, 134.13268135772142, 126.29234584587354, 142.28545194070608, 140.95406620590842, 151.6272794846709, 137.56706172627344, 134.63337896604435, 136.07809508683104, 128.72679596272678, 151.14100116464877, 155.94434115995128, 135.69816006055555, 132.39877765624115, 133.10446662607862, 157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6453215965903623, "mean_inference_ms": 1.8683166585837734, "mean_action_processing_ms": 0.35077814793061174, "mean_env_wait_ms": 2.0751252767972304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004263401031494141, "StateBufferConnector_ms": 0.011110305786132812, "ViewRequirementAgentConnector_ms": 0.1892402172088623}, "num_episodes": 24, "episode_return_max": 180.59773686533362, "episode_return_min": 102.84593723488764, "episode_return_mean": 137.3959103771874, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 476.4600111666659, "num_env_steps_trained_throughput_per_sec": 476.4600111666659, "timesteps_total": 54272, "num_env_steps_sampled_lifetime": 54272, "num_agent_steps_sampled_lifetime": 54272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 2119.349, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2119.349, "sample_time_ms": 872.162, "learn_time_ms": 1230.555, "learn_throughput": 832.145, "synch_weights_time_ms": 16.094}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "training_iteration": 53, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-13", "timestamp": 1744110193, "time_this_iter_s": 2.1556313037872314, "time_total_s": 113.5157630443573, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.5157630443573, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 32.166666666666664, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8732186045497654, "cur_kl_coeff": 2.220446049250313e-17, "cur_lr": 1e-07, "total_loss": 2.1789517350494862, "policy_loss": -0.00019977122865384446, "vf_loss": 9.863067471981049, "vf_explained_var": -5.3942203521728516e-06, "kl": 8.005162842703028e-07, "entropy": 2.866153413057327, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "env_runners": {"episode_reward_max": 180.59773686533362, "episode_reward_min": 102.84593723488764, "episode_reward_mean": 138.41780721449786, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 102.84593723488764}, "policy_reward_max": {"tplp_policy": 180.59773686533362}, "policy_reward_mean": {"tplp_policy": 138.41780721449786}, "custom_metrics": {"mean_episode_reward_mean": 138.41780721449786, "mean_episode_reward_min": 102.84593723488764, "mean_episode_reward_max": 180.59773686533362}, "hist_stats": {"episode_reward": [157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.5086372644181, 144.1183819039697, 132.22784487827224, 137.6948729491409, 152.3339085846642, 153.3073389630913, 144.30384402741748, 120.73825204521836, 114.11243878017915, 128.46482573023587, 136.59458580372106, 142.61020238525506, 148.3106853808706, 139.12386974281725, 143.10615130933618, 134.20048075299562, 127.52923858236706, 128.2440275616732, 125.41415006604794, 133.26160142631548, 139.6429143354324, 138.52030881231437, 157.16337552967414, 148.2222808516455, 155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6450341277487922, "mean_inference_ms": 1.867531853178738, "mean_action_processing_ms": 0.35067840241801407, "mean_env_wait_ms": 2.0746451775242436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032563209533691406, "StateBufferConnector_ms": 0.008983850479125977, "ViewRequirementAgentConnector_ms": 0.20088648796081543}, "num_episodes": 18, "episode_return_max": 180.59773686533362, "episode_return_min": 102.84593723488764, "episode_return_mean": 138.41780721449786, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.01645824199534, "num_env_steps_trained_throughput_per_sec": 467.01645824199534, "timesteps_total": 55296, "num_env_steps_sampled_lifetime": 55296, "num_agent_steps_sampled_lifetime": 55296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 2120.892, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2120.892, "sample_time_ms": 858.713, "learn_time_ms": 1245.425, "learn_throughput": 822.209, "synch_weights_time_ms": 16.215}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "training_iteration": 54, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-15", "timestamp": 1744110195, "time_this_iter_s": 2.1989431381225586, "time_total_s": 115.71470618247986, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C234C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.71470618247986, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 31.875, "ram_util_percent": 87.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.026201679185033, "cur_kl_coeff": 1.1102230246251564e-17, "cur_lr": 1e-07, "total_loss": 2.1840327106416226, "policy_loss": -0.0001323668082477525, "vf_loss": 9.883010572195053, "vf_explained_var": -2.508983016014099e-06, "kl": 8.319543411128283e-07, "entropy": 2.8658754870295526, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "env_runners": {"episode_reward_max": 180.59773686533362, "episode_reward_min": 102.84593723488764, "episode_reward_mean": 138.77688478930847, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 102.84593723488764}, "policy_reward_max": {"tplp_policy": 180.59773686533362}, "policy_reward_mean": {"tplp_policy": 138.77688478930847}, "custom_metrics": {"mean_episode_reward_mean": 138.77688478930847, "mean_episode_reward_min": 102.84593723488764, "mean_episode_reward_max": 180.59773686533362}, "hist_stats": {"episode_reward": [155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.0440949416825, 144.55982730037888, 113.50863853049692, 120.94740175677242, 138.7820721010277, 137.4539350585303, 156.04781400779922, 180.59773686533362, 144.56268692086212, 145.07737205730334, 138.15306938052265, 133.90223724048067, 146.66242106198968, 122.29039470866748, 145.64001841971503, 135.12470393054687, 141.03140042147027, 152.5812871859723, 137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6449078151961255, "mean_inference_ms": 1.867651790487088, "mean_action_processing_ms": 0.3508730533501438, "mean_env_wait_ms": 2.075655500653772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0021238327026367188, "StateBufferConnector_ms": 0.0059926509857177734, "ViewRequirementAgentConnector_ms": 0.21034812927246094}, "num_episodes": 24, "episode_return_max": 180.59773686533362, "episode_return_min": 102.84593723488764, "episode_return_mean": 138.77688478930847, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 485.40647886397517, "num_env_steps_trained_throughput_per_sec": 485.40647886397517, "timesteps_total": 56320, "num_env_steps_sampled_lifetime": 56320, "num_agent_steps_sampled_lifetime": 56320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 2132.45, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2132.436, "sample_time_ms": 872.906, "learn_time_ms": 1242.724, "learn_throughput": 823.996, "synch_weights_time_ms": 16.166}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "training_iteration": 55, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-17", "timestamp": 1744110197, "time_this_iter_s": 2.113757848739624, "time_total_s": 117.82846403121948, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.82846403121948, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 40.766666666666666, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3129502534866333, "cur_kl_coeff": 5.551115123125782e-18, "cur_lr": 1e-07, "total_loss": 2.177113710343838, "policy_loss": -0.0002161694341339171, "vf_loss": 9.855644404888153, "vf_explained_var": -1.010410487651825e-05, "kl": 1.0345324929161848e-06, "entropy": 2.865812066197395, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "env_runners": {"episode_reward_max": 167.44632281184897, "episode_reward_min": 102.84593723488764, "episode_reward_mean": 138.52810355958957, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 102.84593723488764}, "policy_reward_max": {"tplp_policy": 167.44632281184897}, "policy_reward_mean": {"tplp_policy": 138.52810355958957}, "custom_metrics": {"mean_episode_reward_mean": 138.52810355958957, "mean_episode_reward_min": 102.84593723488764, "mean_episode_reward_max": 167.44632281184897}, "hist_stats": {"episode_reward": [137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.91045772108302, 145.5222981867993, 133.0548611320894, 134.0140850153447, 138.2180127929468, 114.41725775427773, 160.46231779146743, 129.39082966236688, 134.9337319975615, 107.55662112106897, 148.98210033614174, 145.62398784484859, 136.66601061115625, 127.3205151778931, 155.0639211391314, 121.69405116270966, 113.99810151198149, 120.63740615873049, 118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6445922452640666, "mean_inference_ms": 1.8669805980063756, "mean_action_processing_ms": 0.3508014204689913, "mean_env_wait_ms": 2.0752204505580143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002249479293823242, "StateBufferConnector_ms": 0.004988670349121094, "ViewRequirementAgentConnector_ms": 0.20778298377990723}, "num_episodes": 18, "episode_return_max": 167.44632281184897, "episode_return_min": 102.84593723488764, "episode_return_mean": 138.52810355958957, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 522.8486981211755, "num_env_steps_trained_throughput_per_sec": 522.8486981211755, "timesteps_total": 57344, "num_env_steps_sampled_lifetime": 57344, "num_agent_steps_sampled_lifetime": 57344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 2130.647, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2130.633, "sample_time_ms": 872.81, "learn_time_ms": 1241.272, "learn_throughput": 824.96, "synch_weights_time_ms": 15.91}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "training_iteration": 56, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-19", "timestamp": 1744110199, "time_this_iter_s": 1.9641070365905762, "time_total_s": 119.79257106781006, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.79257106781006, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 37.45, "ram_util_percent": 88.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9361544072628023, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 1e-07, "total_loss": 2.179704735428095, "policy_loss": -0.00015326207503676414, "vf_loss": 9.865671163797378, "vf_explained_var": -1.305602490901947e-05, "kl": 8.338635814911233e-07, "entropy": 2.865597867965698, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "env_runners": {"episode_reward_max": 167.44632281184897, "episode_reward_min": 102.84593723488764, "episode_reward_mean": 139.12900881944307, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 102.84593723488764}, "policy_reward_max": {"tplp_policy": 167.44632281184897}, "policy_reward_mean": {"tplp_policy": 139.12900881944307}, "custom_metrics": {"mean_episode_reward_mean": 139.12900881944307, "mean_episode_reward_min": 102.84593723488764, "mean_episode_reward_max": 167.44632281184897}, "hist_stats": {"episode_reward": [118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [118.97544101195047, 130.89097980414726, 139.82681585428517, 140.96964561185683, 133.97918572962413, 151.27788889900566, 145.78662295167274, 149.97039499107012, 137.1951000183506, 126.92460162813444, 128.53899431229905, 128.38543948078282, 155.9030698117487, 151.64546360863847, 125.05211153292143, 120.90010746016829, 102.84593723488764, 120.55700057540936, 117.66221246726893, 144.98627913570294, 134.12711035136738, 146.99461891178552, 140.96958125311113, 137.89041302605818, 145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6442475882305777, "mean_inference_ms": 1.8661559620574801, "mean_action_processing_ms": 0.35068971037880803, "mean_env_wait_ms": 2.074382281212593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032532215118408203, "StateBufferConnector_ms": 0.003991127014160156, "ViewRequirementAgentConnector_ms": 0.21005034446716309}, "num_episodes": 18, "episode_return_max": 167.44632281184897, "episode_return_min": 102.84593723488764, "episode_return_mean": 139.12900881944307, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 511.7979923304789, "num_env_steps_trained_throughput_per_sec": 511.7979923304789, "timesteps_total": 58368, "num_env_steps_sampled_lifetime": 58368, "num_agent_steps_sampled_lifetime": 58368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 2113.999, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2113.985, "sample_time_ms": 863.663, "learn_time_ms": 1233.386, "learn_throughput": 830.235, "synch_weights_time_ms": 16.297}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "training_iteration": 57, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-21", "timestamp": 1744110201, "time_this_iter_s": 2.0057876110076904, "time_total_s": 121.79835867881775, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 121.79835867881775, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 27.5, "ram_util_percent": 88.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.953836762160063, "cur_kl_coeff": 1.3877787807814456e-18, "cur_lr": 1e-07, "total_loss": 2.1924386829137803, "policy_loss": -0.00015461171278730035, "vf_loss": 9.916518157720565, "vf_explained_var": -9.007751941680908e-06, "kl": 6.713988141449078e-07, "entropy": 2.865362475812435, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "env_runners": {"episode_reward_max": 167.44632281184897, "episode_reward_min": 109.28338173431614, "episode_reward_mean": 140.3336280955738, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.28338173431614}, "policy_reward_max": {"tplp_policy": 167.44632281184897}, "policy_reward_mean": {"tplp_policy": 140.3336280955738}, "custom_metrics": {"mean_episode_reward_mean": 140.3336280955738, "mean_episode_reward_min": 109.28338173431614, "mean_episode_reward_max": 167.44632281184897}, "hist_stats": {"episode_reward": [145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.9880840582406, 128.0296420355893, 164.91668878674017, 130.3712456415261, 154.5188813583972, 154.7336608777954, 145.2312607619391, 162.10971501380732, 162.35793168767572, 149.54249149908642, 156.4806784297595, 131.30283211414107, 137.55119392500487, 143.82615481085875, 131.39861584318845, 126.97873226956688, 156.36540456319995, 129.80429844210218, 143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6442120228676933, "mean_inference_ms": 1.865656735943453, "mean_action_processing_ms": 0.35065331286341367, "mean_env_wait_ms": 2.073942065525117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260063171386719, "StateBufferConnector_ms": 0.0030014514923095703, "ViewRequirementAgentConnector_ms": 0.22164511680603027}, "num_episodes": 24, "episode_return_max": 167.44632281184897, "episode_return_min": 109.28338173431614, "episode_return_mean": 140.3336280955738, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 450.4244872541484, "num_env_steps_trained_throughput_per_sec": 450.4244872541484, "timesteps_total": 59392, "num_env_steps_sampled_lifetime": 59392, "num_agent_steps_sampled_lifetime": 59392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 2127.825, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2127.811, "sample_time_ms": 862.449, "learn_time_ms": 1248.444, "learn_throughput": 820.221, "synch_weights_time_ms": 16.278}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "training_iteration": 58, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-24", "timestamp": 1744110204, "time_this_iter_s": 2.2797553539276123, "time_total_s": 124.07811403274536, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDF80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.07811403274536, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.724999999999994, "ram_util_percent": 88.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5298500671982764, "cur_kl_coeff": 6.938893903907228e-19, "cur_lr": 1e-07, "total_loss": 2.1668968930840493, "policy_loss": -0.00029555150540545584, "vf_loss": 9.814803588390351, "vf_explained_var": -9.891763329505921e-06, "kl": 1.5731344556846328e-06, "entropy": 2.865084633231163, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "env_runners": {"episode_reward_max": 167.44632281184897, "episode_reward_min": 109.28338173431614, "episode_reward_mean": 139.10678414890515, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.28338173431614}, "policy_reward_max": {"tplp_policy": 167.44632281184897}, "policy_reward_mean": {"tplp_policy": 139.10678414890515}, "custom_metrics": {"mean_episode_reward_mean": 139.10678414890515, "mean_episode_reward_min": 109.28338173431614, "mean_episode_reward_max": 167.44632281184897}, "hist_stats": {"episode_reward": [143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [143.25442194171197, 133.1254744725351, 167.44632281184897, 134.89751952175936, 135.47588429118144, 158.4699009896233, 147.2037438492148, 133.20771827793902, 137.34163660766276, 143.32925328560967, 142.19776613530618, 139.41537451465132, 123.52457106712733, 151.70082978618748, 130.86487319829803, 151.47902243223962, 109.28338173431614, 145.76717375311924, 134.1934692802958, 145.5239606610154, 126.95985355677458, 141.83011997441304, 134.76424880715425, 158.52878442735437, 134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6444475592526183, "mean_inference_ms": 1.8655449981767047, "mean_action_processing_ms": 0.35061643520216024, "mean_env_wait_ms": 2.0740403976215296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006255388259887695, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.2177894115447998}, "num_episodes": 18, "episode_return_max": 167.44632281184897, "episode_return_min": 109.28338173431614, "episode_return_mean": 139.10678414890515, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 477.9858087770659, "num_env_steps_trained_throughput_per_sec": 477.9858087770659, "timesteps_total": 60416, "num_env_steps_sampled_lifetime": 60416, "num_agent_steps_sampled_lifetime": 60416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 2139.812, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2139.798, "sample_time_ms": 866.511, "learn_time_ms": 1256.358, "learn_throughput": 815.054, "synch_weights_time_ms": 16.49}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "training_iteration": 59, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-26", "timestamp": 1744110206, "time_this_iter_s": 2.146759510040283, "time_total_s": 126.22487354278564, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDE40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.22487354278564, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 38.03333333333333, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1336602453142404, "cur_kl_coeff": 3.469446951953614e-19, "cur_lr": 1e-07, "total_loss": 2.177342066168785, "policy_loss": -0.0001059336995240301, "vf_loss": 9.856008833646774, "vf_explained_var": -1.3838335871696471e-05, "kl": 7.035860526638515e-07, "entropy": 2.865541872382164, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "env_runners": {"episode_reward_max": 168.33533318858682, "episode_reward_min": 112.50857746865512, "episode_reward_mean": 138.9518084938031, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.50857746865512}, "policy_reward_max": {"tplp_policy": 168.33533318858682}, "policy_reward_mean": {"tplp_policy": 138.9518084938031}, "custom_metrics": {"mean_episode_reward_mean": 138.9518084938031, "mean_episode_reward_min": 112.50857746865512, "mean_episode_reward_max": 168.33533318858682}, "hist_stats": {"episode_reward": [134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [134.6362185511513, 151.58525119356074, 145.46565552270584, 131.20973469448154, 141.04792612910438, 150.59299458401154, 144.3453561289237, 157.3261904822869, 137.8721737545034, 115.74857453469703, 115.85348927396608, 141.0541821267292, 149.50638660897735, 138.97770779603528, 161.10420111105478, 117.46991319096387, 148.6053631082166, 130.8624664695784, 150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6447030006912662, "mean_inference_ms": 1.8647314535622623, "mean_action_processing_ms": 0.3504767008615871, "mean_env_wait_ms": 2.073042052118041, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007428884506225586, "StateBufferConnector_ms": 0.004004478454589844, "ViewRequirementAgentConnector_ms": 0.21236777305603027}, "num_episodes": 24, "episode_return_max": 168.33533318858682, "episode_return_min": 112.50857746865512, "episode_return_mean": 138.9518084938031, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 498.1842866723843, "num_env_steps_trained_throughput_per_sec": 498.1842866723843, "timesteps_total": 61440, "num_env_steps_sampled_lifetime": 61440, "num_agent_steps_sampled_lifetime": 61440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 2134.981, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2134.967, "sample_time_ms": 873.145, "learn_time_ms": 1245.383, "learn_throughput": 822.237, "synch_weights_time_ms": 15.994}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "training_iteration": 60, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-28", "timestamp": 1744110208, "time_this_iter_s": 2.0606000423431396, "time_total_s": 128.28547358512878, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.28547358512878, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 30.566666666666666, "ram_util_percent": 88.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1393923804163935, "cur_kl_coeff": 1.734723475976807e-19, "cur_lr": 1e-07, "total_loss": 2.1888756662607194, "policy_loss": -0.00015314872143790126, "vf_loss": 9.902572679519654, "vf_explained_var": -1.203492283821106e-05, "kl": 1.059238568812404e-06, "entropy": 2.8661436438560486, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "env_runners": {"episode_reward_max": 168.33533318858682, "episode_reward_min": 112.50857746865512, "episode_reward_mean": 138.33379875150368, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.50857746865512}, "policy_reward_max": {"tplp_policy": 168.33533318858682}, "policy_reward_mean": {"tplp_policy": 138.33379875150368}, "custom_metrics": {"mean_episode_reward_mean": 138.33379875150368, "mean_episode_reward_min": 112.50857746865512, "mean_episode_reward_max": 168.33533318858682}, "hist_stats": {"episode_reward": [150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [150.68443468855833, 128.19435828305237, 128.3236326184897, 144.15958967525728, 153.69412475406776, 141.42857118836713, 120.8693178851041, 128.14443603406318, 132.9223273820662, 136.9223728575408, 122.26101875774206, 135.5892254069842, 126.4947929638684, 148.3382761412718, 136.88334219497793, 151.17944269373905, 143.85920444836555, 113.71834156358143, 127.01076915669601, 128.80970822859317, 139.82437402997286, 140.81899878771426, 147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6448581849961889, "mean_inference_ms": 1.8644443929393841, "mean_action_processing_ms": 0.35033685199278153, "mean_env_wait_ms": 2.072622129714926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007806301116943359, "StateBufferConnector_ms": 0.00843191146850586, "ViewRequirementAgentConnector_ms": 0.21269583702087402}, "num_episodes": 18, "episode_return_max": 168.33533318858682, "episode_return_min": 112.50857746865512, "episode_return_mean": 138.33379875150368, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 453.9333701062677, "num_env_steps_trained_throughput_per_sec": 453.9333701062677, "timesteps_total": 62464, "num_env_steps_sampled_lifetime": 62464, "num_agent_steps_sampled_lifetime": 62464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 2129.308, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2129.294, "sample_time_ms": 863.272, "learn_time_ms": 1248.471, "learn_throughput": 820.203, "synch_weights_time_ms": 17.105}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "training_iteration": 61, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-30", "timestamp": 1744110210, "time_this_iter_s": 2.2696642875671387, "time_total_s": 130.55513787269592, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.55513787269592, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 31.36666666666667, "ram_util_percent": 88.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3367599241435526, "cur_kl_coeff": 8.673617379884035e-20, "cur_lr": 1e-07, "total_loss": 2.185421587526798, "policy_loss": -0.00020292251138016583, "vf_loss": 9.88924532532692, "vf_explained_var": -1.368299126625061e-06, "kl": 1.5777752815582247e-06, "entropy": 2.8668680623173715, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "env_runners": {"episode_reward_max": 182.02281825965798, "episode_reward_min": 110.35051681196641, "episode_reward_mean": 138.73082193851195, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.35051681196641}, "policy_reward_max": {"tplp_policy": 182.02281825965798}, "policy_reward_mean": {"tplp_policy": 138.73082193851195}, "custom_metrics": {"mean_episode_reward_mean": 138.73082193851195, "mean_episode_reward_min": 110.35051681196641, "mean_episode_reward_max": 182.02281825965798}, "hist_stats": {"episode_reward": [147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.4450311306999, 158.4923397998522, 154.75283150668193, 149.83289023409395, 131.20561612052433, 163.269176940704, 135.02233960762518, 122.93346157969891, 125.3813736399322, 112.50857746865512, 124.120829214128, 138.64392257824971, 151.29781259273005, 152.6495264410358, 166.84228732502496, 148.20150820540297, 143.6561905623253, 132.41983211303642, 149.8317675417053, 132.03036348398533, 145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6459585399877946, "mean_inference_ms": 1.8660359873354715, "mean_action_processing_ms": 0.35052409756218256, "mean_env_wait_ms": 2.0744112183711505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009664535522460938, "StateBufferConnector_ms": 0.010428905487060547, "ViewRequirementAgentConnector_ms": 0.22500038146972656}, "num_episodes": 22, "episode_return_max": 182.02281825965798, "episode_return_min": 110.35051681196641, "episode_return_mean": 138.73082193851195, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 397.4904782952813, "num_env_steps_trained_throughput_per_sec": 397.4904782952813, "timesteps_total": 63488, "num_env_steps_sampled_lifetime": 63488, "num_agent_steps_sampled_lifetime": 63488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 2171.389, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2171.375, "sample_time_ms": 890.199, "learn_time_ms": 1263.857, "learn_throughput": 810.218, "synch_weights_time_ms": 17.111}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "training_iteration": 62, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-33", "timestamp": 1744110213, "time_this_iter_s": 2.582146644592285, "time_total_s": 133.1372845172882, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.1372845172882, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 51.85, "ram_util_percent": 88.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.092097955197096, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 1e-07, "total_loss": 2.168229191750288, "policy_loss": -0.0001185099477879703, "vf_loss": 9.820423638820648, "vf_explained_var": -1.1133402585983276e-05, "kl": 1.0682860239086267e-06, "entropy": 2.86758191883564, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "env_runners": {"episode_reward_max": 182.02281825965798, "episode_reward_min": 110.35051681196641, "episode_reward_mean": 137.74617567594925, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.35051681196641}, "policy_reward_max": {"tplp_policy": 182.02281825965798}, "policy_reward_mean": {"tplp_policy": 137.74617567594925}, "custom_metrics": {"mean_episode_reward_mean": 137.74617567594925, "mean_episode_reward_min": 110.35051681196641, "mean_episode_reward_max": 182.02281825965798}, "hist_stats": {"episode_reward": [145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.900047039517, 123.56681912479601, 120.76895921778014, 122.8117680448539, 136.85305662266742, 128.04191463826655, 140.71314027836408, 142.4942210967141, 154.62967539197763, 149.97852350074234, 129.1338288706621, 165.54122186732417, 130.71190257007927, 136.6147873953234, 128.5820571139148, 150.61906365308002, 118.3923266173919, 136.37108373489738, 134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6460960970412677, "mean_inference_ms": 1.8674243627882814, "mean_action_processing_ms": 0.35055867820151176, "mean_env_wait_ms": 2.0757527546989984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008796930313110352, "StateBufferConnector_ms": 0.01042032241821289, "ViewRequirementAgentConnector_ms": 0.2208867073059082}, "num_episodes": 20, "episode_return_max": 182.02281825965798, "episode_return_min": 110.35051681196641, "episode_return_mean": 137.74617567594925, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 497.7331582968056, "num_env_steps_trained_throughput_per_sec": 497.7331582968056, "timesteps_total": 64512, "num_env_steps_sampled_lifetime": 64512, "num_agent_steps_sampled_lifetime": 64512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 2162.203, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2162.189, "sample_time_ms": 892.306, "learn_time_ms": 1252.486, "learn_throughput": 817.574, "synch_weights_time_ms": 17.189}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "training_iteration": 63, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-35", "timestamp": 1744110215, "time_this_iter_s": 2.0621795654296875, "time_total_s": 135.1994640827179, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.1994640827179, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 34.199999999999996, "ram_util_percent": 88.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8521779354661705, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 1e-07, "total_loss": 2.1814310997724533, "policy_loss": -5.927062011323869e-05, "vf_loss": 9.87335222363472, "vf_explained_var": -1.577809453010559e-05, "kl": 6.181678842587246e-07, "entropy": 2.868476866185665, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "env_runners": {"episode_reward_max": 182.02281825965798, "episode_reward_min": 110.35051681196641, "episode_reward_mean": 138.4101428885981, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.35051681196641}, "policy_reward_max": {"tplp_policy": 182.02281825965798}, "policy_reward_mean": {"tplp_policy": 138.4101428885981}, "custom_metrics": {"mean_episode_reward_mean": 138.4101428885981, "mean_episode_reward_min": 110.35051681196641, "mean_episode_reward_max": 182.02281825965798}, "hist_stats": {"episode_reward": [134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [134.64026713443005, 167.1587066011019, 125.1424436743731, 128.85319521953733, 136.77768879143647, 138.33910216704962, 138.39395482012017, 119.8891344713726, 154.44218984556744, 136.08306297799044, 160.9942744074412, 149.10459297645826, 128.12654601040163, 141.14955516344955, 112.52564656183215, 168.33533318858682, 145.71855129424583, 132.15399735943933, 155.0276602700154, 131.5337982373706, 141.35118355703653, 153.78344478558427, 132.4751008505611, 150.22273026424432, 125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6462827766297992, "mean_inference_ms": 1.8681775442696298, "mean_action_processing_ms": 0.3506149781183354, "mean_env_wait_ms": 2.076554204437684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006801605224609375, "StateBufferConnector_ms": 0.009542703628540039, "ViewRequirementAgentConnector_ms": 0.21382689476013184}, "num_episodes": 18, "episode_return_max": 182.02281825965798, "episode_return_min": 110.35051681196641, "episode_return_mean": 138.4101428885981, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 497.8894653785664, "num_env_steps_trained_throughput_per_sec": 497.8894653785664, "timesteps_total": 65536, "num_env_steps_sampled_lifetime": 65536, "num_agent_steps_sampled_lifetime": 65536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 2148.607, "restore_workers_time_ms": 0.014, "training_step_time_ms": 2148.593, "sample_time_ms": 893.224, "learn_time_ms": 1238.196, "learn_throughput": 827.01, "synch_weights_time_ms": 16.966}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "training_iteration": 64, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-37", "timestamp": 1744110217, "time_this_iter_s": 2.0613276958465576, "time_total_s": 137.26079177856445, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDD00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 137.26079177856445, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 36.53333333333333, "ram_util_percent": 88.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.158572865650058, "cur_kl_coeff": 1.0842021724855043e-20, "cur_lr": 1e-07, "total_loss": 2.1586339846253395, "policy_loss": -0.00018482772866263987, "vf_loss": 9.783010751008987, "vf_explained_var": -1.1756643652915955e-05, "kl": 1.2378325743966912e-06, "entropy": 2.8693385884165763, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "env_runners": {"episode_reward_max": 182.02281825965798, "episode_reward_min": 110.35051681196641, "episode_reward_mean": 139.02638801715383, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.35051681196641}, "policy_reward_max": {"tplp_policy": 182.02281825965798}, "policy_reward_mean": {"tplp_policy": 139.02638801715383}, "custom_metrics": {"mean_episode_reward_mean": 139.02638801715383, "mean_episode_reward_min": 110.35051681196641, "mean_episode_reward_max": 182.02281825965798}, "hist_stats": {"episode_reward": [125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [125.17471191336385, 124.30255307908043, 135.690896485339, 139.7018635167307, 137.19452349752456, 125.20792779071326, 136.03260026913898, 140.82094355609252, 131.70851509736292, 140.29962568853395, 127.62129482613963, 131.0092026411812, 142.07680583590718, 154.709641941196, 151.73134739103466, 125.48252638686566, 136.14263303635877, 124.09331767790732, 139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6463779569656966, "mean_inference_ms": 1.868685547743985, "mean_action_processing_ms": 0.35051144900338976, "mean_env_wait_ms": 2.077231713022022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005628108978271484, "StateBufferConnector_ms": 0.007243633270263672, "ViewRequirementAgentConnector_ms": 0.21271347999572754}, "num_episodes": 24, "episode_return_max": 182.02281825965798, "episode_return_min": 110.35051681196641, "episode_return_mean": 139.02638801715383, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 488.50934203034444, "num_env_steps_trained_throughput_per_sec": 488.50934203034444, "timesteps_total": 66560, "num_env_steps_sampled_lifetime": 66560, "num_agent_steps_sampled_lifetime": 66560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 2147.267, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2147.267, "sample_time_ms": 879.6, "learn_time_ms": 1250.129, "learn_throughput": 819.116, "synch_weights_time_ms": 17.332}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "training_iteration": 65, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-39", "timestamp": 1744110219, "time_this_iter_s": 2.101776599884033, "time_total_s": 139.3625683784485, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD4E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.3625683784485, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 29.433333333333334, "ram_util_percent": 87.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1002593211829663, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 1e-07, "total_loss": 2.187797485291958, "policy_loss": -0.00011565372697077691, "vf_loss": 9.899900424480439, "vf_explained_var": -1.3842433691024781e-05, "kl": 1.5193658669199196e-06, "entropy": 2.870619685947895, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "env_runners": {"episode_reward_max": 182.02281825965798, "episode_reward_min": 110.35051681196641, "episode_reward_mean": 139.83507456960754, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 110.35051681196641}, "policy_reward_max": {"tplp_policy": 182.02281825965798}, "policy_reward_mean": {"tplp_policy": 139.83507456960754}, "custom_metrics": {"mean_episode_reward_mean": 139.83507456960754, "mean_episode_reward_min": 110.35051681196641, "mean_episode_reward_max": 182.02281825965798}, "hist_stats": {"episode_reward": [139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.8666284819606, 131.91241696770982, 110.35051681196641, 144.80022237762918, 139.0035705764802, 138.0210209414276, 182.02281825965798, 130.5883296724097, 131.64642121575187, 139.3192060217314, 125.29866624035748, 164.7902981088623, 142.230787466755, 119.73530027792671, 146.7271353819121, 126.53706454033048, 124.03392771357365, 135.0919931001187, 142.50146820609834, 145.11923536397413, 152.9978402424355, 158.03989162033392, 153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.646581370790459, "mean_inference_ms": 1.8695745504153813, "mean_action_processing_ms": 0.350549229584628, "mean_env_wait_ms": 2.078293231481046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002124786376953125, "StateBufferConnector_ms": 0.007260322570800781, "ViewRequirementAgentConnector_ms": 0.22719097137451172}, "num_episodes": 18, "episode_return_max": 182.02281825965798, "episode_return_min": 110.35051681196641, "episode_return_mean": 139.83507456960754, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.80819514926617, "num_env_steps_trained_throughput_per_sec": 466.80819514926617, "timesteps_total": 67584, "num_env_steps_sampled_lifetime": 67584, "num_agent_steps_sampled_lifetime": 67584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 2170.779, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2170.779, "sample_time_ms": 890.649, "learn_time_ms": 1262.464, "learn_throughput": 811.112, "synch_weights_time_ms": 17.46}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "done": false, "training_iteration": 66, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-42", "timestamp": 1744110222, "time_this_iter_s": 2.1999154090881348, "time_total_s": 141.56248378753662, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDB20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.56248378753662, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 44.56666666666666, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7119099617004396, "cur_kl_coeff": 2.710505431213761e-21, "cur_lr": 1e-07, "total_loss": 2.177160219848156, "policy_loss": -0.0003916873538400978, "vf_loss": 9.858814668655395, "vf_explained_var": -6.9230794906616214e-06, "kl": 2.0917815159005036e-06, "entropy": 2.8715176552534105, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "env_runners": {"episode_reward_max": 179.9417819732251, "episode_reward_min": 116.29333687327886, "episode_reward_mean": 140.3864361378233, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.29333687327886}, "policy_reward_max": {"tplp_policy": 179.9417819732251}, "policy_reward_mean": {"tplp_policy": 140.3864361378233}, "custom_metrics": {"mean_episode_reward_mean": 140.3864361378233, "mean_episode_reward_min": 116.29333687327886, "mean_episode_reward_max": 179.9417819732251}, "hist_stats": {"episode_reward": [153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [153.49859958423744, 134.9449639678595, 137.76404008660828, 122.60041064322026, 118.71645641463905, 123.28337916517319, 119.55956658958601, 119.11985981438434, 163.26560815325726, 134.6162118272511, 132.3812935964828, 153.32350917541902, 145.78409323959454, 144.27514620559475, 155.6966000051906, 130.4991988450113, 119.65250371505566, 122.05387893849043, 142.0653797282724, 144.28172235758828, 140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6462329168772288, "mean_inference_ms": 1.8694257262308158, "mean_action_processing_ms": 0.35033357480335453, "mean_env_wait_ms": 2.078633357353775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0011265277862548828, "StateBufferConnector_ms": 0.00726318359375, "ViewRequirementAgentConnector_ms": 0.21793699264526367}, "num_episodes": 22, "episode_return_max": 179.9417819732251, "episode_return_min": 116.29333687327886, "episode_return_mean": 140.3864361378233, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 477.51905404478396, "num_env_steps_trained_throughput_per_sec": 477.51905404478396, "timesteps_total": 68608, "num_env_steps_sampled_lifetime": 68608, "num_agent_steps_sampled_lifetime": 68608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 2185.142, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2185.142, "sample_time_ms": 904.111, "learn_time_ms": 1264.016, "learn_throughput": 810.116, "synch_weights_time_ms": 16.809}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "done": false, "training_iteration": 67, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-44", "timestamp": 1744110224, "time_this_iter_s": 2.1486124992370605, "time_total_s": 143.71109628677368, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.71109628677368, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9332366578280924, "cur_kl_coeff": 1.3552527156068804e-21, "cur_lr": 1e-07, "total_loss": 2.1903519093990327, "policy_loss": -5.717492895200849e-05, "vf_loss": 9.91030466556549, "vf_explained_var": -7.802248001098633e-06, "kl": 5.373792030027858e-07, "entropy": 2.8716706335544586, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "env_runners": {"episode_reward_max": 179.9417819732251, "episode_reward_min": 112.38894330090508, "episode_reward_mean": 140.96945484849596, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.38894330090508}, "policy_reward_max": {"tplp_policy": 179.9417819732251}, "policy_reward_mean": {"tplp_policy": 140.96945484849596}, "custom_metrics": {"mean_episode_reward_mean": 140.96945484849596, "mean_episode_reward_min": 112.38894330090508, "mean_episode_reward_max": 179.9417819732251}, "hist_stats": {"episode_reward": [140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [140.32436841841553, 179.24238062457437, 133.70662796007326, 156.96161898382388, 134.93305413808585, 126.61036278415902, 137.02235985429846, 150.70583874232392, 152.9031054675547, 140.87011486110595, 130.15609219314075, 126.37276505337671, 141.83367607790484, 116.49917058666247, 146.97109945999352, 126.66138075187887, 146.67888866865786, 151.85869580575516, 155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6458354214879118, "mean_inference_ms": 1.8685651648312431, "mean_action_processing_ms": 0.3502375498454373, "mean_env_wait_ms": 2.078480532076724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030088424682617188, "StateBufferConnector_ms": 0.00728154182434082, "ViewRequirementAgentConnector_ms": 0.20898842811584473}, "num_episodes": 20, "episode_return_max": 179.9417819732251, "episode_return_min": 112.38894330090508, "episode_return_mean": 140.96945484849596, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 522.370685331233, "num_env_steps_trained_throughput_per_sec": 522.370685331233, "timesteps_total": 69632, "num_env_steps_sampled_lifetime": 69632, "num_agent_steps_sampled_lifetime": 69632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 2153.83, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2153.83, "sample_time_ms": 890.692, "learn_time_ms": 1246.017, "learn_throughput": 821.819, "synch_weights_time_ms": 16.783}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "training_iteration": 68, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-46", "timestamp": 1744110226, "time_this_iter_s": 1.9661297798156738, "time_total_s": 145.67722606658936, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C20B80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.67722606658936, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 27.233333333333334, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.280453217215836, "cur_kl_coeff": 6.776263578034402e-22, "cur_lr": 1e-07, "total_loss": 2.169560144096613, "policy_loss": -0.00014615018153563142, "vf_loss": 9.828058260679246, "vf_explained_var": -1.363605260848999e-05, "kl": 1.7273357259761647e-06, "entropy": 2.873082746565342, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "env_runners": {"episode_reward_max": 179.9417819732251, "episode_reward_min": 112.38894330090508, "episode_reward_mean": 140.60965070596131, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.38894330090508}, "policy_reward_max": {"tplp_policy": 179.9417819732251}, "policy_reward_mean": {"tplp_policy": 140.60965070596131}, "custom_metrics": {"mean_episode_reward_mean": 140.60965070596131, "mean_episode_reward_min": 112.38894330090508, "mean_episode_reward_max": 179.9417819732251}, "hist_stats": {"episode_reward": [155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.9027787682626, 154.33962233550042, 179.9417819732251, 129.35433370271394, 142.33091657321896, 151.21450033509655, 138.83096205215062, 139.57610370099775, 168.0653022153501, 135.2483959907921, 143.1342327893171, 165.05684472643915, 134.58743519014374, 152.36285909399368, 126.04706291511957, 124.10368833167612, 116.29333687327886, 139.2290849452995, 149.94085829029447, 126.87538711828194, 138.27337182747672, 134.60022926217778, 127.85363391576695, 153.81747931674232, 137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6454532411680239, "mean_inference_ms": 1.8680604360010205, "mean_action_processing_ms": 0.35016018485681294, "mean_env_wait_ms": 2.078294443233534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030088424682617188, "StateBufferConnector_ms": 0.010158300399780273, "ViewRequirementAgentConnector_ms": 0.20966601371765137}, "num_episodes": 18, "episode_return_max": 179.9417819732251, "episode_return_min": 112.38894330090508, "episode_return_mean": 140.60965070596131, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 461.08982022942587, "num_env_steps_trained_throughput_per_sec": 461.08982022942587, "timesteps_total": 70656, "num_env_steps_sampled_lifetime": 70656, "num_agent_steps_sampled_lifetime": 70656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 2161.68, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2161.68, "sample_time_ms": 888.019, "learn_time_ms": 1256.512, "learn_throughput": 814.955, "synch_weights_time_ms": 16.811}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "done": false, "training_iteration": 69, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-48", "timestamp": 1744110228, "time_this_iter_s": 2.2264766693115234, "time_total_s": 147.90370273590088, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.90370273590088, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 40.233333333333334, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0851784359663723, "cur_kl_coeff": 3.388131789017201e-22, "cur_lr": 1e-07, "total_loss": 2.1885462954640387, "policy_loss": -0.000175262097036466, "vf_loss": 9.904681301116943, "vf_explained_var": -1.736097037792206e-05, "kl": 1.2658225111622511e-06, "entropy": 2.874487590789795, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "env_runners": {"episode_reward_max": 169.8211000334385, "episode_reward_min": 112.38894330090508, "episode_reward_mean": 138.89732119398235, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.38894330090508}, "policy_reward_max": {"tplp_policy": 169.8211000334385}, "policy_reward_mean": {"tplp_policy": 138.89732119398235}, "custom_metrics": {"mean_episode_reward_mean": 138.89732119398235, "mean_episode_reward_min": 112.38894330090508, "mean_episode_reward_max": 169.8211000334385}, "hist_stats": {"episode_reward": [137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.3958574607294, 131.1750223928686, 156.02102788581706, 145.6205093140138, 150.24647038726366, 142.56432393284456, 147.5887639819887, 137.46138082045798, 124.509698330411, 133.42400434659874, 124.16660982018246, 118.89334684203573, 150.04221469698194, 134.85708173275316, 134.1402658473187, 160.0918948510712, 151.5720276179627, 133.31739600333427, 133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6452154170201038, "mean_inference_ms": 1.8680416898683516, "mean_action_processing_ms": 0.35036439202967445, "mean_env_wait_ms": 2.0784526385978364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030095577239990234, "StateBufferConnector_ms": 0.012147903442382812, "ViewRequirementAgentConnector_ms": 0.2165694236755371}, "num_episodes": 24, "episode_return_max": 169.8211000334385, "episode_return_min": 112.38894330090508, "episode_return_mean": 138.89732119398235, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 495.4980053601871, "num_env_steps_trained_throughput_per_sec": 495.4980053601871, "timesteps_total": 71680, "num_env_steps_sampled_lifetime": 71680, "num_agent_steps_sampled_lifetime": 71680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 2162.795, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2162.795, "sample_time_ms": 890.061, "learn_time_ms": 1255.679, "learn_throughput": 815.495, "synch_weights_time_ms": 16.822}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "training_iteration": 70, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-50", "timestamp": 1744110230, "time_this_iter_s": 2.071575403213501, "time_total_s": 149.97527813911438, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C216C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.97527813911438, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 39.83333333333333, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.877865807339549, "cur_kl_coeff": 1.6940658945086005e-22, "cur_lr": 1e-07, "total_loss": 2.174358846247196, "policy_loss": -8.638430153951049e-05, "vf_loss": 9.847745406627656, "vf_explained_var": -1.61096453666687e-05, "kl": 5.712429857585022e-07, "entropy": 2.874911163747311, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "env_runners": {"episode_reward_max": 169.8211000334385, "episode_reward_min": 112.38894330090508, "episode_reward_mean": 138.7755672374194, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.38894330090508}, "policy_reward_max": {"tplp_policy": 169.8211000334385}, "policy_reward_mean": {"tplp_policy": 138.7755672374194}, "custom_metrics": {"mean_episode_reward_mean": 138.7755672374194, "mean_episode_reward_min": 112.38894330090508, "mean_episode_reward_max": 169.8211000334385}, "hist_stats": {"episode_reward": [133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [133.8881235000019, 154.72696677071056, 164.60866967249643, 134.14671990588076, 144.15840628206675, 133.0773014495998, 128.45331842186286, 128.6579482962015, 133.72487473002093, 147.441608463227, 138.18398880603291, 131.06958275546918, 136.7510416436267, 153.73407351267682, 130.53516117053857, 135.22689649497866, 135.35753830257005, 156.77163315546167, 166.64897776169474, 153.718661694559, 134.02049602850153, 141.74553696137735, 137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6448761599542604, "mean_inference_ms": 1.8673395128013839, "mean_action_processing_ms": 0.3503698864038206, "mean_env_wait_ms": 2.0778318789037042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004007101058959961, "StateBufferConnector_ms": 0.011117219924926758, "ViewRequirementAgentConnector_ms": 0.20132803916931152}, "num_episodes": 18, "episode_return_max": 169.8211000334385, "episode_return_min": 112.38894330090508, "episode_return_mean": 138.7755672374194, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 501.4689001097869, "num_env_steps_trained_throughput_per_sec": 501.4689001097869, "timesteps_total": 72704, "num_env_steps_sampled_lifetime": 72704, "num_agent_steps_sampled_lifetime": 72704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 2141.411, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2141.411, "sample_time_ms": 890.034, "learn_time_ms": 1235.553, "learn_throughput": 828.779, "synch_weights_time_ms": 15.592}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "done": false, "training_iteration": 71, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-52", "timestamp": 1744110232, "time_this_iter_s": 2.047193765640259, "time_total_s": 152.02247190475464, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.02247190475464, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 30.8, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.601282899826765, "cur_kl_coeff": 8.470329472543003e-23, "cur_lr": 1e-07, "total_loss": 2.1786977358162405, "policy_loss": -0.00036716454196721314, "vf_loss": 9.86648119688034, "vf_explained_var": -1.4838576316833495e-05, "kl": 3.2058016347535913e-06, "entropy": 2.8755538687109947, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "env_runners": {"episode_reward_max": 169.8211000334385, "episode_reward_min": 112.38894330090508, "episode_reward_mean": 137.6347649040409, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.38894330090508}, "policy_reward_max": {"tplp_policy": 169.8211000334385}, "policy_reward_mean": {"tplp_policy": 137.6347649040409}, "custom_metrics": {"mean_episode_reward_mean": 137.6347649040409, "mean_episode_reward_min": 112.38894330090508, "mean_episode_reward_max": 169.8211000334385}, "hist_stats": {"episode_reward": [137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.53143367151762, 149.99221723387268, 150.60014880889793, 145.56298773324914, 150.38618606326432, 132.36473264853794, 134.6349815309001, 121.59871267474338, 149.40069001134782, 126.22463771700407, 112.38894330090508, 159.08139522877096, 142.83057091426454, 140.72064109286924, 134.41355083565833, 131.7511137603359, 158.49286118485057, 121.94245571931592, 149.74030746198534, 150.10165615412933, 138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6445124254894702, "mean_inference_ms": 1.8662514347124488, "mean_action_processing_ms": 0.35033596143849843, "mean_env_wait_ms": 2.0766619690162798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062198638916015625, "StateBufferConnector_ms": 0.009117364883422852, "ViewRequirementAgentConnector_ms": 0.2077479362487793}, "num_episodes": 22, "episode_return_max": 169.8211000334385, "episode_return_min": 112.38894330090508, "episode_return_mean": 137.6347649040409, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.8579429522837, "num_env_steps_trained_throughput_per_sec": 486.8579429522837, "timesteps_total": 73728, "num_env_steps_sampled_lifetime": 73728, "num_agent_steps_sampled_lifetime": 73728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 2094.123, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2094.123, "sample_time_ms": 868.225, "learn_time_ms": 1209.841, "learn_throughput": 846.392, "synch_weights_time_ms": 15.824}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "training_iteration": 72, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-55", "timestamp": 1744110235, "time_this_iter_s": 2.1100480556488037, "time_total_s": 154.13251996040344, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C232E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.13251996040344, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 87.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.430773404613137, "cur_kl_coeff": 4.2351647362715013e-23, "cur_lr": 1e-07, "total_loss": 2.1572216749191284, "policy_loss": -0.0002275968377944082, "vf_loss": 9.780144500732423, "vf_explained_var": -1.4505162835121154e-05, "kl": 1.4079234691877218e-06, "entropy": 2.875868459045887, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "env_runners": {"episode_reward_max": 169.8211000334385, "episode_reward_min": 106.42601661647046, "episode_reward_mean": 137.53658986104674, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.42601661647046}, "policy_reward_max": {"tplp_policy": 169.8211000334385}, "policy_reward_mean": {"tplp_policy": 137.53658986104674}, "custom_metrics": {"mean_episode_reward_mean": 137.53658986104674, "mean_episode_reward_min": 106.42601661647046, "mean_episode_reward_max": 169.8211000334385}, "hist_stats": {"episode_reward": [138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [138.26861293882106, 146.48222849859778, 134.16969701623663, 153.39104114273178, 124.72563759612527, 126.86445367458481, 136.5595253966789, 130.79647521736158, 126.80828026207445, 157.5844939836412, 140.74736003807453, 145.96396574777958, 129.7512464874213, 127.15209351690999, 134.3047056434992, 150.91940540166777, 137.3429692538955, 126.7012157050092, 117.76520421155135, 142.67880825481026, 142.706032917496, 129.44984262789941, 121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6444568570102528, "mean_inference_ms": 1.8660954082431107, "mean_action_processing_ms": 0.3504140844500789, "mean_env_wait_ms": 2.0764094335079455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007209062576293945, "StateBufferConnector_ms": 0.009102821350097656, "ViewRequirementAgentConnector_ms": 0.2234029769897461}, "num_episodes": 20, "episode_return_max": 169.8211000334385, "episode_return_min": 106.42601661647046, "episode_return_mean": 137.53658986104674, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 458.2533655738459, "num_env_steps_trained_throughput_per_sec": 458.2533655738459, "timesteps_total": 74752, "num_env_steps_sampled_lifetime": 74752, "num_agent_steps_sampled_lifetime": 74752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 2111.847, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2111.847, "sample_time_ms": 872.966, "learn_time_ms": 1222.374, "learn_throughput": 837.714, "synch_weights_time_ms": 16.157}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "done": false, "training_iteration": 73, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-57", "timestamp": 1744110237, "time_this_iter_s": 2.239043951034546, "time_total_s": 156.371563911438, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 156.371563911438, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 39.074999999999996, "ram_util_percent": 87.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.568377957120538, "cur_kl_coeff": 2.1175823681357507e-23, "cur_lr": 1e-07, "total_loss": 2.1712887950241564, "policy_loss": -0.00033840266987681387, "vf_loss": 9.8368095099926, "vf_explained_var": -1.043565571308136e-05, "kl": 2.242085854042841e-06, "entropy": 2.875751893222332, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "env_runners": {"episode_reward_max": 169.8211000334385, "episode_reward_min": 105.62372664242223, "episode_reward_mean": 137.43190589931342, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 105.62372664242223}, "policy_reward_max": {"tplp_policy": 169.8211000334385}, "policy_reward_mean": {"tplp_policy": 137.43190589931342}, "custom_metrics": {"mean_episode_reward_mean": 137.43190589931342, "mean_episode_reward_min": 105.62372664242223, "mean_episode_reward_max": 169.8211000334385}, "hist_stats": {"episode_reward": [121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [121.4180598045565, 126.41488325341705, 134.9756345567864, 125.08523858187372, 139.36589083129303, 122.8379134122683, 153.94957183151303, 142.6855214128198, 130.41289580465943, 140.34792499765456, 131.89892634096566, 115.3008399984034, 169.8211000334385, 147.53113639096406, 133.14871137534092, 143.69865532403287, 147.87952503350618, 132.33074909126273, 117.02687817228089, 130.69609402675397, 144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6447977631872581, "mean_inference_ms": 1.8662187029237756, "mean_action_processing_ms": 0.3505417245470208, "mean_env_wait_ms": 2.076723420720237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010346412658691406, "StateBufferConnector_ms": 0.00510859489440918, "ViewRequirementAgentConnector_ms": 0.2192704677581787}, "num_episodes": 22, "episode_return_max": 169.8211000334385, "episode_return_min": 105.62372664242223, "episode_return_mean": 137.43190589931342, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 491.55315223591435, "num_env_steps_trained_throughput_per_sec": 491.55315223591435, "timesteps_total": 75776, "num_env_steps_sampled_lifetime": 75776, "num_agent_steps_sampled_lifetime": 75776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 2114.499, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2114.499, "sample_time_ms": 879.232, "learn_time_ms": 1218.542, "learn_throughput": 840.349, "synch_weights_time_ms": 16.273}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "done": false, "training_iteration": 74, "trial_id": "b517c_00000", "date": "2025-04-08_19-03-59", "timestamp": 1744110239, "time_this_iter_s": 2.089355707168579, "time_total_s": 158.46091961860657, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C234C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 158.46091961860657, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 41.86666666666667, "ram_util_percent": 87.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3363265827298165, "cur_kl_coeff": 1.0587911840678753e-23, "cur_lr": 1e-07, "total_loss": 2.172733934223652, "policy_loss": -0.0003199559228960425, "vf_loss": 9.842521542310715, "vf_explained_var": -1.539364457130432e-05, "kl": 2.335811760945106e-06, "entropy": 2.875764985382557, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "env_runners": {"episode_reward_max": 168.96135220572148, "episode_reward_min": 97.61501067617067, "episode_reward_mean": 138.24610209200512, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.61501067617067}, "policy_reward_max": {"tplp_policy": 168.96135220572148}, "policy_reward_mean": {"tplp_policy": 138.24610209200512}, "custom_metrics": {"mean_episode_reward_mean": 138.24610209200512, "mean_episode_reward_min": 97.61501067617067, "mean_episode_reward_max": 168.96135220572148}, "hist_stats": {"episode_reward": [144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.00454020935666, 162.34095939573618, 121.80305050201694, 138.46967671743556, 134.56881057846107, 135.63018775003786, 159.87640970999166, 135.22090003420453, 158.01837575551713, 146.76080198222098, 119.92014825436408, 152.7471587900337, 133.2047232168821, 159.6770754324537, 124.41443067065637, 126.53227940993814, 150.38843184792918, 126.91209307760487, 130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6444405719834532, "mean_inference_ms": 1.8660359896339542, "mean_action_processing_ms": 0.3504046690959116, "mean_env_wait_ms": 2.0767984592394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010346412658691406, "StateBufferConnector_ms": 0.0040166378021240234, "ViewRequirementAgentConnector_ms": 0.2175288200378418}, "num_episodes": 20, "episode_return_max": 168.96135220572148, "episode_return_min": 97.61501067617067, "episode_return_mean": 138.24610209200512, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 524.4455513307892, "num_env_steps_trained_throughput_per_sec": 524.4455513307892, "timesteps_total": 76800, "num_env_steps_sampled_lifetime": 76800, "num_agent_steps_sampled_lifetime": 76800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 2100.135, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2100.135, "sample_time_ms": 879.256, "learn_time_ms": 1204.594, "learn_throughput": 850.079, "synch_weights_time_ms": 15.933}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "training_iteration": 75, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-01", "timestamp": 1744110241, "time_this_iter_s": 1.958055019378662, "time_total_s": 160.41897463798523, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 160.41897463798523, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 37.95, "ram_util_percent": 87.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2663151059299707, "cur_kl_coeff": 5.293955920339377e-24, "cur_lr": 1e-07, "total_loss": 2.1694924406707288, "policy_loss": -0.00017861208179965616, "vf_loss": 9.829318994283677, "vf_explained_var": -2.1191686391830446e-05, "kl": 2.037217245742795e-06, "entropy": 2.8765868350863455, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "env_runners": {"episode_reward_max": 168.96135220572148, "episode_reward_min": 97.61501067617067, "episode_reward_mean": 138.5960596447425, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.61501067617067}, "policy_reward_max": {"tplp_policy": 168.96135220572148}, "policy_reward_mean": {"tplp_policy": 138.5960596447425}, "custom_metrics": {"mean_episode_reward_mean": 138.5960596447425, "mean_episode_reward_min": 97.61501067617067, "mean_episode_reward_max": 168.96135220572148}, "hist_stats": {"episode_reward": [130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [130.4071532162642, 130.71582215003633, 137.18001311075795, 121.53692381516139, 147.68012096467697, 114.78973697501702, 152.22677846025297, 144.44263422591254, 137.29662491038926, 143.32862016681264, 143.0613928800874, 124.30150320627203, 130.98247139865146, 144.6338954192944, 133.712225186384, 125.57135855184414, 131.18580915839357, 136.28931063470077, 155.7091973377171, 140.215175747546, 131.51201110868206, 136.4769786200862, 157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.644473976075276, "mean_inference_ms": 1.8660225796243903, "mean_action_processing_ms": 0.35043220641749123, "mean_env_wait_ms": 2.077118461720191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012383222579956055, "StateBufferConnector_ms": 0.0050699710845947266, "ViewRequirementAgentConnector_ms": 0.2184901237487793}, "num_episodes": 18, "episode_return_max": 168.96135220572148, "episode_return_min": 97.61501067617067, "episode_return_mean": 138.5960596447425, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 460.404315891863, "num_env_steps_trained_throughput_per_sec": 460.404315891863, "timesteps_total": 77824, "num_env_steps_sampled_lifetime": 77824, "num_agent_steps_sampled_lifetime": 77824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 2103.186, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2103.186, "sample_time_ms": 878.61, "learn_time_ms": 1207.282, "learn_throughput": 848.186, "synch_weights_time_ms": 16.943}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "training_iteration": 76, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-03", "timestamp": 1744110243, "time_this_iter_s": 2.2305543422698975, "time_total_s": 162.64952898025513, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.64952898025513, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 32.8, "ram_util_percent": 88.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.270355883985758, "cur_kl_coeff": 2.6469779601696883e-24, "cur_lr": 1e-07, "total_loss": 2.17057551369071, "policy_loss": -7.88545876275748e-05, "vf_loss": 9.833733993768693, "vf_explained_var": -2.1780282258987428e-05, "kl": 5.848189900625744e-07, "entropy": 2.8777911975979804, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "env_runners": {"episode_reward_max": 168.96135220572148, "episode_reward_min": 97.61501067617067, "episode_reward_mean": 139.79924014881627, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.61501067617067}, "policy_reward_max": {"tplp_policy": 168.96135220572148}, "policy_reward_mean": {"tplp_policy": 139.79924014881627}, "custom_metrics": {"mean_episode_reward_mean": 139.79924014881627, "mean_episode_reward_min": 97.61501067617067, "mean_episode_reward_max": 168.96135220572148}, "hist_stats": {"episode_reward": [157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.509631435318, 106.42601661647046, 136.17401008812047, 155.71531523993772, 144.2512003401574, 150.15783147152473, 141.53061983871925, 137.67309999814378, 129.42208192540872, 108.12795234613552, 159.88827616099866, 155.54613738332733, 165.70015389657036, 135.96871143226556, 118.8176881638193, 148.12335748918022, 130.85672228925952, 140.06492360288112, 141.9473459420595, 136.6282743254438, 144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6444939777527413, "mean_inference_ms": 1.8663794625154104, "mean_action_processing_ms": 0.3506992208648502, "mean_env_wait_ms": 2.0777375431560032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009165287017822266, "StateBufferConnector_ms": 0.006076335906982422, "ViewRequirementAgentConnector_ms": 0.21477651596069336}, "num_episodes": 22, "episode_return_max": 168.96135220572148, "episode_return_min": 97.61501067617067, "episode_return_mean": 139.79924014881627, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.4919226456623, "num_env_steps_trained_throughput_per_sec": 464.4919226456623, "timesteps_total": 78848, "num_env_steps_sampled_lifetime": 78848, "num_agent_steps_sampled_lifetime": 78848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 2109.201, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2109.09, "sample_time_ms": 875.68, "learn_time_ms": 1215.525, "learn_throughput": 842.434, "synch_weights_time_ms": 17.533}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "done": false, "training_iteration": 77, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-06", "timestamp": 1744110246, "time_this_iter_s": 2.2114315032958984, "time_total_s": 164.86096048355103, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.86096048355103, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 46.13333333333333, "ram_util_percent": 87.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.503602474182844, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 1e-07, "total_loss": 2.1735254980623724, "policy_loss": -0.0002790124795865268, "vf_loss": 9.846310263872146, "vf_explained_var": -1.9272789359092712e-05, "kl": 1.5332575807269767e-06, "entropy": 2.8777304574847222, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "env_runners": {"episode_reward_max": 169.3667840131751, "episode_reward_min": 97.61501067617067, "episode_reward_mean": 139.65844513636338, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.61501067617067}, "policy_reward_max": {"tplp_policy": 169.3667840131751}, "policy_reward_mean": {"tplp_policy": 139.65844513636338}, "custom_metrics": {"mean_episode_reward_mean": 139.65844513636338, "mean_episode_reward_min": 97.61501067617067, "mean_episode_reward_max": 169.3667840131751}, "hist_stats": {"episode_reward": [144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.4840080957875, 125.16171079399648, 134.03890522483084, 145.8795018607157, 139.25317131376895, 150.1701731150178, 145.73430662000527, 159.35197893121352, 157.6181476658561, 120.97379613478388, 124.90932444606058, 119.60388061719665, 119.289446425709, 130.67148913973566, 124.03392202577194, 126.43329065793097, 105.62372664242223, 140.5361694392678, 149.273208571907, 149.0491213700501, 158.6501552867098, 159.1645424918516, 152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6443237828698365, "mean_inference_ms": 1.8661870427161944, "mean_action_processing_ms": 0.3510391734292517, "mean_env_wait_ms": 2.0775979702540126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007165193557739258, "StateBufferConnector_ms": 0.005075216293334961, "ViewRequirementAgentConnector_ms": 0.2079472541809082}, "num_episodes": 20, "episode_return_max": 169.3667840131751, "episode_return_min": 97.61501067617067, "episode_return_mean": 139.65844513636338, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 490.55273847583476, "num_env_steps_trained_throughput_per_sec": 490.55273847583476, "timesteps_total": 79872, "num_env_steps_sampled_lifetime": 79872, "num_agent_steps_sampled_lifetime": 79872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 2121.915, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2121.805, "sample_time_ms": 885.158, "learn_time_ms": 1218.86, "learn_throughput": 840.129, "synch_weights_time_ms": 17.567}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "done": false, "training_iteration": 78, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-08", "timestamp": 1744110248, "time_this_iter_s": 2.0931460857391357, "time_total_s": 166.95410656929016, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.95410656929016, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 30.366666666666664, "ram_util_percent": 87.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.142649507522583, "cur_kl_coeff": 6.617444900424221e-25, "cur_lr": 1e-07, "total_loss": 2.177871161699295, "policy_loss": -0.00018794748466461898, "vf_loss": 9.863670229911804, "vf_explained_var": -9.842962026596069e-06, "kl": 1.829136705033818e-06, "entropy": 2.8785842955112457, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "env_runners": {"episode_reward_max": 169.3667840131751, "episode_reward_min": 97.61501067617067, "episode_reward_mean": 139.3636955073789, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 97.61501067617067}, "policy_reward_max": {"tplp_policy": 169.3667840131751}, "policy_reward_mean": {"tplp_policy": 139.3636955073789}, "custom_metrics": {"mean_episode_reward_mean": 139.3636955073789, "mean_episode_reward_min": 97.61501067617067, "mean_episode_reward_max": 169.3667840131751}, "hist_stats": {"episode_reward": [152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.14062282930098, 152.15580754525234, 128.56878679613422, 135.9789701054119, 97.61501067617067, 123.65582101828923, 168.96135220572148, 100.7393865625837, 162.92233988823395, 142.45500596840213, 143.00950414269238, 128.44544733260713, 117.81595730177771, 128.74066789106828, 147.63411831717963, 150.46091709120043, 146.22217525196874, 142.90918084040726, 158.21767769155537, 151.29839604880334, 144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6439116829179009, "mean_inference_ms": 1.865311883929071, "mean_action_processing_ms": 0.3512005090915827, "mean_env_wait_ms": 2.0766184880817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00403141975402832, "StateBufferConnector_ms": 0.005084514617919922, "ViewRequirementAgentConnector_ms": 0.21776413917541504}, "num_episodes": 22, "episode_return_max": 169.3667840131751, "episode_return_min": 97.61501067617067, "episode_return_mean": 139.3636955073789, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 522.6597286456584, "num_env_steps_trained_throughput_per_sec": 522.6597286456584, "timesteps_total": 80896, "num_env_steps_sampled_lifetime": 80896, "num_agent_steps_sampled_lifetime": 80896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 2095.754, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2095.643, "sample_time_ms": 878.997, "learn_time_ms": 1199.053, "learn_throughput": 854.007, "synch_weights_time_ms": 17.374}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "done": false, "training_iteration": 79, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-10", "timestamp": 1744110250, "time_this_iter_s": 1.964735984802246, "time_total_s": 168.9188425540924, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.9188425540924, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 29.066666666666666, "ram_util_percent": 87.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2147345755249264, "cur_kl_coeff": 3.3087224502121104e-25, "cur_lr": 1e-07, "total_loss": 2.181440933793783, "policy_loss": -0.00022465038928203284, "vf_loss": 9.87885661125183, "vf_explained_var": -2.2517144680023192e-05, "kl": 2.050839933988302e-06, "entropy": 2.8804855346679688, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "env_runners": {"episode_reward_max": 181.41573183654666, "episode_reward_min": 105.16238266275396, "episode_reward_mean": 139.77466338845622, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 105.16238266275396}, "policy_reward_max": {"tplp_policy": 181.41573183654666}, "policy_reward_mean": {"tplp_policy": 139.77466338845622}, "custom_metrics": {"mean_episode_reward_mean": 139.77466338845622, "mean_episode_reward_min": 105.16238266275396, "mean_episode_reward_max": 181.41573183654666}, "hist_stats": {"episode_reward": [144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.74951262908974, 145.07343655310459, 144.73821121345867, 132.53951451405672, 161.4624363477802, 137.5723844435751, 151.5865185513122, 146.22222398164368, 138.08354776496424, 131.19869647549464, 163.58417582863322, 133.75412089310154, 137.7512594877893, 131.02878053512035, 105.16238266275396, 151.4625329863377, 144.69827496167883, 122.69744711154661, 158.02311160832596, 149.4754829268391, 149.64780953032616, 140.97789256289616, 138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6434564079978381, "mean_inference_ms": 1.8644904586068356, "mean_action_processing_ms": 0.35123870608217145, "mean_env_wait_ms": 2.075875214286874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007046699523925781, "StateBufferConnector_ms": 0.009074211120605469, "ViewRequirementAgentConnector_ms": 0.20191264152526855}, "num_episodes": 20, "episode_return_max": 181.41573183654666, "episode_return_min": 105.16238266275396, "episode_return_mean": 139.77466338845622, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 468.12316343366757, "num_env_steps_trained_throughput_per_sec": 468.12316343366757, "timesteps_total": 81920, "num_env_steps_sampled_lifetime": 81920, "num_agent_steps_sampled_lifetime": 81920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 2107.839, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2107.728, "sample_time_ms": 869.947, "learn_time_ms": 1219.652, "learn_throughput": 839.584, "synch_weights_time_ms": 17.91}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "training_iteration": 80, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-12", "timestamp": 1744110252, "time_this_iter_s": 2.1937170028686523, "time_total_s": 171.11255955696106, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBDC60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 171.11255955696106, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 28.899999999999995, "ram_util_percent": 87.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.22388300485909, "cur_kl_coeff": 1.6543612251060552e-25, "cur_lr": 1e-07, "total_loss": 2.1746689192950726, "policy_loss": -0.0002694151015020907, "vf_loss": 9.85228613615036, "vf_explained_var": -8.207932114601136e-06, "kl": 1.4461823884426294e-06, "entropy": 2.881332039833069, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "env_runners": {"episode_reward_max": 181.41573183654666, "episode_reward_min": 109.8165494362344, "episode_reward_mean": 139.49879491007806, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.8165494362344}, "policy_reward_max": {"tplp_policy": 181.41573183654666}, "policy_reward_mean": {"tplp_policy": 139.49879491007806}, "custom_metrics": {"mean_episode_reward_mean": 139.49879491007806, "mean_episode_reward_min": 109.8165494362344, "mean_episode_reward_max": 181.41573183654666}, "hist_stats": {"episode_reward": [138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [138.07024401920606, 123.61539800104111, 153.29716024250476, 143.26363081655882, 160.2816976234865, 158.725668439752, 132.60735595707754, 145.00013362532536, 126.39468274987871, 149.1636654038931, 139.37448173616943, 142.5260452770714, 121.38818843723548, 135.09081633418558, 129.79564531528473, 149.4589749720369, 136.5905415706998, 148.63068886111782, 135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6434835145563841, "mean_inference_ms": 1.8643436589338984, "mean_action_processing_ms": 0.35147007725649076, "mean_env_wait_ms": 2.075764113163701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006548404693603516, "StateBufferConnector_ms": 0.008014440536499023, "ViewRequirementAgentConnector_ms": 0.21439361572265625}, "num_episodes": 22, "episode_return_max": 181.41573183654666, "episode_return_min": 109.8165494362344, "episode_return_mean": 139.49879491007806, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 417.3547529780359, "num_env_steps_trained_throughput_per_sec": 417.3547529780359, "timesteps_total": 82944, "num_env_steps_sampled_lifetime": 82944, "num_agent_steps_sampled_lifetime": 82944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 2148.993, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2148.883, "sample_time_ms": 887.947, "learn_time_ms": 1242.743, "learn_throughput": 823.984, "synch_weights_time_ms": 17.974}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "done": false, "training_iteration": 81, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-14", "timestamp": 1744110254, "time_this_iter_s": 2.4593710899353027, "time_total_s": 173.57193064689636, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.57193064689636, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 54.599999999999994, "ram_util_percent": 87.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.202218510210514, "cur_kl_coeff": 8.271806125530276e-26, "cur_lr": 1e-07, "total_loss": 2.1726374618709086, "policy_loss": -0.00021767851430922746, "vf_loss": 9.843944525718689, "vf_explained_var": -1.465640962123871e-05, "kl": 1.6948450499487676e-06, "entropy": 2.881309945881367, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "env_runners": {"episode_reward_max": 181.41573183654666, "episode_reward_min": 109.8165494362344, "episode_reward_mean": 139.17758691821874, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.8165494362344}, "policy_reward_max": {"tplp_policy": 181.41573183654666}, "policy_reward_mean": {"tplp_policy": 139.17758691821874}, "custom_metrics": {"mean_episode_reward_mean": 139.17758691821874, "mean_episode_reward_min": 109.8165494362344, "mean_episode_reward_max": 181.41573183654666}, "hist_stats": {"episode_reward": [135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.87083326813735, 123.71451774717912, 145.49490881259266, 153.22306206300078, 135.3026060733156, 156.14641967171193, 123.73846939399391, 142.23947898301267, 169.3667840131751, 144.8894625411998, 134.7798383575594, 137.4428445627112, 115.55648127443888, 161.44492592305207, 147.91498673284394, 137.09906085519296, 120.41534694166472, 116.58859109385305, 135.51752798889294, 135.52110112230233, 138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6428984986482307, "mean_inference_ms": 1.864130897092432, "mean_action_processing_ms": 0.3514523103256911, "mean_env_wait_ms": 2.0754140188321033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006058692932128906, "StateBufferConnector_ms": 0.008014440536499023, "ViewRequirementAgentConnector_ms": 0.19267940521240234}, "num_episodes": 18, "episode_return_max": 181.41573183654666, "episode_return_min": 109.8165494362344, "episode_return_mean": 139.17758691821874, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 499.74410998503316, "num_env_steps_trained_throughput_per_sec": 499.74410998503316, "timesteps_total": 83968, "num_env_steps_sampled_lifetime": 83968, "num_agent_steps_sampled_lifetime": 83968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 2143.57, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2143.459, "sample_time_ms": 885.001, "learn_time_ms": 1240.867, "learn_throughput": 825.23, "synch_weights_time_ms": 17.269}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "training_iteration": 82, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-17", "timestamp": 1744110257, "time_this_iter_s": 2.053764581680298, "time_total_s": 175.62569522857666, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.62569522857666, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 32.8, "ram_util_percent": 87.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.276133541762829, "cur_kl_coeff": 4.135903062765138e-26, "cur_lr": 1e-07, "total_loss": 2.1605711676180364, "policy_loss": -0.00025064106448553504, "vf_loss": 9.795801037549973, "vf_explained_var": -2.017579972743988e-05, "kl": 1.3058812069033366e-06, "entropy": 2.881284388899803, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "env_runners": {"episode_reward_max": 181.95123320681446, "episode_reward_min": 109.8165494362344, "episode_reward_mean": 139.4972510106767, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.8165494362344}, "policy_reward_max": {"tplp_policy": 181.95123320681446}, "policy_reward_mean": {"tplp_policy": 139.4972510106767}, "custom_metrics": {"mean_episode_reward_mean": 139.4972510106767, "mean_episode_reward_min": 109.8165494362344, "mean_episode_reward_max": 181.95123320681446}, "hist_stats": {"episode_reward": [138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [138.8453105857269, 123.98963137157864, 135.06538525395723, 144.34710867207008, 136.90481622162244, 134.5669130932401, 128.08624164063016, 132.66161673752956, 137.03647627775572, 135.36197282027686, 153.51908162884908, 121.69485160067174, 136.55551347025084, 128.36933650723978, 143.03566398189756, 141.5329137886635, 131.112659794822, 166.40478934555023, 129.16358645400047, 131.13651561461288, 134.4848514346214, 138.51090662539266, 145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6426299105317707, "mean_inference_ms": 1.8642235773130307, "mean_action_processing_ms": 0.3513290313491085, "mean_env_wait_ms": 2.0754561447425157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006058692932128906, "StateBufferConnector_ms": 0.009027242660522461, "ViewRequirementAgentConnector_ms": 0.19269418716430664}, "num_episodes": 20, "episode_return_max": 181.95123320681446, "episode_return_min": 109.8165494362344, "episode_return_mean": 139.4972510106767, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 487.8569045169873, "num_env_steps_trained_throughput_per_sec": 487.8569045169873, "timesteps_total": 84992, "num_env_steps_sampled_lifetime": 84992, "num_agent_steps_sampled_lifetime": 84992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 2130.01, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2129.9, "sample_time_ms": 881.411, "learn_time_ms": 1231.174, "learn_throughput": 831.727, "synch_weights_time_ms": 17.111}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "done": false, "training_iteration": 83, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-19", "timestamp": 1744110259, "time_this_iter_s": 2.104492664337158, "time_total_s": 177.73018789291382, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22B60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.73018789291382, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 30.999999999999996, "ram_util_percent": 87.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2401663661003113, "cur_kl_coeff": 2.067951531382569e-26, "cur_lr": 1e-07, "total_loss": 2.165731331706047, "policy_loss": -0.0001655033091083169, "vf_loss": 9.816021925210952, "vf_explained_var": -1.749768853187561e-05, "kl": 1.2770608101675407e-06, "entropy": 2.8810865193605424, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "env_runners": {"episode_reward_max": 181.95123320681446, "episode_reward_min": 109.8165494362344, "episode_reward_mean": 140.38444058949923, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.8165494362344}, "policy_reward_max": {"tplp_policy": 181.95123320681446}, "policy_reward_mean": {"tplp_policy": 140.38444058949923}, "custom_metrics": {"mean_episode_reward_mean": 140.38444058949923, "mean_episode_reward_min": 109.8165494362344, "mean_episode_reward_max": 181.95123320681446}, "hist_stats": {"episode_reward": [145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.8337502704735, 144.03689007188018, 130.32341337970243, 181.41573183654666, 120.61973719489625, 134.50325795255904, 138.54400753612302, 140.25866147208106, 141.60857457646276, 135.8370799129538, 148.21555444048732, 160.69620877685114, 169.291647467792, 129.1646447363038, 118.78326098486792, 131.83660190721733, 139.8907257888819, 137.18842724639558, 137.96732250322572, 136.05446271121642, 158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.642445875686538, "mean_inference_ms": 1.8646657647567713, "mean_action_processing_ms": 0.3513494322747858, "mean_env_wait_ms": 2.0759636861026274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007055759429931641, "StateBufferConnector_ms": 0.01000356674194336, "ViewRequirementAgentConnector_ms": 0.1934032440185547}, "num_episodes": 22, "episode_return_max": 181.95123320681446, "episode_return_min": 109.8165494362344, "episode_return_mean": 140.38444058949923, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 474.1066577003345, "num_env_steps_trained_throughput_per_sec": 474.1066577003345, "timesteps_total": 86016, "num_env_steps_sampled_lifetime": 86016, "num_agent_steps_sampled_lifetime": 86016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 2137.676, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2137.566, "sample_time_ms": 875.521, "learn_time_ms": 1244.589, "learn_throughput": 822.762, "synch_weights_time_ms": 17.352}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "training_iteration": 84, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-21", "timestamp": 1744110261, "time_this_iter_s": 2.1648929119110107, "time_total_s": 179.89508080482483, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C227A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.89508080482483, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 42.76666666666667, "ram_util_percent": 87.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1617585867643356, "cur_kl_coeff": 1.0339757656912845e-26, "cur_lr": 1e-07, "total_loss": 2.1899563759565353, "policy_loss": -0.00020521542755886913, "vf_loss": 9.913340586423875, "vf_explained_var": -1.94009393453598e-05, "kl": 1.6143846197302914e-06, "entropy": 2.881735609471798, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "env_runners": {"episode_reward_max": 181.95123320681446, "episode_reward_min": 109.8165494362344, "episode_reward_mean": 139.72088130420357, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.8165494362344}, "policy_reward_max": {"tplp_policy": 181.95123320681446}, "policy_reward_mean": {"tplp_policy": 139.72088130420357}, "custom_metrics": {"mean_episode_reward_mean": 139.72088130420357, "mean_episode_reward_min": 109.8165494362344, "mean_episode_reward_max": 181.95123320681446}, "hist_stats": {"episode_reward": [158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [158.5826107596223, 169.69832341690778, 153.67281890902035, 115.39070996191818, 117.42226088918626, 160.7050816841039, 149.91568629430142, 140.73373513217808, 134.20151358588603, 147.90531824981193, 122.14905319910147, 168.4504146560954, 157.7668514695432, 155.17268872896622, 138.1592854972544, 112.71285047906545, 123.06768858227954, 109.8165494362344, 154.42375202494452, 129.93392756115085, 133.60275332243475, 130.67653630904968, 148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6424419735694841, "mean_inference_ms": 1.8657580772757023, "mean_action_processing_ms": 0.3513685316165215, "mean_env_wait_ms": 2.076894170154526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005038261413574219, "StateBufferConnector_ms": 0.006012439727783203, "ViewRequirementAgentConnector_ms": 0.20789361000061035}, "num_episodes": 20, "episode_return_max": 181.95123320681446, "episode_return_min": 109.8165494362344, "episode_return_mean": 139.72088130420357, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 451.5904301213426, "num_env_steps_trained_throughput_per_sec": 451.5904301213426, "timesteps_total": 87040, "num_env_steps_sampled_lifetime": 87040, "num_agent_steps_sampled_lifetime": 87040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 2169.177, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2169.066, "sample_time_ms": 893.323, "learn_time_ms": 1257.724, "learn_throughput": 814.169, "synch_weights_time_ms": 17.916}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "done": false, "training_iteration": 85, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-23", "timestamp": 1744110263, "time_this_iter_s": 2.2730369567871094, "time_total_s": 182.16811776161194, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.16811776161194, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 42.6, "ram_util_percent": 87.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.490562254562974, "cur_kl_coeff": 5.1698788284564225e-27, "cur_lr": 1e-07, "total_loss": 2.1832912869751455, "policy_loss": -0.00026705536292865873, "vf_loss": 9.887127298116685, "vf_explained_var": -1.3697892427444458e-05, "kl": 2.122878544064122e-06, "entropy": 2.882234826683998, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "env_runners": {"episode_reward_max": 181.95123320681446, "episode_reward_min": 112.48212720968755, "episode_reward_mean": 139.67336234076177, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.48212720968755}, "policy_reward_max": {"tplp_policy": 181.95123320681446}, "policy_reward_mean": {"tplp_policy": 139.67336234076177}, "custom_metrics": {"mean_episode_reward_mean": 139.67336234076177, "mean_episode_reward_min": 112.48212720968755, "mean_episode_reward_max": 181.95123320681446}, "hist_stats": {"episode_reward": [148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.55820585556404, 146.65330564783955, 132.87984605794662, 145.26396839097393, 136.63657576676113, 144.73398335129258, 134.5500666582798, 161.62588863744006, 146.93513160187572, 129.16316187566156, 136.48930627637498, 153.5722019143145, 137.70904634037188, 126.01970400221118, 121.03973207209724, 135.04480611610637, 120.45580017541556, 136.91974012718822, 139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6423386262693606, "mean_inference_ms": 1.8662444786751806, "mean_action_processing_ms": 0.3512935393547649, "mean_env_wait_ms": 2.0775241218225746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004505634307861328, "StateBufferConnector_ms": 0.006171464920043945, "ViewRequirementAgentConnector_ms": 0.1962418556213379}, "num_episodes": 22, "episode_return_max": 181.95123320681446, "episode_return_min": 112.48212720968755, "episode_return_mean": 139.67336234076177, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 490.3967478055863, "num_env_steps_trained_throughput_per_sec": 490.3967478055863, "timesteps_total": 88064, "num_env_steps_sampled_lifetime": 88064, "num_agent_steps_sampled_lifetime": 88064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 2155.574, "restore_workers_time_ms": 0.111, "training_step_time_ms": 2155.463, "sample_time_ms": 894.688, "learn_time_ms": 1243.879, "learn_throughput": 823.231, "synch_weights_time_ms": 16.793}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "done": false, "training_iteration": 86, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-25", "timestamp": 1744110265, "time_this_iter_s": 2.093252658843994, "time_total_s": 184.26137042045593, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.26137042045593, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 39.03333333333333, "ram_util_percent": 87.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.892418190091848, "cur_kl_coeff": 2.5849394142282113e-27, "cur_lr": 1e-07, "total_loss": 2.1901282481849194, "policy_loss": -4.912725125905126e-05, "vf_loss": 9.913837385177612, "vf_explained_var": -2.350844442844391e-05, "kl": 7.071825073978744e-07, "entropy": 2.882819710671902, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "env_runners": {"episode_reward_max": 181.95123320681446, "episode_reward_min": 112.48212720968755, "episode_reward_mean": 140.98571372743044, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.48212720968755}, "policy_reward_max": {"tplp_policy": 181.95123320681446}, "policy_reward_mean": {"tplp_policy": 140.98571372743044}, "custom_metrics": {"mean_episode_reward_mean": 140.98571372743044, "mean_episode_reward_min": 112.48212720968755, "mean_episode_reward_max": 181.95123320681446}, "hist_stats": {"episode_reward": [139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.48728576187546, 148.1791695570267, 118.34967410728763, 151.5865893302158, 120.9709218633001, 181.95123320681446, 132.69364054888425, 141.81939054926374, 133.72712927248676, 149.39698651911507, 115.47907441729647, 138.91957488579334, 141.62548535056757, 146.086416622954, 157.68798890277907, 141.58918060093953, 131.0010809686667, 156.30729389775698, 144.59269463663856, 120.92852069876724, 139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6422236583282875, "mean_inference_ms": 1.8664232473248559, "mean_action_processing_ms": 0.35113824162099383, "mean_env_wait_ms": 2.0776713936399798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005102396011352539, "StateBufferConnector_ms": 0.007169246673583984, "ViewRequirementAgentConnector_ms": 0.19557905197143555}, "num_episodes": 18, "episode_return_max": 181.95123320681446, "episode_return_min": 112.48212720968755, "episode_return_mean": 140.98571372743044, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 502.8756976648476, "num_env_steps_trained_throughput_per_sec": 502.8756976648476, "timesteps_total": 89088, "num_env_steps_sampled_lifetime": 89088, "num_agent_steps_sampled_lifetime": 89088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 2138.747, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2138.747, "sample_time_ms": 883.656, "learn_time_ms": 1238.428, "learn_throughput": 826.855, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "done": false, "training_iteration": 87, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-27", "timestamp": 1744110267, "time_this_iter_s": 2.04221773147583, "time_total_s": 186.30358815193176, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCF40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 186.30358815193176, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 29.13333333333333, "ram_util_percent": 87.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4109258376061917, "cur_kl_coeff": 1.2924697071141056e-27, "cur_lr": 1e-07, "total_loss": 2.1827059842646124, "policy_loss": -0.00017872543539851904, "vf_loss": 9.885171407461167, "vf_explained_var": -1.8731504678726196e-05, "kl": 1.8420198811375244e-06, "entropy": 2.8840812340378763, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "env_runners": {"episode_reward_max": 167.79613581424584, "episode_reward_min": 112.48212720968755, "episode_reward_mean": 140.9896015455568, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.48212720968755}, "policy_reward_max": {"tplp_policy": 167.79613581424584}, "policy_reward_mean": {"tplp_policy": 140.9896015455568}, "custom_metrics": {"mean_episode_reward_mean": 140.9896015455568, "mean_episode_reward_min": 112.48212720968755, "mean_episode_reward_max": 167.79613581424584}, "hist_stats": {"episode_reward": [139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.4355836720776, 125.3915124245392, 143.98745056183677, 131.0657656242434, 160.67807738829126, 139.53932513149215, 138.51836420684643, 129.0334473809155, 142.45183706151735, 140.81924277834295, 140.95245844337475, 141.35512666176714, 139.5513920039767, 158.87205679370228, 149.46821225054123, 148.23075045888854, 145.873356607326, 112.48212720968755, 158.3586339388386, 139.5191648696013, 126.65629265305945, 135.2785391491066, 146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6421778657751167, "mean_inference_ms": 1.8667469857828065, "mean_action_processing_ms": 0.3511162736994828, "mean_env_wait_ms": 2.078176336077626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005102396011352539, "StateBufferConnector_ms": 0.009189844131469727, "ViewRequirementAgentConnector_ms": 0.1900007724761963}, "num_episodes": 20, "episode_return_max": 167.79613581424584, "episode_return_min": 112.48212720968755, "episode_return_mean": 140.9896015455568, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 461.5685428594642, "num_env_steps_trained_throughput_per_sec": 461.5685428594642, "timesteps_total": 90112, "num_env_steps_sampled_lifetime": 90112, "num_agent_steps_sampled_lifetime": 90112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 2151.855, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2151.855, "sample_time_ms": 889.342, "learn_time_ms": 1245.691, "learn_throughput": 822.034, "synch_weights_time_ms": 16.718}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "training_iteration": 88, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-30", "timestamp": 1744110270, "time_this_iter_s": 2.2244794368743896, "time_total_s": 188.52806758880615, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.52806758880615, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 46.43333333333334, "ram_util_percent": 87.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0344469625502826, "cur_kl_coeff": 6.462348535570528e-28, "cur_lr": 1e-07, "total_loss": 2.178190691024065, "policy_loss": -0.00019287016475573183, "vf_loss": 9.867396569252014, "vf_explained_var": -1.952126622200012e-05, "kl": 1.1607032475602352e-06, "entropy": 2.884655822813511, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "env_runners": {"episode_reward_max": 170.3618645625314, "episode_reward_min": 111.23133966552587, "episode_reward_mean": 141.49636443234166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.23133966552587}, "policy_reward_max": {"tplp_policy": 170.3618645625314}, "policy_reward_mean": {"tplp_policy": 141.49636443234166}, "custom_metrics": {"mean_episode_reward_mean": 141.49636443234166, "mean_episode_reward_min": 111.23133966552587, "mean_episode_reward_max": 170.3618645625314}, "hist_stats": {"episode_reward": [146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [146.9782688806731, 157.2119114562628, 153.82189041434054, 131.32387154719888, 129.78301870039473, 127.19770269189961, 119.97094556020959, 130.5707571009081, 139.53886060744426, 130.62919568112636, 150.66707765647402, 136.040603581444, 147.6919675067761, 154.55388109408148, 121.1746603970341, 129.92643832285847, 140.88931513583458, 145.80883410022454, 134.44536861930163, 142.71128929353736, 156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.642218386730205, "mean_inference_ms": 1.8672023646692955, "mean_action_processing_ms": 0.3512218245602439, "mean_env_wait_ms": 2.0788260778167675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005111217498779297, "StateBufferConnector_ms": 0.008184671401977539, "ViewRequirementAgentConnector_ms": 0.1934194564819336}, "num_episodes": 22, "episode_return_max": 170.3618645625314, "episode_return_min": 111.23133966552587, "episode_return_mean": 141.49636443234166, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 494.6812202721101, "num_env_steps_trained_throughput_per_sec": 494.6812202721101, "timesteps_total": 91136, "num_env_steps_sampled_lifetime": 91136, "num_agent_steps_sampled_lifetime": 91136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 2162.936, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2162.936, "sample_time_ms": 897.212, "learn_time_ms": 1248.922, "learn_throughput": 819.907, "synch_weights_time_ms": 16.699}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "done": false, "training_iteration": 89, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-32", "timestamp": 1744110272, "time_this_iter_s": 2.076153039932251, "time_total_s": 190.6042206287384, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.6042206287384, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 41.800000000000004, "ram_util_percent": 87.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.149848148226738, "cur_kl_coeff": 3.231174267785264e-28, "cur_lr": 1e-07, "total_loss": 2.180298516154289, "policy_loss": -0.00018923136522062123, "vf_loss": 9.875661253929138, "vf_explained_var": -2.135448157787323e-05, "kl": 1.7492232257998452e-06, "entropy": 2.8842754885554314, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "env_runners": {"episode_reward_max": 171.54922965486287, "episode_reward_min": 111.23133966552587, "episode_reward_mean": 141.5969950287133, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.23133966552587}, "policy_reward_max": {"tplp_policy": 171.54922965486287}, "policy_reward_mean": {"tplp_policy": 141.5969950287133}, "custom_metrics": {"mean_episode_reward_mean": 141.5969950287133, "mean_episode_reward_min": 111.23133966552587, "mean_episode_reward_max": 171.54922965486287}, "hist_stats": {"episode_reward": [156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [156.11320001264886, 133.10925285720234, 150.8468666821258, 139.88212771618515, 136.90620115071894, 145.07225054948012, 144.1828401693867, 146.20971028943103, 117.87117739111356, 117.35865114324436, 147.4526128812398, 138.88116385469044, 142.44139179781936, 116.0707612694981, 160.15924336660524, 146.76500766541886, 152.4245435897984, 134.20827512505863, 119.24550983276917, 157.05106854759853, 159.6079507476107, 147.83286727888017, 160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6421623479705356, "mean_inference_ms": 1.8673924191655067, "mean_action_processing_ms": 0.351248828259947, "mean_env_wait_ms": 2.0791608947024756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010175228118896484, "StateBufferConnector_ms": 0.011178016662597656, "ViewRequirementAgentConnector_ms": 0.1903979778289795}, "num_episodes": 20, "episode_return_max": 171.54922965486287, "episode_return_min": 111.23133966552587, "episode_return_mean": 141.5969950287133, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 481.12176898227466, "num_env_steps_trained_throughput_per_sec": 481.12176898227466, "timesteps_total": 92160, "num_env_steps_sampled_lifetime": 92160, "num_agent_steps_sampled_lifetime": 92160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 2157.026, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2157.026, "sample_time_ms": 901.479, "learn_time_ms": 1239.14, "learn_throughput": 826.38, "synch_weights_time_ms": 16.303}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "done": false, "training_iteration": 90, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-34", "timestamp": 1744110274, "time_this_iter_s": 2.132883310317993, "time_total_s": 192.7371039390564, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.7371039390564, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 36.03333333333334, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1246610697358848, "cur_kl_coeff": 1.615587133892632e-28, "cur_lr": 1e-07, "total_loss": 2.167222525924444, "policy_loss": -8.686815272085369e-05, "vf_loss": 9.823246467113496, "vf_explained_var": -1.950003206729889e-05, "kl": 1.0956823581542706e-06, "entropy": 2.885022130608559, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "env_runners": {"episode_reward_max": 171.54922965486287, "episode_reward_min": 111.23133966552587, "episode_reward_mean": 140.92736778953315, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.23133966552587}, "policy_reward_max": {"tplp_policy": 171.54922965486287}, "policy_reward_mean": {"tplp_policy": 140.92736778953315}, "custom_metrics": {"mean_episode_reward_mean": 140.92736778953315, "mean_episode_reward_min": 111.23133966552587, "mean_episode_reward_max": 171.54922965486287}, "hist_stats": {"episode_reward": [160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [160.92687822993128, 150.13387752753684, 147.29527833736336, 167.79613581424584, 145.124627209975, 134.69636112599855, 140.5673913436268, 143.22209691578854, 137.00008538807572, 159.4802783549079, 139.5299370203925, 147.7904128350665, 124.66767863309147, 134.77603248923796, 141.86195899250754, 143.17576129034774, 139.6595934910794, 137.83326614951835, 125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6420543341613236, "mean_inference_ms": 1.867042671416023, "mean_action_processing_ms": 0.3512618180669867, "mean_env_wait_ms": 2.078793971960726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010527849197387695, "StateBufferConnector_ms": 0.010014533996582031, "ViewRequirementAgentConnector_ms": 0.19780397415161133}, "num_episodes": 22, "episode_return_max": 171.54922965486287, "episode_return_min": 111.23133966552587, "episode_return_mean": 140.92736778953315, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 475.7930068641003, "num_env_steps_trained_throughput_per_sec": 475.7930068641003, "timesteps_total": 93184, "num_env_steps_sampled_lifetime": 93184, "num_agent_steps_sampled_lifetime": 93184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 2126.891, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2126.891, "sample_time_ms": 883.005, "learn_time_ms": 1227.358, "learn_throughput": 834.312, "synch_weights_time_ms": 16.425}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "done": false, "training_iteration": 91, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-36", "timestamp": 1744110276, "time_this_iter_s": 2.1579110622406006, "time_total_s": 194.895015001297, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.895015001297, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 31.53333333333333, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2019837468862535, "cur_kl_coeff": 8.07793566946316e-29, "cur_lr": 1e-07, "total_loss": 2.175894259661436, "policy_loss": -0.00010518348426558077, "vf_loss": 9.85827323794365, "vf_explained_var": -2.06921249628067e-05, "kl": 9.77879399477466e-07, "entropy": 2.8856885388493536, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "env_runners": {"episode_reward_max": 171.54922965486287, "episode_reward_min": 111.23133966552587, "episode_reward_mean": 141.24027234244576, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.23133966552587}, "policy_reward_max": {"tplp_policy": 171.54922965486287}, "policy_reward_mean": {"tplp_policy": 141.24027234244576}, "custom_metrics": {"mean_episode_reward_mean": 141.24027234244576, "mean_episode_reward_min": 111.23133966552587, "mean_episode_reward_max": 171.54922965486287}, "hist_stats": {"episode_reward": [125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [125.13332202054762, 155.6558138560462, 136.81315006219225, 130.9718006466815, 148.53795436313715, 127.07049078651615, 138.49975064302342, 121.43279640121509, 138.40607396699806, 140.21265852498453, 150.74929883747737, 138.8660486623982, 140.7537536739285, 161.26390823283845, 128.33234495102914, 150.83657740603408, 147.14474967849958, 154.59476115691672, 143.14596674501396, 131.7315780297666, 132.78253451996798, 167.35464375166345, 138.61271365448394, 151.43139274955925, 157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.642181572788229, "mean_inference_ms": 1.8675443415943949, "mean_action_processing_ms": 0.3513446510151539, "mean_env_wait_ms": 2.0794516830716585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010421276092529297, "StateBufferConnector_ms": 0.00901651382446289, "ViewRequirementAgentConnector_ms": 0.20553088188171387}, "num_episodes": 18, "episode_return_max": 171.54922965486287, "episode_return_min": 111.23133966552587, "episode_return_mean": 141.24027234244576, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 442.8061998288765, "num_env_steps_trained_throughput_per_sec": 442.8061998288765, "timesteps_total": 94208, "num_env_steps_sampled_lifetime": 94208, "num_agent_steps_sampled_lifetime": 94208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 2153.238, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2153.238, "sample_time_ms": 897.587, "learn_time_ms": 1239.156, "learn_throughput": 826.369, "synch_weights_time_ms": 16.496}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "done": false, "training_iteration": 92, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-39", "timestamp": 1744110279, "time_this_iter_s": 2.318648338317871, "time_total_s": 197.21366333961487, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF4C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.21366333961487, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 40.925000000000004, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4308563984930514, "cur_kl_coeff": 4.03896783473158e-29, "cur_lr": 1e-07, "total_loss": 2.1973211392760277, "policy_loss": -9.058035211637617e-05, "vf_loss": 9.94422892332077, "vf_explained_var": -2.3731216788291932e-05, "kl": 7.721993378062564e-07, "entropy": 2.8864550933241846, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "env_runners": {"episode_reward_max": 171.92257598238484, "episode_reward_min": 111.23133966552587, "episode_reward_mean": 142.0838906606805, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.23133966552587}, "policy_reward_max": {"tplp_policy": 171.92257598238484}, "policy_reward_mean": {"tplp_policy": 142.0838906606805}, "custom_metrics": {"mean_episode_reward_mean": 142.0838906606805, "mean_episode_reward_min": 111.23133966552587, "mean_episode_reward_max": 171.92257598238484}, "hist_stats": {"episode_reward": [157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.10839286489465, 155.42025923411597, 131.32503712257653, 170.3618645625314, 121.8355890138132, 125.57348219027533, 111.23133966552587, 165.22474313609456, 130.22815120912682, 151.12329457376768, 150.21278087888706, 138.36787501382173, 164.1278930310301, 125.56328241540572, 115.524074333539, 159.9081172525984, 149.98061916065245, 126.10054510958453, 144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6423626709412221, "mean_inference_ms": 1.8672502947945557, "mean_action_processing_ms": 0.3511357381498986, "mean_env_wait_ms": 2.079371254752275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011426925659179688, "StateBufferConnector_ms": 0.00698089599609375, "ViewRequirementAgentConnector_ms": 0.209883451461792}, "num_episodes": 24, "episode_return_max": 171.92257598238484, "episode_return_min": 111.23133966552587, "episode_return_mean": 142.0838906606805, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 514.7944044118996, "num_env_steps_trained_throughput_per_sec": 514.7944044118996, "timesteps_total": 95232, "num_env_steps_sampled_lifetime": 95232, "num_agent_steps_sampled_lifetime": 95232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 2142.255, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2142.255, "sample_time_ms": 888.826, "learn_time_ms": 1237.119, "learn_throughput": 827.73, "synch_weights_time_ms": 16.21}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "done": false, "training_iteration": 93, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-41", "timestamp": 1744110281, "time_this_iter_s": 1.994131088256836, "time_total_s": 199.2077944278717, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.2077944278717, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 26.600000000000005, "ram_util_percent": 87.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1323994658887386, "cur_kl_coeff": 2.01948391736579e-29, "cur_lr": 1e-07, "total_loss": 2.1909933030605315, "policy_loss": -9.590471745468676e-05, "vf_loss": 9.919084739685058, "vf_explained_var": -2.775825560092926e-05, "kl": 6.517241665116024e-07, "entropy": 2.8868197605013846, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "env_runners": {"episode_reward_max": 177.66940005330991, "episode_reward_min": 111.09728640695617, "episode_reward_mean": 142.46667090180756, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.09728640695617}, "policy_reward_max": {"tplp_policy": 177.66940005330991}, "policy_reward_mean": {"tplp_policy": 142.46667090180756}, "custom_metrics": {"mean_episode_reward_mean": 142.46667090180756, "mean_episode_reward_min": 111.09728640695617, "mean_episode_reward_max": 177.66940005330991}, "hist_stats": {"episode_reward": [144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.78503213013863, 123.78242283532701, 120.15555175040787, 158.50029145516683, 124.63328622529016, 131.2820499653232, 149.64372282920388, 125.09611541774069, 124.86822593225274, 142.20855905921363, 164.9610962282604, 138.45267575060657, 151.95662513249837, 145.25800249205597, 125.60384248323783, 139.56527957095489, 122.61574480240971, 171.54922965486287, 119.02030186769647, 157.90399777301903, 131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6421494211299161, "mean_inference_ms": 1.8668133178299684, "mean_action_processing_ms": 0.35109000555545955, "mean_env_wait_ms": 2.0788020298610617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141810417175293, "StateBufferConnector_ms": 0.005983829498291016, "ViewRequirementAgentConnector_ms": 0.19930624961853027}, "num_episodes": 18, "episode_return_max": 177.66940005330991, "episode_return_min": 111.09728640695617, "episode_return_mean": 142.46667090180756, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 508.89371658989563, "num_env_steps_trained_throughput_per_sec": 508.89371658989563, "timesteps_total": 96256, "num_env_steps_sampled_lifetime": 96256, "num_agent_steps_sampled_lifetime": 96256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 2127.491, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2127.491, "sample_time_ms": 882.426, "learn_time_ms": 1228.966, "learn_throughput": 833.221, "synch_weights_time_ms": 15.998}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "done": false, "training_iteration": 94, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-43", "timestamp": 1744110283, "time_this_iter_s": 2.018054723739624, "time_total_s": 201.22584915161133, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.22584915161133, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 28.166666666666668, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.179727637022734, "cur_kl_coeff": 1.009741958682895e-29, "cur_lr": 1e-07, "total_loss": 2.168438706547022, "policy_loss": -0.00016235181828960776, "vf_loss": 9.82924519777298, "vf_explained_var": -2.3776665329933167e-05, "kl": 1.1035040967111165e-06, "entropy": 2.887102510035038, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "env_runners": {"episode_reward_max": 177.66940005330991, "episode_reward_min": 111.09728640695617, "episode_reward_mean": 143.9277698437845, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.09728640695617}, "policy_reward_max": {"tplp_policy": 177.66940005330991}, "policy_reward_mean": {"tplp_policy": 143.9277698437845}, "custom_metrics": {"mean_episode_reward_mean": 143.9277698437845, "mean_episode_reward_min": 111.09728640695617, "mean_episode_reward_max": 177.66940005330991}, "hist_stats": {"episode_reward": [131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [131.1019544002714, 135.62357614441157, 157.7760598874822, 115.29958738865781, 147.17068433171502, 135.682009470746, 157.8942473179959, 152.2164395817458, 134.23918222129166, 124.67302550057266, 119.28775206492956, 137.06346010739884, 144.70178711578427, 139.00423836329654, 137.63330018207213, 128.9859077778706, 128.2513863003259, 150.88021748840114, 141.29746638466443, 147.02336833016292, 147.67918668920652, 152.07691606972847, 148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6421629833740122, "mean_inference_ms": 1.8665182861782768, "mean_action_processing_ms": 0.35109873721410223, "mean_env_wait_ms": 2.0786645584517065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006352901458740234, "StateBufferConnector_ms": 0.0019943714141845703, "ViewRequirementAgentConnector_ms": 0.20888948440551758}, "num_episodes": 20, "episode_return_max": 177.66940005330991, "episode_return_min": 111.09728640695617, "episode_return_mean": 143.9277698437845, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 446.25994907506595, "num_env_steps_trained_throughput_per_sec": 446.25994907506595, "timesteps_total": 97280, "num_env_steps_sampled_lifetime": 97280, "num_agent_steps_sampled_lifetime": 97280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 2130.199, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2130.199, "sample_time_ms": 877.094, "learn_time_ms": 1237.117, "learn_throughput": 827.731, "synch_weights_time_ms": 15.889}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "done": false, "training_iteration": 95, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-45", "timestamp": 1744110285, "time_this_iter_s": 2.3013510704040527, "time_total_s": 203.52720022201538, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 203.52720022201538, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 47.13333333333333, "ram_util_percent": 87.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4479033328592776, "cur_kl_coeff": 5.048709793414475e-30, "cur_lr": 1e-07, "total_loss": 2.1717241033911705, "policy_loss": -0.0003524219966493547, "vf_loss": 9.84322167634964, "vf_explained_var": -1.995116472244263e-05, "kl": 2.4558940283858633e-06, "entropy": 2.887289157509804, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "env_runners": {"episode_reward_max": 177.66940005330991, "episode_reward_min": 111.09728640695617, "episode_reward_mean": 144.61251978592807, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.09728640695617}, "policy_reward_max": {"tplp_policy": 177.66940005330991}, "policy_reward_mean": {"tplp_policy": 144.61251978592807}, "custom_metrics": {"mean_episode_reward_mean": 144.61251978592807, "mean_episode_reward_min": 111.09728640695617, "mean_episode_reward_max": 177.66940005330991}, "hist_stats": {"episode_reward": [148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.14398308881024, 162.97771635468234, 118.7575519985192, 148.88726888041546, 140.91894931294885, 150.8584771974279, 145.5931521146405, 149.19964840324198, 139.85900123082058, 140.4371652540195, 157.62212174618807, 154.56188957957536, 127.6638193500077, 150.4625980231491, 137.1402051743288, 153.98845597224468, 147.1918001843459, 166.0421670106086, 150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.64232279267328, "mean_inference_ms": 1.8666426017566553, "mean_action_processing_ms": 0.35114529514766973, "mean_env_wait_ms": 2.0788108639370066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01009821891784668, "StateBufferConnector_ms": 0.003987789154052734, "ViewRequirementAgentConnector_ms": 0.20285749435424805}, "num_episodes": 22, "episode_return_max": 177.66940005330991, "episode_return_min": 111.09728640695617, "episode_return_mean": 144.61251978592807, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 488.4299553700127, "num_env_steps_trained_throughput_per_sec": 488.4299553700127, "timesteps_total": 98304, "num_env_steps_sampled_lifetime": 98304, "num_agent_steps_sampled_lifetime": 98304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 2131.04, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2131.04, "sample_time_ms": 874.538, "learn_time_ms": 1240.536, "learn_throughput": 825.449, "synch_weights_time_ms": 15.867}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "training_iteration": 96, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-47", "timestamp": 1744110287, "time_this_iter_s": 2.102022886276245, "time_total_s": 205.62922310829163, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.62922310829163, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 40.06666666666667, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2122658248990774, "cur_kl_coeff": 2.5243548967072376e-30, "cur_lr": 1e-07, "total_loss": 2.1880012802779674, "policy_loss": -0.0001542195794172585, "vf_loss": 9.90751251578331, "vf_explained_var": -1.7912313342094422e-05, "kl": 1.1225128511149762e-06, "entropy": 2.8872262835502625, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "env_runners": {"episode_reward_max": 177.66940005330991, "episode_reward_min": 111.09728640695617, "episode_reward_mean": 143.54140886255948, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.09728640695617}, "policy_reward_max": {"tplp_policy": 177.66940005330991}, "policy_reward_mean": {"tplp_policy": 143.54140886255948}, "custom_metrics": {"mean_episode_reward_mean": 143.54140886255948, "mean_episode_reward_min": 111.09728640695617, "mean_episode_reward_max": 177.66940005330991}, "hist_stats": {"episode_reward": [150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [150.41448590291185, 171.92257598238484, 149.53151594541063, 136.9130889312972, 136.26474437555026, 148.82745151804653, 134.45236599639009, 125.36411073080984, 146.24857948977984, 149.5509928075542, 157.41353568504192, 156.40858703184256, 159.60589443581375, 158.33455462078507, 130.52649510402478, 154.4581213326945, 149.42553535784495, 127.66454963814998, 118.33352389545551, 130.88418486382164, 144.76747055858755, 134.14958374523817, 127.74444706687761, 153.58892010049257, 130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6422318479061421, "mean_inference_ms": 1.866231898632111, "mean_action_processing_ms": 0.35108913001874514, "mean_env_wait_ms": 2.0784037174444405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009100675582885742, "StateBufferConnector_ms": 0.0039882659912109375, "ViewRequirementAgentConnector_ms": 0.20290422439575195}, "num_episodes": 18, "episode_return_max": 177.66940005330991, "episode_return_min": 111.09728640695617, "episode_return_mean": 143.54140886255948, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 505.4027073552481, "num_env_steps_trained_throughput_per_sec": 505.4027073552481, "timesteps_total": 99328, "num_env_steps_sampled_lifetime": 99328, "num_agent_steps_sampled_lifetime": 99328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 2130.022, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2130.022, "sample_time_ms": 879.625, "learn_time_ms": 1234.627, "learn_throughput": 829.4, "synch_weights_time_ms": 15.57}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "done": false, "training_iteration": 97, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-49", "timestamp": 1744110289, "time_this_iter_s": 2.031306743621826, "time_total_s": 207.66052985191345, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.66052985191345, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 32.800000000000004, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.490233252197504, "cur_kl_coeff": 1.2621774483536188e-30, "cur_lr": 1e-07, "total_loss": 2.1779916547238827, "policy_loss": -0.00020130335469730197, "vf_loss": 9.86787943840027, "vf_explained_var": -2.119205892086029e-05, "kl": 1.7990796231548422e-06, "entropy": 2.8877689465880394, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "env_runners": {"episode_reward_max": 177.66940005330991, "episode_reward_min": 111.09728640695617, "episode_reward_mean": 142.83124050420562, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.09728640695617}, "policy_reward_max": {"tplp_policy": 177.66940005330991}, "policy_reward_mean": {"tplp_policy": 142.83124050420562}, "custom_metrics": {"mean_episode_reward_mean": 142.83124050420562, "mean_episode_reward_min": 111.09728640695617, "mean_episode_reward_max": 177.66940005330991}, "hist_stats": {"episode_reward": [130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [130.06808001565483, 127.20537456801576, 148.5926576573376, 177.66940005330991, 158.09134256149474, 144.95699391086856, 145.86816796438137, 151.31445459891466, 153.39938995929512, 140.94335999214047, 119.19762034826677, 166.50826712804894, 111.09728640695617, 164.31644133224646, 135.976927022834, 130.9562341938133, 142.5869559111809, 152.59825680831094, 163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6420610192881672, "mean_inference_ms": 1.8656167815552687, "mean_action_processing_ms": 0.3510731264981179, "mean_env_wait_ms": 2.0777640058970763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009112834930419922, "StateBufferConnector_ms": 0.008100032806396484, "ViewRequirementAgentConnector_ms": 0.19212818145751953}, "num_episodes": 24, "episode_return_max": 177.66940005330991, "episode_return_min": 111.09728640695617, "episode_return_mean": 142.83124050420562, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 514.8461786135465, "num_env_steps_trained_throughput_per_sec": 514.8461786135465, "timesteps_total": 100352, "num_env_steps_sampled_lifetime": 100352, "num_agent_steps_sampled_lifetime": 100352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 2107.064, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2107.064, "sample_time_ms": 867.432, "learn_time_ms": 1223.855, "learn_throughput": 836.7, "synch_weights_time_ms": 15.577}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "done": false, "training_iteration": 98, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-51", "timestamp": 1744110291, "time_this_iter_s": 1.9941418170928955, "time_total_s": 209.65467166900635, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22340>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.65467166900635, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 28.03333333333333, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.237250892072916, "cur_kl_coeff": 6.310887241768094e-31, "cur_lr": 1e-07, "total_loss": 2.1845217160880566, "policy_loss": -0.00011675486603053286, "vf_loss": 9.894041341543197, "vf_explained_var": -2.3269280791282654e-05, "kl": 9.68817039415093e-07, "entropy": 2.8887186482548715, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "env_runners": {"episode_reward_max": 171.11495108090224, "episode_reward_min": 101.19448562502302, "episode_reward_mean": 142.26000058767792, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.19448562502302}, "policy_reward_max": {"tplp_policy": 171.11495108090224}, "policy_reward_mean": {"tplp_policy": 142.26000058767792}, "custom_metrics": {"mean_episode_reward_mean": 142.26000058767792, "mean_episode_reward_min": 101.19448562502302, "mean_episode_reward_max": 171.11495108090224}, "hist_stats": {"episode_reward": [163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [163.78239134247815, 163.7263895027654, 154.18725991979446, 138.38794786011573, 153.06714421821985, 148.48291353381626, 158.5888250380929, 137.99527006738623, 150.60666092044764, 133.24265461383436, 130.2963810953986, 130.16277743365598, 148.76130385061654, 125.97135544870592, 151.138827692466, 138.52379281298508, 134.72988840218392, 171.11495108090224, 157.92140944151905, 155.96200373550218, 128.1180479414469, 126.32065961222749, 143.5595258465567, 143.83999100367325, 121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6420376272657218, "mean_inference_ms": 1.8655253458177088, "mean_action_processing_ms": 0.3511087011239718, "mean_env_wait_ms": 2.0777299652795445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009120464324951172, "StateBufferConnector_ms": 0.009098052978515625, "ViewRequirementAgentConnector_ms": 0.20770668983459473}, "num_episodes": 18, "episode_return_max": 171.11495108090224, "episode_return_min": 101.19448562502302, "episode_return_mean": 142.26000058767792, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.08830650330265, "num_env_steps_trained_throughput_per_sec": 445.08830650330265, "timesteps_total": 101376, "num_env_steps_sampled_lifetime": 101376, "num_agent_steps_sampled_lifetime": 101376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 101376, "timers": {"training_iteration_time_ms": 2130.129, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2130.129, "sample_time_ms": 867.051, "learn_time_ms": 1246.743, "learn_throughput": 821.34, "synch_weights_time_ms": 16.135}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "done": false, "training_iteration": 99, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-54", "timestamp": 1744110294, "time_this_iter_s": 2.307098627090454, "time_total_s": 211.9617702960968, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 211.9617702960968, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 42.93333333333334, "ram_util_percent": 87.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3116570487618446, "cur_kl_coeff": 3.155443620884047e-31, "cur_lr": 1e-07, "total_loss": 2.1832812398672106, "policy_loss": -0.00013592630857601763, "vf_loss": 9.889483839273453, "vf_explained_var": -2.4773553013801576e-05, "kl": 1.1693669835333154e-06, "entropy": 2.889538027346134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "env_runners": {"episode_reward_max": 169.6015966084146, "episode_reward_min": 101.19448562502302, "episode_reward_mean": 142.83770341061577, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.19448562502302}, "policy_reward_max": {"tplp_policy": 169.6015966084146}, "policy_reward_mean": {"tplp_policy": 142.83770341061577}, "custom_metrics": {"mean_episode_reward_mean": 142.83770341061577, "mean_episode_reward_min": 101.19448562502302, "mean_episode_reward_max": 169.6015966084146}, "hist_stats": {"episode_reward": [121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [121.57073296518064, 145.63995435051265, 122.76019131593826, 144.12073028316638, 135.1387638181733, 162.0502211020951, 155.0022575124719, 152.28254747546063, 153.2636883878819, 142.37133417423215, 136.55875163588922, 133.0769591260209, 147.20662292154688, 148.43637919215163, 131.90545515000392, 146.93052034143977, 121.72114904735906, 156.91783890743375, 156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.642311904115736, "mean_inference_ms": 1.8657325951144947, "mean_action_processing_ms": 0.35107884752080765, "mean_env_wait_ms": 2.078427344745233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006124734878540039, "StateBufferConnector_ms": 0.010097503662109375, "ViewRequirementAgentConnector_ms": 0.20037245750427246}, "num_episodes": 24, "episode_return_max": 169.6015966084146, "episode_return_min": 101.19448562502302, "episode_return_mean": 142.83770341061577, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 468.1666895392453, "num_env_steps_trained_throughput_per_sec": 468.1666895392453, "timesteps_total": 102400, "num_env_steps_sampled_lifetime": 102400, "num_agent_steps_sampled_lifetime": 102400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 2136.019, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2136.019, "sample_time_ms": 884.626, "learn_time_ms": 1235.264, "learn_throughput": 828.973, "synch_weights_time_ms": 15.929}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "training_iteration": 100, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-56", "timestamp": 1744110296, "time_this_iter_s": 2.1928625106811523, "time_total_s": 214.15463280677795, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.15463280677795, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 47.53333333333333, "ram_util_percent": 87.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6104219228029253, "cur_kl_coeff": 1.5777218104420235e-31, "cur_lr": 1e-07, "total_loss": 2.1838798373937607, "policy_loss": -0.0001670925528742373, "vf_loss": 9.892619800567626, "vf_explained_var": -2.7255713939666747e-05, "kl": 1.9511344561351508e-06, "entropy": 2.8910800933837892, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "env_runners": {"episode_reward_max": 169.6015966084146, "episode_reward_min": 101.19448562502302, "episode_reward_mean": 142.94942950217833, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.19448562502302}, "policy_reward_max": {"tplp_policy": 169.6015966084146}, "policy_reward_mean": {"tplp_policy": 142.94942950217833}, "custom_metrics": {"mean_episode_reward_mean": 142.94942950217833, "mean_episode_reward_min": 101.19448562502302, "mean_episode_reward_max": 169.6015966084146}, "hist_stats": {"episode_reward": [156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [156.8414691486768, 160.5458315965144, 131.2759000892993, 128.7202607509663, 128.30639471456124, 148.13268513176143, 162.23915470846035, 136.5349243748017, 151.22378953063577, 126.85121473439972, 145.66735538333018, 143.47923678299153, 131.66131086255317, 138.23570562762936, 136.80231726043667, 128.03833988730298, 166.24998812926063, 146.59085240358033, 115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6420685507971388, "mean_inference_ms": 1.8656856751597923, "mean_action_processing_ms": 0.351191069925179, "mean_env_wait_ms": 2.0786365898737267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002177000045776367, "StateBufferConnector_ms": 0.009099721908569336, "ViewRequirementAgentConnector_ms": 0.1900627613067627}, "num_episodes": 18, "episode_return_max": 169.6015966084146, "episode_return_min": 101.19448562502302, "episode_return_mean": 142.94942950217833, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 505.4777726373089, "num_env_steps_trained_throughput_per_sec": 505.4777726373089, "timesteps_total": 103424, "num_env_steps_sampled_lifetime": 103424, "num_agent_steps_sampled_lifetime": 103424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 103424, "timers": {"training_iteration_time_ms": 2123.379, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2123.379, "sample_time_ms": 883.711, "learn_time_ms": 1223.678, "learn_throughput": 836.822, "synch_weights_time_ms": 15.691}, "counters": {"num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "done": false, "training_iteration": 101, "trial_id": "b517c_00000", "date": "2025-04-08_19-04-58", "timestamp": 1744110298, "time_this_iter_s": 2.0300796031951904, "time_total_s": 216.18471240997314, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.18471240997314, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 28.5, "ram_util_percent": 87.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3821032524108885, "cur_kl_coeff": 7.888609052210117e-32, "cur_lr": 1e-07, "total_loss": 2.1924891345202924, "policy_loss": -0.00013214834325481206, "vf_loss": 9.927548664808274, "vf_explained_var": -3.2909959554672244e-05, "kl": 1.2676960448487761e-06, "entropy": 2.89265908151865, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "env_runners": {"episode_reward_max": 189.06639124187126, "episode_reward_min": 101.19448562502302, "episode_reward_mean": 143.70320176471992, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.19448562502302}, "policy_reward_max": {"tplp_policy": 189.06639124187126}, "policy_reward_mean": {"tplp_policy": 143.70320176471992}, "custom_metrics": {"mean_episode_reward_mean": 143.70320176471992, "mean_episode_reward_min": 101.19448562502302, "mean_episode_reward_max": 189.06639124187126}, "hist_stats": {"episode_reward": [115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [115.8534434905446, 131.1240340759769, 121.00618974433428, 137.2796869638109, 137.18295350548314, 148.37068484393245, 124.79297018059484, 153.65797509780322, 138.55295172940671, 130.63553693681376, 138.78519446831743, 138.90995795659774, 125.27476825560835, 141.4899972993483, 136.9408977622481, 149.04069324131748, 143.8722848194085, 139.63319449501907, 152.2313977676046, 152.28515332919653, 166.5507427772793, 145.46693000793752, 164.33959574591586, 147.56698052466263, 142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6419140041631313, "mean_inference_ms": 1.8654972690840355, "mean_action_processing_ms": 0.35128175703207276, "mean_env_wait_ms": 2.0787681343734064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031862258911132812, "StateBufferConnector_ms": 0.010214567184448242, "ViewRequirementAgentConnector_ms": 0.1860957145690918}, "num_episodes": 18, "episode_return_max": 189.06639124187126, "episode_return_min": 101.19448562502302, "episode_return_mean": 143.70320176471992, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 499.83047483209293, "num_env_steps_trained_throughput_per_sec": 499.83047483209293, "timesteps_total": 104448, "num_env_steps_sampled_lifetime": 104448, "num_agent_steps_sampled_lifetime": 104448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 104448, "timers": {"training_iteration_time_ms": 2096.997, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2096.997, "sample_time_ms": 867.071, "learn_time_ms": 1213.732, "learn_throughput": 843.679, "synch_weights_time_ms": 15.894}, "counters": {"num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "done": false, "training_iteration": 102, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-00", "timestamp": 1744110300, "time_this_iter_s": 2.0560803413391113, "time_total_s": 218.24079275131226, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFC40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.24079275131226, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 32.699999999999996, "ram_util_percent": 87.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3957473654299974, "cur_kl_coeff": 3.9443045261050587e-32, "cur_lr": 1e-07, "total_loss": 2.168838971853256, "policy_loss": -0.00013898383476771415, "vf_loss": 9.83347254395485, "vf_explained_var": -1.4763325452804565e-05, "kl": 1.7386700931959486e-06, "entropy": 2.8939017072319984, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "env_runners": {"episode_reward_max": 189.06639124187126, "episode_reward_min": 101.19448562502302, "episode_reward_mean": 144.01276843353892, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 101.19448562502302}, "policy_reward_max": {"tplp_policy": 189.06639124187126}, "policy_reward_mean": {"tplp_policy": 144.01276843353892}, "custom_metrics": {"mean_episode_reward_mean": 144.01276843353892, "mean_episode_reward_min": 101.19448562502302, "mean_episode_reward_max": 189.06639124187126}, "hist_stats": {"episode_reward": [142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [142.3210469032413, 152.20867141835421, 101.19448562502302, 156.61503334034825, 138.25510426439183, 138.67619377674316, 123.30705208104474, 155.35231063057705, 139.12627896718473, 145.95311106962626, 139.7449691833645, 150.97486519381076, 158.34275834829987, 122.02219661566558, 145.06308598537976, 123.15947910666728, 155.7147373991158, 123.97127504204745, 169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6419116404435524, "mean_inference_ms": 1.8657596320963392, "mean_action_processing_ms": 0.3513869137682808, "mean_env_wait_ms": 2.0794777751586238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033202171325683594, "StateBufferConnector_ms": 0.009369850158691406, "ViewRequirementAgentConnector_ms": 0.19105315208435059}, "num_episodes": 24, "episode_return_max": 189.06639124187126, "episode_return_min": 101.19448562502302, "episode_return_mean": 144.01276843353892, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 439.0822463025824, "num_env_steps_trained_throughput_per_sec": 439.0822463025824, "timesteps_total": 105472, "num_env_steps_sampled_lifetime": 105472, "num_agent_steps_sampled_lifetime": 105472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 105472, "timers": {"training_iteration_time_ms": 2131.296, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2131.296, "sample_time_ms": 876.021, "learn_time_ms": 1238.975, "learn_throughput": 826.49, "synch_weights_time_ms": 16.1}, "counters": {"num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "done": false, "training_iteration": 103, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-03", "timestamp": 1744110303, "time_this_iter_s": 2.3394618034362793, "time_total_s": 220.58025455474854, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.58025455474854, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 43.53333333333333, "ram_util_percent": 87.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2655124425888062, "cur_kl_coeff": 1.9721522630525293e-32, "cur_lr": 1e-07, "total_loss": 2.16338589116931, "policy_loss": -0.0002114776143571362, "vf_loss": 9.812670069932938, "vf_explained_var": -2.5495514273643492e-05, "kl": 2.3051065094481515e-06, "entropy": 2.8957015469670297, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "env_runners": {"episode_reward_max": 189.06639124187126, "episode_reward_min": 118.37808341346638, "episode_reward_mean": 145.50081159904278, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.37808341346638}, "policy_reward_max": {"tplp_policy": 189.06639124187126}, "policy_reward_mean": {"tplp_policy": 145.50081159904278}, "custom_metrics": {"mean_episode_reward_mean": 145.50081159904278, "mean_episode_reward_min": 118.37808341346638, "mean_episode_reward_max": 189.06639124187126}, "hist_stats": {"episode_reward": [169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [169.6015966084146, 155.5033536689366, 133.1729487454569, 155.90635453381975, 151.2985500104534, 130.56505946539792, 140.07994898343165, 128.99394592274132, 150.73656334469987, 155.35466597545914, 148.96241073061898, 118.96131158697413, 167.71283806449512, 146.367642335595, 154.89245440662546, 136.11346546761672, 155.1584077015465, 148.64991338044584, 157.68464006988677, 161.8641069821227, 134.36115293761108, 164.63131134506196, 140.57096762996818, 164.29829886666272, 145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6418690652815171, "mean_inference_ms": 1.8661894982128748, "mean_action_processing_ms": 0.35145127024751033, "mean_env_wait_ms": 2.0801349520880343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005334615707397461, "StateBufferConnector_ms": 0.008371829986572266, "ViewRequirementAgentConnector_ms": 0.20031189918518066}, "num_episodes": 18, "episode_return_max": 189.06639124187126, "episode_return_min": 118.37808341346638, "episode_return_mean": 145.50081159904278, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 462.87247329787454, "num_env_steps_trained_throughput_per_sec": 462.87247329787454, "timesteps_total": 106496, "num_env_steps_sampled_lifetime": 106496, "num_agent_steps_sampled_lifetime": 106496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 2151.302, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2151.302, "sample_time_ms": 892.333, "learn_time_ms": 1242.731, "learn_throughput": 823.992, "synch_weights_time_ms": 16.039}, "counters": {"num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "training_iteration": 104, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-05", "timestamp": 1744110305, "time_this_iter_s": 2.2174341678619385, "time_total_s": 222.79768872261047, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.79768872261047, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 33.725, "ram_util_percent": 87.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2153904240578415, "cur_kl_coeff": 9.860761315262647e-33, "cur_lr": 1e-07, "total_loss": 2.157345686852932, "policy_loss": -0.00012296182103455067, "vf_loss": 9.788816505670548, "vf_explained_var": -9.607523679733276e-06, "kl": 1.3198677807135794e-06, "entropy": 2.897354820370674, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "env_runners": {"episode_reward_max": 189.06639124187126, "episode_reward_min": 118.37808341346638, "episode_reward_mean": 145.13203340404513, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.37808341346638}, "policy_reward_max": {"tplp_policy": 189.06639124187126}, "policy_reward_mean": {"tplp_policy": 145.13203340404513}, "custom_metrics": {"mean_episode_reward_mean": 145.13203340404513, "mean_episode_reward_min": 118.37808341346638, "mean_episode_reward_max": 189.06639124187126}, "hist_stats": {"episode_reward": [145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.58057428144275, 154.686077337971, 155.0248666524594, 133.39298602824152, 118.37808341346638, 151.98983477719048, 137.65288985193797, 148.49168435796216, 128.7402584614498, 150.14329069605927, 124.41905923856443, 145.8341147667833, 147.13515536320182, 153.04663417181254, 124.28715790459499, 144.45477306344438, 151.25885279938382, 142.4280499435501, 171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6414825324907092, "mean_inference_ms": 1.865850501922069, "mean_action_processing_ms": 0.3514080692656926, "mean_env_wait_ms": 2.079802711198778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063321590423583984, "StateBufferConnector_ms": 0.006376504898071289, "ViewRequirementAgentConnector_ms": 0.20230627059936523}, "num_episodes": 24, "episode_return_max": 189.06639124187126, "episode_return_min": 118.37808341346638, "episode_return_mean": 145.13203340404513, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 517.0415291640729, "num_env_steps_trained_throughput_per_sec": 517.0415291640729, "timesteps_total": 107520, "num_env_steps_sampled_lifetime": 107520, "num_agent_steps_sampled_lifetime": 107520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 2119.89, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2119.89, "sample_time_ms": 881.604, "learn_time_ms": 1222.518, "learn_throughput": 837.615, "synch_weights_time_ms": 15.567}, "counters": {"num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "done": false, "training_iteration": 105, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-07", "timestamp": 1744110307, "time_this_iter_s": 1.9860427379608154, "time_total_s": 224.7837314605713, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.7837314605713, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 29.299999999999997, "ram_util_percent": 87.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0822881259024144, "cur_kl_coeff": 4.9303806576313234e-33, "cur_lr": 1e-07, "total_loss": 2.1786522530019283, "policy_loss": -9.124944335781038e-05, "vf_loss": 9.874070084095, "vf_explained_var": -2.259984612464905e-05, "kl": 5.430509386838977e-07, "entropy": 2.8977400988340376, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "env_runners": {"episode_reward_max": 189.06639124187126, "episode_reward_min": 109.21874387910468, "episode_reward_mean": 145.90826960357023, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.21874387910468}, "policy_reward_max": {"tplp_policy": 189.06639124187126}, "policy_reward_mean": {"tplp_policy": 145.90826960357023}, "custom_metrics": {"mean_episode_reward_mean": 145.90826960357023, "mean_episode_reward_min": 109.21874387910468, "mean_episode_reward_max": 189.06639124187126}, "hist_stats": {"episode_reward": [171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [171.46252958570648, 142.61091615297667, 123.58200583893785, 149.03144082885115, 139.14964532926714, 144.03960198412074, 189.06639124187126, 131.63893780935922, 147.0729761527655, 152.57420664572328, 159.4052531071659, 135.85137009607763, 131.59726377685817, 133.13936155350854, 156.89620073726658, 141.96895378792942, 129.49495521090242, 131.21621449949194, 129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6413123064482893, "mean_inference_ms": 1.865543154697811, "mean_action_processing_ms": 0.3513922977277094, "mean_env_wait_ms": 2.079514912188855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076847076416015625, "StateBufferConnector_ms": 0.005265235900878906, "ViewRequirementAgentConnector_ms": 0.20283818244934082}, "num_episodes": 18, "episode_return_max": 189.06639124187126, "episode_return_min": 109.21874387910468, "episode_return_mean": 145.90826960357023, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 477.1792476664702, "num_env_steps_trained_throughput_per_sec": 477.1792476664702, "timesteps_total": 108544, "num_env_steps_sampled_lifetime": 108544, "num_agent_steps_sampled_lifetime": 108544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 108544, "timers": {"training_iteration_time_ms": 2124.833, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2124.833, "sample_time_ms": 871.723, "learn_time_ms": 1236.407, "learn_throughput": 828.207, "synch_weights_time_ms": 16.402}, "counters": {"num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "done": false, "training_iteration": 106, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-09", "timestamp": 1744110309, "time_this_iter_s": 2.1517903804779053, "time_total_s": 226.9355218410492, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.9355218410492, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 34.699999999999996, "ram_util_percent": 87.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.082137145102024, "cur_kl_coeff": 2.4651903288156617e-33, "cur_lr": 1e-07, "total_loss": 2.157951331138611, "policy_loss": -0.00017405953840352595, "vf_loss": 9.791480273008347, "vf_explained_var": -3.1861290335655215e-05, "kl": 1.0680657679840166e-06, "entropy": 2.8974466562271117, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "env_runners": {"episode_reward_max": 177.2761321225728, "episode_reward_min": 109.21874387910468, "episode_reward_mean": 145.52567352152772, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.21874387910468}, "policy_reward_max": {"tplp_policy": 177.2761321225728}, "policy_reward_mean": {"tplp_policy": 145.52567352152772}, "custom_metrics": {"mean_episode_reward_mean": 145.52567352152772, "mean_episode_reward_min": 109.21874387910468, "mean_episode_reward_max": 177.2761321225728}, "hist_stats": {"episode_reward": [129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [129.87115457368824, 153.37606012980973, 139.96039034880795, 127.53343178571953, 154.55957167613806, 141.8129238582418, 151.85897224514176, 147.7922900353249, 163.8561208135193, 137.01795995032583, 127.29118419438666, 145.33144848401145, 129.5415152226711, 151.93174909955277, 140.1124725992831, 151.53151459754008, 156.31852645987883, 134.352374301236, 134.56343696049296, 129.30900462224034, 160.02209276665823, 143.14551746599875, 142.65019047409425, 138.9078867390656, 177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6412709323378141, "mean_inference_ms": 1.8654719351496982, "mean_action_processing_ms": 0.3512751737498148, "mean_env_wait_ms": 2.079431789080772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008671283721923828, "StateBufferConnector_ms": 0.003267049789428711, "ViewRequirementAgentConnector_ms": 0.21263432502746582}, "num_episodes": 18, "episode_return_max": 177.2761321225728, "episode_return_min": 109.21874387910468, "episode_return_mean": 145.52567352152772, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.1061206602673, "num_env_steps_trained_throughput_per_sec": 486.1061206602673, "timesteps_total": 109568, "num_env_steps_sampled_lifetime": 109568, "num_agent_steps_sampled_lifetime": 109568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 109568, "timers": {"training_iteration_time_ms": 2132.875, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2132.875, "sample_time_ms": 874.425, "learn_time_ms": 1241.847, "learn_throughput": 824.578, "synch_weights_time_ms": 16.302}, "counters": {"num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "done": false, "training_iteration": 107, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-11", "timestamp": 1744110311, "time_this_iter_s": 2.1128292083740234, "time_total_s": 229.04835104942322, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE3E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.04835104942322, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 37.699999999999996, "ram_util_percent": 87.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.243312227353454, "cur_kl_coeff": 1.2325951644078308e-33, "cur_lr": 1e-07, "total_loss": 2.170186027139425, "policy_loss": -0.00021689385757781566, "vf_loss": 9.840562546253205, "vf_explained_var": -2.0570680499076842e-05, "kl": 1.3786906560619982e-06, "entropy": 2.8973771065473555, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "env_runners": {"episode_reward_max": 177.2761321225728, "episode_reward_min": 109.21874387910468, "episode_reward_mean": 146.49424734108482, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.21874387910468}, "policy_reward_max": {"tplp_policy": 177.2761321225728}, "policy_reward_mean": {"tplp_policy": 146.49424734108482}, "custom_metrics": {"mean_episode_reward_mean": 146.49424734108482, "mean_episode_reward_min": 109.21874387910468, "mean_episode_reward_max": 177.2761321225728}, "hist_stats": {"episode_reward": [177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [177.2761321225728, 159.45275414216303, 153.27718119687148, 150.11774539605557, 147.77779910777105, 127.34403834437167, 163.46215484905238, 128.12681024609094, 150.20775734485204, 152.03838867390115, 150.36466767069177, 140.3750977197988, 158.57638875687812, 142.9812542570102, 146.27929422839924, 131.59143023163276, 144.72695790594358, 150.22217944737906, 162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6409903140417883, "mean_inference_ms": 1.864987162914447, "mean_action_processing_ms": 0.35106473662001975, "mean_env_wait_ms": 2.078909453806127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010511636734008789, "StateBufferConnector_ms": 0.003343343734741211, "ViewRequirementAgentConnector_ms": 0.19834542274475098}, "num_episodes": 24, "episode_return_max": 177.2761321225728, "episode_return_min": 109.21874387910468, "episode_return_mean": 146.49424734108482, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 520.1204334410315, "num_env_steps_trained_throughput_per_sec": 520.1204334410315, "timesteps_total": 110592, "num_env_steps_sampled_lifetime": 110592, "num_agent_steps_sampled_lifetime": 110592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 110592, "timers": {"training_iteration_time_ms": 2130.859, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2130.859, "sample_time_ms": 874.146, "learn_time_ms": 1240.252, "learn_throughput": 825.639, "synch_weights_time_ms": 16.159}, "counters": {"num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "done": false, "training_iteration": 108, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-13", "timestamp": 1744110313, "time_this_iter_s": 1.97379732131958, "time_total_s": 231.0221483707428, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.0221483707428, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 31.83333333333334, "ram_util_percent": 87.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5292673625051973, "cur_kl_coeff": 6.162975822039154e-34, "cur_lr": 1e-07, "total_loss": 2.1834248907864096, "policy_loss": -0.00028765778406523166, "vf_loss": 9.893857169151307, "vf_explained_var": -3.2521039247512815e-05, "kl": 2.0689581654798062e-06, "entropy": 2.8975174129009247, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "env_runners": {"episode_reward_max": 171.26107351867927, "episode_reward_min": 109.21874387910468, "episode_reward_mean": 146.08341843719398, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.21874387910468}, "policy_reward_max": {"tplp_policy": 171.26107351867927}, "policy_reward_mean": {"tplp_policy": 146.08341843719398}, "custom_metrics": {"mean_episode_reward_mean": 146.08341843719398, "mean_episode_reward_min": 109.21874387910468, "mean_episode_reward_max": 171.26107351867927}, "hist_stats": {"episode_reward": [162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [162.8796300641541, 151.29929382749705, 138.70018925865054, 135.18046222951833, 140.3548177119089, 157.94053948068654, 145.7428787512823, 143.72265093571323, 137.15317586112528, 154.09479807784905, 153.6858876883751, 120.32961563139062, 143.89018241320963, 153.42346393324252, 136.26122583863238, 166.2493058540592, 155.6901922319616, 146.47275374961083, 142.70665786368616, 161.92654060658066, 136.15437800687607, 155.7563118949455, 161.97974009368687, 109.21874387910468, 164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6408182914101013, "mean_inference_ms": 1.8640810196483824, "mean_action_processing_ms": 0.3509084412021323, "mean_env_wait_ms": 2.078047912847462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00850677490234375, "StateBufferConnector_ms": 0.00533604621887207, "ViewRequirementAgentConnector_ms": 0.20031237602233887}, "num_episodes": 18, "episode_return_max": 171.26107351867927, "episode_return_min": 109.21874387910468, "episode_return_mean": 146.08341843719398, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 503.73946373095157, "num_env_steps_trained_throughput_per_sec": 503.73946373095157, "timesteps_total": 111616, "num_env_steps_sampled_lifetime": 111616, "num_agent_steps_sampled_lifetime": 111616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 111616, "timers": {"training_iteration_time_ms": 2104.072, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2104.072, "sample_time_ms": 868.203, "learn_time_ms": 1219.886, "learn_throughput": 839.423, "synch_weights_time_ms": 15.681}, "counters": {"num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "done": false, "training_iteration": 109, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-15", "timestamp": 1744110315, "time_this_iter_s": 2.037433624267578, "time_total_s": 233.05958199501038, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.05958199501038, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 32.53333333333334, "ram_util_percent": 87.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.834306575357914, "cur_kl_coeff": 3.081487911019577e-34, "cur_lr": 1e-07, "total_loss": 2.190718266367912, "policy_loss": -0.0002726712467847392, "vf_loss": 9.92326163649559, "vf_explained_var": -2.372041344642639e-05, "kl": 2.723549381888901e-06, "entropy": 2.898244598507881, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "env_runners": {"episode_reward_max": 187.46911826443437, "episode_reward_min": 124.23098987743143, "episode_reward_mean": 146.95310939812296, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.23098987743143}, "policy_reward_max": {"tplp_policy": 187.46911826443437}, "policy_reward_mean": {"tplp_policy": 146.95310939812296}, "custom_metrics": {"mean_episode_reward_mean": 146.95310939812296, "mean_episode_reward_min": 124.23098987743143, "mean_episode_reward_max": 187.46911826443437}, "hist_stats": {"episode_reward": [164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [164.0629882609861, 135.398642708842, 153.8573548002147, 147.67602766693977, 164.40447918931096, 134.2906817878949, 139.23582969402855, 158.23108835387325, 135.93732654423488, 140.10601597889627, 154.87283106230316, 145.10671729706178, 158.1930939639705, 171.11122348061298, 128.3408691617648, 132.54430913829876, 127.51047033382184, 162.37447300752112, 142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6407792319553284, "mean_inference_ms": 1.8631097591720502, "mean_action_processing_ms": 0.3507895918570098, "mean_env_wait_ms": 2.07705979932719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006999015808105469, "StateBufferConnector_ms": 0.0063326358795166016, "ViewRequirementAgentConnector_ms": 0.18755030632019043}, "num_episodes": 24, "episode_return_max": 187.46911826443437, "episode_return_min": 124.23098987743143, "episode_return_mean": 146.95310939812296, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 473.00193387129315, "num_env_steps_trained_throughput_per_sec": 473.00193387129315, "timesteps_total": 112640, "num_env_steps_sampled_lifetime": 112640, "num_agent_steps_sampled_lifetime": 112640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 112640, "timers": {"training_iteration_time_ms": 2101.836, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2101.836, "sample_time_ms": 853.183, "learn_time_ms": 1231.854, "learn_throughput": 831.267, "synch_weights_time_ms": 16.497}, "counters": {"num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "done": false, "training_iteration": 110, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-18", "timestamp": 1744110318, "time_this_iter_s": 2.1706936359405518, "time_total_s": 235.23027563095093, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE3E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.23027563095093, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 42.43333333333333, "ram_util_percent": 87.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0459311574697496, "cur_kl_coeff": 1.5407439555097886e-34, "cur_lr": 1e-07, "total_loss": 2.1761930860579013, "policy_loss": -8.355820900760592e-05, "vf_loss": 9.86498344540596, "vf_explained_var": -3.164857625961304e-05, "kl": 1.3147963483284285e-06, "entropy": 2.8996920928359033, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "env_runners": {"episode_reward_max": 187.46911826443437, "episode_reward_min": 124.23098987743143, "episode_reward_mean": 146.69839126767332, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.23098987743143}, "policy_reward_max": {"tplp_policy": 187.46911826443437}, "policy_reward_mean": {"tplp_policy": 146.69839126767332}, "custom_metrics": {"mean_episode_reward_mean": 146.69839126767332, "mean_episode_reward_min": 124.23098987743143, "mean_episode_reward_max": 187.46911826443437}, "hist_stats": {"episode_reward": [142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [142.55340304163087, 132.78241595278644, 141.47046338176074, 133.01341143642605, 156.50318024803738, 128.19308281130193, 131.06181710949065, 127.06685866940819, 156.0563271080043, 145.8277284538631, 133.09507275308172, 154.99042178899703, 149.0928222799292, 124.23098987743143, 171.26107351867927, 154.4546043623594, 135.45766414007792, 162.38106079212244, 157.87098876341338, 150.91624726669633, 139.44445038639353, 160.0598003669807, 125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6408559969382912, "mean_inference_ms": 1.8630356454271868, "mean_action_processing_ms": 0.3508159402113739, "mean_env_wait_ms": 2.076868533748086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008003711700439453, "StateBufferConnector_ms": 0.009548425674438477, "ViewRequirementAgentConnector_ms": 0.19297051429748535}, "num_episodes": 18, "episode_return_max": 187.46911826443437, "episode_return_min": 124.23098987743143, "episode_return_mean": 146.69839126767332, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.03395528639237, "num_env_steps_trained_throughput_per_sec": 448.03395528639237, "timesteps_total": 113664, "num_env_steps_sampled_lifetime": 113664, "num_agent_steps_sampled_lifetime": 113664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 113664, "timers": {"training_iteration_time_ms": 2127.809, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2127.809, "sample_time_ms": 868.324, "learn_time_ms": 1242.47, "learn_throughput": 824.165, "synch_weights_time_ms": 16.814}, "counters": {"num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "done": false, "training_iteration": 111, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-20", "timestamp": 1744110320, "time_this_iter_s": 2.2914159297943115, "time_total_s": 237.52169156074524, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C21580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.52169156074524, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 44.43333333333333, "ram_util_percent": 87.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.415230370312929, "cur_kl_coeff": 7.703719777548943e-35, "cur_lr": 1e-07, "total_loss": 2.1799192138016226, "policy_loss": -0.00016360131558030845, "vf_loss": 9.881063562631606, "vf_explained_var": -1.1360645294189453e-05, "kl": 2.219799211433671e-06, "entropy": 2.901830743253231, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "env_runners": {"episode_reward_max": 187.46911826443437, "episode_reward_min": 117.60375457201238, "episode_reward_mean": 146.02734036421538, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 117.60375457201238}, "policy_reward_max": {"tplp_policy": 187.46911826443437}, "policy_reward_mean": {"tplp_policy": 146.02734036421538}, "custom_metrics": {"mean_episode_reward_mean": 146.02734036421538, "mean_episode_reward_min": 117.60375457201238, "mean_episode_reward_max": 187.46911826443437}, "hist_stats": {"episode_reward": [125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [125.2308948260484, 145.42912804214836, 150.37952842326254, 141.4158628933219, 139.79537487846846, 155.34404536859648, 124.29793593554777, 148.471680598561, 166.52480717431143, 158.76437236942056, 147.9550906848707, 135.8318530829315, 142.62098524521562, 147.62348238289368, 148.9588537627321, 147.5239893444967, 136.58613998011836, 160.6209346509084, 161.15992762679963, 134.71114085477467, 136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6411190897955518, "mean_inference_ms": 1.8627162131914852, "mean_action_processing_ms": 0.35089301645269527, "mean_env_wait_ms": 2.076342475904484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010005474090576172, "StateBufferConnector_ms": 0.009666919708251953, "ViewRequirementAgentConnector_ms": 0.1791822910308838}, "num_episodes": 22, "episode_return_max": 187.46911826443437, "episode_return_min": 117.60375457201238, "episode_return_mean": 146.02734036421538, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 503.1725058357325, "num_env_steps_trained_throughput_per_sec": 503.1725058357325, "timesteps_total": 114688, "num_env_steps_sampled_lifetime": 114688, "num_agent_steps_sampled_lifetime": 114688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 2126.448, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2126.448, "sample_time_ms": 869.802, "learn_time_ms": 1239.476, "learn_throughput": 826.156, "synch_weights_time_ms": 16.87}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "training_iteration": 112, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-22", "timestamp": 1744110322, "time_this_iter_s": 2.040478229522705, "time_total_s": 239.56216979026794, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.56216979026794, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 31.166666666666668, "ram_util_percent": 87.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.09592277854681, "cur_kl_coeff": 3.8518598887744714e-35, "cur_lr": 1e-07, "total_loss": 2.187128892540932, "policy_loss": -8.104583248496056e-05, "vf_loss": 9.910181498527527, "vf_explained_var": -3.128126263618469e-05, "kl": 7.84347816740194e-07, "entropy": 2.903354327380657, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "env_runners": {"episode_reward_max": 187.46911826443437, "episode_reward_min": 117.60375457201238, "episode_reward_mean": 145.9890759342696, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 117.60375457201238}, "policy_reward_max": {"tplp_policy": 187.46911826443437}, "policy_reward_mean": {"tplp_policy": 145.9890759342696}, "custom_metrics": {"mean_episode_reward_mean": 145.9890759342696, "mean_episode_reward_min": 117.60375457201238, "mean_episode_reward_max": 187.46911826443437}, "hist_stats": {"episode_reward": [136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [136.44989289493827, 154.49032048311975, 165.35230530441657, 138.43682642247006, 159.9353497819104, 148.22299379560926, 164.38818102589997, 128.94920392572803, 139.7291526389116, 149.29500872099618, 147.49890903229232, 131.7468475609507, 136.565568168614, 144.28047166080646, 150.18212068677138, 141.72092066734058, 141.33777349457426, 149.34895315990667, 140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6410387633418101, "mean_inference_ms": 1.8626465341701361, "mean_action_processing_ms": 0.3511255735071996, "mean_env_wait_ms": 2.0761325868195772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01001739501953125, "StateBufferConnector_ms": 0.009656667709350586, "ViewRequirementAgentConnector_ms": 0.19021916389465332}, "num_episodes": 20, "episode_return_max": 187.46911826443437, "episode_return_min": 117.60375457201238, "episode_return_mean": 145.9890759342696, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 462.6820439864773, "num_env_steps_trained_throughput_per_sec": 462.6820439864773, "timesteps_total": 115712, "num_env_steps_sampled_lifetime": 115712, "num_agent_steps_sampled_lifetime": 115712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 115712, "timers": {"training_iteration_time_ms": 2114.553, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2114.553, "sample_time_ms": 865.764, "learn_time_ms": 1231.013, "learn_throughput": 831.835, "synch_weights_time_ms": 17.475}, "counters": {"num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "done": false, "training_iteration": 113, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-24", "timestamp": 1744110324, "time_this_iter_s": 2.218726396560669, "time_total_s": 241.7808961868286, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 241.7808961868286, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 36.06666666666667, "ram_util_percent": 87.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.080017714947462, "cur_kl_coeff": 1.9259299443872357e-35, "cur_lr": 1e-07, "total_loss": 2.1889628835022448, "policy_loss": -9.092041291296482e-05, "vf_loss": 9.917742735147476, "vf_explained_var": -2.301149070262909e-05, "kl": 9.252652034177911e-07, "entropy": 2.9038186758756637, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "env_runners": {"episode_reward_max": 187.46911826443437, "episode_reward_min": 115.24674518841248, "episode_reward_mean": 146.27545432842481, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.24674518841248}, "policy_reward_max": {"tplp_policy": 187.46911826443437}, "policy_reward_mean": {"tplp_policy": 146.27545432842481}, "custom_metrics": {"mean_episode_reward_mean": 146.27545432842481, "mean_episode_reward_min": 115.24674518841248, "mean_episode_reward_max": 187.46911826443437}, "hist_stats": {"episode_reward": [140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [140.81456757376546, 142.27908785732416, 135.65811883692066, 149.8839233809831, 155.094379587161, 159.8402331420477, 144.24339850175855, 136.61980578083848, 156.07608703612374, 143.70658230757732, 147.5523924049469, 161.2470998030171, 187.46911826443437, 170.3495446234313, 146.18262035642428, 143.3011621949793, 161.68990690717504, 135.96588875207868, 150.29405433830556, 149.68426363824886, 137.69129707378573, 151.4522729608384, 126.78266223071303, 143.28970844654714, 132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.641235716572349, "mean_inference_ms": 1.8631183055896636, "mean_action_processing_ms": 0.3512669433455078, "mean_env_wait_ms": 2.0765980456548636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010999202728271484, "StateBufferConnector_ms": 0.00966191291809082, "ViewRequirementAgentConnector_ms": 0.1871035099029541}, "num_episodes": 18, "episode_return_max": 187.46911826443437, "episode_return_min": 115.24674518841248, "episode_return_mean": 146.27545432842481, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 456.9931384538022, "num_env_steps_trained_throughput_per_sec": 456.9931384538022, "timesteps_total": 116736, "num_env_steps_sampled_lifetime": 116736, "num_agent_steps_sampled_lifetime": 116736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 116736, "timers": {"training_iteration_time_ms": 2117.399, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2117.399, "sample_time_ms": 866.832, "learn_time_ms": 1232.406, "learn_throughput": 830.895, "synch_weights_time_ms": 17.86}, "counters": {"num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "done": false, "training_iteration": 114, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-27", "timestamp": 1744110327, "time_this_iter_s": 2.2469284534454346, "time_total_s": 244.02782464027405, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.02782464027405, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 42.474999999999994, "ram_util_percent": 87.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4356252759695054, "cur_kl_coeff": 9.629649721936178e-36, "cur_lr": 1e-07, "total_loss": 2.1642203859984877, "policy_loss": -0.00030643054051324723, "vf_loss": 9.819666439294815, "vf_explained_var": -3.12071293592453e-05, "kl": 1.8599382046902146e-06, "entropy": 2.9038978651165963, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "env_runners": {"episode_reward_max": 175.48931993740953, "episode_reward_min": 115.24674518841248, "episode_reward_mean": 144.73998917062596, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.24674518841248}, "policy_reward_max": {"tplp_policy": 175.48931993740953}, "policy_reward_mean": {"tplp_policy": 144.73998917062596}, "custom_metrics": {"mean_episode_reward_mean": 144.73998917062596, "mean_episode_reward_min": 115.24674518841248, "mean_episode_reward_max": 175.48931993740953}, "hist_stats": {"episode_reward": [132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [132.5142438871071, 136.69056565169498, 132.20144549053612, 148.89010931618645, 162.39567885826963, 142.43721347403667, 131.27371099147413, 144.1255018104277, 148.91978249982057, 143.75527894007882, 168.86579031498275, 145.36031584926866, 167.52492887226865, 142.67251716203006, 162.4859915746395, 147.59716401552853, 158.5315356354786, 134.33758098036927, 154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6415394237534564, "mean_inference_ms": 1.8639452447488132, "mean_action_processing_ms": 0.3515470805856386, "mean_env_wait_ms": 2.0774413644917016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008997678756713867, "StateBufferConnector_ms": 0.009456634521484375, "ViewRequirementAgentConnector_ms": 0.20033001899719238}, "num_episodes": 24, "episode_return_max": 175.48931993740953, "episode_return_min": 115.24674518841248, "episode_return_mean": 144.73998917062596, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 430.17662375384293, "num_env_steps_trained_throughput_per_sec": 430.17662375384293, "timesteps_total": 117760, "num_env_steps_sampled_lifetime": 117760, "num_agent_steps_sampled_lifetime": 117760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 117760, "timers": {"training_iteration_time_ms": 2157.391, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2157.391, "sample_time_ms": 877.165, "learn_time_ms": 1261.517, "learn_throughput": 811.721, "synch_weights_time_ms": 18.408}, "counters": {"num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "done": false, "training_iteration": 115, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-29", "timestamp": 1744110329, "time_this_iter_s": 2.386984348297119, "time_total_s": 246.41480898857117, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFC40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.41480898857117, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 38.06666666666667, "ram_util_percent": 87.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3631491847336292, "cur_kl_coeff": 4.814824860968089e-36, "cur_lr": 1e-07, "total_loss": 2.1853741995990275, "policy_loss": -0.0001681483641732484, "vf_loss": 9.90350204706192, "vf_explained_var": -2.526901662349701e-05, "kl": 1.0670191675998809e-06, "entropy": 2.9033316925168036, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "env_runners": {"episode_reward_max": 175.48931993740953, "episode_reward_min": 115.24674518841248, "episode_reward_mean": 143.809054358882, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.24674518841248}, "policy_reward_max": {"tplp_policy": 175.48931993740953}, "policy_reward_mean": {"tplp_policy": 143.809054358882}, "custom_metrics": {"mean_episode_reward_mean": 143.809054358882, "mean_episode_reward_min": 115.24674518841248, "mean_episode_reward_max": 175.48931993740953}, "hist_stats": {"episode_reward": [154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [154.31056136968346, 144.96507639350853, 158.39115542995256, 119.85811960503835, 145.99945114955497, 117.60375457201238, 151.24831623585482, 142.18638216785598, 136.16696887511856, 131.12298577361338, 140.3741709095643, 153.70270475502303, 138.14651408034166, 150.66541318343724, 133.60430517515127, 128.66213599729042, 131.03507450677952, 148.4459106838446, 155.75777783624784, 145.56289884735745, 128.38836342107427, 132.9474374105736, 145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.641894343853084, "mean_inference_ms": 1.8649880365610805, "mean_action_processing_ms": 0.3518414420324639, "mean_env_wait_ms": 2.0783369577686863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008299589157104492, "StateBufferConnector_ms": 0.007462024688720703, "ViewRequirementAgentConnector_ms": 0.19707465171813965}, "num_episodes": 18, "episode_return_max": 175.48931993740953, "episode_return_min": 115.24674518841248, "episode_return_mean": 143.809054358882, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 343.3730100203323, "num_env_steps_trained_throughput_per_sec": 343.3730100203323, "timesteps_total": 118784, "num_env_steps_sampled_lifetime": 118784, "num_agent_steps_sampled_lifetime": 118784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 118784, "timers": {"training_iteration_time_ms": 2241.015, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2241.015, "sample_time_ms": 905.157, "learn_time_ms": 1317.342, "learn_throughput": 777.323, "synch_weights_time_ms": 18.316}, "counters": {"num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "done": false, "training_iteration": 116, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-32", "timestamp": 1744110332, "time_this_iter_s": 2.9899935722351074, "time_total_s": 249.40480256080627, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.40480256080627, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 43.95, "ram_util_percent": 88.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3300553813576697, "cur_kl_coeff": 2.4074124304840446e-36, "cur_lr": 1e-07, "total_loss": 2.1779177762567996, "policy_loss": -0.00020460282103158535, "vf_loss": 9.873795038461685, "vf_explained_var": -1.2811645865440368e-05, "kl": 1.372048239445256e-06, "entropy": 2.9032638117671015, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "env_runners": {"episode_reward_max": 175.48931993740953, "episode_reward_min": 115.24674518841248, "episode_reward_mean": 145.1176746003237, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.24674518841248}, "policy_reward_max": {"tplp_policy": 175.48931993740953}, "policy_reward_mean": {"tplp_policy": 145.1176746003237}, "custom_metrics": {"mean_episode_reward_mean": 145.1176746003237, "mean_episode_reward_min": 115.24674518841248, "mean_episode_reward_max": 175.48931993740953}, "hist_stats": {"episode_reward": [145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.05564919475395, 141.50829502587575, 153.2987269590423, 145.68120137064162, 147.66964853572222, 151.3009807111512, 133.42822570462337, 162.23609899651882, 146.26564534758413, 159.85517702782008, 144.74372846639224, 159.4725180615495, 130.6565917594868, 142.80207010420315, 144.449050132851, 158.38695675854294, 136.3583465195224, 150.9148736229224, 161.57179350378868, 158.9121513756915, 115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6429308871059765, "mean_inference_ms": 1.867682272899845, "mean_action_processing_ms": 0.35232812930433277, "mean_env_wait_ms": 2.080594877173207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008702754974365234, "StateBufferConnector_ms": 0.0070226192474365234, "ViewRequirementAgentConnector_ms": 0.20395708084106445}, "num_episodes": 22, "episode_return_max": 175.48931993740953, "episode_return_min": 115.24674518841248, "episode_return_mean": 145.1176746003237, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 285.03596862762066, "num_env_steps_trained_throughput_per_sec": 285.03596862762066, "timesteps_total": 119808, "num_env_steps_sampled_lifetime": 119808, "num_agent_steps_sampled_lifetime": 119808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 119808, "timers": {"training_iteration_time_ms": 2389.614, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2389.614, "sample_time_ms": 936.041, "learn_time_ms": 1431.675, "learn_throughput": 715.246, "synch_weights_time_ms": 21.798}, "counters": {"num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "done": false, "training_iteration": 117, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-36", "timestamp": 1744110336, "time_this_iter_s": 3.609400510787964, "time_total_s": 253.01420307159424, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.01420307159424, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 49.20000000000001, "ram_util_percent": 88.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4682392314076425, "cur_kl_coeff": 1.2037062152420223e-36, "cur_lr": 1e-07, "total_loss": 2.1845926962792874, "policy_loss": -0.00017107257153838872, "vf_loss": 9.900663197040558, "vf_explained_var": -2.621673047542572e-05, "kl": 2.040247899426362e-06, "entropy": 2.9040202766656877, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "env_runners": {"episode_reward_max": 175.48931993740953, "episode_reward_min": 111.04295540388159, "episode_reward_mean": 143.6401591608628, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.04295540388159}, "policy_reward_max": {"tplp_policy": 175.48931993740953}, "policy_reward_mean": {"tplp_policy": 143.6401591608628}, "custom_metrics": {"mean_episode_reward_mean": 143.6401591608628, "mean_episode_reward_min": 111.04295540388159, "mean_episode_reward_max": 175.48931993740953}, "hist_stats": {"episode_reward": [115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [115.24674518841248, 152.1186233723051, 132.95786488294073, 152.1366747605595, 149.6760559616235, 144.99159647558062, 138.61584713419128, 151.86037735091656, 149.8552005575053, 163.09427782063185, 147.26496333929737, 134.9163096738909, 133.2687184201258, 156.91627028322216, 151.02711741896468, 162.1380513211284, 142.36725868633704, 175.48931993740953, 129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6446265264761831, "mean_inference_ms": 1.8731119010097512, "mean_action_processing_ms": 0.35322250685322826, "mean_env_wait_ms": 2.0855366175438967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009797811508178711, "StateBufferConnector_ms": 0.007389068603515625, "ViewRequirementAgentConnector_ms": 0.23950695991516113}, "num_episodes": 20, "episode_return_max": 175.48931993740953, "episode_return_min": 111.04295540388159, "episode_return_mean": 143.6401591608628, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 264.09286153711827, "num_env_steps_trained_throughput_per_sec": 264.09286153711827, "timesteps_total": 120832, "num_env_steps_sampled_lifetime": 120832, "num_agent_steps_sampled_lifetime": 120832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 120832, "timers": {"training_iteration_time_ms": 2580.479, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2580.479, "sample_time_ms": 1031.133, "learn_time_ms": 1525.828, "learn_throughput": 671.111, "synch_weights_time_ms": 23.418}, "counters": {"num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "done": false, "training_iteration": 118, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-40", "timestamp": 1744110340, "time_this_iter_s": 3.88693904876709, "time_total_s": 256.9011421203613, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.9011421203613, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 57.760000000000005, "ram_util_percent": 86.62}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.701983505859971, "cur_kl_coeff": 6.0185310762101115e-37, "cur_lr": 1e-07, "total_loss": 2.173936506360769, "policy_loss": -0.00012016787368338556, "vf_loss": 9.858465570211411, "vf_explained_var": -3.521852195262909e-05, "kl": 1.4736794026637412e-06, "entropy": 2.9055972903966905, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "env_runners": {"episode_reward_max": 166.79752514256018, "episode_reward_min": 111.04295540388159, "episode_reward_mean": 142.75832534803902, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.04295540388159}, "policy_reward_max": {"tplp_policy": 166.79752514256018}, "policy_reward_mean": {"tplp_policy": 142.75832534803902}, "custom_metrics": {"mean_episode_reward_mean": 142.75832534803902, "mean_episode_reward_min": 111.04295540388159, "mean_episode_reward_max": 166.79752514256018}, "hist_stats": {"episode_reward": [129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [129.58854842571705, 137.20859191766047, 132.6795465565112, 160.04500003733622, 156.9243683706914, 151.97477687347344, 142.3758877579475, 134.36560063289048, 140.65704564310101, 130.28230072381203, 127.5397257212875, 130.73544572767932, 136.5080447809119, 132.45846560417198, 151.424909372398, 161.4589033235484, 149.9126900454801, 146.3699077859848, 160.09489745194963, 133.26099120208121, 137.79342112878481, 122.10601251237487, 130.90193845453922, 154.23806264762618, 151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6463335197422954, "mean_inference_ms": 1.878587218986831, "mean_action_processing_ms": 0.3541590177500023, "mean_env_wait_ms": 2.0905610806187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012741804122924805, "StateBufferConnector_ms": 0.006389617919921875, "ViewRequirementAgentConnector_ms": 0.26297760009765625}, "num_episodes": 18, "episode_return_max": 166.79752514256018, "episode_return_min": 111.04295540388159, "episode_return_mean": 142.75832534803902, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 339.76448691255996, "num_env_steps_trained_throughput_per_sec": 339.76448691255996, "timesteps_total": 121856, "num_env_steps_sampled_lifetime": 121856, "num_agent_steps_sampled_lifetime": 121856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 121856, "timers": {"training_iteration_time_ms": 2678.584, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2678.584, "sample_time_ms": 1062.816, "learn_time_ms": 1591.339, "learn_throughput": 643.483, "synch_weights_time_ms": 24.329}, "counters": {"num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "done": false, "training_iteration": 119, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-43", "timestamp": 1744110343, "time_this_iter_s": 3.0204107761383057, "time_total_s": 259.92155289649963, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.92155289649963, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 55.525, "ram_util_percent": 86.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.458493651635945, "cur_kl_coeff": 3.0092655381050558e-37, "cur_lr": 1e-07, "total_loss": 2.171931263804436, "policy_loss": -0.00011053842608816921, "vf_loss": 9.850743722915649, "vf_explained_var": -2.516210079193115e-05, "kl": 1.006647220025414e-06, "entropy": 2.9064411967992783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "env_runners": {"episode_reward_max": 171.10644243653604, "episode_reward_min": 111.04295540388159, "episode_reward_mean": 143.09229492510818, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.04295540388159}, "policy_reward_max": {"tplp_policy": 171.10644243653604}, "policy_reward_mean": {"tplp_policy": 143.09229492510818}, "custom_metrics": {"mean_episode_reward_mean": 143.09229492510818, "mean_episode_reward_min": 111.04295540388159, "mean_episode_reward_max": 171.10644243653604}, "hist_stats": {"episode_reward": [151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.47463063454776, 131.18194036713854, 133.9128838682679, 129.53571209028618, 150.41829260889398, 138.29000393688895, 164.67761332845186, 134.51714208600274, 153.51212021925966, 160.03789045490151, 138.49214490032102, 140.0660286401115, 151.25843034163302, 129.62844220870767, 136.7977076987652, 128.54488966345852, 141.55629961260806, 147.93971282780208, 141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6487031565304442, "mean_inference_ms": 1.8858906491726548, "mean_action_processing_ms": 0.3553608793796691, "mean_env_wait_ms": 2.097652531502877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0167388916015625, "StateBufferConnector_ms": 0.006632089614868164, "ViewRequirementAgentConnector_ms": 0.26431965827941895}, "num_episodes": 24, "episode_return_max": 171.10644243653604, "episode_return_min": 111.04295540388159, "episode_return_mean": 143.09229492510818, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 401.8573056062468, "num_env_steps_trained_throughput_per_sec": 401.8573056062468, "timesteps_total": 122880, "num_env_steps_sampled_lifetime": 122880, "num_agent_steps_sampled_lifetime": 122880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 122880, "timers": {"training_iteration_time_ms": 2716.912, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2716.912, "sample_time_ms": 1076.85, "learn_time_ms": 1615.997, "learn_throughput": 633.665, "synch_weights_time_ms": 23.965}, "counters": {"num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "done": false, "training_iteration": 120, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-46", "timestamp": 1744110346, "time_this_iter_s": 2.553555965423584, "time_total_s": 262.4751088619232, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C21580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.4751088619232, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 43.575, "ram_util_percent": 86.02499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.465075604990125, "cur_kl_coeff": 1.5046327690525279e-37, "cur_lr": 1e-07, "total_loss": 2.194433133304119, "policy_loss": -0.00029437368793878705, "vf_loss": 9.9412182867527, "vf_explained_var": -3.562308847904205e-05, "kl": 1.8087083907908364e-06, "entropy": 2.9057708576321604, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "env_runners": {"episode_reward_max": 171.10644243653604, "episode_reward_min": 111.04295540388159, "episode_reward_mean": 143.54182665068885, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.04295540388159}, "policy_reward_max": {"tplp_policy": 171.10644243653604}, "policy_reward_mean": {"tplp_policy": 143.54182665068885}, "custom_metrics": {"mean_episode_reward_mean": 143.54182665068885, "mean_episode_reward_min": 111.04295540388159, "mean_episode_reward_max": 171.10644243653604}, "hist_stats": {"episode_reward": [141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.37143405948947, 144.2098444808969, 130.69796446472785, 159.0356919567863, 127.64371301356027, 146.0784015786423, 130.48156733749312, 151.96237770945038, 139.120180374913, 166.79752514256018, 150.51845944053898, 146.80311691927815, 162.23192726056936, 161.37234374611182, 154.00100811826726, 138.26817260603792, 161.61499027808335, 131.83122031458686, 140.19744693300964, 146.2741043476365, 143.42226804134452, 131.75560938883228, 149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6502030606881882, "mean_inference_ms": 1.8906835401344446, "mean_action_processing_ms": 0.35610338239099776, "mean_env_wait_ms": 2.1024588856984976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018903017044067383, "StateBufferConnector_ms": 0.007668256759643555, "ViewRequirementAgentConnector_ms": 0.26605725288391113}, "num_episodes": 18, "episode_return_max": 171.10644243653604, "episode_return_min": 111.04295540388159, "episode_return_mean": 143.54182665068885, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 496.3334369150776, "num_env_steps_trained_throughput_per_sec": 496.3334369150776, "timesteps_total": 123904, "num_env_steps_sampled_lifetime": 123904, "num_agent_steps_sampled_lifetime": 123904, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 123904, "timers": {"training_iteration_time_ms": 2694.67, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2694.67, "sample_time_ms": 1067.776, "learn_time_ms": 1602.971, "learn_throughput": 638.814, "synch_weights_time_ms": 23.824}, "counters": {"num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "done": false, "training_iteration": 121, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-48", "timestamp": 1744110348, "time_this_iter_s": 2.0693914890289307, "time_total_s": 264.54450035095215, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE3E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.54450035095215, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 36.13333333333333, "ram_util_percent": 85.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3328179255127908, "cur_kl_coeff": 7.523163845262639e-38, "cur_lr": 1e-07, "total_loss": 2.1855170473456385, "policy_loss": -0.00012313079787418246, "vf_loss": 9.904799270629884, "vf_explained_var": -3.0580535531044005e-05, "kl": 1.3548360496606903e-06, "entropy": 2.90559651106596, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "env_runners": {"episode_reward_max": 171.10644243653604, "episode_reward_min": 111.04295540388159, "episode_reward_mean": 143.459244460556, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.04295540388159}, "policy_reward_max": {"tplp_policy": 171.10644243653604}, "policy_reward_mean": {"tplp_policy": 143.459244460556}, "custom_metrics": {"mean_episode_reward_mean": 143.459244460556, "mean_episode_reward_min": 111.04295540388159, "mean_episode_reward_max": 171.10644243653604}, "hist_stats": {"episode_reward": [149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [149.68966129238112, 115.40650175311069, 140.10507101556166, 154.53635670166616, 135.80000909225595, 157.3493205688445, 127.4000756818146, 136.74235425761452, 162.31464859828864, 152.38365441149884, 165.90735534698638, 142.80409291473575, 127.46613533494096, 162.07377415173835, 123.19646786494073, 111.04295540388159, 138.24240424652587, 149.1774691656326, 153.4807917929904, 146.98013889252712, 140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6514132144519172, "mean_inference_ms": 1.895227147914958, "mean_action_processing_ms": 0.3568368427326186, "mean_env_wait_ms": 2.1070951095330357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0186922550201416, "StateBufferConnector_ms": 0.008768081665039062, "ViewRequirementAgentConnector_ms": 0.25698280334472656}, "num_episodes": 22, "episode_return_max": 171.10644243653604, "episode_return_min": 111.04295540388159, "episode_return_mean": 143.459244460556, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 474.860536544528, "num_env_steps_trained_throughput_per_sec": 474.860536544528, "timesteps_total": 124928, "num_env_steps_sampled_lifetime": 124928, "num_agent_steps_sampled_lifetime": 124928, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 124928, "timers": {"training_iteration_time_ms": 2706.804, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2706.804, "sample_time_ms": 1072.109, "learn_time_ms": 1610.479, "learn_throughput": 635.836, "synch_weights_time_ms": 24.215}, "counters": {"num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "done": false, "training_iteration": 122, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-50", "timestamp": 1744110350, "time_this_iter_s": 2.163540840148926, "time_total_s": 266.7080411911011, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.7080411911011, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 35.199999999999996, "ram_util_percent": 85.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2147699780762196, "cur_kl_coeff": 3.7615819226313197e-38, "cur_lr": 1e-07, "total_loss": 2.187289224565029, "policy_loss": -0.00011337462929077447, "vf_loss": 9.912060672044754, "vf_explained_var": -2.6201456785202025e-05, "kl": 8.461468998272048e-07, "entropy": 2.9061257258057593, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "env_runners": {"episode_reward_max": 171.10644243653604, "episode_reward_min": 121.43700928450711, "episode_reward_mean": 143.78767255415144, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.43700928450711}, "policy_reward_max": {"tplp_policy": 171.10644243653604}, "policy_reward_mean": {"tplp_policy": 143.78767255415144}, "custom_metrics": {"mean_episode_reward_mean": 143.78767255415144, "mean_episode_reward_min": 121.43700928450711, "mean_episode_reward_max": 171.10644243653604}, "hist_stats": {"episode_reward": [140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [140.241165233541, 141.75539279172114, 139.79941575394125, 151.3888009022138, 140.11612479327587, 130.4160049244967, 145.71457360465092, 146.25057655326552, 127.18926748635229, 142.64510817791574, 147.425153820024, 142.63390947119026, 121.43700928450711, 151.38027210618094, 149.0651199180767, 147.83906579579008, 151.41043094661822, 150.21535090531404, 145.1722623543816, 131.20982442893018, 166.36211060130117, 138.98211265711265, 137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6519074373023278, "mean_inference_ms": 1.8966769415994813, "mean_action_processing_ms": 0.35703386526811054, "mean_env_wait_ms": 2.1089328526383477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01559758186340332, "StateBufferConnector_ms": 0.008385896682739258, "ViewRequirementAgentConnector_ms": 0.2317197322845459}, "num_episodes": 20, "episode_return_max": 171.10644243653604, "episode_return_min": 121.43700928450711, "episode_return_mean": 143.78767255415144, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 451.94820581509714, "num_env_steps_trained_throughput_per_sec": 451.94820581509714, "timesteps_total": 125952, "num_env_steps_sampled_lifetime": 125952, "num_agent_steps_sampled_lifetime": 125952, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 125952, "timers": {"training_iteration_time_ms": 2712.06, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2712.06, "sample_time_ms": 1082.432, "learn_time_ms": 1606.069, "learn_throughput": 637.582, "synch_weights_time_ms": 23.56}, "counters": {"num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "done": false, "training_iteration": 123, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-52", "timestamp": 1744110352, "time_this_iter_s": 2.2718966007232666, "time_total_s": 268.97993779182434, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 268.97993779182434, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 46.73333333333334, "ram_util_percent": 85.96666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1331394664943217, "cur_kl_coeff": 1.8807909613156599e-38, "cur_lr": 1e-07, "total_loss": 2.1776870720088484, "policy_loss": -7.22187920473516e-05, "vf_loss": 9.873595756292342, "vf_explained_var": -1.573897898197174e-05, "kl": 8.904111042484786e-07, "entropy": 2.906396596133709, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "env_runners": {"episode_reward_max": 171.10644243653604, "episode_reward_min": 123.27567531914083, "episode_reward_mean": 143.10586753618634, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.27567531914083}, "policy_reward_max": {"tplp_policy": 171.10644243653604}, "policy_reward_mean": {"tplp_policy": 143.10586753618634}, "custom_metrics": {"mean_episode_reward_mean": 143.10586753618634, "mean_episode_reward_min": 123.27567531914083, "mean_episode_reward_max": 171.10644243653604}, "hist_stats": {"episode_reward": [137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.16903559803768, 148.74828999204829, 141.02693301606377, 123.62697639833792, 159.489852978545, 141.51028569477654, 135.38261313324526, 147.53642080041269, 141.17933523875575, 129.50870651521825, 134.12772111060508, 151.41709463505904, 128.1163553345503, 131.2630353247973, 171.10644243653604, 133.83668362340677, 157.53883342668277, 128.3653332541406, 142.47219473793695, 125.0591192471923, 155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6522526433635802, "mean_inference_ms": 1.8972095378499636, "mean_action_processing_ms": 0.35703694421803545, "mean_env_wait_ms": 2.109721029230378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012656450271606445, "StateBufferConnector_ms": 0.007390499114990234, "ViewRequirementAgentConnector_ms": 0.21010804176330566}, "num_episodes": 22, "episode_return_max": 171.10644243653604, "episode_return_min": 123.27567531914083, "episode_return_mean": 143.10586753618634, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 481.03377420405104, "num_env_steps_trained_throughput_per_sec": 481.03377420405104, "timesteps_total": 126976, "num_env_steps_sampled_lifetime": 126976, "num_agent_steps_sampled_lifetime": 126976, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 126976, "timers": {"training_iteration_time_ms": 2700.862, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2700.862, "sample_time_ms": 1075.638, "learn_time_ms": 1601.453, "learn_throughput": 639.419, "synch_weights_time_ms": 23.771}, "counters": {"num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "done": false, "training_iteration": 124, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-54", "timestamp": 1744110354, "time_this_iter_s": 2.1342554092407227, "time_total_s": 271.11419320106506, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.11419320106506, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 39.699999999999996, "ram_util_percent": 85.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5156100831925867, "cur_kl_coeff": 9.403954806578299e-39, "cur_lr": 1e-07, "total_loss": 2.1695742659270763, "policy_loss": -0.00020355053711682559, "vf_loss": 9.841795063018798, "vf_explained_var": -4.2147934436798096e-05, "kl": 1.4526076982157576e-06, "entropy": 2.906709523499012, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 171.09152254846555, "episode_reward_min": 115.79630556908896, "episode_reward_mean": 143.91671910740243, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.79630556908896}, "policy_reward_max": {"tplp_policy": 171.09152254846555}, "policy_reward_mean": {"tplp_policy": 143.91671910740243}, "custom_metrics": {"mean_episode_reward_mean": 143.91671910740243, "mean_episode_reward_min": 115.79630556908896, "mean_episode_reward_max": 171.09152254846555}, "hist_stats": {"episode_reward": [155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.08744716640854, 142.5478750747847, 158.67173794482494, 171.09152254846555, 146.81308781812055, 142.12824541978654, 145.30669239859324, 130.05197804121917, 140.44836504957743, 140.84853525772843, 151.6385835488429, 148.53003041119524, 134.29138622177456, 150.99390670940556, 138.56695870173178, 142.24739174852525, 146.62242788732277, 141.69484102279173, 129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6520711813766852, "mean_inference_ms": 1.8976539057292912, "mean_action_processing_ms": 0.35710050825772827, "mean_env_wait_ms": 2.1102059730704275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01666426658630371, "StateBufferConnector_ms": 0.007130146026611328, "ViewRequirementAgentConnector_ms": 0.2237224578857422}, "num_episodes": 20, "episode_return_max": 171.09152254846555, "episode_return_min": 115.79630556908896, "episode_return_mean": 143.91671910740243, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 487.8073133946775, "num_env_steps_trained_throughput_per_sec": 487.8073133946775, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 2672.739, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2672.739, "sample_time_ms": 1070.917, "learn_time_ms": 1578.486, "learn_throughput": 648.723, "synch_weights_time_ms": 23.231}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 125, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-57", "timestamp": 1744110357, "time_this_iter_s": 2.104022741317749, "time_total_s": 273.2182159423828, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 273.2182159423828, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 33.1, "ram_util_percent": 85.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4569744184613227, "cur_kl_coeff": 4.7019774032891496e-39, "cur_lr": 1e-07, "total_loss": 2.1797593027353286, "policy_loss": -0.00021874195081181825, "vf_loss": 9.882514834403992, "vf_explained_var": -4.9925222992897036e-05, "kl": 1.5628074816032012e-06, "entropy": 2.906506581604481, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "env_runners": {"episode_reward_max": 170.30821254515575, "episode_reward_min": 109.45967121267292, "episode_reward_mean": 143.95528753917776, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.45967121267292}, "policy_reward_max": {"tplp_policy": 170.30821254515575}, "policy_reward_mean": {"tplp_policy": 143.95528753917776}, "custom_metrics": {"mean_episode_reward_mean": 143.95528753917776, "mean_episode_reward_min": 109.45967121267292, "mean_episode_reward_max": 170.30821254515575}, "hist_stats": {"episode_reward": [129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [129.68837954996988, 162.29919372934276, 157.10686976575084, 133.77889684774047, 142.01107171552977, 160.44730799052735, 150.144803617624, 129.33918986538828, 149.98335965931625, 134.82623369095293, 151.70576312698753, 146.08434566776594, 140.14099561176974, 138.6624292949694, 163.76212937552637, 136.04668169377604, 131.01440356179606, 149.43199961454295, 137.62514455222637, 165.0146806579128, 146.1477997740813, 138.37453967047335, 143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6520193318156139, "mean_inference_ms": 1.8977645547043644, "mean_action_processing_ms": 0.3570632734184892, "mean_env_wait_ms": 2.1102812413651093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01420140266418457, "StateBufferConnector_ms": 0.007099628448486328, "ViewRequirementAgentConnector_ms": 0.2124636173248291}, "num_episodes": 18, "episode_return_max": 170.30821254515575, "episode_return_min": 109.45967121267292, "episode_return_mean": 143.95528753917776, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.0937970111172, "num_env_steps_trained_throughput_per_sec": 486.0937970111172, "timesteps_total": 129024, "num_env_steps_sampled_lifetime": 129024, "num_agent_steps_sampled_lifetime": 129024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 2585.18, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2585.18, "sample_time_ms": 1045.184, "learn_time_ms": 1517.015, "learn_throughput": 675.01, "synch_weights_time_ms": 22.876}, "counters": {"num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "done": false, "training_iteration": 126, "trial_id": "b517c_00000", "date": "2025-04-08_19-05-59", "timestamp": 1744110359, "time_this_iter_s": 2.111860990524292, "time_total_s": 275.3300769329071, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC900>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.3300769329071, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 26.7, "ram_util_percent": 85.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.499141365289688, "cur_kl_coeff": 2.3509887016445748e-39, "cur_lr": 1e-07, "total_loss": 2.1769373178482057, "policy_loss": -0.00013581709354184567, "vf_loss": 9.871080601215363, "vf_explained_var": -2.672448754310608e-05, "kl": 1.407904143579941e-06, "entropy": 2.906970116496086, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "env_runners": {"episode_reward_max": 170.30821254515575, "episode_reward_min": 109.45967121267292, "episode_reward_mean": 144.41743144210216, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.45967121267292}, "policy_reward_max": {"tplp_policy": 170.30821254515575}, "policy_reward_mean": {"tplp_policy": 144.41743144210216}, "custom_metrics": {"mean_episode_reward_mean": 144.41743144210216, "mean_episode_reward_min": 109.45967121267292, "mean_episode_reward_max": 170.30821254515575}, "hist_stats": {"episode_reward": [143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [143.0798340318123, 152.30795090920216, 147.64648462463694, 145.43761660217967, 150.08699293802914, 123.37566170347624, 138.70665991840366, 159.29616973536693, 137.90719499016083, 154.5615433156493, 154.624588531964, 135.66413539597218, 150.98827210928158, 164.55692939530906, 139.45431752521105, 138.27981862036557, 128.54728211603467, 135.8982559398695, 152.22814228351888, 156.65808704294813, 137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6520016992388254, "mean_inference_ms": 1.8978770803040528, "mean_action_processing_ms": 0.3570287696706048, "mean_env_wait_ms": 2.110485613432079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012008905410766602, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.22015810012817383}, "num_episodes": 22, "episode_return_max": 170.30821254515575, "episode_return_min": 109.45967121267292, "episode_return_mean": 144.41743144210216, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 437.276000837703, "num_env_steps_trained_throughput_per_sec": 437.276000837703, "timesteps_total": 130048, "num_env_steps_sampled_lifetime": 130048, "num_agent_steps_sampled_lifetime": 130048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 130048, "timers": {"training_iteration_time_ms": 2460.104, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2460.104, "sample_time_ms": 1018.663, "learn_time_ms": 1421.629, "learn_throughput": 720.3, "synch_weights_time_ms": 19.707}, "counters": {"num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "done": false, "training_iteration": 127, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-01", "timestamp": 1744110361, "time_this_iter_s": 2.3481369018554688, "time_total_s": 277.6782138347626, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 277.6782138347626, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 45.199999999999996, "ram_util_percent": 85.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1656432446092366, "cur_kl_coeff": 1.1754943508222874e-39, "cur_lr": 1e-07, "total_loss": 2.1902898482978346, "policy_loss": -0.000106956617673859, "vf_loss": 9.924760258197784, "vf_explained_var": -3.0143558979034425e-05, "kl": 1.1645885152011815e-06, "entropy": 2.907932426035404, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "env_runners": {"episode_reward_max": 178.5603230333176, "episode_reward_min": 109.45967121267292, "episode_reward_mean": 144.47308415709577, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.45967121267292}, "policy_reward_max": {"tplp_policy": 178.5603230333176}, "policy_reward_mean": {"tplp_policy": 144.47308415709577}, "custom_metrics": {"mean_episode_reward_mean": 144.47308415709577, "mean_episode_reward_min": 109.45967121267292, "mean_episode_reward_max": 178.5603230333176}, "hist_stats": {"episode_reward": [137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.74803791736653, 123.27567531914083, 131.96200507619523, 147.7646869820202, 131.24789629740397, 141.4369594867753, 136.925113156859, 133.39617796843305, 131.28101601360956, 159.15705572692303, 135.89150158048875, 128.4955164780245, 148.38243819964833, 153.9609668112264, 134.43550675943737, 128.5209798488547, 123.33795883730976, 133.70580695641758, 158.03587805789073, 152.62114391379868, 115.79630556908896, 152.3868553509435, 147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6518240217665907, "mean_inference_ms": 1.8974690771553628, "mean_action_processing_ms": 0.35691891789236485, "mean_env_wait_ms": 2.110206693551252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011137247085571289, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.21503686904907227}, "num_episodes": 20, "episode_return_max": 178.5603230333176, "episode_return_min": 109.45967121267292, "episode_return_mean": 144.47308415709577, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 511.149182315746, "num_env_steps_trained_throughput_per_sec": 511.149182315746, "timesteps_total": 131072, "num_env_steps_sampled_lifetime": 131072, "num_agent_steps_sampled_lifetime": 131072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 131072, "timers": {"training_iteration_time_ms": 2272.695, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2272.695, "sample_time_ms": 925.17, "learn_time_ms": 1329.307, "learn_throughput": 770.326, "synch_weights_time_ms": 18.112}, "counters": {"num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "done": false, "training_iteration": 128, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-03", "timestamp": 1744110363, "time_this_iter_s": 2.0079996585845947, "time_total_s": 279.68621349334717, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.68621349334717, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 31.2, "ram_util_percent": 85.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1692601036280394, "cur_kl_coeff": 5.877471754111437e-40, "cur_lr": 1e-07, "total_loss": 2.1794596932828427, "policy_loss": -9.039489668793976e-05, "vf_loss": 9.881612116098404, "vf_explained_var": -1.8947571516036987e-05, "kl": 1.0063098191404052e-06, "entropy": 2.908529444038868, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "env_runners": {"episode_reward_max": 178.5603230333176, "episode_reward_min": 109.45967121267292, "episode_reward_mean": 145.89186009261235, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.45967121267292}, "policy_reward_max": {"tplp_policy": 178.5603230333176}, "policy_reward_mean": {"tplp_policy": 145.89186009261235}, "custom_metrics": {"mean_episode_reward_mean": 145.89186009261235, "mean_episode_reward_min": 109.45967121267292, "mean_episode_reward_max": 178.5603230333176}, "hist_stats": {"episode_reward": [147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.83203036684856, 159.99032181232067, 145.24347160928593, 119.76438556772578, 143.68026688362124, 158.89786924786335, 144.7645045880578, 118.1627070055666, 167.47601109587134, 150.96778790890053, 138.28548093015377, 147.57826964875684, 140.54400852085178, 146.84950806240414, 140.01905745317094, 127.55789635489113, 153.46146909647769, 170.30821254515575, 130.44576364804763, 144.4687319738799, 157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6515293167317115, "mean_inference_ms": 1.8969498094891843, "mean_action_processing_ms": 0.35679711043699736, "mean_env_wait_ms": 2.109617005895974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139444351196289, "StateBufferConnector_ms": 0.003476381301879883, "ViewRequirementAgentConnector_ms": 0.20691251754760742}, "num_episodes": 22, "episode_return_max": 178.5603230333176, "episode_return_min": 109.45967121267292, "episode_return_mean": 145.89186009261235, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.85288197993555, "num_env_steps_trained_throughput_per_sec": 464.85288197993555, "timesteps_total": 132096, "num_env_steps_sampled_lifetime": 132096, "num_agent_steps_sampled_lifetime": 132096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 132096, "timers": {"training_iteration_time_ms": 2191.594, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2191.594, "sample_time_ms": 899.049, "learn_time_ms": 1275.022, "learn_throughput": 803.123, "synch_weights_time_ms": 17.294}, "counters": {"num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "done": false, "training_iteration": 129, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-05", "timestamp": 1744110365, "time_this_iter_s": 2.208231210708618, "time_total_s": 281.8944447040558, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C234C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.8944447040558, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 37.53333333333333, "ram_util_percent": 85.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4718876730650665, "cur_kl_coeff": 2.9387358770557185e-40, "cur_lr": 1e-07, "total_loss": 2.168607781082392, "policy_loss": -0.00024722153320908544, "vf_loss": 9.838974034786224, "vf_explained_var": -2.518296241760254e-05, "kl": 1.971363331243481e-06, "entropy": 2.9088849678635595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "env_runners": {"episode_reward_max": 178.5603230333176, "episode_reward_min": 109.45967121267292, "episode_reward_mean": 146.3140197440771, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 109.45967121267292}, "policy_reward_max": {"tplp_policy": 178.5603230333176}, "policy_reward_mean": {"tplp_policy": 146.3140197440771}, "custom_metrics": {"mean_episode_reward_mean": 146.3140197440771, "mean_episode_reward_min": 109.45967121267292, "mean_episode_reward_max": 178.5603230333176}, "hist_stats": {"episode_reward": [157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.63240123377344, 162.77444127027246, 139.2313255363262, 133.5214432426624, 109.45967121267292, 158.0579135559244, 141.1462374828555, 132.27830171864562, 158.63814356746184, 140.9554042038838, 163.0932382606204, 153.65715465273382, 148.0354781433429, 134.92765695386944, 170.1489203474521, 152.96562914421025, 158.0463015647426, 139.83764108363914, 145.1870409450514, 138.77099570950034, 157.8560679239741, 137.30440716964932, 144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6513206977469366, "mean_inference_ms": 1.8965191410989186, "mean_action_processing_ms": 0.3566764872931899, "mean_env_wait_ms": 2.1093309037910832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004126310348510742, "StateBufferConnector_ms": 0.0070819854736328125, "ViewRequirementAgentConnector_ms": 0.2073071002960205}, "num_episodes": 20, "episode_return_max": 178.5603230333176, "episode_return_min": 109.45967121267292, "episode_return_mean": 146.3140197440771, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.42918560150264, "num_env_steps_trained_throughput_per_sec": 448.42918560150264, "timesteps_total": 133120, "num_env_steps_sampled_lifetime": 133120, "num_agent_steps_sampled_lifetime": 133120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 133120, "timers": {"training_iteration_time_ms": 2165.13, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2165.13, "sample_time_ms": 889.85, "learn_time_ms": 1257.905, "learn_throughput": 814.052, "synch_weights_time_ms": 17.146}, "counters": {"num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "done": false, "training_iteration": 130, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-08", "timestamp": 1744110368, "time_this_iter_s": 2.2903056144714355, "time_total_s": 284.1847503185272, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.1847503185272, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 40.06666666666667, "ram_util_percent": 85.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.01281423792243, "cur_kl_coeff": 1.4693679385278593e-40, "cur_lr": 1e-07, "total_loss": 2.1787798680365085, "policy_loss": -0.0001134282851126045, "vf_loss": 9.879212468862534, "vf_explained_var": -2.7082115411758424e-05, "kl": 1.1213576237345534e-06, "entropy": 2.9090981021523477, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "env_runners": {"episode_reward_max": 178.5603230333176, "episode_reward_min": 115.1345435550526, "episode_reward_mean": 145.5263092437351, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.1345435550526}, "policy_reward_max": {"tplp_policy": 178.5603230333176}, "policy_reward_mean": {"tplp_policy": 145.5263092437351}, "custom_metrics": {"mean_episode_reward_mean": 145.5263092437351, "mean_episode_reward_min": 115.1345435550526, "mean_episode_reward_max": 178.5603230333176}, "hist_stats": {"episode_reward": [144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.28038719099868, 130.7326954962019, 151.25509749993302, 156.77118073205614, 161.59242582801326, 147.18437975183178, 167.06152717180956, 125.21048439730616, 125.43269809475822, 161.11000844490505, 155.90107035423998, 161.92942850410935, 124.69265224221922, 158.77633052901214, 126.78038664007975, 164.13740205237795, 164.36650123859164, 127.91222522696378, 126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6515223009675069, "mean_inference_ms": 1.8963075369451499, "mean_action_processing_ms": 0.3566433189977925, "mean_env_wait_ms": 2.109310992626399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051229000091552734, "StateBufferConnector_ms": 0.008070945739746094, "ViewRequirementAgentConnector_ms": 0.21529841423034668}, "num_episodes": 22, "episode_return_max": 178.5603230333176, "episode_return_min": 115.1345435550526, "episode_return_mean": 145.5263092437351, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.75879058328496, "num_env_steps_trained_throughput_per_sec": 467.75879058328496, "timesteps_total": 134144, "num_env_steps_sampled_lifetime": 134144, "num_agent_steps_sampled_lifetime": 134144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 134144, "timers": {"training_iteration_time_ms": 2177.733, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2177.733, "sample_time_ms": 900.072, "learn_time_ms": 1260.063, "learn_throughput": 812.657, "synch_weights_time_ms": 17.269}, "counters": {"num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "done": false, "training_iteration": 131, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-10", "timestamp": 1744110370, "time_this_iter_s": 2.1954851150512695, "time_total_s": 286.3802354335785, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C234C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 286.3802354335785, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 43.5, "ram_util_percent": 85.73333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2275291450321673, "cur_kl_coeff": 7.346839692639296e-41, "cur_lr": 1e-07, "total_loss": 2.1737523809075356, "policy_loss": -0.00015729153528809547, "vf_loss": 9.859526443481446, "vf_explained_var": -4.1389837861061096e-05, "kl": 1.638337732456918e-06, "entropy": 2.9097192719578744, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "env_runners": {"episode_reward_max": 178.5603230333176, "episode_reward_min": 115.1345435550526, "episode_reward_mean": 145.1101890695592, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.1345435550526}, "policy_reward_max": {"tplp_policy": 178.5603230333176}, "policy_reward_mean": {"tplp_policy": 145.1101890695592}, "custom_metrics": {"mean_episode_reward_mean": 145.1101890695592, "mean_episode_reward_min": 115.1345435550526, "mean_episode_reward_max": 178.5603230333176}, "hist_stats": {"episode_reward": [126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [126.57904071090711, 130.96979239579488, 147.13093560360022, 144.4230538992534, 137.81079182525747, 157.55711497104306, 149.03692069800806, 152.03461816206186, 145.5728591632302, 178.5603230333176, 148.3680495432732, 140.36996154357323, 132.28665579796794, 151.31067674891622, 140.91233545544182, 127.44942680784808, 154.20139118641708, 158.01853521728594, 157.27820995792723, 143.06037487070628, 157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6513798619082273, "mean_inference_ms": 1.8962669022275764, "mean_action_processing_ms": 0.35667214504693207, "mean_env_wait_ms": 2.1095133206258683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008127927780151367, "StateBufferConnector_ms": 0.008070945739746094, "ViewRequirementAgentConnector_ms": 0.20244812965393066}, "num_episodes": 18, "episode_return_max": 178.5603230333176, "episode_return_min": 115.1345435550526, "episode_return_mean": 145.1101890695592, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 496.0268805885014, "num_env_steps_trained_throughput_per_sec": 496.0268805885014, "timesteps_total": 135168, "num_env_steps_sampled_lifetime": 135168, "num_agent_steps_sampled_lifetime": 135168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 135168, "timers": {"training_iteration_time_ms": 2168.531, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2168.531, "sample_time_ms": 898.661, "learn_time_ms": 1252.856, "learn_throughput": 817.332, "synch_weights_time_ms": 16.685}, "counters": {"num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "done": false, "training_iteration": 132, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-12", "timestamp": 1744110372, "time_this_iter_s": 2.0718061923980713, "time_total_s": 288.45204162597656, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.45204162597656, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 31.566666666666666, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.072782349586487, "cur_kl_coeff": 3.673419846319648e-41, "cur_lr": 1e-07, "total_loss": 2.1745503678917886, "policy_loss": -0.0003775850404053926, "vf_loss": 9.863781303167343, "vf_explained_var": -3.6276131868362424e-05, "kl": 2.2739038919361575e-06, "entropy": 2.910173645615578, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "env_runners": {"episode_reward_max": 174.9844510918062, "episode_reward_min": 115.1345435550526, "episode_reward_mean": 145.32545475862048, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.1345435550526}, "policy_reward_max": {"tplp_policy": 174.9844510918062}, "policy_reward_mean": {"tplp_policy": 145.32545475862048}, "custom_metrics": {"mean_episode_reward_mean": 145.32545475862048, "mean_episode_reward_min": 115.1345435550526, "mean_episode_reward_max": 174.9844510918062}, "hist_stats": {"episode_reward": [157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.16264777467046, 141.71992001324998, 155.28247276097335, 142.1566628218891, 156.5051649182846, 151.80513562276928, 139.05351683519262, 155.76773647982014, 156.25600377277752, 147.1743849260722, 119.98221671145157, 115.1345435550526, 126.15113881759737, 145.35610691610165, 147.46549319682745, 129.38164455880317, 148.7634986817226, 151.00173203298561, 158.10094923189698, 137.08352140274062, 150.0591163647564, 134.70208830653507, 162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6513473368323811, "mean_inference_ms": 1.8961585167615167, "mean_action_processing_ms": 0.35666359402507697, "mean_env_wait_ms": 2.1094650983463668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069980621337890625, "StateBufferConnector_ms": 0.008069515228271484, "ViewRequirementAgentConnector_ms": 0.19292879104614258}, "num_episodes": 20, "episode_return_max": 174.9844510918062, "episode_return_min": 115.1345435550526, "episode_return_mean": 145.32545475862048, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 495.58382365158633, "num_env_steps_trained_throughput_per_sec": 495.58382365158633, "timesteps_total": 136192, "num_env_steps_sampled_lifetime": 136192, "num_agent_steps_sampled_lifetime": 136192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 136192, "timers": {"training_iteration_time_ms": 2148.582, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2148.582, "sample_time_ms": 882.654, "learn_time_ms": 1248.83, "learn_throughput": 819.968, "synch_weights_time_ms": 16.768}, "counters": {"num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "done": false, "training_iteration": 133, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-14", "timestamp": 1744110374, "time_this_iter_s": 2.072849750518799, "time_total_s": 290.52489137649536, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.52489137649536, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 30.633333333333336, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4809261601418258, "cur_kl_coeff": 1.836709923159824e-41, "cur_lr": 1e-07, "total_loss": 2.177062699943781, "policy_loss": -0.00021626583475153893, "vf_loss": 9.873210310935974, "vf_explained_var": -3.761984407901764e-05, "kl": 2.1924239854281824e-06, "entropy": 2.9102361261844636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "env_runners": {"episode_reward_max": 175.3264045755332, "episode_reward_min": 112.34335534699511, "episode_reward_mean": 145.50645019305202, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.34335534699511}, "policy_reward_max": {"tplp_policy": 175.3264045755332}, "policy_reward_mean": {"tplp_policy": 145.50645019305202}, "custom_metrics": {"mean_episode_reward_mean": 145.50645019305202, "mean_episode_reward_min": 112.34335534699511, "mean_episode_reward_max": 175.3264045755332}, "hist_stats": {"episode_reward": [162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [162.8754412093138, 140.221813685443, 140.22618134856808, 147.63798374568725, 147.5481174347637, 157.417562726763, 144.48037533336708, 148.27687766656308, 141.2699193901077, 146.64941087451453, 167.14256895304365, 139.72990128095748, 144.3959891282437, 149.90799465887696, 133.9997575991203, 155.49023739440327, 130.62826841070614, 155.85411395459198, 147.86484017667982, 140.92040953708937, 149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6514834544572327, "mean_inference_ms": 1.8961255128220273, "mean_action_processing_ms": 0.35662523849811, "mean_env_wait_ms": 2.109807146925648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009994983673095703, "StateBufferConnector_ms": 0.0075833797454833984, "ViewRequirementAgentConnector_ms": 0.21499061584472656}, "num_episodes": 22, "episode_return_max": 175.3264045755332, "episode_return_min": 112.34335534699511, "episode_return_mean": 145.50645019305202, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 447.88323204177914, "num_env_steps_trained_throughput_per_sec": 447.88323204177914, "timesteps_total": 137216, "num_env_steps_sampled_lifetime": 137216, "num_agent_steps_sampled_lifetime": 137216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 137216, "timers": {"training_iteration_time_ms": 2164.338, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2164.238, "sample_time_ms": 884.19, "learn_time_ms": 1263.276, "learn_throughput": 810.591, "synch_weights_time_ms": 16.443}, "counters": {"num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "done": false, "training_iteration": 134, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-17", "timestamp": 1744110377, "time_this_iter_s": 2.2919232845306396, "time_total_s": 292.816814661026, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C22160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.816814661026, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 38.824999999999996, "ram_util_percent": 85.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7288488879799844, "cur_kl_coeff": 9.18354961579912e-42, "cur_lr": 1e-07, "total_loss": 2.1879132322967054, "policy_loss": -0.0003452627512160689, "vf_loss": 9.917501652240754, "vf_explained_var": -4.1243433952331546e-05, "kl": 3.1832700962297624e-06, "entropy": 2.9111690118908884, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "env_runners": {"episode_reward_max": 187.06740733595464, "episode_reward_min": 112.34335534699511, "episode_reward_mean": 145.1603206591466, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.34335534699511}, "policy_reward_max": {"tplp_policy": 187.06740733595464}, "policy_reward_mean": {"tplp_policy": 145.1603206591466}, "custom_metrics": {"mean_episode_reward_mean": 145.1603206591466, "mean_episode_reward_min": 112.34335534699511, "mean_episode_reward_max": 187.06740733595464}, "hist_stats": {"episode_reward": [149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [149.9658372691576, 155.3295364605368, 141.06532209390812, 145.11348044046923, 143.10967364253796, 143.9948005355502, 164.36686482127362, 138.3960325852582, 135.6203196606258, 132.15839352145682, 132.48985387700822, 158.49456388168377, 148.97236265772798, 146.02570139731586, 132.63575478956764, 152.71134587650005, 150.30148066465995, 137.71033847387704, 124.89583608006842, 132.61201644611512, 147.6085647642368, 124.87068055318261, 140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.651650614443978, "mean_inference_ms": 1.8963665275175388, "mean_action_processing_ms": 0.35656823024449014, "mean_env_wait_ms": 2.1100881624604737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009992837905883789, "StateBufferConnector_ms": 0.006981849670410156, "ViewRequirementAgentConnector_ms": 0.21717071533203125}, "num_episodes": 20, "episode_return_max": 187.06740733595464, "episode_return_min": 112.34335534699511, "episode_return_mean": 145.1603206591466, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.6050347881418, "num_env_steps_trained_throughput_per_sec": 466.6050347881418, "timesteps_total": 138240, "num_env_steps_sampled_lifetime": 138240, "num_agent_steps_sampled_lifetime": 138240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 138240, "timers": {"training_iteration_time_ms": 2173.877, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2173.777, "sample_time_ms": 891.427, "learn_time_ms": 1265.519, "learn_throughput": 809.154, "synch_weights_time_ms": 16.606}, "counters": {"num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "done": false, "training_iteration": 135, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-19", "timestamp": 1744110379, "time_this_iter_s": 2.1997997760772705, "time_total_s": 295.01661443710327, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.01661443710327, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 43.03333333333333, "ram_util_percent": 85.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.380624372512102, "cur_kl_coeff": 4.59177480789956e-42, "cur_lr": 1e-07, "total_loss": 2.1756976768374443, "policy_loss": -0.00010303818853572012, "vf_loss": 9.86802077293396, "vf_explained_var": -3.085806965827942e-05, "kl": 1.1212802736970673e-06, "entropy": 2.9120449095964434, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "env_runners": {"episode_reward_max": 187.06740733595464, "episode_reward_min": 112.34335534699511, "episode_reward_mean": 146.56201883818056, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.34335534699511}, "policy_reward_max": {"tplp_policy": 187.06740733595464}, "policy_reward_mean": {"tplp_policy": 146.56201883818056}, "custom_metrics": {"mean_episode_reward_mean": 146.56201883818056, "mean_episode_reward_min": 112.34335534699511, "mean_episode_reward_max": 187.06740733595464}, "hist_stats": {"episode_reward": [140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [140.46648588001787, 153.49706858703016, 143.73276744296285, 126.26257264437798, 152.97369629048117, 137.47763971263433, 156.17543389401905, 120.59825125727583, 168.5540488877658, 152.3785691730996, 165.0806165735443, 143.0921188681397, 151.1986782081241, 146.04470158463562, 125.24646558277719, 158.25650407351102, 124.52722372933239, 137.1563569345269, 157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6516064272179153, "mean_inference_ms": 1.8962870245708827, "mean_action_processing_ms": 0.35644295541983273, "mean_env_wait_ms": 2.1100362615660786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010633468627929688, "StateBufferConnector_ms": 0.00599360466003418, "ViewRequirementAgentConnector_ms": 0.22324800491333008}, "num_episodes": 22, "episode_return_max": 187.06740733595464, "episode_return_min": 112.34335534699511, "episode_return_mean": 146.56201883818056, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 499.356795181583, "num_env_steps_trained_throughput_per_sec": 499.356795181583, "timesteps_total": 139264, "num_env_steps_sampled_lifetime": 139264, "num_agent_steps_sampled_lifetime": 139264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 139264, "timers": {"training_iteration_time_ms": 2168.281, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2168.182, "sample_time_ms": 893.03, "learn_time_ms": 1258.441, "learn_throughput": 813.705, "synch_weights_time_ms": 16.487}, "counters": {"num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "done": false, "training_iteration": 136, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-21", "timestamp": 1744110381, "time_this_iter_s": 2.055912494659424, "time_total_s": 297.0725269317627, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.0725269317627, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 31.866666666666664, "ram_util_percent": 85.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.410129192844033, "cur_kl_coeff": 2.29588740394978e-42, "cur_lr": 1e-07, "total_loss": 2.1674741342663766, "policy_loss": -8.797610062174498e-05, "vf_loss": 9.835730773210525, "vf_explained_var": -4.621520638465881e-05, "kl": 1.8955384456974257e-06, "entropy": 2.913705776631832, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "env_runners": {"episode_reward_max": 187.06740733595464, "episode_reward_min": 112.34335534699511, "episode_reward_mean": 147.03493847575737, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.34335534699511}, "policy_reward_max": {"tplp_policy": 187.06740733595464}, "policy_reward_mean": {"tplp_policy": 147.03493847575737}, "custom_metrics": {"mean_episode_reward_mean": 147.03493847575737, "mean_episode_reward_min": 112.34335534699511, "mean_episode_reward_max": 187.06740733595464}, "hist_stats": {"episode_reward": [157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.72629745464258, 152.09477676751305, 161.77565568792724, 142.41594870549545, 137.85061524888712, 151.05902445664108, 135.85663307045425, 141.5304824566598, 155.0115070748865, 139.63732884960194, 150.59401694327994, 163.52184864007455, 174.9844510918062, 139.7956627669348, 147.6228165181192, 156.03900118862052, 134.21345468550186, 141.04453422705188, 175.3264045755332, 156.28336007007775, 146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6515768628599931, "mean_inference_ms": 1.8962164246577098, "mean_action_processing_ms": 0.35638033104200884, "mean_env_wait_ms": 2.1099460075013927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007132768630981445, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.23835277557373047}, "num_episodes": 18, "episode_return_max": 187.06740733595464, "episode_return_min": 112.34335534699511, "episode_return_mean": 147.03493847575737, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 478.31888131108707, "num_env_steps_trained_throughput_per_sec": 478.31888131108707, "timesteps_total": 140288, "num_env_steps_sampled_lifetime": 140288, "num_agent_steps_sampled_lifetime": 140288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 140288, "timers": {"training_iteration_time_ms": 2148.187, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2148.088, "sample_time_ms": 886.811, "learn_time_ms": 1244.283, "learn_throughput": 822.964, "synch_weights_time_ms": 16.769}, "counters": {"num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "done": false, "training_iteration": 137, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-23", "timestamp": 1744110383, "time_this_iter_s": 2.14764142036438, "time_total_s": 299.2201683521271, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEE80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 299.2201683521271, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 37.13333333333333, "ram_util_percent": 85.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6519556105136872, "cur_kl_coeff": 1.14794370197489e-42, "cur_lr": 1e-07, "total_loss": 2.156142071634531, "policy_loss": -0.00020239168079569936, "vf_loss": 9.791527235507965, "vf_explained_var": -3.7194415926933286e-05, "kl": 1.6556300663328472e-06, "entropy": 2.9153733596205713, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "env_runners": {"episode_reward_max": 187.06740733595464, "episode_reward_min": 112.34335534699511, "episode_reward_mean": 145.9449312026656, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.34335534699511}, "policy_reward_max": {"tplp_policy": 187.06740733595464}, "policy_reward_mean": {"tplp_policy": 145.9449312026656}, "custom_metrics": {"mean_episode_reward_mean": 145.9449312026656, "mean_episode_reward_min": 112.34335534699511, "mean_episode_reward_max": 187.06740733595464}, "hist_stats": {"episode_reward": [146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [146.21086900317158, 129.83009821713122, 112.34335534699511, 133.59941224451583, 141.54765894040676, 160.87383821045293, 125.32636538166456, 144.77882070520099, 125.76475264094599, 161.46199443186282, 125.66371283561294, 128.24880982208, 157.5696556147436, 143.3808712430651, 144.75317628531354, 158.11575860895877, 141.96276128965837, 152.53171270577977, 160.71378496246962, 157.87806600968787, 148.6527610887234, 117.31293509174749, 129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6517124279430507, "mean_inference_ms": 1.896422835730778, "mean_action_processing_ms": 0.3563642856839777, "mean_env_wait_ms": 2.1102391384272736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009126424789428711, "StateBufferConnector_ms": 0.009500503540039062, "ViewRequirementAgentConnector_ms": 0.2370765209197998}, "num_episodes": 20, "episode_return_max": 187.06740733595464, "episode_return_min": 112.34335534699511, "episode_return_mean": 145.9449312026656, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 446.9472485842747, "num_env_steps_trained_throughput_per_sec": 446.9472485842747, "timesteps_total": 141312, "num_env_steps_sampled_lifetime": 141312, "num_agent_steps_sampled_lifetime": 141312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 141312, "timers": {"training_iteration_time_ms": 2176.964, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2176.865, "sample_time_ms": 896.901, "learn_time_ms": 1262.47, "learn_throughput": 811.108, "synch_weights_time_ms": 17.269}, "counters": {"num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "done": false, "training_iteration": 138, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-26", "timestamp": 1744110386, "time_this_iter_s": 2.298079252243042, "time_total_s": 301.5182476043701, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.5182476043701, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 44.93333333333334, "ram_util_percent": 85.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.767150205373764, "cur_kl_coeff": 5.73971850987445e-43, "cur_lr": 1e-07, "total_loss": 2.1527288265526296, "policy_loss": -0.00025712005444802346, "vf_loss": 9.778572231531143, "vf_explained_var": -3.7707388401031494e-05, "kl": 2.920550720819648e-06, "entropy": 2.9165711224079134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "env_runners": {"episode_reward_max": 187.06740733595464, "episode_reward_min": 118.44021014509902, "episode_reward_mean": 147.35786706812257, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.44021014509902}, "policy_reward_max": {"tplp_policy": 187.06740733595464}, "policy_reward_mean": {"tplp_policy": 147.35786706812257}, "custom_metrics": {"mean_episode_reward_mean": 147.35786706812257, "mean_episode_reward_min": 118.44021014509902, "mean_episode_reward_max": 187.06740733595464}, "hist_stats": {"episode_reward": [129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [129.98805608303573, 160.74254778360282, 151.0269791718785, 134.0830504903808, 148.45091117508923, 132.6264840010141, 187.06740733595464, 141.23143161267527, 162.32163346449167, 143.35688997592445, 157.68625053426373, 158.0085533140369, 146.47914532814968, 170.10446996049478, 134.45532852507196, 127.39132033465607, 118.69283065438408, 138.24582519268588, 165.0245963405939, 175.38517266819335, 135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6519268578021237, "mean_inference_ms": 1.8970450592837989, "mean_action_processing_ms": 0.35639880762805226, "mean_env_wait_ms": 2.110910888285902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006131887435913086, "StateBufferConnector_ms": 0.009501218795776367, "ViewRequirementAgentConnector_ms": 0.21759915351867676}, "num_episodes": 22, "episode_return_max": 187.06740733595464, "episode_return_min": 118.44021014509902, "episode_return_mean": 147.35786706812257, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 420.22854697364164, "num_env_steps_trained_throughput_per_sec": 420.22854697364164, "timesteps_total": 142336, "num_env_steps_sampled_lifetime": 142336, "num_agent_steps_sampled_lifetime": 142336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 142336, "timers": {"training_iteration_time_ms": 2200.357, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2200.257, "sample_time_ms": 911.197, "learn_time_ms": 1271.536, "learn_throughput": 805.325, "synch_weights_time_ms": 17.424}, "counters": {"num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "done": false, "training_iteration": 139, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-28", "timestamp": 1744110388, "time_this_iter_s": 2.4422647953033447, "time_total_s": 303.96051239967346, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 303.96051239967346, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 43.775, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.224531305581331, "cur_kl_coeff": 2.869859254937225e-43, "cur_lr": 1e-07, "total_loss": 2.1937171749770643, "policy_loss": -0.0001908889156766236, "vf_loss": 9.942698222398757, "vf_explained_var": -2.8819963335990906e-05, "kl": 1.5255266267999446e-06, "entropy": 2.9176649138331414, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "env_runners": {"episode_reward_max": 176.0035998555502, "episode_reward_min": 111.83586652287822, "episode_reward_mean": 146.21497348089056, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.83586652287822}, "policy_reward_max": {"tplp_policy": 176.0035998555502}, "policy_reward_mean": {"tplp_policy": 146.21497348089056}, "custom_metrics": {"mean_episode_reward_mean": 146.21497348089056, "mean_episode_reward_min": 111.83586652287822, "mean_episode_reward_max": 176.0035998555502}, "hist_stats": {"episode_reward": [135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.81263725810874, 149.7405119521744, 132.82111404664136, 143.91543762983287, 167.75491289349887, 154.22093908758268, 164.39348816894108, 156.52376212425924, 123.93077894444315, 157.65798080006746, 128.7752348978506, 155.0810011568246, 156.9510065648605, 149.99606629138415, 161.63875299107897, 138.22935508987484, 145.63345335602298, 127.85551175431694, 137.96428580865145, 149.3125785709099, 135.57845664392153, 137.44499367235076, 141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6520124194906596, "mean_inference_ms": 1.8973946311100105, "mean_action_processing_ms": 0.35641544265705405, "mean_env_wait_ms": 2.1114333311781626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006133317947387695, "StateBufferConnector_ms": 0.007506608963012695, "ViewRequirementAgentConnector_ms": 0.2211744785308838}, "num_episodes": 20, "episode_return_max": 176.0035998555502, "episode_return_min": 111.83586652287822, "episode_return_mean": 146.21497348089056, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 483.9842581653668, "num_env_steps_trained_throughput_per_sec": 483.9842581653668, "timesteps_total": 143360, "num_env_steps_sampled_lifetime": 143360, "num_agent_steps_sampled_lifetime": 143360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 143360, "timers": {"training_iteration_time_ms": 2183.581, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2183.481, "sample_time_ms": 906.362, "learn_time_ms": 1259.672, "learn_throughput": 812.91, "synch_weights_time_ms": 17.347}, "counters": {"num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "done": false, "training_iteration": 140, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-30", "timestamp": 1744110390, "time_this_iter_s": 2.12099552154541, "time_total_s": 306.0815079212189, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBF600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.0815079212189, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 35.766666666666666, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.481427592411637, "cur_kl_coeff": 1.4349296274686126e-43, "cur_lr": 1e-07, "total_loss": 2.18059007152915, "policy_loss": -0.0001773812051396817, "vf_loss": 9.890171509981155, "vf_explained_var": -1.9043311476707457e-05, "kl": 1.5568828627188224e-06, "entropy": 2.917754165828228, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "env_runners": {"episode_reward_max": 176.0035998555502, "episode_reward_min": 111.83586652287822, "episode_reward_mean": 145.87785227926082, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.83586652287822}, "policy_reward_max": {"tplp_policy": 176.0035998555502}, "policy_reward_mean": {"tplp_policy": 145.87785227926082}, "custom_metrics": {"mean_episode_reward_mean": 145.87785227926082, "mean_episode_reward_min": 111.83586652287822, "mean_episode_reward_max": 176.0035998555502}, "hist_stats": {"episode_reward": [141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.01347676855556, 144.34178764465676, 151.32742183887805, 176.0035998555502, 158.7424267709285, 145.36915911222388, 137.97577805989496, 142.53716475297085, 118.44021014509902, 148.9223101062069, 144.66104210006714, 151.85064952356112, 161.94860087587213, 143.5247524675415, 151.56090155128516, 158.7684311923729, 160.26574744329528, 144.94806217719082, 166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6522284865940758, "mean_inference_ms": 1.8981646377796682, "mean_action_processing_ms": 0.3564315606286504, "mean_env_wait_ms": 2.1122058793223797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005493640899658203, "StateBufferConnector_ms": 0.008012056350708008, "ViewRequirementAgentConnector_ms": 0.24059796333312988}, "num_episodes": 22, "episode_return_max": 176.0035998555502, "episode_return_min": 111.83586652287822, "episode_return_mean": 145.87785227926082, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 434.58458517244793, "num_env_steps_trained_throughput_per_sec": 434.58458517244793, "timesteps_total": 144384, "num_env_steps_sampled_lifetime": 144384, "num_agent_steps_sampled_lifetime": 144384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 144384, "timers": {"training_iteration_time_ms": 2200.292, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2200.192, "sample_time_ms": 902.05, "learn_time_ms": 1280.491, "learn_throughput": 799.693, "synch_weights_time_ms": 17.651}, "counters": {"num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "done": false, "training_iteration": 141, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-33", "timestamp": 1744110393, "time_this_iter_s": 2.364213705062866, "time_total_s": 308.44572162628174, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFD80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.44572162628174, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 45.46666666666667, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361679082363844, "cur_kl_coeff": 7.174648137343063e-44, "cur_lr": 1e-07, "total_loss": 2.1906508237123488, "policy_loss": -9.610155830159783e-05, "vf_loss": 9.930448269844055, "vf_explained_var": -5.387738347053528e-05, "kl": 1.1993698573409262e-06, "entropy": 2.918651393055916, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "env_runners": {"episode_reward_max": 174.4952398262525, "episode_reward_min": 111.83586652287822, "episode_reward_mean": 146.15608311850067, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.83586652287822}, "policy_reward_max": {"tplp_policy": 174.4952398262525}, "policy_reward_mean": {"tplp_policy": 146.15608311850067}, "custom_metrics": {"mean_episode_reward_mean": 146.15608311850067, "mean_episode_reward_min": 111.83586652287822, "mean_episode_reward_max": 174.4952398262525}, "hist_stats": {"episode_reward": [166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [166.13566414130753, 148.28796882899755, 132.45984899321454, 141.81895962784876, 151.1886450917097, 146.48504770454198, 131.40943173194643, 163.58886458388162, 160.60337300539138, 123.46364138065684, 143.367626633446, 137.0551174035171, 150.11900693746725, 149.45563007431892, 145.07087303374823, 146.11028768440494, 121.98825734743045, 141.56103934621834, 142.9972727041877, 143.05054792574813, 159.35846628876826, 139.4214941146704, 145.68692709110505, 140.30158593962634, 155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6524364702498414, "mean_inference_ms": 1.8989573878062433, "mean_action_processing_ms": 0.35647331577701785, "mean_env_wait_ms": 2.1130425051753856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005494832992553711, "StateBufferConnector_ms": 0.008046627044677734, "ViewRequirementAgentConnector_ms": 0.24651432037353516}, "num_episodes": 18, "episode_return_max": 174.4952398262525, "episode_return_min": 111.83586652287822, "episode_return_mean": 146.15608311850067, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.78268404529786, "num_env_steps_trained_throughput_per_sec": 467.78268404529786, "timesteps_total": 145408, "num_env_steps_sampled_lifetime": 145408, "num_agent_steps_sampled_lifetime": 145408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 145408, "timers": {"training_iteration_time_ms": 2212.757, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2212.657, "sample_time_ms": 907.033, "learn_time_ms": 1287.853, "learn_throughput": 795.122, "synch_weights_time_ms": 17.771}, "counters": {"num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "done": false, "training_iteration": 142, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-35", "timestamp": 1744110395, "time_this_iter_s": 2.194899082183838, "time_total_s": 310.6406207084656, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.6406207084656, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 43.23333333333334, "ram_util_percent": 85.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.158057247847319, "cur_kl_coeff": 3.5873240686715314e-44, "cur_lr": 1e-07, "total_loss": 2.144446436315775, "policy_loss": -0.00044957384816370907, "vf_loss": 9.747412294149399, "vf_explained_var": -1.969970762729645e-05, "kl": 3.4297996076571025e-06, "entropy": 2.919570578634739, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "env_runners": {"episode_reward_max": 189.80124454085566, "episode_reward_min": 111.83586652287822, "episode_reward_mean": 146.99675255329095, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.83586652287822}, "policy_reward_max": {"tplp_policy": 189.80124454085566}, "policy_reward_mean": {"tplp_policy": 146.99675255329095}, "custom_metrics": {"mean_episode_reward_mean": 146.99675255329095, "mean_episode_reward_min": 111.83586652287822, "mean_episode_reward_max": 189.80124454085566}, "hist_stats": {"episode_reward": [155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.19129418410864, 162.13144568436348, 165.13322149643977, 127.72684958833977, 126.23607151470931, 140.04279068115127, 150.1549380986545, 168.03270297497977, 139.0503023259297, 128.0866072852034, 152.96828123891433, 158.31126668303102, 163.81230664168606, 157.07488289415053, 149.35479643461792, 145.6907054354953, 162.3639545302686, 140.90857140679623, 139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6527564552058103, "mean_inference_ms": 1.8996755451372251, "mean_action_processing_ms": 0.35647147394903117, "mean_env_wait_ms": 2.113568003411876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005492687225341797, "StateBufferConnector_ms": 0.005544900894165039, "ViewRequirementAgentConnector_ms": 0.25334978103637695}, "num_episodes": 24, "episode_return_max": 189.80124454085566, "episode_return_min": 111.83586652287822, "episode_return_mean": 146.99675255329095, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 480.63402724583415, "num_env_steps_trained_throughput_per_sec": 480.63402724583415, "timesteps_total": 146432, "num_env_steps_sampled_lifetime": 146432, "num_agent_steps_sampled_lifetime": 146432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 146432, "timers": {"training_iteration_time_ms": 2219.184, "restore_workers_time_ms": 0.1, "training_step_time_ms": 2219.084, "sample_time_ms": 914.24, "learn_time_ms": 1286.654, "learn_throughput": 795.863, "synch_weights_time_ms": 18.19}, "counters": {"num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "done": false, "training_iteration": 143, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-37", "timestamp": 1744110397, "time_this_iter_s": 2.1359622478485107, "time_total_s": 312.7765829563141, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBECA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.7765829563141, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 27.675, "ram_util_percent": 85.475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.176774011924863, "cur_kl_coeff": 1.7936620343357657e-44, "cur_lr": 1e-07, "total_loss": 2.1852517440915107, "policy_loss": -0.00016791109228506685, "vf_loss": 9.909631264209747, "vf_explained_var": -3.69831919670105e-05, "kl": 1.3128586103139383e-06, "entropy": 2.9198816895484923, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "env_runners": {"episode_reward_max": 189.80124454085566, "episode_reward_min": 111.83586652287822, "episode_reward_mean": 145.84701258945796, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 111.83586652287822}, "policy_reward_max": {"tplp_policy": 189.80124454085566}, "policy_reward_mean": {"tplp_policy": 145.84701258945796}, "custom_metrics": {"mean_episode_reward_mean": 145.84701258945796, "mean_episode_reward_min": 111.83586652287822, "mean_episode_reward_max": 189.80124454085566}, "hist_stats": {"episode_reward": [139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.88970707240685, 133.54990178321773, 135.3203582722211, 166.48638412967165, 135.51725603295705, 136.2450951400076, 140.34665093897382, 111.83586652287822, 155.15063130030666, 157.95905701762433, 140.52581693757708, 153.18848885919076, 140.26696996177193, 144.8725485033791, 142.9415302993226, 160.1340126041622, 125.69282814432312, 144.88389576632426, 167.04440753515829, 166.70551695375187, 157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6526438823732948, "mean_inference_ms": 1.8997085686292214, "mean_action_processing_ms": 0.35660625091264814, "mean_env_wait_ms": 2.1136937848929396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0076215267181396484, "StateBufferConnector_ms": 0.0045468807220458984, "ViewRequirementAgentConnector_ms": 0.24326515197753906}, "num_episodes": 18, "episode_return_max": 189.80124454085566, "episode_return_min": 111.83586652287822, "episode_return_mean": 145.84701258945796, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 479.07730191424906, "num_env_steps_trained_throughput_per_sec": 479.07730191424906, "timesteps_total": 147456, "num_env_steps_sampled_lifetime": 147456, "num_agent_steps_sampled_lifetime": 147456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 147456, "timers": {"training_iteration_time_ms": 2204.297, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2204.297, "sample_time_ms": 906.074, "learn_time_ms": 1279.744, "learn_throughput": 800.16, "synch_weights_time_ms": 18.478}, "counters": {"num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "done": false, "training_iteration": 144, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-39", "timestamp": 1744110399, "time_this_iter_s": 2.1436872482299805, "time_total_s": 314.92027020454407, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE3E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.92027020454407, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 31.76666666666667, "ram_util_percent": 85.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.57274685241282, "cur_kl_coeff": 8.968310171678829e-45, "cur_lr": 1e-07, "total_loss": 2.162343996763229, "policy_loss": -0.00017570527270436287, "vf_loss": 9.818392634391785, "vf_explained_var": -2.9604509472846984e-05, "kl": 2.1206537337933875e-06, "entropy": 2.9207845270633697, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "env_runners": {"episode_reward_max": 189.80124454085566, "episode_reward_min": 116.62266278910485, "episode_reward_mean": 145.95367895822775, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.62266278910485}, "policy_reward_max": {"tplp_policy": 189.80124454085566}, "policy_reward_mean": {"tplp_policy": 145.95367895822775}, "custom_metrics": {"mean_episode_reward_mean": 145.95367895822775, "mean_episode_reward_min": 116.62266278910485, "mean_episode_reward_max": 189.80124454085566}, "hist_stats": {"episode_reward": [157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.71865301314782, 121.35321352901451, 118.11575277241272, 134.1199240477031, 160.4770399090711, 133.4765725300471, 153.45532540208407, 152.31971563265475, 159.8595090048308, 160.27093806635455, 135.81769645268994, 137.6419922673934, 150.16302738364976, 126.22654733939707, 156.45856319847763, 126.65144474749566, 133.60856643459763, 148.3652806547189, 137.32211141008995, 140.34834125588088, 174.4952398262525, 157.2393911530961, 151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.652790331423854, "mean_inference_ms": 1.8999416507712081, "mean_action_processing_ms": 0.35676328467991925, "mean_env_wait_ms": 2.113826916302737, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008618831634521484, "StateBufferConnector_ms": 0.00556182861328125, "ViewRequirementAgentConnector_ms": 0.24146318435668945}, "num_episodes": 20, "episode_return_max": 189.80124454085566, "episode_return_min": 116.62266278910485, "episode_return_mean": 145.95367895822775, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.37474099506335, "num_env_steps_trained_throughput_per_sec": 448.37474099506335, "timesteps_total": 148480, "num_env_steps_sampled_lifetime": 148480, "num_agent_steps_sampled_lifetime": 148480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 148480, "timers": {"training_iteration_time_ms": 2213.22, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.22, "sample_time_ms": 905.753, "learn_time_ms": 1288.653, "learn_throughput": 794.628, "synch_weights_time_ms": 18.763}, "counters": {"num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "done": false, "training_iteration": 145, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-42", "timestamp": 1744110402, "time_this_iter_s": 2.290357828140259, "time_total_s": 317.2106280326843, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 317.2106280326843, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 45.833333333333336, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6822363564744593, "cur_kl_coeff": 4.484155085839414e-45, "cur_lr": 1e-07, "total_loss": 2.1882861949503423, "policy_loss": -0.00018001138232648373, "vf_loss": 9.922493344545364, "vf_explained_var": -6.001293659210205e-05, "kl": 1.344011802296291e-06, "entropy": 2.9215712040662765, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "env_runners": {"episode_reward_max": 192.0072094591757, "episode_reward_min": 116.62266278910485, "episode_reward_mean": 146.43492928781262, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.62266278910485}, "policy_reward_max": {"tplp_policy": 192.0072094591757}, "policy_reward_mean": {"tplp_policy": 146.43492928781262}, "custom_metrics": {"mean_episode_reward_mean": 146.43492928781262, "mean_episode_reward_min": 116.62266278910485, "mean_episode_reward_max": 192.0072094591757}, "hist_stats": {"episode_reward": [151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.62250068137234, 135.82368407225445, 141.85832451765222, 165.86940226038197, 143.43363553516787, 130.51172967808716, 164.48324177634686, 136.18165723772137, 141.14934090129884, 156.89063503834785, 143.10724862542153, 139.6685147236662, 159.81221836373055, 137.6683822292384, 163.6725732967756, 166.53688639332913, 151.02136929256923, 132.61957751317235, 123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6529330103629326, "mean_inference_ms": 1.9002481883502498, "mean_action_processing_ms": 0.35697500320811765, "mean_env_wait_ms": 2.114264477407565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00811910629272461, "StateBufferConnector_ms": 0.005047798156738281, "ViewRequirementAgentConnector_ms": 0.22209787368774414}, "num_episodes": 22, "episode_return_max": 192.0072094591757, "episode_return_min": 116.62266278910485, "episode_return_mean": 146.43492928781262, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 473.33002451636764, "num_env_steps_trained_throughput_per_sec": 473.33002451636764, "timesteps_total": 149504, "num_env_steps_sampled_lifetime": 149504, "num_agent_steps_sampled_lifetime": 149504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 149504, "timers": {"training_iteration_time_ms": 2224.495, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2224.495, "sample_time_ms": 918.526, "learn_time_ms": 1287.304, "learn_throughput": 795.461, "synch_weights_time_ms": 18.614}, "counters": {"num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "done": false, "training_iteration": 146, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-44", "timestamp": 1744110404, "time_this_iter_s": 2.169663906097412, "time_total_s": 319.38029193878174, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.38029193878174, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 44.03333333333334, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4487785324454308, "cur_kl_coeff": 2.242077542919707e-45, "cur_lr": 1e-07, "total_loss": 2.182853338122368, "policy_loss": -0.00019984928658232093, "vf_loss": 9.900821447372437, "vf_explained_var": -3.33886593580246e-05, "kl": 1.8754473912530044e-06, "entropy": 2.9215215146541595, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "env_runners": {"episode_reward_max": 192.0072094591757, "episode_reward_min": 116.62266278910485, "episode_reward_mean": 145.94253900285156, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.62266278910485}, "policy_reward_max": {"tplp_policy": 192.0072094591757}, "policy_reward_mean": {"tplp_policy": 145.94253900285156}, "custom_metrics": {"mean_episode_reward_mean": 145.94253900285156, "mean_episode_reward_min": 116.62266278910485, "mean_episode_reward_max": 192.0072094591757}, "hist_stats": {"episode_reward": [123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [123.6781894902894, 162.39921666487365, 126.79077157147324, 147.38871615974443, 128.52421776594775, 135.18822127441598, 166.5166267243015, 148.45306632766238, 141.2450246536257, 156.99292385406343, 151.6412488946383, 157.37087138187843, 189.80124454085566, 159.38792133456684, 149.88641538750807, 131.7762511228375, 150.75585216203504, 137.1337462171727, 159.7868322346424, 137.10825878342135, 164.70721991226753, 144.87873782921397, 151.12917887269393, 143.63897441673103, 148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6529432006737588, "mean_inference_ms": 1.9002453693636738, "mean_action_processing_ms": 0.3570532638508266, "mean_env_wait_ms": 2.1142555244613788, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01214599609375, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.19793248176574707}, "num_episodes": 18, "episode_return_max": 192.0072094591757, "episode_return_min": 116.62266278910485, "episode_return_mean": 145.94253900285156, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 503.4424586089785, "num_env_steps_trained_throughput_per_sec": 503.4424586089785, "timesteps_total": 150528, "num_env_steps_sampled_lifetime": 150528, "num_agent_steps_sampled_lifetime": 150528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 2213.812, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.812, "sample_time_ms": 914.052, "learn_time_ms": 1281.577, "learn_throughput": 799.016, "synch_weights_time_ms": 18.132}, "counters": {"num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "done": false, "training_iteration": 147, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-46", "timestamp": 1744110406, "time_this_iter_s": 2.0385525226593018, "time_total_s": 321.41884446144104, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.41884446144104, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 29.5, "ram_util_percent": 85.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.27520813383162, "cur_kl_coeff": 1.1210387714598536e-45, "cur_lr": 1e-07, "total_loss": 2.1703540943562984, "policy_loss": -5.03986026160419e-05, "vf_loss": 9.850538337230683, "vf_explained_var": -2.4215131998062133e-05, "kl": 1.0576468056022748e-06, "entropy": 2.9223007217049597, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "env_runners": {"episode_reward_max": 192.0072094591757, "episode_reward_min": 116.62266278910485, "episode_reward_mean": 145.38833604681986, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.62266278910485}, "policy_reward_max": {"tplp_policy": 192.0072094591757}, "policy_reward_mean": {"tplp_policy": 145.38833604681986}, "custom_metrics": {"mean_episode_reward_mean": 145.38833604681986, "mean_episode_reward_min": 116.62266278910485, "mean_episode_reward_max": 192.0072094591757}, "hist_stats": {"episode_reward": [148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.8591525761423, 128.92120060741883, 142.4035811777889, 127.40433650665602, 117.66758517133914, 145.09543722520056, 129.60135535652063, 146.05657116734085, 168.46597140991486, 144.74027064081477, 162.5758730877225, 148.94586149296734, 145.1971518040035, 152.99703587709763, 126.24078102253043, 147.35667430265653, 116.62266278910485, 144.71975962265455, 138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6529744362978653, "mean_inference_ms": 1.900338308055895, "mean_action_processing_ms": 0.3571880555888681, "mean_env_wait_ms": 2.1142126466272426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011409282684326172, "StateBufferConnector_ms": 0.007008552551269531, "ViewRequirementAgentConnector_ms": 0.1985490322113037}, "num_episodes": 24, "episode_return_max": 192.0072094591757, "episode_return_min": 116.62266278910485, "episode_return_mean": 145.38833604681986, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 452.5367799302677, "num_env_steps_trained_throughput_per_sec": 452.5367799302677, "timesteps_total": 151552, "num_env_steps_sampled_lifetime": 151552, "num_agent_steps_sampled_lifetime": 151552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 151552, "timers": {"training_iteration_time_ms": 2210.982, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2210.982, "sample_time_ms": 908.107, "learn_time_ms": 1284.773, "learn_throughput": 797.028, "synch_weights_time_ms": 18.052}, "counters": {"num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "done": false, "training_iteration": 148, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-48", "timestamp": 1744110408, "time_this_iter_s": 2.272595167160034, "time_total_s": 323.6914396286011, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBECA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 323.6914396286011, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 37.333333333333336, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2907646425068378, "cur_kl_coeff": 5.605193857299268e-46, "cur_lr": 1e-07, "total_loss": 2.1668875485658647, "policy_loss": -0.00014729402610100806, "vf_loss": 9.83738499879837, "vf_explained_var": -3.5826489329338075e-05, "kl": 1.5102689105983558e-06, "entropy": 2.9231141418218614, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "env_runners": {"episode_reward_max": 192.0072094591757, "episode_reward_min": 117.07849641997429, "episode_reward_mean": 147.3343397506085, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 117.07849641997429}, "policy_reward_max": {"tplp_policy": 192.0072094591757}, "policy_reward_mean": {"tplp_policy": 147.3343397506085}, "custom_metrics": {"mean_episode_reward_mean": 147.3343397506085, "mean_episode_reward_min": 117.07849641997429, "mean_episode_reward_max": 192.0072094591757}, "hist_stats": {"episode_reward": [138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [138.09842500284878, 175.40082258313092, 130.47176708647802, 128.1416470272608, 141.01430662736524, 139.53195033159307, 157.23515866485067, 128.61079420156855, 160.8785603144906, 135.82057460611327, 160.42432260952728, 136.84794728171786, 141.58166243100678, 150.9451222881749, 141.2703029304921, 159.71138985204237, 151.73677099097594, 170.15961341080865, 153.4899562339117, 153.4523162323364, 147.0222949722242, 192.0072094591757, 147.39141245153593, 134.86014238377834, 141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6531128817374307, "mean_inference_ms": 1.9007458488249886, "mean_action_processing_ms": 0.35724612860706434, "mean_env_wait_ms": 2.1144973186452494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01236271858215332, "StateBufferConnector_ms": 0.01002359390258789, "ViewRequirementAgentConnector_ms": 0.2130730152130127}, "num_episodes": 18, "episode_return_max": 192.0072094591757, "episode_return_min": 117.07849641997429, "episode_return_mean": 147.3343397506085, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.66785414767764, "num_env_steps_trained_throughput_per_sec": 422.66785414767764, "timesteps_total": 152576, "num_env_steps_sampled_lifetime": 152576, "num_agent_steps_sampled_lifetime": 152576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 152576, "timers": {"training_iteration_time_ms": 2209.576, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2209.576, "sample_time_ms": 899.201, "learn_time_ms": 1292.263, "learn_throughput": 792.408, "synch_weights_time_ms": 18.061}, "counters": {"num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "done": false, "training_iteration": 149, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-51", "timestamp": 1744110411, "time_this_iter_s": 2.4285099506378174, "time_total_s": 326.1199495792389, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 326.1199495792389, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 36.949999999999996, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1314855944365263, "cur_kl_coeff": 2.802596928649634e-46, "cur_lr": 1e-07, "total_loss": 2.183662939071655, "policy_loss": -0.00011812862940132617, "vf_loss": 9.904410070180893, "vf_explained_var": -3.656968474388123e-05, "kl": 7.957395234736709e-07, "entropy": 2.923214453458786, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "env_runners": {"episode_reward_max": 187.94141950151027, "episode_reward_min": 117.07849641997429, "episode_reward_mean": 146.41787359641106, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 117.07849641997429}, "policy_reward_max": {"tplp_policy": 187.94141950151027}, "policy_reward_mean": {"tplp_policy": 146.41787359641106}, "custom_metrics": {"mean_episode_reward_mean": 146.41787359641106, "mean_episode_reward_min": 117.07849641997429, "mean_episode_reward_max": 187.94141950151027}, "hist_stats": {"episode_reward": [141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.53317285603705, 141.95981781061292, 140.7986433502252, 150.31039223021673, 136.33217504619205, 147.34650906608437, 162.00512476657735, 149.74646557249287, 146.23886527263448, 141.97011723483925, 152.9093411594617, 141.33484387676185, 145.95057622012123, 131.2336437383962, 136.91811037512727, 128.81874868080473, 165.26107339793938, 138.60268549447278, 158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.653345648129822, "mean_inference_ms": 1.9008715096687352, "mean_action_processing_ms": 0.35712262199257666, "mean_env_wait_ms": 2.114236337876801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010376930236816406, "StateBufferConnector_ms": 0.011509180068969727, "ViewRequirementAgentConnector_ms": 0.2064223289489746}, "num_episodes": 24, "episode_return_max": 187.94141950151027, "episode_return_min": 117.07849641997429, "episode_return_mean": 146.41787359641106, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 485.6436422713777, "num_env_steps_trained_throughput_per_sec": 485.6436422713777, "timesteps_total": 153600, "num_env_steps_sampled_lifetime": 153600, "num_agent_steps_sampled_lifetime": 153600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 153600, "timers": {"training_iteration_time_ms": 2208.853, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2208.853, "sample_time_ms": 897.789, "learn_time_ms": 1292.851, "learn_throughput": 792.048, "synch_weights_time_ms": 18.149}, "counters": {"num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "done": false, "training_iteration": 150, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-53", "timestamp": 1744110413, "time_this_iter_s": 2.1132678985595703, "time_total_s": 328.23321747779846, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD580>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 328.23321747779846, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 33.43333333333333, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.498369290679693, "cur_kl_coeff": 1.401298464324817e-46, "cur_lr": 1e-07, "total_loss": 2.179720038920641, "policy_loss": -0.00021317040082067252, "vf_loss": 9.889128631353378, "vf_explained_var": -4.5697018504142764e-05, "kl": 1.7760343296202574e-06, "entropy": 2.923489600419998, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "env_runners": {"episode_reward_max": 187.94141950151027, "episode_reward_min": 114.93094568429828, "episode_reward_mean": 146.3795106646075, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.93094568429828}, "policy_reward_max": {"tplp_policy": 187.94141950151027}, "policy_reward_mean": {"tplp_policy": 146.3795106646075}, "custom_metrics": {"mean_episode_reward_mean": 146.3795106646075, "mean_episode_reward_min": 114.93094568429828, "mean_episode_reward_max": 187.94141950151027}, "hist_stats": {"episode_reward": [158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [158.76894209271714, 139.19110287598505, 143.96681752718086, 169.45765884563596, 129.49735606579756, 133.97011134836416, 143.34792789350206, 151.64281516332304, 148.45400632532068, 135.96480630344126, 146.6971625956532, 158.26212301574844, 140.09158472947772, 128.31295774049445, 127.44730848972686, 153.75545373564663, 145.0761388339123, 152.2818520040341, 131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6532157485205036, "mean_inference_ms": 1.9007151299025367, "mean_action_processing_ms": 0.3570909091992172, "mean_env_wait_ms": 2.1140982410728135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011383533477783203, "StateBufferConnector_ms": 0.010511398315429688, "ViewRequirementAgentConnector_ms": 0.20677781105041504}, "num_episodes": 18, "episode_return_max": 187.94141950151027, "episode_return_min": 114.93094568429828, "episode_return_mean": 146.3795106646075, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 499.9754138273881, "num_env_steps_trained_throughput_per_sec": 499.9754138273881, "timesteps_total": 154624, "num_env_steps_sampled_lifetime": 154624, "num_agent_steps_sampled_lifetime": 154624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 154624, "timers": {"training_iteration_time_ms": 2178.036, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2178.036, "sample_time_ms": 890.214, "learn_time_ms": 1270.01, "learn_throughput": 806.293, "synch_weights_time_ms": 17.747}, "counters": {"num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "done": false, "training_iteration": 151, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-55", "timestamp": 1744110415, "time_this_iter_s": 2.054232597351074, "time_total_s": 330.28745007514954, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.28745007514954, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 30.13333333333333, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.915250137448311, "cur_kl_coeff": 7.006492321624085e-47, "cur_lr": 1e-07, "total_loss": 2.1887841552495955, "policy_loss": -0.0002992570283822715, "vf_loss": 9.925547909736633, "vf_explained_var": -5.7807937264442447e-05, "kl": 2.093149595783217e-06, "entropy": 2.9230356216430664, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "env_runners": {"episode_reward_max": 187.94141950151027, "episode_reward_min": 114.93094568429828, "episode_reward_mean": 146.35431642209707, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.93094568429828}, "policy_reward_max": {"tplp_policy": 187.94141950151027}, "policy_reward_mean": {"tplp_policy": 146.35431642209707}, "custom_metrics": {"mean_episode_reward_mean": 146.35431642209707, "mean_episode_reward_min": 114.93094568429828, "mean_episode_reward_max": 187.94141950151027}, "hist_stats": {"episode_reward": [131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [131.31766099167152, 137.8211066744464, 151.077796472002, 161.0417789516014, 132.74580865225698, 133.7499148271266, 135.5607151980101, 187.94141950151027, 153.25635206264076, 145.98979532360102, 145.08994250678867, 156.6825295649114, 127.4477394558813, 152.3466992088304, 164.85910704217903, 142.95557756504738, 117.07849641997429, 144.66979863932426, 161.18459202976848, 147.28435343839516, 125.70530839211139, 157.59494821766452, 161.85208066118304, 152.1986244824526, 147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.653272869178442, "mean_inference_ms": 1.9010279412299993, "mean_action_processing_ms": 0.357038235041979, "mean_env_wait_ms": 2.1141213468354425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009467601776123047, "StateBufferConnector_ms": 0.009543180465698242, "ViewRequirementAgentConnector_ms": 0.20826077461242676}, "num_episodes": 18, "episode_return_max": 187.94141950151027, "episode_return_min": 114.93094568429828, "episode_return_mean": 146.35431642209707, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 424.1551319458401, "num_env_steps_trained_throughput_per_sec": 424.1551319458401, "timesteps_total": 155648, "num_env_steps_sampled_lifetime": 155648, "num_agent_steps_sampled_lifetime": 155648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 155648, "timers": {"training_iteration_time_ms": 2200.552, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2200.552, "sample_time_ms": 893.445, "learn_time_ms": 1289.039, "learn_throughput": 794.39, "synch_weights_time_ms": 18.003}, "counters": {"num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "done": false, "training_iteration": 152, "trial_id": "b517c_00000", "date": "2025-04-08_19-06-58", "timestamp": 1744110418, "time_this_iter_s": 2.420694589614868, "time_total_s": 332.7081446647644, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.7081446647644, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 40.025000000000006, "ram_util_percent": 85.725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2105597238987684, "cur_kl_coeff": 3.5032461608120424e-47, "cur_lr": 1e-07, "total_loss": 2.185802116245031, "policy_loss": -0.00010525176185183227, "vf_loss": 9.912888783216477, "vf_explained_var": -3.68557870388031e-05, "kl": 1.9008717165647226e-06, "entropy": 2.923147989809513, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "env_runners": {"episode_reward_max": 180.85156682806138, "episode_reward_min": 114.93094568429828, "episode_reward_mean": 146.84985626808495, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.93094568429828}, "policy_reward_max": {"tplp_policy": 180.85156682806138}, "policy_reward_mean": {"tplp_policy": 146.84985626808495}, "custom_metrics": {"mean_episode_reward_mean": 146.84985626808495, "mean_episode_reward_min": 114.93094568429828, "mean_episode_reward_max": 180.85156682806138}, "hist_stats": {"episode_reward": [147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.0414959533982, 157.05234247399426, 135.67795100200624, 170.0342619764879, 146.90001076822367, 134.6878580912443, 158.5804663241907, 131.00066938020223, 175.489958923364, 160.54820848733982, 149.03343948718046, 151.86922185114128, 141.4396195989889, 158.50276592452917, 159.6936384026021, 146.8690184282136, 134.10987393395467, 147.89845841380136, 135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6535131617766843, "mean_inference_ms": 1.9019373762273266, "mean_action_processing_ms": 0.35696256552866557, "mean_env_wait_ms": 2.1145145616933276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007212400436401367, "StateBufferConnector_ms": 0.008678197860717773, "ViewRequirementAgentConnector_ms": 0.21297287940979004}, "num_episodes": 24, "episode_return_max": 180.85156682806138, "episode_return_min": 114.93094568429828, "episode_return_mean": 146.84985626808495, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.0749942621879, "num_env_steps_trained_throughput_per_sec": 466.0749942621879, "timesteps_total": 156672, "num_env_steps_sampled_lifetime": 156672, "num_agent_steps_sampled_lifetime": 156672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 156672, "timers": {"training_iteration_time_ms": 2207.207, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2207.207, "sample_time_ms": 905.176, "learn_time_ms": 1284.62, "learn_throughput": 797.123, "synch_weights_time_ms": 17.345}, "counters": {"num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "done": false, "training_iteration": 153, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-00", "timestamp": 1744110420, "time_this_iter_s": 2.2038989067077637, "time_total_s": 334.91204357147217, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23BA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.91204357147217, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 47.9, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3794772032648326, "cur_kl_coeff": 1.7516230804060212e-47, "cur_lr": 1e-07, "total_loss": 2.170970951020718, "policy_loss": -9.788068418856711e-05, "vf_loss": 9.854092919826508, "vf_explained_var": -3.604888916015625e-05, "kl": 7.660953319721386e-07, "entropy": 2.924544130265713, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "env_runners": {"episode_reward_max": 180.85156682806138, "episode_reward_min": 114.93094568429828, "episode_reward_mean": 146.17655604728535, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.93094568429828}, "policy_reward_max": {"tplp_policy": 180.85156682806138}, "policy_reward_mean": {"tplp_policy": 146.17655604728535}, "custom_metrics": {"mean_episode_reward_mean": 146.17655604728535, "mean_episode_reward_min": 114.93094568429828, "mean_episode_reward_max": 180.85156682806138}, "hist_stats": {"episode_reward": [135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.13546316558006, 143.29079936197536, 158.71752542409862, 148.82158942907546, 133.66749292035922, 136.22095374320008, 149.43135741861016, 140.19765338799567, 148.3311286065051, 136.02940745341496, 140.47644708727725, 124.41114041632295, 168.01150755053803, 151.34224264575977, 160.24224993111565, 135.38370166911258, 146.24610137873626, 144.92111805697647, 158.85929663235302, 148.98971241251888, 140.25635658193744, 153.46627693244196, 156.64984394479896, 147.77554286992685, 146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6534919973012114, "mean_inference_ms": 1.902275661524528, "mean_action_processing_ms": 0.3568832048751146, "mean_env_wait_ms": 2.114481311432124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007323741912841797, "StateBufferConnector_ms": 0.007195711135864258, "ViewRequirementAgentConnector_ms": 0.20691728591918945}, "num_episodes": 18, "episode_return_max": 180.85156682806138, "episode_return_min": 114.93094568429828, "episode_return_mean": 146.17655604728535, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 505.4535018661909, "num_env_steps_trained_throughput_per_sec": 505.4535018661909, "timesteps_total": 157696, "num_env_steps_sampled_lifetime": 157696, "num_agent_steps_sampled_lifetime": 157696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 157696, "timers": {"training_iteration_time_ms": 2196.053, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2195.938, "sample_time_ms": 903.365, "learn_time_ms": 1275.84, "learn_throughput": 802.609, "synch_weights_time_ms": 16.668}, "counters": {"num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "done": false, "training_iteration": 154, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-02", "timestamp": 1744110422, "time_this_iter_s": 2.0301949977874756, "time_total_s": 336.94223856925964, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C21080>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 336.94223856925964, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 31.166666666666668, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.692822740226984, "cur_kl_coeff": 8.758115402030106e-48, "cur_lr": 1e-07, "total_loss": 2.1774367943406103, "policy_loss": -0.00016921076748985798, "vf_loss": 9.880607867240906, "vf_explained_var": -2.8190016746520995e-05, "kl": 2.345155955563172e-06, "entropy": 2.9254598021507263, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "env_runners": {"episode_reward_max": 180.85156682806138, "episode_reward_min": 114.93094568429828, "episode_reward_mean": 147.43080217215223, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.93094568429828}, "policy_reward_max": {"tplp_policy": 180.85156682806138}, "policy_reward_mean": {"tplp_policy": 147.43080217215223}, "custom_metrics": {"mean_episode_reward_mean": 147.43080217215223, "mean_episode_reward_min": 114.93094568429828, "mean_episode_reward_max": 180.85156682806138}, "hist_stats": {"episode_reward": [146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [146.09186571600398, 157.80572344532874, 172.22999237766706, 130.78211601770562, 124.76377032810967, 114.93094568429828, 149.59768761965873, 148.28233851322176, 134.71730851025364, 166.04647359664008, 124.05762251188834, 149.72358730096965, 124.76159317196958, 161.40566494946717, 143.1683332556348, 142.64360315509833, 159.74628382631337, 136.78287817112388, 118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6535583172527721, "mean_inference_ms": 1.9028294323932657, "mean_action_processing_ms": 0.3568019824051183, "mean_env_wait_ms": 2.114544059978644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008321046829223633, "StateBufferConnector_ms": 0.006208181381225586, "ViewRequirementAgentConnector_ms": 0.2066056728363037}, "num_episodes": 24, "episode_return_max": 180.85156682806138, "episode_return_min": 114.93094568429828, "episode_return_mean": 147.43080217215223, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 469.1436872986599, "num_env_steps_trained_throughput_per_sec": 469.1436872986599, "timesteps_total": 158720, "num_env_steps_sampled_lifetime": 158720, "num_agent_steps_sampled_lifetime": 158720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 158720, "timers": {"training_iteration_time_ms": 2185.943, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2185.827, "sample_time_ms": 898.055, "learn_time_ms": 1271.21, "learn_throughput": 805.532, "synch_weights_time_ms": 16.548}, "counters": {"num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "done": false, "training_iteration": 155, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-04", "timestamp": 1744110424, "time_this_iter_s": 2.189181089401245, "time_total_s": 339.1314196586609, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 339.1314196586609, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 39.699999999999996, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.48004137724638, "cur_kl_coeff": 4.379057701015053e-48, "cur_lr": 1e-07, "total_loss": 2.1670616969466208, "policy_loss": -0.0001765542256180197, "vf_loss": 9.839849877357484, "vf_explained_var": -3.487318754196167e-05, "kl": 2.3788081647151126e-06, "entropy": 2.9272421285510064, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "env_runners": {"episode_reward_max": 180.85156682806138, "episode_reward_min": 117.54071073921986, "episode_reward_mean": 149.02028600053976, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 117.54071073921986}, "policy_reward_max": {"tplp_policy": 180.85156682806138}, "policy_reward_mean": {"tplp_policy": 149.02028600053976}, "custom_metrics": {"mean_episode_reward_mean": 149.02028600053976, "mean_episode_reward_min": 117.54071073921986, "mean_episode_reward_max": 180.85156682806138}, "hist_stats": {"episode_reward": [118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [118.53044710215953, 138.00269838114468, 173.190287758318, 138.385907648506, 117.54071073921986, 158.4799451143396, 164.60401336306606, 122.7148462137767, 158.40955087961433, 169.49322458916572, 130.60224579297306, 145.41138640527592, 148.45644697314148, 129.2288752844365, 159.93215662272965, 134.1547964696144, 130.4687796457938, 155.53099386158434, 135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6536238815566865, "mean_inference_ms": 1.9033430469480543, "mean_action_processing_ms": 0.35678844779442215, "mean_env_wait_ms": 2.1147499100827436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008083820343017578, "StateBufferConnector_ms": 0.008212089538574219, "ViewRequirementAgentConnector_ms": 0.20769834518432617}, "num_episodes": 18, "episode_return_max": 180.85156682806138, "episode_return_min": 117.54071073921986, "episode_return_mean": 149.02028600053976, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.6143700606877, "num_env_steps_trained_throughput_per_sec": 422.6143700606877, "timesteps_total": 159744, "num_env_steps_sampled_lifetime": 159744, "num_agent_steps_sampled_lifetime": 159744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 159744, "timers": {"training_iteration_time_ms": 2211.904, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2211.789, "sample_time_ms": 892.101, "learn_time_ms": 1302.674, "learn_throughput": 786.076, "synch_weights_time_ms": 17.0}, "counters": {"num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "done": false, "training_iteration": 156, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-07", "timestamp": 1744110427, "time_this_iter_s": 2.429307699203491, "time_total_s": 341.5607273578644, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C227A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 341.5607273578644, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 44.06666666666667, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193517791107297, "cur_kl_coeff": 2.1895288505075265e-48, "cur_lr": 1e-07, "total_loss": 2.1692876264452936, "policy_loss": -0.00018148820381611586, "vf_loss": 9.848999583721161, "vf_explained_var": -2.125389873981476e-05, "kl": 1.438404793041581e-06, "entropy": 2.9278079852461816, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "env_runners": {"episode_reward_max": 180.85156682806138, "episode_reward_min": 123.59749692000737, "episode_reward_mean": 149.52159453866818, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.59749692000737}, "policy_reward_max": {"tplp_policy": 180.85156682806138}, "policy_reward_mean": {"tplp_policy": 149.52159453866818}, "custom_metrics": {"mean_episode_reward_mean": 149.52159453866818, "mean_episode_reward_min": 123.59749692000737, "mean_episode_reward_max": 180.85156682806138}, "hist_stats": {"episode_reward": [135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.88848049965128, 150.69837919638204, 147.08722869952004, 155.67555141149094, 143.0139981708673, 143.68665803849134, 150.1298634018871, 141.23760050998413, 147.42627989318763, 158.3845779813068, 160.18721772330537, 144.51985745438998, 150.56707182852583, 180.85156682806138, 138.8031622245905, 160.3472843816257, 142.63588561446602, 150.63926879487857, 150.0337037383099, 155.59147183371581, 150.50515652624566, 133.0960926199062, 175.84728028877825, 136.04947519512143, 150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6536109434901012, "mean_inference_ms": 1.9035455763808855, "mean_action_processing_ms": 0.3567937152644464, "mean_env_wait_ms": 2.114823997166512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00702357292175293, "StateBufferConnector_ms": 0.01054525375366211, "ViewRequirementAgentConnector_ms": 0.20047783851623535}, "num_episodes": 18, "episode_return_max": 180.85156682806138, "episode_return_min": 123.59749692000737, "episode_return_mean": 149.52159453866818, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 485.6216231373386, "num_env_steps_trained_throughput_per_sec": 485.6216231373386, "timesteps_total": 160768, "num_env_steps_sampled_lifetime": 160768, "num_agent_steps_sampled_lifetime": 160768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 160768, "timers": {"training_iteration_time_ms": 2219.368, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2219.253, "sample_time_ms": 899.162, "learn_time_ms": 1302.631, "learn_throughput": 786.101, "synch_weights_time_ms": 17.396}, "counters": {"num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "done": false, "training_iteration": 157, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-09", "timestamp": 1744110429, "time_this_iter_s": 2.1134183406829834, "time_total_s": 343.67414569854736, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 343.67414569854736, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 31.55, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5848474260419607, "cur_kl_coeff": 1.0947644252537632e-48, "cur_lr": 1e-07, "total_loss": 2.166629946231842, "policy_loss": -0.00014232753310352563, "vf_loss": 9.838268798589706, "vf_explained_var": -4.10228967666626e-05, "kl": 1.8568957167383604e-06, "entropy": 2.927949498593807, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "env_runners": {"episode_reward_max": 177.34281640661854, "episode_reward_min": 123.59749692000737, "episode_reward_mean": 149.71549243372817, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.59749692000737}, "policy_reward_max": {"tplp_policy": 177.34281640661854}, "policy_reward_mean": {"tplp_policy": 149.71549243372817}, "custom_metrics": {"mean_episode_reward_mean": 149.71549243372817, "mean_episode_reward_min": 123.59749692000737, "mean_episode_reward_max": 177.34281640661854}, "hist_stats": {"episode_reward": [150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [150.54690257741342, 132.6224611754217, 140.4298520872585, 135.3000442836733, 149.0714759767641, 141.81507961984676, 146.40944610216195, 160.5059969185714, 135.37254221572238, 170.24570551983473, 130.9655706518368, 149.78459123332374, 148.0688096392352, 166.90568116799548, 128.54981856682355, 140.60850412111836, 163.48830698550648, 151.21523827756258, 159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6533658984330338, "mean_inference_ms": 1.9031467131875635, "mean_action_processing_ms": 0.35672233189844677, "mean_env_wait_ms": 2.114523180245283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00702357292175293, "StateBufferConnector_ms": 0.011380910873413086, "ViewRequirementAgentConnector_ms": 0.18981146812438965}, "num_episodes": 24, "episode_return_max": 177.34281640661854, "episode_return_min": 123.59749692000737, "episode_return_mean": 149.71549243372817, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 493.80948995242375, "num_env_steps_trained_throughput_per_sec": 493.80948995242375, "timesteps_total": 161792, "num_env_steps_sampled_lifetime": 161792, "num_agent_steps_sampled_lifetime": 161792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 161792, "timers": {"training_iteration_time_ms": 2200.456, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2200.206, "sample_time_ms": 895.76, "learn_time_ms": 1286.97, "learn_throughput": 795.668, "synch_weights_time_ms": 17.412}, "counters": {"num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "done": false, "training_iteration": 158, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-11", "timestamp": 1744110431, "time_this_iter_s": 2.078700304031372, "time_total_s": 345.75284600257874, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBFB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.75284600257874, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 32.699999999999996, "ram_util_percent": 85.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1956687362864615, "cur_kl_coeff": 5.473822126268816e-49, "cur_lr": 1e-07, "total_loss": 2.1623773105442523, "policy_loss": -0.00010834317072294652, "vf_loss": 9.821383786201476, "vf_explained_var": -4.698708653450012e-05, "kl": 9.86818555226421e-07, "entropy": 2.9286027774214745, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "env_runners": {"episode_reward_max": 177.34281640661854, "episode_reward_min": 118.38087225691262, "episode_reward_mean": 149.0998989276789, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.38087225691262}, "policy_reward_max": {"tplp_policy": 177.34281640661854}, "policy_reward_mean": {"tplp_policy": 149.0998989276789}, "custom_metrics": {"mean_episode_reward_mean": 149.0998989276789, "mean_episode_reward_min": 118.38087225691262, "mean_episode_reward_max": 177.34281640661854}, "hist_stats": {"episode_reward": [159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [159.33941062453042, 171.40846807179204, 139.63657146020253, 161.3446186147275, 130.02252606609198, 163.77555854596525, 148.350928587885, 161.9523388723035, 153.68704286434829, 143.36537961604563, 134.84043520255798, 153.14253931410704, 161.33945152166282, 160.08343303878485, 146.10023818281374, 131.60754531399434, 165.50943412446884, 150.68787158377404, 138.55622560142376, 142.35324427957363, 148.9244721696592, 151.56824258753778, 147.9817230097267, 147.13213881122562, 152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6532560479839624, "mean_inference_ms": 1.9029704343462424, "mean_action_processing_ms": 0.3567069081285071, "mean_env_wait_ms": 2.1143010434033203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005147218704223633, "StateBufferConnector_ms": 0.011356592178344727, "ViewRequirementAgentConnector_ms": 0.19257330894470215}, "num_episodes": 18, "episode_return_max": 177.34281640661854, "episode_return_min": 118.38087225691262, "episode_return_mean": 149.0998989276789, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 453.8222368460816, "num_env_steps_trained_throughput_per_sec": 453.8222368460816, "timesteps_total": 162816, "num_env_steps_sampled_lifetime": 162816, "num_agent_steps_sampled_lifetime": 162816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 162816, "timers": {"training_iteration_time_ms": 2183.824, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2183.574, "sample_time_ms": 887.789, "learn_time_ms": 1278.031, "learn_throughput": 801.232, "synch_weights_time_ms": 17.689}, "counters": {"num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "done": false, "training_iteration": 159, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-13", "timestamp": 1744110433, "time_this_iter_s": 2.2616255283355713, "time_total_s": 348.0144715309143, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 348.0144715309143, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 36.233333333333334, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5151793219149114, "cur_kl_coeff": 2.736911063134408e-49, "cur_lr": 1e-07, "total_loss": 2.1815921008586883, "policy_loss": -4.53642918728292e-05, "vf_loss": 9.898181301355361, "vf_explained_var": -5.351118743419647e-05, "kl": 8.707368039873042e-07, "entropy": 2.929078671336174, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "env_runners": {"episode_reward_max": 178.1975576706543, "episode_reward_min": 118.38087225691262, "episode_reward_mean": 149.3125660602619, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.38087225691262}, "policy_reward_max": {"tplp_policy": 178.1975576706543}, "policy_reward_mean": {"tplp_policy": 149.3125660602619}, "custom_metrics": {"mean_episode_reward_mean": 149.3125660602619, "mean_episode_reward_min": 118.38087225691262, "mean_episode_reward_max": 178.1975576706543}, "hist_stats": {"episode_reward": [152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.064445080734, 156.16895245813234, 130.56676292416685, 148.52893848585515, 165.56488123062823, 155.28702320599336, 154.9095275496788, 146.80789239808396, 162.15230800777468, 164.40972458687216, 157.34530853989858, 123.59749692000737, 151.76456198422858, 167.18404723943334, 153.6329324466359, 161.38750611103163, 144.72068529139273, 131.44439132973972, 132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6530744327005844, "mean_inference_ms": 1.902970803122047, "mean_action_processing_ms": 0.35675141248946446, "mean_env_wait_ms": 2.1141463194801693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006144285202026367, "StateBufferConnector_ms": 0.014421939849853516, "ViewRequirementAgentConnector_ms": 0.18355679512023926}, "num_episodes": 24, "episode_return_max": 178.1975576706543, "episode_return_min": 118.38087225691262, "episode_return_mean": 149.3125660602619, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 455.0670856635612, "num_env_steps_trained_throughput_per_sec": 455.0670856635612, "timesteps_total": 163840, "num_env_steps_sampled_lifetime": 163840, "num_agent_steps_sampled_lifetime": 163840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 163840, "timers": {"training_iteration_time_ms": 2197.992, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2197.742, "sample_time_ms": 895.989, "learn_time_ms": 1283.775, "learn_throughput": 797.647, "synch_weights_time_ms": 17.927}, "counters": {"num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "done": false, "training_iteration": 160, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-16", "timestamp": 1744110436, "time_this_iter_s": 2.255906343460083, "time_total_s": 350.2703778743744, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.2703778743744, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 44.23333333333333, "ram_util_percent": 85.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5991061866283416, "cur_kl_coeff": 1.368455531567204e-49, "cur_lr": 1e-07, "total_loss": 2.1648080207407476, "policy_loss": -0.0002785879885777831, "vf_loss": 9.83217050433159, "vf_explained_var": -5.190223455429077e-05, "kl": 2.1352147375433563e-06, "entropy": 2.9295602843165396, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "env_runners": {"episode_reward_max": 180.19869822056557, "episode_reward_min": 118.38087225691262, "episode_reward_mean": 148.27480514835926, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.38087225691262}, "policy_reward_max": {"tplp_policy": 180.19869822056557}, "policy_reward_mean": {"tplp_policy": 148.27480514835926}, "custom_metrics": {"mean_episode_reward_mean": 148.27480514835926, "mean_episode_reward_min": 118.38087225691262, "mean_episode_reward_max": 180.19869822056557}, "hist_stats": {"episode_reward": [132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [132.17580478753547, 135.71202866483017, 156.6818879134174, 152.44903290940778, 165.43710870790156, 157.5467235722475, 149.6289024610327, 137.79929003701554, 145.71012040590102, 155.60365919616032, 139.12364235759867, 146.25416841318838, 136.24697323627402, 164.6045441790846, 139.36755759484714, 152.7616456001279, 153.0973603004974, 147.3881532787321, 157.08680168346044, 153.90064502600126, 138.58522429895544, 161.93481522573708, 158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6529256432209998, "mean_inference_ms": 1.9028520852151363, "mean_action_processing_ms": 0.3567701906356884, "mean_env_wait_ms": 2.1138519979460817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005374908447265625, "StateBufferConnector_ms": 0.014417409896850586, "ViewRequirementAgentConnector_ms": 0.18163490295410156}, "num_episodes": 18, "episode_return_max": 180.19869822056557, "episode_return_min": 118.38087225691262, "episode_return_mean": 148.27480514835926, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.0012245739932, "num_env_steps_trained_throughput_per_sec": 486.0012245739932, "timesteps_total": 164864, "num_env_steps_sampled_lifetime": 164864, "num_agent_steps_sampled_lifetime": 164864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 164864, "timers": {"training_iteration_time_ms": 2203.881, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2203.631, "sample_time_ms": 896.387, "learn_time_ms": 1289.232, "learn_throughput": 794.272, "synch_weights_time_ms": 17.962}, "counters": {"num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "done": false, "training_iteration": 161, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-18", "timestamp": 1744110438, "time_this_iter_s": 2.1130380630493164, "time_total_s": 352.3834159374237, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 352.3834159374237, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 34.26666666666667, "ram_util_percent": 85.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.375868346169591, "cur_kl_coeff": 6.84227765783602e-50, "cur_lr": 1e-07, "total_loss": 2.1812944918870927, "policy_loss": -0.0001698775915428996, "vf_loss": 9.897849148511886, "vf_explained_var": -4.432722926139832e-06, "kl": 1.8973421241241794e-06, "entropy": 2.9299791663885117, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "env_runners": {"episode_reward_max": 180.19869822056557, "episode_reward_min": 118.38087225691262, "episode_reward_mean": 148.4271540552531, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.38087225691262}, "policy_reward_max": {"tplp_policy": 180.19869822056557}, "policy_reward_mean": {"tplp_policy": 148.4271540552531}, "custom_metrics": {"mean_episode_reward_mean": 148.4271540552531, "mean_episode_reward_min": 118.38087225691262, "mean_episode_reward_max": 180.19869822056557}, "hist_stats": {"episode_reward": [158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [158.71582846616187, 177.34281640661854, 168.22197247362948, 144.05846080089088, 162.4676294753516, 139.1261151474942, 137.36301934610444, 134.9209074202116, 141.87142178282937, 151.23160560800954, 146.89536168470127, 151.3748434180172, 158.61069638657065, 155.34357329868712, 160.38315813324732, 142.1113120840107, 141.80118112061905, 138.45999949414644, 164.05309426221083, 142.06089800185424, 156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6528994383508528, "mean_inference_ms": 1.9027492351058348, "mean_action_processing_ms": 0.3566714984535138, "mean_env_wait_ms": 2.113272349598544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063190460205078125, "StateBufferConnector_ms": 0.016118526458740234, "ViewRequirementAgentConnector_ms": 0.19841217994689941}, "num_episodes": 22, "episode_return_max": 180.19869822056557, "episode_return_min": 118.38087225691262, "episode_return_mean": 148.4271540552531, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 495.0674191287669, "num_env_steps_trained_throughput_per_sec": 495.0674191287669, "timesteps_total": 165888, "num_env_steps_sampled_lifetime": 165888, "num_agent_steps_sampled_lifetime": 165888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 165888, "timers": {"training_iteration_time_ms": 2169.3, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2169.05, "sample_time_ms": 887.078, "learn_time_ms": 1263.909, "learn_throughput": 810.185, "synch_weights_time_ms": 17.886}, "counters": {"num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "done": false, "training_iteration": 162, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-20", "timestamp": 1744110440, "time_this_iter_s": 2.0745186805725098, "time_total_s": 354.4579346179962, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 354.4579346179962, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 34.1, "ram_util_percent": 85.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4105613220483066, "cur_kl_coeff": 3.42113882891801e-50, "cur_lr": 1e-07, "total_loss": 2.1579815104603766, "policy_loss": -0.00014474591007456182, "vf_loss": 9.805008763074875, "vf_explained_var": -3.954581916332245e-05, "kl": 2.178639958881623e-06, "entropy": 2.931259310245514, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "env_runners": {"episode_reward_max": 180.19869822056557, "episode_reward_min": 118.38087225691262, "episode_reward_mean": 148.02347527603553, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.38087225691262}, "policy_reward_max": {"tplp_policy": 180.19869822056557}, "policy_reward_mean": {"tplp_policy": 148.02347527603553}, "custom_metrics": {"mean_episode_reward_mean": 148.02347527603553, "mean_episode_reward_min": 118.38087225691262, "mean_episode_reward_max": 180.19869822056557}, "hist_stats": {"episode_reward": [156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [156.29439216567388, 158.7629417490864, 118.38087225691262, 138.64554741421145, 156.288072558699, 145.054887554858, 127.09282391315976, 143.1138227828184, 147.83038173596785, 148.3549346618896, 127.83275079213672, 142.3310128307681, 148.54163765869004, 137.5220727950383, 140.5329070582019, 137.65362632296788, 152.07037247451117, 145.89768208765764, 159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6526994014017755, "mean_inference_ms": 1.9027723844978266, "mean_action_processing_ms": 0.3567982351337466, "mean_env_wait_ms": 2.1133428941772814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010534048080444336, "StateBufferConnector_ms": 0.012125253677368164, "ViewRequirementAgentConnector_ms": 0.19801974296569824}, "num_episodes": 20, "episode_return_max": 180.19869822056557, "episode_return_min": 118.38087225691262, "episode_return_mean": 148.02347527603553, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 461.4455588937943, "num_env_steps_trained_throughput_per_sec": 461.4455588937943, "timesteps_total": 166912, "num_env_steps_sampled_lifetime": 166912, "num_agent_steps_sampled_lifetime": 166912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 166912, "timers": {"training_iteration_time_ms": 2171.504, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2171.255, "sample_time_ms": 879.115, "learn_time_ms": 1273.976, "learn_throughput": 803.783, "synch_weights_time_ms": 17.986}, "counters": {"num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "done": false, "training_iteration": 163, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-22", "timestamp": 1744110442, "time_this_iter_s": 2.225858211517334, "time_total_s": 356.68379282951355, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 356.68379282951355, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 43.400000000000006, "ram_util_percent": 85.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.814955275505781, "cur_kl_coeff": 1.710569414459005e-50, "cur_lr": 1e-07, "total_loss": 2.1571427308022977, "policy_loss": -0.00043507074005901816, "vf_loss": 9.802848035097123, "vf_explained_var": -4.943013191223144e-05, "kl": 3.4945015048304384e-06, "entropy": 2.9313421085476876, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "env_runners": {"episode_reward_max": 180.19869822056557, "episode_reward_min": 115.58167027670882, "episode_reward_mean": 148.16244228049294, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.58167027670882}, "policy_reward_max": {"tplp_policy": 180.19869822056557}, "policy_reward_mean": {"tplp_policy": 148.16244228049294}, "custom_metrics": {"mean_episode_reward_mean": 148.16244228049294, "mean_episode_reward_min": 115.58167027670882, "mean_episode_reward_max": 180.19869822056557}, "hist_stats": {"episode_reward": [159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [159.25730999197702, 149.10528747657003, 161.0723022851294, 169.48088298365235, 163.19999823074528, 138.35509697595248, 159.118354302843, 141.00629446841458, 150.7151420388498, 164.54007123701535, 154.55402121745377, 134.1588769814971, 141.65771643785348, 156.27980989271273, 139.05020498681847, 156.9950093106234, 153.6009953023552, 137.16325386064756, 143.39902043724263, 139.794594115139, 145.30669655718742, 178.1975576706543, 151.3205591931039, 145.27073810694336, 137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.652681408504391, "mean_inference_ms": 1.9030550880501522, "mean_action_processing_ms": 0.3568512245298317, "mean_env_wait_ms": 2.113578334564806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009201765060424805, "StateBufferConnector_ms": 0.01113128662109375, "ViewRequirementAgentConnector_ms": 0.19172310829162598}, "num_episodes": 18, "episode_return_max": 180.19869822056557, "episode_return_min": 115.58167027670882, "episode_return_mean": 148.16244228049294, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.7662283716373, "num_env_steps_trained_throughput_per_sec": 467.7662283716373, "timesteps_total": 167936, "num_env_steps_sampled_lifetime": 167936, "num_agent_steps_sampled_lifetime": 167936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 167936, "timers": {"training_iteration_time_ms": 2187.827, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2187.692, "sample_time_ms": 891.975, "learn_time_ms": 1277.41, "learn_throughput": 801.622, "synch_weights_time_ms": 18.13}, "counters": {"num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "done": false, "training_iteration": 164, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-24", "timestamp": 1744110444, "time_this_iter_s": 2.1939890384674072, "time_total_s": 358.87778186798096, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 358.87778186798096, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 35.400000000000006, "ram_util_percent": 85.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9362533517181872, "cur_kl_coeff": 8.552847072295025e-51, "cur_lr": 1e-07, "total_loss": 2.180938272178173, "policy_loss": -0.0002869516029022634, "vf_loss": 9.89727474451065, "vf_explained_var": -4.76837158203125e-05, "kl": 2.3453904063303053e-06, "entropy": 2.93093446791172, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "env_runners": {"episode_reward_max": 180.19869822056557, "episode_reward_min": 115.4878913036445, "episode_reward_mean": 147.4396273415659, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.4878913036445}, "policy_reward_max": {"tplp_policy": 180.19869822056557}, "policy_reward_mean": {"tplp_policy": 147.4396273415659}, "custom_metrics": {"mean_episode_reward_mean": 147.4396273415659, "mean_episode_reward_min": 115.4878913036445, "mean_episode_reward_max": 180.19869822056557}, "hist_stats": {"episode_reward": [137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.609889003794, 153.39182681744208, 124.23051937896697, 143.37697922975633, 165.88306290972787, 153.08458804634915, 156.2308737697631, 130.8545800660978, 163.15204231656188, 140.16466743488846, 147.0811554088889, 135.77009566373323, 128.49834792416596, 132.62177127345038, 135.02089983582533, 180.19869822056557, 156.205389214463, 149.37945178030782, 144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6526553798786687, "mean_inference_ms": 1.9031877429125732, "mean_action_processing_ms": 0.3568943741118996, "mean_env_wait_ms": 2.113626185283873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011499643325805664, "StateBufferConnector_ms": 0.007058620452880859, "ViewRequirementAgentConnector_ms": 0.20111346244812012}, "num_episodes": 24, "episode_return_max": 180.19869822056557, "episode_return_min": 115.4878913036445, "episode_return_mean": 147.4396273415659, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 481.5778309703884, "num_env_steps_trained_throughput_per_sec": 481.5778309703884, "timesteps_total": 168960, "num_env_steps_sampled_lifetime": 168960, "num_agent_steps_sampled_lifetime": 168960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 168960, "timers": {"training_iteration_time_ms": 2182.191, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2182.057, "sample_time_ms": 888.871, "learn_time_ms": 1275.198, "learn_throughput": 803.013, "synch_weights_time_ms": 17.81}, "counters": {"num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "done": false, "training_iteration": 165, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-27", "timestamp": 1744110447, "time_this_iter_s": 2.1318459510803223, "time_total_s": 361.0096278190613, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 361.0096278190613, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 30.866666666666664, "ram_util_percent": 85.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2769115936011075, "cur_kl_coeff": 4.2764235361475127e-51, "cur_lr": 1e-07, "total_loss": 2.174218542128801, "policy_loss": -0.00013076259638182818, "vf_loss": 9.870029169321061, "vf_explained_var": -4.0823593735694885e-05, "kl": 1.182045432911172e-06, "entropy": 2.931579899787903, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "env_runners": {"episode_reward_max": 178.29057208076446, "episode_reward_min": 115.4878913036445, "episode_reward_mean": 149.1138278688618, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.4878913036445}, "policy_reward_max": {"tplp_policy": 178.29057208076446}, "policy_reward_mean": {"tplp_policy": 149.1138278688618}, "custom_metrics": {"mean_episode_reward_mean": 149.1138278688618, "mean_episode_reward_min": 115.4878913036445, "mean_episode_reward_max": 178.29057208076446}, "hist_stats": {"episode_reward": [144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.8166731611618, 164.6667826371076, 143.68918186851755, 147.65285537391048, 140.41617835804624, 164.31408843074618, 148.30028626642516, 165.56372565166572, 151.8668481133773, 173.33174819147524, 128.69835336616293, 167.6990380949395, 136.9550064641484, 134.41138121084595, 154.83497595968316, 141.7398872552211, 125.98380063042389, 147.76523986022983, 158.95183180267975, 147.08825684779882, 135.98892356278157, 158.05538739576593, 147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.652699415457735, "mean_inference_ms": 1.903387632428846, "mean_action_processing_ms": 0.3569423302281251, "mean_env_wait_ms": 2.1137596105590966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012496232986450195, "StateBufferConnector_ms": 0.007056236267089844, "ViewRequirementAgentConnector_ms": 0.210313081741333}, "num_episodes": 18, "episode_return_max": 178.29057208076446, "episode_return_min": 115.4878913036445, "episode_return_mean": 149.1138278688618, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 441.88356552030876, "num_env_steps_trained_throughput_per_sec": 441.88356552030876, "timesteps_total": 169984, "num_env_steps_sampled_lifetime": 169984, "num_agent_steps_sampled_lifetime": 169984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 169984, "timers": {"training_iteration_time_ms": 2171.625, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2171.491, "sample_time_ms": 888.161, "learn_time_ms": 1265.498, "learn_throughput": 809.168, "synch_weights_time_ms": 17.654}, "counters": {"num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "done": false, "training_iteration": 166, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-29", "timestamp": 1744110449, "time_this_iter_s": 2.3235318660736084, "time_total_s": 363.3331596851349, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 363.3331596851349, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 39.86666666666667, "ram_util_percent": 85.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6495992828160526, "cur_kl_coeff": 2.1382117680737563e-51, "cur_lr": 1e-07, "total_loss": 2.1662891037762164, "policy_loss": -0.00013165647978894413, "vf_loss": 9.838589644432068, "vf_explained_var": -2.6585906744003297e-05, "kl": 1.6570295989115635e-06, "entropy": 2.9322663962841036, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "env_runners": {"episode_reward_max": 180.25076423149443, "episode_reward_min": 115.4878913036445, "episode_reward_mean": 148.64756381838654, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.4878913036445}, "policy_reward_max": {"tplp_policy": 180.25076423149443}, "policy_reward_mean": {"tplp_policy": 148.64756381838654}, "custom_metrics": {"mean_episode_reward_mean": 148.64756381838654, "mean_episode_reward_min": 115.4878913036445, "mean_episode_reward_max": 180.25076423149443}, "hist_stats": {"episode_reward": [147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.19894476582127, 144.6537630579676, 141.27347004160245, 170.23019606907422, 153.81529053353267, 147.866624445578, 154.14302684660245, 140.5131708862614, 120.75397274180922, 157.84890252243628, 150.08985715580656, 143.42966592338595, 141.81151588261645, 145.3956427636595, 168.2174918318768, 153.89024138968895, 142.66802008179167, 158.20190899155045, 145.18275426813767, 163.92849893600894, 156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6528801136748379, "mean_inference_ms": 1.9039525412225058, "mean_action_processing_ms": 0.3569427779272033, "mean_env_wait_ms": 2.114193695800809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015491247177124023, "StateBufferConnector_ms": 0.0029938220977783203, "ViewRequirementAgentConnector_ms": 0.2028641700744629}, "num_episodes": 22, "episode_return_max": 180.25076423149443, "episode_return_min": 115.4878913036445, "episode_return_mean": 148.64756381838654, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 422.69114849454866, "num_env_steps_trained_throughput_per_sec": 422.69114849454866, "timesteps_total": 171008, "num_env_steps_sampled_lifetime": 171008, "num_agent_steps_sampled_lifetime": 171008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 171008, "timers": {"training_iteration_time_ms": 2203.019, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2202.884, "sample_time_ms": 894.397, "learn_time_ms": 1290.658, "learn_throughput": 793.394, "synch_weights_time_ms": 17.701}, "counters": {"num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "done": false, "training_iteration": 167, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-31", "timestamp": 1744110451, "time_this_iter_s": 2.4290077686309814, "time_total_s": 365.76216745376587, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 365.76216745376587, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 43.225, "ram_util_percent": 85.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.847745254635811, "cur_kl_coeff": 1.0691058840368782e-51, "cur_lr": 1e-07, "total_loss": 2.181293271481991, "policy_loss": -8.947403402999043e-05, "vf_loss": 9.89895665049553, "vf_explained_var": -3.0833855271339415e-05, "kl": 1.562730575710436e-06, "entropy": 2.933564139902592, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "env_runners": {"episode_reward_max": 180.25076423149443, "episode_reward_min": 115.4878913036445, "episode_reward_mean": 147.904704146533, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.4878913036445}, "policy_reward_max": {"tplp_policy": 180.25076423149443}, "policy_reward_mean": {"tplp_policy": 147.904704146533}, "custom_metrics": {"mean_episode_reward_mean": 147.904704146533, "mean_episode_reward_min": 115.4878913036445, "mean_episode_reward_max": 180.25076423149443}, "hist_stats": {"episode_reward": [156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [156.41705523278594, 158.40922045564065, 137.67180655036992, 148.15339778257317, 157.6587150351827, 128.52338712590898, 124.87420797237277, 115.58167027670882, 148.89328137242276, 149.31785243744167, 119.38439246632691, 156.46390440932245, 138.89849145699844, 151.5759015653211, 134.3321543566369, 150.83074755882933, 138.1482359307465, 132.43535556800742, 162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6530381605955712, "mean_inference_ms": 1.904303439462218, "mean_action_processing_ms": 0.35690914571588195, "mean_env_wait_ms": 2.114437086791931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012282848358154297, "StateBufferConnector_ms": 0.00713348388671875, "ViewRequirementAgentConnector_ms": 0.19661521911621094}, "num_episodes": 20, "episode_return_max": 180.25076423149443, "episode_return_min": 115.4878913036445, "episode_return_mean": 147.904704146533, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 457.0873444693926, "num_env_steps_trained_throughput_per_sec": 457.0873444693926, "timesteps_total": 172032, "num_env_steps_sampled_lifetime": 172032, "num_agent_steps_sampled_lifetime": 172032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 2219.679, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2219.679, "sample_time_ms": 898.564, "learn_time_ms": 1303.85, "learn_throughput": 785.366, "synch_weights_time_ms": 17.137}, "counters": {"num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "done": false, "training_iteration": 168, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-34", "timestamp": 1744110454, "time_this_iter_s": 2.2462239265441895, "time_total_s": 368.00839138031006, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.00839138031006, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 35.8, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9174593865871428, "cur_kl_coeff": 5.345529420184391e-52, "cur_lr": 1e-07, "total_loss": 2.169944553077221, "policy_loss": -0.0002711735956836492, "vf_loss": 9.854685169458389, "vf_explained_var": -3.154464066028595e-05, "kl": 2.6770531174058476e-06, "entropy": 2.9345556437969207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "env_runners": {"episode_reward_max": 180.25076423149443, "episode_reward_min": 112.98826586374724, "episode_reward_mean": 148.12681344964503, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.98826586374724}, "policy_reward_max": {"tplp_policy": 180.25076423149443}, "policy_reward_mean": {"tplp_policy": 148.12681344964503}, "custom_metrics": {"mean_episode_reward_mean": 148.12681344964503, "mean_episode_reward_min": 112.98826586374724, "mean_episode_reward_max": 180.25076423149443}, "hist_stats": {"episode_reward": [162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [162.69454381289097, 168.96953465440944, 143.541760586754, 163.8594066242814, 143.15802315098495, 154.82924310174423, 146.49198506340517, 156.6183180421939, 115.4878913036445, 127.25185418890452, 153.7930107279927, 140.47701113031437, 163.92059329433192, 135.97457007750486, 164.64982844814955, 143.17883692924332, 157.65210335984622, 161.32270496289522, 148.9865161910225, 156.76677748960904, 149.24465973586214, 130.86553579393947, 138.7594272210968, 162.84308293101193, 145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6530960831749326, "mean_inference_ms": 1.9045366021985428, "mean_action_processing_ms": 0.35685985175135243, "mean_env_wait_ms": 2.114539914678562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01579761505126953, "StateBufferConnector_ms": 0.00713348388671875, "ViewRequirementAgentConnector_ms": 0.19577550888061523}, "num_episodes": 18, "episode_return_max": 180.25076423149443, "episode_return_min": 112.98826586374724, "episode_return_mean": 148.12681344964503, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.6142904238944, "num_env_steps_trained_throughput_per_sec": 465.6142904238944, "timesteps_total": 173056, "num_env_steps_sampled_lifetime": 173056, "num_agent_steps_sampled_lifetime": 173056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 173056, "timers": {"training_iteration_time_ms": 2213.964, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.964, "sample_time_ms": 901.771, "learn_time_ms": 1294.916, "learn_throughput": 790.785, "synch_weights_time_ms": 17.15}, "counters": {"num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "done": false, "training_iteration": 169, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-36", "timestamp": 1744110456, "time_this_iter_s": 2.2066452503204346, "time_total_s": 370.2150366306305, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 370.2150366306305, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 38.8, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.317429892718792, "cur_kl_coeff": 2.6727647100921954e-52, "cur_lr": 1e-07, "total_loss": 2.1725963935256005, "policy_loss": -0.00010437819291837513, "vf_loss": 9.864674466848374, "vf_explained_var": -5.60171902179718e-05, "kl": 7.602456652211486e-07, "entropy": 2.934678389132023, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "env_runners": {"episode_reward_max": 180.25076423149443, "episode_reward_min": 112.98826586374724, "episode_reward_mean": 148.9349383127593, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.98826586374724}, "policy_reward_max": {"tplp_policy": 180.25076423149443}, "policy_reward_mean": {"tplp_policy": 148.9349383127593}, "custom_metrics": {"mean_episode_reward_mean": 148.9349383127593, "mean_episode_reward_min": 112.98826586374724, "mean_episode_reward_max": 180.25076423149443}, "hist_stats": {"episode_reward": [145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.3906908468842, 167.0760992747041, 145.30150512069173, 151.88963867528287, 152.65054101437593, 161.7532325672674, 157.78955799140516, 178.29057208076446, 125.99734654395863, 164.05284852878464, 139.26364074950493, 137.31542508455206, 170.95267635175807, 161.85990197307055, 172.99410404727848, 165.99460002194192, 164.48019324350562, 142.28539079018782, 129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6532003020373359, "mean_inference_ms": 1.9051771170879153, "mean_action_processing_ms": 0.3568215241373558, "mean_env_wait_ms": 2.1152342284206984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01549839973449707, "StateBufferConnector_ms": 0.008131027221679688, "ViewRequirementAgentConnector_ms": 0.19920682907104492}, "num_episodes": 24, "episode_return_max": 180.25076423149443, "episode_return_min": 112.98826586374724, "episode_return_mean": 148.9349383127593, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 417.43044345834863, "num_env_steps_trained_throughput_per_sec": 417.43044345834863, "timesteps_total": 174080, "num_env_steps_sampled_lifetime": 174080, "num_agent_steps_sampled_lifetime": 174080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 174080, "timers": {"training_iteration_time_ms": 2234.253, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2234.253, "sample_time_ms": 906.179, "learn_time_ms": 1310.909, "learn_throughput": 781.137, "synch_weights_time_ms": 17.037}, "counters": {"num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "done": false, "training_iteration": 170, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-38", "timestamp": 1744110458, "time_this_iter_s": 2.4592556953430176, "time_total_s": 372.6742923259735, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C23380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.6742923259735, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 39.599999999999994, "ram_util_percent": 85.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3622116465121508, "cur_kl_coeff": 1.3363823550460977e-52, "cur_lr": 1e-07, "total_loss": 2.1946146301925182, "policy_loss": -7.611152832396329e-05, "vf_loss": 9.952945631742477, "vf_explained_var": -5.2570551633834836e-05, "kl": 1.3998175817056535e-06, "entropy": 2.9354564175009727, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "env_runners": {"episode_reward_max": 180.25076423149443, "episode_reward_min": 112.98826586374724, "episode_reward_mean": 147.46999812279978, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.98826586374724}, "policy_reward_max": {"tplp_policy": 180.25076423149443}, "policy_reward_mean": {"tplp_policy": 147.46999812279978}, "custom_metrics": {"mean_episode_reward_mean": 147.46999812279978, "mean_episode_reward_min": 112.98826586374724, "mean_episode_reward_max": 180.25076423149443}, "hist_stats": {"episode_reward": [129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [129.59204914531242, 153.5102395352915, 144.40350914209776, 152.36681355982415, 143.59513494411738, 146.16953358407056, 145.35778063852274, 129.12935757051082, 152.59383262069733, 118.23020127147295, 138.87114654573267, 160.77051702642373, 180.25076423149443, 137.3364793079674, 156.63770626197478, 147.24129357834968, 164.09401103924984, 123.69651690124084, 148.5902367939773, 156.96133772357035, 146.57227723426323, 148.2366067793503, 149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6533358290852996, "mean_inference_ms": 1.9058729104856464, "mean_action_processing_ms": 0.35685128045379805, "mean_env_wait_ms": 2.116119065514792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013505697250366211, "StateBufferConnector_ms": 0.006134033203125, "ViewRequirementAgentConnector_ms": 0.20039677619934082}, "num_episodes": 18, "episode_return_max": 180.25076423149443, "episode_return_min": 112.98826586374724, "episode_return_mean": 147.46999812279978, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 414.7380680783962, "num_env_steps_trained_throughput_per_sec": 414.7380680783962, "timesteps_total": 175104, "num_env_steps_sampled_lifetime": 175104, "num_agent_steps_sampled_lifetime": 175104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 175104, "timers": {"training_iteration_time_ms": 2270.456, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2270.456, "sample_time_ms": 923.06, "learn_time_ms": 1330.488, "learn_throughput": 769.642, "synch_weights_time_ms": 16.78}, "counters": {"num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "done": false, "training_iteration": 171, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-41", "timestamp": 1744110461, "time_this_iter_s": 2.475153923034668, "time_total_s": 375.1494462490082, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 375.1494462490082, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 51.93333333333333, "ram_util_percent": 85.43333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3989834686741234, "cur_kl_coeff": 6.681911775230489e-53, "cur_lr": 1e-07, "total_loss": 2.1703277722001078, "policy_loss": -0.00011213285033591091, "vf_loss": 9.85672909617424, "vf_explained_var": -4.441924393177033e-05, "kl": 1.851860947854611e-06, "entropy": 2.937423573434353, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "env_runners": {"episode_reward_max": 176.84803178401327, "episode_reward_min": 112.98826586374724, "episode_reward_mean": 148.56039121435134, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.98826586374724}, "policy_reward_max": {"tplp_policy": 176.84803178401327}, "policy_reward_mean": {"tplp_policy": 148.56039121435134}, "custom_metrics": {"mean_episode_reward_mean": 148.56039121435134, "mean_episode_reward_min": 112.98826586374724, "mean_episode_reward_max": 176.84803178401327}, "hist_stats": {"episode_reward": [149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [149.92268447855292, 152.32893819764027, 122.9348240797176, 157.15212564191518, 167.84962060627777, 131.0851286738273, 145.9608012494518, 154.64736012467947, 137.03373786961518, 127.03107310347465, 127.13378547587921, 150.80756777309378, 134.06552656710724, 149.31039616501383, 144.53193864441667, 151.28095150179567, 154.44057598250922, 164.50107180127011, 138.0124024993286, 159.46039146827698, 118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6533814672743553, "mean_inference_ms": 1.9063130447889143, "mean_action_processing_ms": 0.35689617680198815, "mean_env_wait_ms": 2.116863190895811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012514829635620117, "StateBufferConnector_ms": 0.0066297054290771484, "ViewRequirementAgentConnector_ms": 0.20118093490600586}, "num_episodes": 22, "episode_return_max": 176.84803178401327, "episode_return_min": 112.98826586374724, "episode_return_mean": 148.56039121435134, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 494.9211480322154, "num_env_steps_trained_throughput_per_sec": 494.9211480322154, "timesteps_total": 176128, "num_env_steps_sampled_lifetime": 176128, "num_agent_steps_sampled_lifetime": 176128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 176128, "timers": {"training_iteration_time_ms": 2270.518, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2270.518, "sample_time_ms": 921.893, "learn_time_ms": 1332.313, "learn_throughput": 768.588, "synch_weights_time_ms": 16.312}, "counters": {"num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "done": false, "training_iteration": 172, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-43", "timestamp": 1744110463, "time_this_iter_s": 2.074256420135498, "time_total_s": 377.2237026691437, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.2237026691437, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 28.63333333333333, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.056489716470241, "cur_kl_coeff": 3.3409558876152443e-53, "cur_lr": 1e-07, "total_loss": 2.179348261654377, "policy_loss": -0.000446814761380665, "vf_loss": 9.89467312693596, "vf_explained_var": -4.404187202453613e-05, "kl": 4.647550652547849e-06, "entropy": 2.938732048869133, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "env_runners": {"episode_reward_max": 176.84803178401327, "episode_reward_min": 112.98826586374724, "episode_reward_mean": 148.9596556600701, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 112.98826586374724}, "policy_reward_max": {"tplp_policy": 176.84803178401327}, "policy_reward_mean": {"tplp_policy": 148.9596556600701}, "custom_metrics": {"mean_episode_reward_mean": 148.9596556600701, "mean_episode_reward_min": 112.98826586374724, "mean_episode_reward_max": 176.84803178401327}, "hist_stats": {"episode_reward": [118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [118.69713842404488, 112.98826586374724, 136.2544043340236, 158.90327003946805, 146.17432078980787, 146.25180867999327, 139.2677192302872, 134.97240657794666, 159.62658140686068, 144.96623045327402, 132.17675079669922, 130.64607462817162, 165.03836321159366, 155.82234265174776, 156.22662829890706, 134.29560851062143, 164.19417613021002, 160.59808790099018, 145.29022907558135, 153.06179653406082, 175.24998824984232, 141.4843643268024, 140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6534574414243941, "mean_inference_ms": 1.9067112191575595, "mean_action_processing_ms": 0.35693512643917336, "mean_env_wait_ms": 2.1174817508007355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011631011962890625, "StateBufferConnector_ms": 0.00551295280456543, "ViewRequirementAgentConnector_ms": 0.20567798614501953}, "num_episodes": 20, "episode_return_max": 176.84803178401327, "episode_return_min": 112.98826586374724, "episode_return_mean": 148.9596556600701, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.4697203449236, "num_env_steps_trained_throughput_per_sec": 464.4697203449236, "timesteps_total": 177152, "num_env_steps_sampled_lifetime": 177152, "num_agent_steps_sampled_lifetime": 177152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 177152, "timers": {"training_iteration_time_ms": 2269.073, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2269.073, "sample_time_ms": 916.903, "learn_time_ms": 1335.736, "learn_throughput": 766.618, "synch_weights_time_ms": 16.433}, "counters": {"num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "done": false, "training_iteration": 173, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-45", "timestamp": 1744110465, "time_this_iter_s": 2.211185932159424, "time_total_s": 379.4348886013031, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 379.4348886013031, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 37.833333333333336, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3559672225266697, "cur_kl_coeff": 1.6704779438076221e-53, "cur_lr": 1e-07, "total_loss": 2.1659810431301594, "policy_loss": -4.184501012787223e-05, "vf_loss": 9.840110623836518, "vf_explained_var": -4.963837563991547e-05, "kl": 1.4037913141251579e-06, "entropy": 2.9400477394461633, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "env_runners": {"episode_reward_max": 192.70223535270017, "episode_reward_min": 124.74308250013873, "episode_reward_mean": 151.1397568306921, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.74308250013873}, "policy_reward_max": {"tplp_policy": 192.70223535270017}, "policy_reward_mean": {"tplp_policy": 151.1397568306921}, "custom_metrics": {"mean_episode_reward_mean": 151.1397568306921, "mean_episode_reward_min": 124.74308250013873, "mean_episode_reward_max": 192.70223535270017}, "hist_stats": {"episode_reward": [140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [140.03798699004875, 140.88951157626727, 166.80269467056675, 160.82965364345193, 144.0433495908659, 145.57883501225024, 144.74344033260212, 148.75556291445267, 146.77867868271937, 162.7126339314665, 159.93698365791892, 137.61700853996965, 171.53007900488615, 159.52068615502958, 145.14457906049637, 149.4019528844565, 168.44045900382008, 139.5069672647082, 136.14237439232176, 141.41916579703667, 144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6537730485597818, "mean_inference_ms": 1.9072849782305548, "mean_action_processing_ms": 0.35692820696907057, "mean_env_wait_ms": 2.1180614831497415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005120038986206055, "StateBufferConnector_ms": 0.006640434265136719, "ViewRequirementAgentConnector_ms": 0.19373035430908203}, "num_episodes": 22, "episode_return_max": 192.70223535270017, "episode_return_min": 124.74308250013873, "episode_return_mean": 151.1397568306921, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 427.10405000148666, "num_env_steps_trained_throughput_per_sec": 427.10405000148666, "timesteps_total": 178176, "num_env_steps_sampled_lifetime": 178176, "num_agent_steps_sampled_lifetime": 178176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 178176, "timers": {"training_iteration_time_ms": 2289.914, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2289.914, "sample_time_ms": 919.918, "learn_time_ms": 1353.236, "learn_throughput": 756.705, "synch_weights_time_ms": 16.658}, "counters": {"num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "done": false, "training_iteration": 174, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-48", "timestamp": 1744110468, "time_this_iter_s": 2.403468132019043, "time_total_s": 381.83835673332214, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 381.83835673332214, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 41.55, "ram_util_percent": 85.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.126503252983094, "cur_kl_coeff": 8.352389719038111e-54, "cur_lr": 1e-07, "total_loss": 2.1652043737471103, "policy_loss": -0.00039545727777294814, "vf_loss": 9.838570183515548, "vf_explained_var": -3.430545330047607e-05, "kl": 2.613787653316102e-06, "entropy": 2.9404272243380545, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "env_runners": {"episode_reward_max": 192.70223535270017, "episode_reward_min": 116.72900031185844, "episode_reward_mean": 150.0783489769767, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.72900031185844}, "policy_reward_max": {"tplp_policy": 192.70223535270017}, "policy_reward_mean": {"tplp_policy": 150.0783489769767}, "custom_metrics": {"mean_episode_reward_mean": 150.0783489769767, "mean_episode_reward_min": 116.72900031185844, "mean_episode_reward_max": 192.70223535270017}, "hist_stats": {"episode_reward": [144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.73423852471439, 148.97438158800637, 124.74308250013873, 144.30342728803734, 140.00235752145014, 140.29415969795136, 176.84803178401327, 146.07025494940623, 144.4093565737918, 135.63451879933362, 176.32853698061217, 159.578554147717, 164.56042645647165, 161.15288496639965, 137.05190481353338, 136.5962891290285, 162.28103799629824, 158.2587215244786, 154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6537570329491696, "mean_inference_ms": 1.907716806777448, "mean_action_processing_ms": 0.357040684292441, "mean_env_wait_ms": 2.1188127101577843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00559544563293457, "StateBufferConnector_ms": 0.008030891418457031, "ViewRequirementAgentConnector_ms": 0.19873523712158203}, "num_episodes": 20, "episode_return_max": 192.70223535270017, "episode_return_min": 116.72900031185844, "episode_return_mean": 150.0783489769767, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 475.7652313881606, "num_env_steps_trained_throughput_per_sec": 475.7652313881606, "timesteps_total": 179200, "num_env_steps_sampled_lifetime": 179200, "num_agent_steps_sampled_lifetime": 179200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 179200, "timers": {"training_iteration_time_ms": 2292.512, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2292.512, "sample_time_ms": 926.101, "learn_time_ms": 1349.61, "learn_throughput": 758.738, "synch_weights_time_ms": 16.699}, "counters": {"num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "done": false, "training_iteration": 175, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-50", "timestamp": 1744110470, "time_this_iter_s": 2.1573193073272705, "time_total_s": 383.9956760406494, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 383.9956760406494, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 38.0, "ram_util_percent": 85.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.656969391182065, "cur_kl_coeff": 4.1761948595190553e-54, "cur_lr": 1e-07, "total_loss": 2.1731940560042857, "policy_loss": -0.00014230252127163113, "vf_loss": 9.869270575046539, "vf_explained_var": -5.4222717881202695e-05, "kl": 1.4735803654186697e-06, "entropy": 2.9398128375411035, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "env_runners": {"episode_reward_max": 192.70223535270017, "episode_reward_min": 116.72900031185844, "episode_reward_mean": 151.0544855167251, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.72900031185844}, "policy_reward_max": {"tplp_policy": 192.70223535270017}, "policy_reward_mean": {"tplp_policy": 151.0544855167251}, "custom_metrics": {"mean_episode_reward_mean": 151.0544855167251, "mean_episode_reward_min": 116.72900031185844, "mean_episode_reward_max": 192.70223535270017}, "hist_stats": {"episode_reward": [154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [154.39837628316283, 162.21334123833577, 138.24015156616846, 137.84665642431148, 174.18616867217264, 154.43183876955936, 153.66743574160722, 150.42833048109006, 152.7170626381196, 167.11153644514457, 161.4277587284906, 139.61977743056184, 134.6311796218402, 148.55068507265534, 142.1557947808099, 141.6359821030047, 146.452687194461, 140.50493264652897, 151.39132169549777, 161.09587753637075, 161.88070686913656, 147.26753166184517, 151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6537673596418938, "mean_inference_ms": 1.9077576498409459, "mean_action_processing_ms": 0.3569741872186647, "mean_env_wait_ms": 2.118791320446432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007608652114868164, "StateBufferConnector_ms": 0.009035110473632812, "ViewRequirementAgentConnector_ms": 0.19023919105529785}, "num_episodes": 18, "episode_return_max": 192.70223535270017, "episode_return_min": 116.72900031185844, "episode_return_mean": 151.0544855167251, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 499.6188903676583, "num_env_steps_trained_throughput_per_sec": 499.6188903676583, "timesteps_total": 180224, "num_env_steps_sampled_lifetime": 180224, "num_agent_steps_sampled_lifetime": 180224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 180224, "timers": {"training_iteration_time_ms": 2265.733, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2265.733, "sample_time_ms": 921.205, "learn_time_ms": 1327.869, "learn_throughput": 771.16, "synch_weights_time_ms": 16.557}, "counters": {"num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "done": false, "training_iteration": 176, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-52", "timestamp": 1744110472, "time_this_iter_s": 2.0622923374176025, "time_total_s": 386.057968378067, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBCE00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.057968378067, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 31.466666666666665, "ram_util_percent": 85.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1740137629210947, "cur_kl_coeff": 2.0880974297595277e-54, "cur_lr": 1e-07, "total_loss": 2.1568002119660377, "policy_loss": -9.01425228221342e-05, "vf_loss": 9.803930878639221, "vf_explained_var": -4.144608974456787e-05, "kl": 1.6938875173622137e-06, "entropy": 2.940923610329628, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "env_runners": {"episode_reward_max": 192.70223535270017, "episode_reward_min": 116.72900031185844, "episode_reward_mean": 150.27334457844282, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.72900031185844}, "policy_reward_max": {"tplp_policy": 192.70223535270017}, "policy_reward_mean": {"tplp_policy": 150.27334457844282}, "custom_metrics": {"mean_episode_reward_mean": 150.27334457844282, "mean_episode_reward_min": 116.72900031185844, "mean_episode_reward_max": 192.70223535270017}, "hist_stats": {"episode_reward": [151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.8227323612492, 146.1980894136591, 151.99675809813766, 145.2108317016878, 148.1374952318068, 167.49887040926725, 133.36560946627512, 142.49370478910606, 144.0412981934811, 164.78195203230067, 130.0462638417739, 128.6196575267509, 149.70289483849206, 174.9108226789358, 164.44970121532614, 129.9385509165684, 131.82022738616456, 145.23364784375738, 167.17007942861724, 143.20332380391525, 144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.653917924239027, "mean_inference_ms": 1.9079522412973169, "mean_action_processing_ms": 0.35699817928785677, "mean_env_wait_ms": 2.119123460156707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006600856781005859, "StateBufferConnector_ms": 0.007515430450439453, "ViewRequirementAgentConnector_ms": 0.18211984634399414}, "num_episodes": 22, "episode_return_max": 192.70223535270017, "episode_return_min": 116.72900031185844, "episode_return_mean": 150.27334457844282, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 423.0655410837692, "num_env_steps_trained_throughput_per_sec": 423.0655410837692, "timesteps_total": 181248, "num_env_steps_sampled_lifetime": 181248, "num_agent_steps_sampled_lifetime": 181248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 181248, "timers": {"training_iteration_time_ms": 2265.519, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2265.519, "sample_time_ms": 921.248, "learn_time_ms": 1327.871, "learn_throughput": 771.159, "synch_weights_time_ms": 16.298}, "counters": {"num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "done": false, "training_iteration": 177, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-55", "timestamp": 1744110475, "time_this_iter_s": 2.4264187812805176, "time_total_s": 388.48438715934753, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D714E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 388.48438715934753, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 45.76666666666667, "ram_util_percent": 85.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.593090835213661, "cur_kl_coeff": 1.0440487148797638e-54, "cur_lr": 1e-07, "total_loss": 2.1786754317581654, "policy_loss": -0.00021958230499876663, "vf_loss": 9.892871594429016, "vf_explained_var": -1.9080564379692076e-05, "kl": 3.499740339130142e-06, "entropy": 2.9432285875082016, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "env_runners": {"episode_reward_max": 192.70223535270017, "episode_reward_min": 116.72900031185844, "episode_reward_mean": 150.94697399513697, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.72900031185844}, "policy_reward_max": {"tplp_policy": 192.70223535270017}, "policy_reward_mean": {"tplp_policy": 150.94697399513697}, "custom_metrics": {"mean_episode_reward_mean": 150.94697399513697, "mean_episode_reward_min": 116.72900031185844, "mean_episode_reward_max": 192.70223535270017}, "hist_stats": {"episode_reward": [144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.63411753825167, 181.64453400138652, 151.05429315158753, 168.04508919727175, 146.36478987542077, 192.70223535270017, 157.08028393149235, 152.29268922209863, 147.1772673052374, 144.48232232339052, 163.76769899634493, 142.1939330776335, 166.63387870057727, 152.70612683699142, 136.9264549363968, 152.51681418452054, 143.57947564701183, 149.61513362231716, 163.4709004811281, 162.9352315625859, 140.43541925825778, 128.94852792454932, 135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6540553043018699, "mean_inference_ms": 1.9083168111299948, "mean_action_processing_ms": 0.3570698627898605, "mean_env_wait_ms": 2.119575005705903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008058786392211914, "StateBufferConnector_ms": 0.0065114498138427734, "ViewRequirementAgentConnector_ms": 0.20200085639953613}, "num_episodes": 20, "episode_return_max": 192.70223535270017, "episode_return_min": 116.72900031185844, "episode_return_mean": 150.94697399513697, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.5600846369873, "num_env_steps_trained_throughput_per_sec": 448.5600846369873, "timesteps_total": 182272, "num_env_steps_sampled_lifetime": 182272, "num_agent_steps_sampled_lifetime": 182272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 182272, "timers": {"training_iteration_time_ms": 2269.777, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2269.777, "sample_time_ms": 926.414, "learn_time_ms": 1326.928, "learn_throughput": 771.707, "synch_weights_time_ms": 16.334}, "counters": {"num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "done": false, "training_iteration": 178, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-57", "timestamp": 1744110477, "time_this_iter_s": 2.290186643600464, "time_total_s": 390.774573802948, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.774573802948, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 37.949999999999996, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5813789505511524, "cur_kl_coeff": 5.220243574398819e-55, "cur_lr": 1e-07, "total_loss": 2.1718759670853616, "policy_loss": -0.00012977622100152075, "vf_loss": 9.86606907248497, "vf_explained_var": -5.823597311973572e-05, "kl": 1.6433895214953976e-06, "entropy": 2.94511516392231, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "env_runners": {"episode_reward_max": 177.19968961084194, "episode_reward_min": 116.72900031185844, "episode_reward_mean": 150.01264214491587, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 116.72900031185844}, "policy_reward_max": {"tplp_policy": 177.19968961084194}, "policy_reward_mean": {"tplp_policy": 150.01264214491587}, "custom_metrics": {"mean_episode_reward_mean": 150.01264214491587, "mean_episode_reward_min": 116.72900031185844, "mean_episode_reward_max": 177.19968961084194}, "hist_stats": {"episode_reward": [135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.6901470586174, 173.47822722762038, 132.38302570801696, 139.21393227816577, 138.71353808440767, 128.47947867262658, 169.19899392527032, 137.05686528846036, 116.72900031185844, 152.5669266422318, 140.32838970381414, 160.5367269136165, 153.80431794710358, 138.60303407499782, 162.48305646277717, 149.63672784743397, 172.19727521561538, 133.20820718835498, 143.91203313084273, 146.6087841503566, 161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6542406769217467, "mean_inference_ms": 1.9083664668837672, "mean_action_processing_ms": 0.35713553182777746, "mean_env_wait_ms": 2.119808921596613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010525703430175781, "StateBufferConnector_ms": 0.006381511688232422, "ViewRequirementAgentConnector_ms": 0.21088504791259766}, "num_episodes": 22, "episode_return_max": 177.19968961084194, "episode_return_min": 116.72900031185844, "episode_return_mean": 150.01264214491587, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 469.34373073299264, "num_env_steps_trained_throughput_per_sec": 469.34373073299264, "timesteps_total": 183296, "num_env_steps_sampled_lifetime": 183296, "num_agent_steps_sampled_lifetime": 183296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 183296, "timers": {"training_iteration_time_ms": 2268.13, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2268.03, "sample_time_ms": 926.288, "learn_time_ms": 1325.79, "learn_throughput": 772.37, "synch_weights_time_ms": 15.84}, "counters": {"num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "done": false, "training_iteration": 179, "trial_id": "b517c_00000", "date": "2025-04-08_19-07-59", "timestamp": 1744110479, "time_this_iter_s": 2.187150001525879, "time_total_s": 392.9617238044739, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 392.9617238044739, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 40.93333333333333, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.107879340276122, "cur_kl_coeff": 2.6101217871994096e-55, "cur_lr": 1e-07, "total_loss": 2.1971558324992655, "policy_loss": -7.431161939166486e-05, "vf_loss": 9.966948598623276, "vf_explained_var": -6.705485284328461e-05, "kl": 3.5379138633162557e-07, "entropy": 2.945069880783558, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "env_runners": {"episode_reward_max": 177.19968961084194, "episode_reward_min": 119.35461024254752, "episode_reward_mean": 151.3260920372209, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 119.35461024254752}, "policy_reward_max": {"tplp_policy": 177.19968961084194}, "policy_reward_mean": {"tplp_policy": 151.3260920372209}, "custom_metrics": {"mean_episode_reward_mean": 151.3260920372209, "mean_episode_reward_min": 119.35461024254752, "mean_episode_reward_max": 177.19968961084194}, "hist_stats": {"episode_reward": [161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [161.37058809119105, 168.32583873380872, 176.6729893588887, 156.65716212851078, 157.31394883824018, 144.3059805473577, 164.02541640678854, 146.23453015737368, 141.9111308536235, 177.19968961084194, 157.80640787775678, 149.2908088351616, 157.7591285329542, 136.6336495376145, 161.89733309566665, 151.51039932924306, 150.01626034053953, 142.40943062038278, 129.3839663544458, 143.5901004948466, 173.31409858246676, 175.03707557278682, 165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6543620237113437, "mean_inference_ms": 1.9083443918449041, "mean_action_processing_ms": 0.35725185030770873, "mean_env_wait_ms": 2.11998881905179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007057666778564453, "StateBufferConnector_ms": 0.004990816116333008, "ViewRequirementAgentConnector_ms": 0.2119143009185791}, "num_episodes": 20, "episode_return_max": 177.19968961084194, "episode_return_min": 119.35461024254752, "episode_return_mean": 151.3260920372209, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 476.97729093270925, "num_env_steps_trained_throughput_per_sec": 476.97729093270925, "timesteps_total": 184320, "num_env_steps_sampled_lifetime": 184320, "num_agent_steps_sampled_lifetime": 184320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 184320, "timers": {"training_iteration_time_ms": 2237.505, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2237.263, "sample_time_ms": 916.042, "learn_time_ms": 1305.218, "learn_throughput": 784.543, "synch_weights_time_ms": 15.892}, "counters": {"num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "done": false, "training_iteration": 180, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-01", "timestamp": 1744110481, "time_this_iter_s": 2.152634620666504, "time_total_s": 395.1143584251404, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D714E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 395.1143584251404, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 34.266666666666666, "ram_util_percent": 85.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7321848571300507, "cur_kl_coeff": 1.3050608935997048e-55, "cur_lr": 1e-07, "total_loss": 2.1647697359323503, "policy_loss": -0.00010721651196945458, "vf_loss": 9.837492567300796, "vf_explained_var": -4.358813166618347e-05, "kl": 1.440985955758478e-06, "entropy": 2.944961741566658, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "env_runners": {"episode_reward_max": 176.77458405364268, "episode_reward_min": 119.35461024254752, "episode_reward_mean": 149.92646627619052, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 119.35461024254752}, "policy_reward_max": {"tplp_policy": 176.77458405364268}, "policy_reward_mean": {"tplp_policy": 149.92646627619052}, "custom_metrics": {"mean_episode_reward_mean": 149.92646627619052, "mean_episode_reward_min": 119.35461024254752, "mean_episode_reward_max": 176.77458405364268}, "hist_stats": {"episode_reward": [165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [165.73153748109402, 161.18724008439295, 119.35461024254752, 152.2031697557234, 142.68894395107475, 130.73817311843624, 142.41973088340276, 121.27060307851944, 142.2994365139304, 174.2275243923847, 127.23268607673869, 132.9006193034788, 149.45287183444225, 161.83259072452097, 151.40451424631678, 155.04585612017672, 176.77458405364268, 153.51217431876222, 146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6547265848373811, "mean_inference_ms": 1.9085483946609532, "mean_action_processing_ms": 0.3573485870607969, "mean_env_wait_ms": 2.1202208417790094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005044460296630859, "StateBufferConnector_ms": 0.0040395259857177734, "ViewRequirementAgentConnector_ms": 0.23106122016906738}, "num_episodes": 22, "episode_return_max": 176.77458405364268, "episode_return_min": 119.35461024254752, "episode_return_mean": 149.92646627619052, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 450.19904253097855, "num_env_steps_trained_throughput_per_sec": 450.19904253097855, "timesteps_total": 185344, "num_env_steps_sampled_lifetime": 185344, "num_agent_steps_sampled_lifetime": 185344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 185344, "timers": {"training_iteration_time_ms": 2218.057, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2217.815, "sample_time_ms": 906.89, "learn_time_ms": 1294.419, "learn_throughput": 791.088, "synch_weights_time_ms": 16.393}, "counters": {"num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "done": false, "training_iteration": 181, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-04", "timestamp": 1744110484, "time_this_iter_s": 2.2811272144317627, "time_total_s": 397.39548563957214, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 397.39548563957214, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 46.23333333333333, "ram_util_percent": 85.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3706556666642427, "cur_kl_coeff": 6.525304467998524e-56, "cur_lr": 1e-07, "total_loss": 2.1727358512580395, "policy_loss": -0.0001528069900814444, "vf_loss": 9.869593572616576, "vf_explained_var": -5.6313350796699524e-05, "kl": 1.1699573140511178e-06, "entropy": 2.9450974449515344, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "env_runners": {"episode_reward_max": 186.8394505012876, "episode_reward_min": 120.31380263954084, "episode_reward_mean": 151.0207493928266, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 120.31380263954084}, "policy_reward_max": {"tplp_policy": 186.8394505012876}, "policy_reward_mean": {"tplp_policy": 151.0207493928266}, "custom_metrics": {"mean_episode_reward_mean": 151.0207493928266, "mean_episode_reward_min": 120.31380263954084, "mean_episode_reward_max": 186.8394505012876}, "hist_stats": {"episode_reward": [146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [146.6728776774761, 172.88622169892142, 162.65161925937525, 136.82536180414405, 148.36146423413686, 136.64881803860652, 148.34284506992884, 142.2269334040157, 171.47758418070265, 172.0731301084811, 120.4107037592495, 141.44033574730426, 126.64289158476437, 163.87911785318275, 133.18333328747102, 156.61233200286637, 164.65919867219986, 152.72392609145734, 155.88421407117627, 142.13161940231475, 132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6547882167928851, "mean_inference_ms": 1.908951788397366, "mean_action_processing_ms": 0.35754621083051163, "mean_env_wait_ms": 2.1208373766343582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004048347473144531, "StateBufferConnector_ms": 0.004052400588989258, "ViewRequirementAgentConnector_ms": 0.2262895107269287}, "num_episodes": 18, "episode_return_max": 186.8394505012876, "episode_return_min": 120.31380263954084, "episode_return_mean": 151.0207493928266, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 465.5071021534122, "num_env_steps_trained_throughput_per_sec": 465.5071021534122, "timesteps_total": 186368, "num_env_steps_sampled_lifetime": 186368, "num_agent_steps_sampled_lifetime": 186368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 186368, "timers": {"training_iteration_time_ms": 2231.13, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2230.889, "sample_time_ms": 921.086, "learn_time_ms": 1293.114, "learn_throughput": 791.887, "synch_weights_time_ms": 16.577}, "counters": {"num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "done": false, "training_iteration": 182, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-06", "timestamp": 1744110486, "time_this_iter_s": 2.205270767211914, "time_total_s": 399.60075640678406, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 399.60075640678406, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 35.575, "ram_util_percent": 85.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3751228477805855, "cur_kl_coeff": 3.262652233999262e-56, "cur_lr": 1e-07, "total_loss": 2.1769433327019216, "policy_loss": -3.0191498808562756e-05, "vf_loss": 9.885880035161971, "vf_explained_var": -7.572807371616363e-05, "kl": 5.325155580604424e-07, "entropy": 2.9449648529291155, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "env_runners": {"episode_reward_max": 186.8394505012876, "episode_reward_min": 114.8790907761295, "episode_reward_mean": 149.84909468816545, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.8790907761295}, "policy_reward_max": {"tplp_policy": 186.8394505012876}, "policy_reward_mean": {"tplp_policy": 149.84909468816545}, "custom_metrics": {"mean_episode_reward_mean": 149.84909468816545, "mean_episode_reward_min": 114.8790907761295, "mean_episode_reward_max": 186.8394505012876}, "hist_stats": {"episode_reward": [132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [132.43694085297125, 147.3434000215445, 156.28042027949942, 164.37759128893796, 149.4595482247685, 150.1791833277139, 151.5530377093245, 151.69217629618652, 129.80794993772568, 154.36365300535792, 153.19592415052134, 155.37632518780345, 162.43826425856338, 176.01485803949174, 144.22999261203208, 175.39553708971442, 156.58305486306557, 133.977022821566, 132.73951602521765, 120.31380263954084, 158.51942434716088, 155.0432323666948, 164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6549253609671482, "mean_inference_ms": 1.9092686129360006, "mean_action_processing_ms": 0.35767282036631604, "mean_env_wait_ms": 2.1211763069559284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005719423294067383, "StateBufferConnector_ms": 0.004877567291259766, "ViewRequirementAgentConnector_ms": 0.2192978858947754}, "num_episodes": 20, "episode_return_max": 186.8394505012876, "episode_return_min": 114.8790907761295, "episode_return_mean": 149.84909468816545, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 476.8261075772298, "num_env_steps_trained_throughput_per_sec": 476.8261075772298, "timesteps_total": 187392, "num_env_steps_sampled_lifetime": 187392, "num_agent_steps_sampled_lifetime": 187392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 187392, "timers": {"training_iteration_time_ms": 2225.417, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2225.175, "sample_time_ms": 923.82, "learn_time_ms": 1284.662, "learn_throughput": 797.097, "synch_weights_time_ms": 16.581}, "counters": {"num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "done": false, "training_iteration": 183, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-08", "timestamp": 1744110488, "time_this_iter_s": 2.153144121170044, "time_total_s": 401.7539005279541, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBEDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.7539005279541, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 37.333333333333336, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.207994683459401, "cur_kl_coeff": 1.631326116999631e-56, "cur_lr": 1e-07, "total_loss": 2.155551128089428, "policy_loss": -0.0003221562074031681, "vf_loss": 9.801596587896347, "vf_explained_var": -4.255101084709168e-05, "kl": 3.116297494210052e-06, "entropy": 2.9452586278319357, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "env_runners": {"episode_reward_max": 186.8394505012876, "episode_reward_min": 114.8790907761295, "episode_reward_mean": 149.19454463824601, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.8790907761295}, "policy_reward_max": {"tplp_policy": 186.8394505012876}, "policy_reward_mean": {"tplp_policy": 149.19454463824601}, "custom_metrics": {"mean_episode_reward_mean": 149.19454463824601, "mean_episode_reward_min": 114.8790907761295, "mean_episode_reward_max": 186.8394505012876}, "hist_stats": {"episode_reward": [164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [164.15664864179095, 164.3513692464939, 138.14470709453238, 150.43945814241613, 164.9325341947175, 139.6539482331817, 141.8571899028274, 154.64874318338232, 130.58877819677443, 151.41250577475472, 154.52314296875412, 160.50097978263395, 158.51119655005053, 133.39490876440783, 137.6678303210337, 159.47482719733927, 169.471822254178, 168.8804298995673, 171.36438836319007, 159.91862268519807, 137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6549998600203746, "mean_inference_ms": 1.9094853138143122, "mean_action_processing_ms": 0.3577752683049693, "mean_env_wait_ms": 2.121369474022693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032525062561035156, "StateBufferConnector_ms": 0.005888462066650391, "ViewRequirementAgentConnector_ms": 0.21102094650268555}, "num_episodes": 22, "episode_return_max": 186.8394505012876, "episode_return_min": 114.8790907761295, "episode_return_mean": 149.19454463824601, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 454.5299675635632, "num_env_steps_trained_throughput_per_sec": 454.5299675635632, "timesteps_total": 188416, "num_env_steps_sampled_lifetime": 188416, "num_agent_steps_sampled_lifetime": 188416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 188416, "timers": {"training_iteration_time_ms": 2210.951, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2210.709, "sample_time_ms": 911.434, "learn_time_ms": 1282.459, "learn_throughput": 798.466, "synch_weights_time_ms": 16.806}, "counters": {"num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "done": false, "training_iteration": 184, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-11", "timestamp": 1744110491, "time_this_iter_s": 2.259072780609131, "time_total_s": 404.01297330856323, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 404.01297330856323, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 34.6, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2978702787309886, "cur_kl_coeff": 8.156630584998155e-57, "cur_lr": 1e-07, "total_loss": 2.1550199910998344, "policy_loss": -0.00020724136848002673, "vf_loss": 9.798635160923004, "vf_explained_var": -5.719773471355438e-05, "kl": 1.1414855968894245e-06, "entropy": 2.9443157091736794, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "env_runners": {"episode_reward_max": 186.8394505012876, "episode_reward_min": 114.8790907761295, "episode_reward_mean": 147.7998807846101, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.8790907761295}, "policy_reward_max": {"tplp_policy": 186.8394505012876}, "policy_reward_mean": {"tplp_policy": 147.7998807846101}, "custom_metrics": {"mean_episode_reward_mean": 147.7998807846101, "mean_episode_reward_min": 114.8790907761295, "mean_episode_reward_max": 186.8394505012876}, "hist_stats": {"episode_reward": [137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [137.9860561615455, 151.77427337821155, 142.64524938051824, 151.20395056487942, 151.87257945448627, 153.22783061887904, 159.9761618776102, 163.82430400800683, 162.66679952878152, 153.0993612802107, 152.94735223396447, 151.57388080701725, 148.3803386505908, 142.65670702792434, 121.6752211904125, 139.54166533003442, 144.75120987052242, 132.60895601847528, 147.7891687883239, 141.2192805786716, 143.01446172651583, 145.70308875229978, 157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6551278655073121, "mean_inference_ms": 1.9098858184221632, "mean_action_processing_ms": 0.35785917467257067, "mean_env_wait_ms": 2.1217310846309823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007246494293212891, "StateBufferConnector_ms": 0.0068933963775634766, "ViewRequirementAgentConnector_ms": 0.2122328281402588}, "num_episodes": 20, "episode_return_max": 186.8394505012876, "episode_return_min": 114.8790907761295, "episode_return_mean": 147.7998807846101, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 448.4193536969821, "num_env_steps_trained_throughput_per_sec": 448.4193536969821, "timesteps_total": 189440, "num_env_steps_sampled_lifetime": 189440, "num_agent_steps_sampled_lifetime": 189440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 189440, "timers": {"training_iteration_time_ms": 2224.076, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2223.834, "sample_time_ms": 914.083, "learn_time_ms": 1292.778, "learn_throughput": 792.093, "synch_weights_time_ms": 16.964}, "counters": {"num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "done": false, "training_iteration": 185, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-13", "timestamp": 1744110493, "time_this_iter_s": 2.289586305618286, "time_total_s": 406.3025596141815, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 406.3025596141815, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 49.03333333333333, "ram_util_percent": 85.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6354290336370467, "cur_kl_coeff": 4.0783152924990775e-57, "cur_lr": 1e-07, "total_loss": 2.1751227930188177, "policy_loss": -0.0002114349917974323, "vf_loss": 9.878442960977555, "vf_explained_var": -3.235526382923126e-05, "kl": 1.2693318312884116e-06, "entropy": 2.9427650973200796, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "env_runners": {"episode_reward_max": 186.8394505012876, "episode_reward_min": 114.8790907761295, "episode_reward_mean": 148.75612817278554, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.8790907761295}, "policy_reward_max": {"tplp_policy": 186.8394505012876}, "policy_reward_mean": {"tplp_policy": 148.75612817278554}, "custom_metrics": {"mean_episode_reward_mean": 148.75612817278554, "mean_episode_reward_min": 114.8790907761295, "mean_episode_reward_max": 186.8394505012876}, "hist_stats": {"episode_reward": [157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.1115415120433, 160.39157050709937, 133.76303137289116, 157.99550796633693, 130.8781780916852, 145.68110987211372, 141.36246660407662, 176.4474895994721, 147.53645329768898, 150.53933369951739, 164.5886441580183, 161.1138708061697, 180.0212393438805, 186.8394505012876, 144.5274939028391, 142.19024612925776, 135.15854186687596, 160.5659507832328, 147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6551542171404141, "mean_inference_ms": 1.9100506742441397, "mean_action_processing_ms": 0.3578898843576024, "mean_env_wait_ms": 2.1218936371994066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007345676422119141, "StateBufferConnector_ms": 0.008851289749145508, "ViewRequirementAgentConnector_ms": 0.1947941780090332}, "num_episodes": 22, "episode_return_max": 186.8394505012876, "episode_return_min": 114.8790907761295, "episode_return_mean": 148.75612817278554, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 492.31837594909564, "num_env_steps_trained_throughput_per_sec": 492.31837594909564, "timesteps_total": 190464, "num_env_steps_sampled_lifetime": 190464, "num_agent_steps_sampled_lifetime": 190464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 190464, "timers": {"training_iteration_time_ms": 2227.115, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2226.874, "sample_time_ms": 916.203, "learn_time_ms": 1293.759, "learn_throughput": 791.492, "synch_weights_time_ms": 16.902}, "counters": {"num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "done": false, "training_iteration": 186, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-15", "timestamp": 1744110495, "time_this_iter_s": 2.085186243057251, "time_total_s": 408.38774585723877, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 408.38774585723877, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 32.733333333333334, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8578105341643094, "cur_kl_coeff": 2.0391576462495387e-57, "cur_lr": 1e-07, "total_loss": 2.1695972457528114, "policy_loss": -0.00023766878293827177, "vf_loss": 9.856275314092636, "vf_explained_var": -3.635995090007782e-05, "kl": 2.1330407633066152e-06, "entropy": 2.9423389196395875, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "env_runners": {"episode_reward_max": 175.7984148407503, "episode_reward_min": 114.8790907761295, "episode_reward_mean": 147.96378163324545, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.8790907761295}, "policy_reward_max": {"tplp_policy": 175.7984148407503}, "policy_reward_mean": {"tplp_policy": 147.96378163324545}, "custom_metrics": {"mean_episode_reward_mean": 147.96378163324545, "mean_episode_reward_min": 114.8790907761295, "mean_episode_reward_max": 175.7984148407503}, "hist_stats": {"episode_reward": [147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.11768428996916, 158.31307223637808, 162.78259549166978, 128.33388344769153, 136.3313981480553, 125.90718965091139, 142.43734884628546, 152.11395366872262, 144.8827411846479, 134.9054535815194, 143.89468634338976, 126.28364898683402, 114.8790907761295, 143.30148708006357, 156.51816799626675, 169.9407311007093, 156.49133356936719, 138.4100984329392, 150.29408882560222, 139.9063027260707, 160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6551389975473308, "mean_inference_ms": 1.909911920376814, "mean_action_processing_ms": 0.3578698948902907, "mean_env_wait_ms": 2.1217702082087753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008341789245605469, "StateBufferConnector_ms": 0.009836435317993164, "ViewRequirementAgentConnector_ms": 0.2127370834350586}, "num_episodes": 18, "episode_return_max": 175.7984148407503, "episode_return_min": 114.8790907761295, "episode_return_mean": 147.96378163324545, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 492.69648426548315, "num_env_steps_trained_throughput_per_sec": 492.69648426548315, "timesteps_total": 191488, "num_env_steps_sampled_lifetime": 191488, "num_agent_steps_sampled_lifetime": 191488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 191488, "timers": {"training_iteration_time_ms": 2192.908, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2192.667, "sample_time_ms": 907.426, "learn_time_ms": 1268.434, "learn_throughput": 807.294, "synch_weights_time_ms": 16.796}, "counters": {"num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "done": false, "training_iteration": 187, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-17", "timestamp": 1744110497, "time_this_iter_s": 2.083319664001465, "time_total_s": 410.47106552124023, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBC180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 410.47106552124023, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 33.03333333333334, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.027842897921801, "cur_kl_coeff": 1.0195788231247694e-57, "cur_lr": 1e-07, "total_loss": 2.1792209155857565, "policy_loss": -0.00026228323695249857, "vf_loss": 9.894793462753295, "vf_explained_var": -2.5303661823272704e-05, "kl": 2.0969724727315507e-06, "entropy": 2.942151667177677, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "env_runners": {"episode_reward_max": 175.7984148407503, "episode_reward_min": 115.69160937184714, "episode_reward_mean": 149.07461794596932, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.69160937184714}, "policy_reward_max": {"tplp_policy": 175.7984148407503}, "policy_reward_mean": {"tplp_policy": 149.07461794596932}, "custom_metrics": {"mean_episode_reward_mean": 149.07461794596932, "mean_episode_reward_min": 115.69160937184714, "mean_episode_reward_max": 175.7984148407503}, "hist_stats": {"episode_reward": [160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [160.51348556495506, 133.05830240021533, 138.24914461382485, 131.5408926236802, 158.43914062913078, 152.40917058807705, 151.52662763575145, 145.752839221062, 146.94928287722067, 124.10170228957845, 137.89909091740037, 158.26246239553512, 148.74045814738176, 169.958421406779, 166.86071192937052, 144.56557058734666, 156.68282730346112, 118.88728430964703, 164.85520522964876, 146.4128381317212, 144.1665550022247, 175.7984148407503, 141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6551629374485518, "mean_inference_ms": 1.909944076841187, "mean_action_processing_ms": 0.35783154702025444, "mean_env_wait_ms": 2.1217345646214683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006087064743041992, "StateBufferConnector_ms": 0.011008739471435547, "ViewRequirementAgentConnector_ms": 0.22640728950500488}, "num_episodes": 20, "episode_return_max": 175.7984148407503, "episode_return_min": 115.69160937184714, "episode_return_mean": 149.07461794596932, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 444.72026012864575, "num_env_steps_trained_throughput_per_sec": 444.72026012864575, "timesteps_total": 192512, "num_env_steps_sampled_lifetime": 192512, "num_agent_steps_sampled_lifetime": 192512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 192512, "timers": {"training_iteration_time_ms": 2194.879, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2194.638, "sample_time_ms": 907.917, "learn_time_ms": 1269.644, "learn_throughput": 806.526, "synch_weights_time_ms": 17.067}, "counters": {"num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "done": false, "training_iteration": 188, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-19", "timestamp": 1744110499, "time_this_iter_s": 2.3092072010040283, "time_total_s": 412.78027272224426, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 412.78027272224426, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 35.7, "ram_util_percent": 85.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5068946078419687, "cur_kl_coeff": 5.097894115623847e-58, "cur_lr": 1e-07, "total_loss": 2.1771036006510256, "policy_loss": -0.00013919015764258803, "vf_loss": 9.88564430475235, "vf_explained_var": -5.463957786560059e-05, "kl": 1.4885055824809258e-06, "entropy": 2.941682703793049, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "env_runners": {"episode_reward_max": 174.63574756752763, "episode_reward_min": 115.69160937184714, "episode_reward_mean": 150.16099689036065, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.69160937184714}, "policy_reward_max": {"tplp_policy": 174.63574756752763}, "policy_reward_mean": {"tplp_policy": 150.16099689036065}, "custom_metrics": {"mean_episode_reward_mean": 150.16099689036065, "mean_episode_reward_min": 115.69160937184714, "mean_episode_reward_max": 174.63574756752763}, "hist_stats": {"episode_reward": [141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.6027096148468, 129.530210759374, 139.8624835614578, 154.12077628798662, 138.72379202281107, 132.65501045301443, 169.60810294806944, 136.59415775834654, 139.8522767805249, 144.27587132264995, 136.46589270869993, 171.60666680575633, 155.26056363571223, 166.11262915815703, 115.69160937184714, 148.07949986676712, 131.34140023495166, 163.0790228996865, 167.4064106673461, 161.36244038010628, 151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6553657314909116, "mean_inference_ms": 1.9103066358868674, "mean_action_processing_ms": 0.3578337055352415, "mean_env_wait_ms": 2.12210699545479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007274627685546875, "StateBufferConnector_ms": 0.009996414184570312, "ViewRequirementAgentConnector_ms": 0.2537343502044678}, "num_episodes": 22, "episode_return_max": 174.63574756752763, "episode_return_min": 115.69160937184714, "episode_return_mean": 150.16099689036065, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 455.2012620670322, "num_env_steps_trained_throughput_per_sec": 455.2012620670322, "timesteps_total": 193536, "num_env_steps_sampled_lifetime": 193536, "num_agent_steps_sampled_lifetime": 193536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 2201.558, "restore_workers_time_ms": 0.142, "training_step_time_ms": 2201.416, "sample_time_ms": 917.39, "learn_time_ms": 1266.843, "learn_throughput": 808.308, "synch_weights_time_ms": 17.183}, "counters": {"num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "done": false, "training_iteration": 189, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-22", "timestamp": 1744110502, "time_this_iter_s": 2.2541449069976807, "time_total_s": 415.03441762924194, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 415.03441762924194, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 48.333333333333336, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.651009905897081, "cur_kl_coeff": 2.5489470578119234e-58, "cur_lr": 1e-07, "total_loss": 2.1873414613306523, "policy_loss": -0.0001702364010270685, "vf_loss": 9.926695168018341, "vf_explained_var": -5.646049976348877e-05, "kl": 1.3146434863386957e-06, "entropy": 2.9416208028793336, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "env_runners": {"episode_reward_max": 174.63574756752763, "episode_reward_min": 118.87926687524235, "episode_reward_mean": 150.6256347381821, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.87926687524235}, "policy_reward_max": {"tplp_policy": 174.63574756752763}, "policy_reward_mean": {"tplp_policy": 150.6256347381821}, "custom_metrics": {"mean_episode_reward_mean": 150.6256347381821, "mean_episode_reward_min": 118.87926687524235, "mean_episode_reward_max": 174.63574756752763}, "hist_stats": {"episode_reward": [151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.2459084008951, 137.46320513607932, 152.25582282869843, 147.52586740080494, 144.38098483235433, 151.16934687939246, 164.2284517992988, 169.98511164552508, 151.7102138579119, 153.36350923614717, 141.4920567272563, 144.4388514858515, 149.763177880245, 163.23979488496295, 151.84470116901852, 148.6590035951329, 161.672915384196, 129.98035059528732, 145.585058517632, 146.9894527412816, 162.80071397566059, 145.59061524570805, 141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6554813816929035, "mean_inference_ms": 1.9104213261935876, "mean_action_processing_ms": 0.35777043434966865, "mean_env_wait_ms": 2.122119932188475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033690929412841797, "StateBufferConnector_ms": 0.00799417495727539, "ViewRequirementAgentConnector_ms": 0.26201462745666504}, "num_episodes": 20, "episode_return_max": 174.63574756752763, "episode_return_min": 118.87926687524235, "episode_return_mean": 150.6256347381821, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 505.5820206837004, "num_env_steps_trained_throughput_per_sec": 505.5820206837004, "timesteps_total": 194560, "num_env_steps_sampled_lifetime": 194560, "num_agent_steps_sampled_lifetime": 194560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 194560, "timers": {"training_iteration_time_ms": 2189.412, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2189.412, "sample_time_ms": 913.368, "learn_time_ms": 1258.838, "learn_throughput": 813.449, "synch_weights_time_ms": 17.206}, "counters": {"num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "done": false, "training_iteration": 190, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-24", "timestamp": 1744110504, "time_this_iter_s": 2.030177116394043, "time_total_s": 417.064594745636, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 417.064594745636, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 30.5, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.392643280699849, "cur_kl_coeff": 1.2744735289059617e-58, "cur_lr": 1e-07, "total_loss": 2.170291446149349, "policy_loss": -7.488899864256382e-05, "vf_loss": 9.858370715379715, "vf_explained_var": -4.7272816300392154e-05, "kl": 1.6056855468959963e-06, "entropy": 2.9422632813453675, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "env_runners": {"episode_reward_max": 183.87043078917074, "episode_reward_min": 118.87926687524235, "episode_reward_mean": 150.8004908391191, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 118.87926687524235}, "policy_reward_max": {"tplp_policy": 183.87043078917074}, "policy_reward_mean": {"tplp_policy": 150.8004908391191}, "custom_metrics": {"mean_episode_reward_mean": 150.8004908391191, "mean_episode_reward_min": 118.87926687524235, "mean_episode_reward_max": 183.87043078917074}, "hist_stats": {"episode_reward": [141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.66845339909827, 123.10900610409831, 164.5140685489967, 169.27433700991512, 130.3201736868528, 149.78079117663518, 164.92796871596352, 148.58484310790098, 158.10425526168927, 152.23901566121413, 145.24480378450232, 118.87926687524235, 168.1682399879798, 164.52706170693082, 153.1151228318093, 136.628728980278, 142.0486495671455, 141.6436276923652, 168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6556021862070024, "mean_inference_ms": 1.9106020352814412, "mean_action_processing_ms": 0.357736717633841, "mean_env_wait_ms": 2.122307765187368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005269050598144531, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.2622058391571045}, "num_episodes": 22, "episode_return_max": 183.87043078917074, "episode_return_min": 118.87926687524235, "episode_return_mean": 150.8004908391191, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 469.6057573338873, "num_env_steps_trained_throughput_per_sec": 469.6057573338873, "timesteps_total": 195584, "num_env_steps_sampled_lifetime": 195584, "num_agent_steps_sampled_lifetime": 195584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 195584, "timers": {"training_iteration_time_ms": 2180.012, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2180.012, "sample_time_ms": 908.302, "learn_time_ms": 1254.372, "learn_throughput": 816.345, "synch_weights_time_ms": 17.337}, "counters": {"num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "done": false, "training_iteration": 191, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-26", "timestamp": 1744110506, "time_this_iter_s": 2.1876161098480225, "time_total_s": 419.252210855484, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 419.252210855484, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 35.96666666666667, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3914259139448406, "cur_kl_coeff": 6.372367644529809e-59, "cur_lr": 1e-07, "total_loss": 2.1853278286755087, "policy_loss": -0.00010890133853536099, "vf_loss": 9.919139295816422, "vf_explained_var": -5.2471831440925595e-05, "kl": 1.3848722608678088e-06, "entropy": 2.9434810280799866, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "env_runners": {"episode_reward_max": 183.87043078917074, "episode_reward_min": 124.77838989936431, "episode_reward_mean": 151.41194382439772, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.77838989936431}, "policy_reward_max": {"tplp_policy": 183.87043078917074}, "policy_reward_mean": {"tplp_policy": 151.41194382439772}, "custom_metrics": {"mean_episode_reward_mean": 151.41194382439772, "mean_episode_reward_min": 124.77838989936431, "mean_episode_reward_max": 183.87043078917074}, "hist_stats": {"episode_reward": [168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [168.9819981075822, 158.57450101523017, 133.8748352087615, 139.18265834199775, 158.23431586259937, 145.48287783867266, 153.75393454548592, 155.15945841363262, 159.70127842779502, 148.68936108569582, 164.66944242704307, 157.06976084278705, 147.53781181264188, 135.1521204111943, 140.30537425451243, 146.78751046486852, 131.53903407222643, 155.74003726337392, 154.61157219250111, 162.22048972393875, 151.22230230739544, 157.46656224254312, 156.8984956102979, 163.072651507226, 152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6557545072708458, "mean_inference_ms": 1.9110567709597566, "mean_action_processing_ms": 0.3577392252508405, "mean_env_wait_ms": 2.1226809555036934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005287647247314453, "StateBufferConnector_ms": 0.005006551742553711, "ViewRequirementAgentConnector_ms": 0.25745391845703125}, "num_episodes": 18, "episode_return_max": 183.87043078917074, "episode_return_min": 124.77838989936431, "episode_return_mean": 151.41194382439772, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 423.69595070844576, "num_env_steps_trained_throughput_per_sec": 423.69595070844576, "timesteps_total": 196608, "num_env_steps_sampled_lifetime": 196608, "num_agent_steps_sampled_lifetime": 196608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 196608, "timers": {"training_iteration_time_ms": 2201.719, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2201.719, "sample_time_ms": 907.302, "learn_time_ms": 1276.073, "learn_throughput": 802.462, "synch_weights_time_ms": 18.344}, "counters": {"num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "done": false, "training_iteration": 192, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-29", "timestamp": 1744110509, "time_this_iter_s": 2.4229044914245605, "time_total_s": 421.67511534690857, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 421.67511534690857, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 45.775000000000006, "ram_util_percent": 85.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3900874741375446, "cur_kl_coeff": 3.1861838222649043e-59, "cur_lr": 1e-07, "total_loss": 2.169127197563648, "policy_loss": -0.0001322462223470211, "vf_loss": 9.854591482877732, "vf_explained_var": -3.095827996730804e-05, "kl": 1.6809178719157104e-06, "entropy": 2.9438844308257104, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "env_runners": {"episode_reward_max": 183.87043078917074, "episode_reward_min": 114.1159130720193, "episode_reward_mean": 151.49275128723028, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.1159130720193}, "policy_reward_max": {"tplp_policy": 183.87043078917074}, "policy_reward_mean": {"tplp_policy": 151.49275128723028}, "custom_metrics": {"mean_episode_reward_mean": 151.49275128723028, "mean_episode_reward_min": 114.1159130720193, "mean_episode_reward_max": 183.87043078917074}, "hist_stats": {"episode_reward": [152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.09110971156346, 146.0661966926096, 172.76847883810603, 174.63574756752763, 153.97357693067858, 160.04853016022096, 156.13421223389818, 144.30400959069848, 141.16461356839372, 154.83226774064158, 127.65577718665331, 143.12938882510412, 146.5195171451335, 149.8630204833312, 166.05865333905018, 149.53114948637733, 141.240787312529, 151.08608418425933, 141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6560951695887768, "mean_inference_ms": 1.9116852347546984, "mean_action_processing_ms": 0.35762189966961005, "mean_env_wait_ms": 2.1231210809125547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006387233734130859, "StateBufferConnector_ms": 0.005205392837524414, "ViewRequirementAgentConnector_ms": 0.23807978630065918}, "num_episodes": 24, "episode_return_max": 183.87043078917074, "episode_return_min": 114.1159130720193, "episode_return_mean": 151.49275128723028, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 459.93179636056783, "num_env_steps_trained_throughput_per_sec": 459.93179636056783, "timesteps_total": 197632, "num_env_steps_sampled_lifetime": 197632, "num_agent_steps_sampled_lifetime": 197632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 197632, "timers": {"training_iteration_time_ms": 2209.608, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2209.608, "sample_time_ms": 915.235, "learn_time_ms": 1276.24, "learn_throughput": 802.357, "synch_weights_time_ms": 18.133}, "counters": {"num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "done": false, "training_iteration": 193, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-31", "timestamp": 1744110511, "time_this_iter_s": 2.232457160949707, "time_total_s": 423.9075725078583, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 423.9075725078583, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 42.5, "ram_util_percent": 85.59999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.191287235170603, "cur_kl_coeff": 1.5930919111324521e-59, "cur_lr": 1e-07, "total_loss": 2.1782478265464307, "policy_loss": -2.796482585836202e-05, "vf_loss": 9.890827810764312, "vf_explained_var": -5.610398948192596e-05, "kl": 4.1304423327032104e-07, "entropy": 2.9443115800619126, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "env_runners": {"episode_reward_max": 183.87043078917074, "episode_reward_min": 114.1159130720193, "episode_reward_mean": 151.14021924705963, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.1159130720193}, "policy_reward_max": {"tplp_policy": 183.87043078917074}, "policy_reward_mean": {"tplp_policy": 151.14021924705963}, "custom_metrics": {"mean_episode_reward_mean": 151.14021924705963, "mean_episode_reward_min": 114.1159130720193, "mean_episode_reward_max": 183.87043078917074}, "hist_stats": {"episode_reward": [141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [141.14520514793918, 166.08998799555098, 164.96564472287935, 125.64484367304351, 150.79418433165583, 143.68930117937938, 158.48082518197754, 147.39063704024682, 141.7319461021774, 142.0592764235808, 137.51167561476095, 158.5588353332799, 148.9789463022915, 167.57525009352625, 172.12658153726755, 160.50464855790054, 128.35086237502864, 141.76978891098497, 165.11595288286014, 149.34444812622235, 168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6560077859604528, "mean_inference_ms": 1.9118326188420838, "mean_action_processing_ms": 0.3576512191501178, "mean_env_wait_ms": 2.1235381505122457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006395101547241211, "StateBufferConnector_ms": 0.0067174434661865234, "ViewRequirementAgentConnector_ms": 0.22847485542297363}, "num_episodes": 18, "episode_return_max": 183.87043078917074, "episode_return_min": 114.1159130720193, "episode_return_mean": 151.14021924705963, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 501.75678080678665, "num_env_steps_trained_throughput_per_sec": 501.75678080678665, "timesteps_total": 198656, "num_env_steps_sampled_lifetime": 198656, "num_agent_steps_sampled_lifetime": 198656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 198656, "timers": {"training_iteration_time_ms": 2188.403, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2188.403, "sample_time_ms": 912.834, "learn_time_ms": 1257.884, "learn_throughput": 814.065, "synch_weights_time_ms": 17.685}, "counters": {"num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "done": false, "training_iteration": 194, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-33", "timestamp": 1744110513, "time_this_iter_s": 2.0466666221618652, "time_total_s": 425.95423913002014, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D714E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 425.95423913002014, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 32.53333333333334, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8657152485102415, "cur_kl_coeff": 7.965459555662261e-60, "cur_lr": 1e-07, "total_loss": 2.153145031630993, "policy_loss": -0.00041219062404707074, "vf_loss": 9.792273306846619, "vf_explained_var": -4.6852603554725646e-05, "kl": 4.645211075596234e-06, "entropy": 2.945111058652401, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "env_runners": {"episode_reward_max": 183.87043078917074, "episode_reward_min": 114.1159130720193, "episode_reward_mean": 151.08636880868778, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.1159130720193}, "policy_reward_max": {"tplp_policy": 183.87043078917074}, "policy_reward_mean": {"tplp_policy": 151.08636880868778}, "custom_metrics": {"mean_episode_reward_mean": 151.08636880868778, "mean_episode_reward_min": 114.1159130720193, "mean_episode_reward_max": 183.87043078917074}, "hist_stats": {"episode_reward": [168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [168.70608780237737, 152.53083526930612, 152.66087673811526, 166.49829505501953, 147.3662548361568, 126.42888577768005, 154.28149953139112, 147.15124161768148, 161.7210123672248, 155.2351073409205, 150.99564812172142, 134.80499694265387, 183.87043078917074, 146.83709873879343, 152.13785582523883, 124.98994610354654, 143.3720391855265, 144.5864964357961, 154.84803554579912, 149.38767927984037, 164.47086873926253, 156.88818318076991, 131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6559805457840977, "mean_inference_ms": 1.9120041444740759, "mean_action_processing_ms": 0.35759438206029953, "mean_env_wait_ms": 2.12376999433018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075359344482421875, "StateBufferConnector_ms": 0.00821995735168457, "ViewRequirementAgentConnector_ms": 0.20816349983215332}, "num_episodes": 20, "episode_return_max": 183.87043078917074, "episode_return_min": 114.1159130720193, "episode_return_mean": 151.08636880868778, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 462.43550170757896, "num_env_steps_trained_throughput_per_sec": 462.43550170757896, "timesteps_total": 199680, "num_env_steps_sampled_lifetime": 199680, "num_agent_steps_sampled_lifetime": 199680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 199680, "timers": {"training_iteration_time_ms": 2181.482, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2181.482, "sample_time_ms": 899.825, "learn_time_ms": 1263.963, "learn_throughput": 810.15, "synch_weights_time_ms": 17.693}, "counters": {"num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "done": false, "training_iteration": 195, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-35", "timestamp": 1744110515, "time_this_iter_s": 2.2208831310272217, "time_total_s": 428.17512226104736, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 428.17512226104736, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 33.6, "ram_util_percent": 85.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193958768248558, "cur_kl_coeff": 3.9827297778311304e-60, "cur_lr": 1e-07, "total_loss": 2.1776427164673806, "policy_loss": -4.573474870994687e-06, "vf_loss": 9.888991039991378, "vf_explained_var": -7.586926221847534e-05, "kl": 5.08587464055632e-07, "entropy": 2.946004605293274, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "env_runners": {"episode_reward_max": 182.54728247153744, "episode_reward_min": 114.1159130720193, "episode_reward_mean": 151.14951616525192, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 114.1159130720193}, "policy_reward_max": {"tplp_policy": 182.54728247153744}, "policy_reward_mean": {"tplp_policy": 151.14951616525192}, "custom_metrics": {"mean_episode_reward_mean": 151.14951616525192, "mean_episode_reward_min": 114.1159130720193, "mean_episode_reward_max": 182.54728247153744}, "hist_stats": {"episode_reward": [131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [131.86829302908566, 152.40863734770858, 167.8183153566207, 146.67892909854808, 124.77838989936431, 144.93669788915633, 150.25181025094932, 182.54728247153744, 143.06688953123577, 130.10111876160946, 145.57325215373277, 167.49764775275685, 161.44729918758816, 146.16637621872732, 148.50016845263403, 168.9235533051902, 150.4494475170309, 114.1159130720193, 152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6560224286562878, "mean_inference_ms": 1.9123222352954132, "mean_action_processing_ms": 0.3575835855286573, "mean_env_wait_ms": 2.1241533901961986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007531404495239258, "StateBufferConnector_ms": 0.010628223419189453, "ViewRequirementAgentConnector_ms": 0.20845317840576172}, "num_episodes": 22, "episode_return_max": 182.54728247153744, "episode_return_min": 114.1159130720193, "episode_return_mean": 151.14951616525192, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 434.87196451741755, "num_env_steps_trained_throughput_per_sec": 434.87196451741755, "timesteps_total": 200704, "num_env_steps_sampled_lifetime": 200704, "num_agent_steps_sampled_lifetime": 200704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 200704, "timers": {"training_iteration_time_ms": 2208.958, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2208.958, "sample_time_ms": 909.776, "learn_time_ms": 1281.41, "learn_throughput": 799.12, "synch_weights_time_ms": 17.672}, "counters": {"num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "done": false, "training_iteration": 196, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-38", "timestamp": 1744110518, "time_this_iter_s": 2.3615591526031494, "time_total_s": 430.5366814136505, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 430.5366814136505, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 48.96666666666667, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.749869668483734, "cur_kl_coeff": 1.9913648889155652e-60, "cur_lr": 1e-07, "total_loss": 2.181068202853203, "policy_loss": -0.00014074922946747393, "vf_loss": 9.903403556346893, "vf_explained_var": -5.118511617183685e-05, "kl": 1.764730949016524e-06, "entropy": 2.9464191794395447, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "env_runners": {"episode_reward_max": 181.19288263943997, "episode_reward_min": 123.89308680667108, "episode_reward_mean": 152.07709512569605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.89308680667108}, "policy_reward_max": {"tplp_policy": 181.19288263943997}, "policy_reward_mean": {"tplp_policy": 152.07709512569605}, "custom_metrics": {"mean_episode_reward_mean": 152.07709512569605, "mean_episode_reward_min": 123.89308680667108, "mean_episode_reward_max": 181.19288263943997}, "hist_stats": {"episode_reward": [152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.9727647102213, 144.78267682765352, 145.9145307622376, 155.56638934266277, 147.03424672970004, 147.47221380558324, 134.4212065579603, 159.02664282316667, 168.01283153972236, 145.5007712175855, 154.4054058157684, 151.79528592526228, 166.90042721716193, 172.95275310049448, 151.2875524524635, 162.76748585202375, 139.1016445612951, 161.48480686515543, 156.52368361142953, 155.83043000245274, 166.46528043998126, 149.22473951423214, 152.66340604462192, 154.69151161180085, 134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6559524863999742, "mean_inference_ms": 1.9124311020885905, "mean_action_processing_ms": 0.35756626106954065, "mean_env_wait_ms": 2.12441326807906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008596658706665039, "StateBufferConnector_ms": 0.00963449478149414, "ViewRequirementAgentConnector_ms": 0.20276141166687012}, "num_episodes": 18, "episode_return_max": 181.19288263943997, "episode_return_min": 123.89308680667108, "episode_return_mean": 152.07709512569605, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 456.00425706307664, "num_env_steps_trained_throughput_per_sec": 456.00425706307664, "timesteps_total": 201728, "num_env_steps_sampled_lifetime": 201728, "num_agent_steps_sampled_lifetime": 201728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 201728, "timers": {"training_iteration_time_ms": 2225.681, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2225.681, "sample_time_ms": 916.67, "learn_time_ms": 1291.237, "learn_throughput": 793.038, "synch_weights_time_ms": 17.674}, "counters": {"num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "done": false, "training_iteration": 197, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-40", "timestamp": 1744110520, "time_this_iter_s": 2.2513599395751953, "time_total_s": 432.7880413532257, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 432.7880413532257, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 34.675, "ram_util_percent": 85.57499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7568492740392685, "cur_kl_coeff": 9.956824444577826e-61, "cur_lr": 1e-07, "total_loss": 2.169512878358364, "policy_loss": -0.00016820046002976596, "vf_loss": 9.857812768220901, "vf_explained_var": -3.691241145133972e-05, "kl": 2.7484976114822145e-06, "entropy": 2.947721266746521, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "env_runners": {"episode_reward_max": 181.19288263943997, "episode_reward_min": 123.89308680667108, "episode_reward_mean": 151.27946371775926, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.89308680667108}, "policy_reward_max": {"tplp_policy": 181.19288263943997}, "policy_reward_mean": {"tplp_policy": 151.27946371775926}, "custom_metrics": {"mean_episode_reward_mean": 151.27946371775926, "mean_episode_reward_min": 123.89308680667108, "mean_episode_reward_max": 181.19288263943997}, "hist_stats": {"episode_reward": [134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [134.20316396055662, 138.13499140542757, 172.59854092816002, 154.3727677990342, 144.14176643033426, 152.89648895875575, 151.37934548215168, 140.85470851256378, 155.1688350382434, 138.969743224809, 152.42410383243643, 158.12244355701887, 152.33676823485158, 142.71273846098632, 139.83055873949573, 160.3480347584601, 167.67925728494365, 160.64916156988912, 152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6557736393121842, "mean_inference_ms": 1.9124797355949912, "mean_action_processing_ms": 0.3575738827375603, "mean_env_wait_ms": 2.1245965348218037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073070526123046875, "StateBufferConnector_ms": 0.009433269500732422, "ViewRequirementAgentConnector_ms": 0.2018129825592041}, "num_episodes": 24, "episode_return_max": 181.19288263943997, "episode_return_min": 123.89308680667108, "episode_return_mean": 151.27946371775926, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 466.15451462960294, "num_env_steps_trained_throughput_per_sec": 466.15451462960294, "timesteps_total": 202752, "num_env_steps_sampled_lifetime": 202752, "num_agent_steps_sampled_lifetime": 202752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 202752, "timers": {"training_iteration_time_ms": 2215.094, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2215.094, "sample_time_ms": 913.021, "learn_time_ms": 1284.247, "learn_throughput": 797.355, "synch_weights_time_ms": 17.726}, "counters": {"num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "done": false, "training_iteration": 198, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-42", "timestamp": 1744110522, "time_this_iter_s": 2.2023773193359375, "time_total_s": 434.99041867256165, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D720C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 434.99041867256165, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 39.733333333333334, "ram_util_percent": 85.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2812965981662274, "cur_kl_coeff": 4.978412222288913e-61, "cur_lr": 1e-07, "total_loss": 2.187404938787222, "policy_loss": -6.228634738363326e-05, "vf_loss": 9.929510998725892, "vf_explained_var": -4.356652498245239e-05, "kl": 1.3447858481036024e-06, "entropy": 2.9491053119301798, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "env_runners": {"episode_reward_max": 181.19288263943997, "episode_reward_min": 123.89308680667108, "episode_reward_mean": 152.3465468884474, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.89308680667108}, "policy_reward_max": {"tplp_policy": 181.19288263943997}, "policy_reward_mean": {"tplp_policy": 152.3465468884474}, "custom_metrics": {"mean_episode_reward_mean": 152.3465468884474, "mean_episode_reward_min": 123.89308680667108, "mean_episode_reward_max": 181.19288263943997}, "hist_stats": {"episode_reward": [152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.12844976805832, 139.43819041147253, 155.726417704278, 141.77496026942669, 148.8449203416574, 151.47613581274877, 150.028927582387, 146.36691010846036, 134.41005620241134, 161.89101526122244, 174.8456232447449, 150.18380419886913, 143.4528283252321, 137.62879437269558, 163.9819763725139, 128.87219531709005, 156.87755759698547, 140.18661595028217, 140.19822177480313, 173.50438111186702, 145.37857370911902, 156.29436104424826, 137.9359746953375, 147.18645184869368, 145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6557723001484028, "mean_inference_ms": 1.9127022821663398, "mean_action_processing_ms": 0.3576154260110171, "mean_env_wait_ms": 2.1249231425103416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0063016414642333984, "StateBufferConnector_ms": 0.006925106048583984, "ViewRequirementAgentConnector_ms": 0.19874930381774902}, "num_episodes": 18, "episode_return_max": 181.19288263943997, "episode_return_min": 123.89308680667108, "episode_return_mean": 152.3465468884474, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 446.4448010717251, "num_env_steps_trained_throughput_per_sec": 446.4448010717251, "timesteps_total": 203776, "num_env_steps_sampled_lifetime": 203776, "num_agent_steps_sampled_lifetime": 203776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 203776, "timers": {"training_iteration_time_ms": 2219.506, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2219.506, "sample_time_ms": 907.174, "learn_time_ms": 1294.46, "learn_throughput": 791.064, "synch_weights_time_ms": 17.773}, "counters": {"num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "done": false, "training_iteration": 199, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-45", "timestamp": 1744110525, "time_this_iter_s": 2.2993838787078857, "time_total_s": 437.28980255126953, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 437.28980255126953, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 45.800000000000004, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4821432009339333, "cur_kl_coeff": 2.4892061111444565e-61, "cur_lr": 1e-07, "total_loss": 2.1883718475699423, "policy_loss": -5.052859778515994e-05, "vf_loss": 9.93360856771469, "vf_explained_var": -3.228411078453064e-05, "kl": 8.778176334711674e-07, "entropy": 2.9497978419065474, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "env_runners": {"episode_reward_max": 181.19288263943997, "episode_reward_min": 123.89308680667108, "episode_reward_mean": 152.8778771861846, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 123.89308680667108}, "policy_reward_max": {"tplp_policy": 181.19288263943997}, "policy_reward_mean": {"tplp_policy": 152.8778771861846}, "custom_metrics": {"mean_episode_reward_mean": 152.8778771861846, "mean_episode_reward_min": 123.89308680667108, "mean_episode_reward_max": 181.19288263943997}, "hist_stats": {"episode_reward": [145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.37644190193853, 181.19288263943997, 146.94310340149252, 163.17382097741975, 146.46757029671315, 153.60762105786281, 172.55222590706882, 164.50892863340772, 133.39629061514393, 154.67825122826832, 178.6959117666436, 143.1597216145525, 144.96510410567294, 123.89308680667108, 141.35358305540424, 151.62160268863832, 142.29665587680105, 154.38465334003456, 160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.656010927899985, "mean_inference_ms": 1.9134466987488947, "mean_action_processing_ms": 0.3576574312298164, "mean_env_wait_ms": 2.1254137258040005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0060749053955078125, "StateBufferConnector_ms": 0.006310939788818359, "ViewRequirementAgentConnector_ms": 0.2085866928100586}, "num_episodes": 24, "episode_return_max": 181.19288263943997, "episode_return_min": 123.89308680667108, "episode_return_mean": 152.8778771861846, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 456.45743355889977, "num_env_steps_trained_throughput_per_sec": 456.45743355889977, "timesteps_total": 204800, "num_env_steps_sampled_lifetime": 204800, "num_agent_steps_sampled_lifetime": 204800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 204800, "timers": {"training_iteration_time_ms": 2241.304, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2241.304, "sample_time_ms": 922.224, "learn_time_ms": 1301.449, "learn_throughput": 786.816, "synch_weights_time_ms": 17.531}, "counters": {"num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "done": false, "training_iteration": 200, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-47", "timestamp": 1744110527, "time_this_iter_s": 2.2477211952209473, "time_total_s": 439.5375237464905, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 439.5375237464905, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 46.166666666666664, "ram_util_percent": 85.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4902745448052883, "cur_kl_coeff": 1.2446030555722282e-61, "cur_lr": 1e-07, "total_loss": 2.171568398177624, "policy_loss": -1.7269281670451164e-05, "vf_loss": 9.866574692726136, "vf_explained_var": -5.9767067432403566e-05, "kl": 6.972369707619608e-07, "entropy": 2.950580082833767, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "env_runners": {"episode_reward_max": 176.9976767626791, "episode_reward_min": 124.29213890011869, "episode_reward_mean": 151.7956063062917, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.29213890011869}, "policy_reward_max": {"tplp_policy": 176.9976767626791}, "policy_reward_mean": {"tplp_policy": 151.7956063062917}, "custom_metrics": {"mean_episode_reward_mean": 151.7956063062917, "mean_episode_reward_min": 124.29213890011869, "mean_episode_reward_max": 176.9976767626791}, "hist_stats": {"episode_reward": [160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [160.11409313087208, 150.1274339900833, 137.00819018733722, 158.41771326977678, 138.37712015357423, 152.19205126839796, 167.8018175499787, 173.2361920953708, 138.1742260464551, 164.39504698384644, 140.57839345820483, 167.87789565757978, 149.1008472693833, 164.469771597541, 159.37432282586673, 151.9614926388033, 150.91299833046267, 140.42554145463052, 154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6560328699713878, "mean_inference_ms": 1.9138355221747179, "mean_action_processing_ms": 0.357838511218446, "mean_env_wait_ms": 2.126061788166495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006072998046875, "StateBufferConnector_ms": 0.0053060054779052734, "ViewRequirementAgentConnector_ms": 0.2020888328552246}, "num_episodes": 18, "episode_return_max": 176.9976767626791, "episode_return_min": 124.29213890011869, "episode_return_mean": 151.7956063062917, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.3477877469726, "num_env_steps_trained_throughput_per_sec": 467.3477877469726, "timesteps_total": 205824, "num_env_steps_sampled_lifetime": 205824, "num_agent_steps_sampled_lifetime": 205824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 205824, "timers": {"training_iteration_time_ms": 2242.357, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2242.357, "sample_time_ms": 924.99, "learn_time_ms": 1300.319, "learn_throughput": 787.499, "synch_weights_time_ms": 16.948}, "counters": {"num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "done": false, "training_iteration": 201, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-49", "timestamp": 1744110529, "time_this_iter_s": 2.197634696960449, "time_total_s": 441.7351584434509, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C234C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 441.7351584434509, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 30.7, "ram_util_percent": 85.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0652190539985895, "cur_kl_coeff": 6.223015277861141e-62, "cur_lr": 1e-07, "total_loss": 2.180119612812996, "policy_loss": -4.169050371274352e-05, "vf_loss": 9.900998562574387, "vf_explained_var": -4.648864269256592e-05, "kl": 3.388438474249966e-07, "entropy": 2.9508834302425386, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "env_runners": {"episode_reward_max": 177.30990125215723, "episode_reward_min": 124.29213890011869, "episode_reward_mean": 151.05289277399507, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.29213890011869}, "policy_reward_max": {"tplp_policy": 177.30990125215723}, "policy_reward_mean": {"tplp_policy": 151.05289277399507}, "custom_metrics": {"mean_episode_reward_mean": 151.05289277399507, "mean_episode_reward_min": 124.29213890011869, "mean_episode_reward_max": 177.30990125215723}, "hist_stats": {"episode_reward": [154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [154.39377853277128, 137.12861518095383, 150.68635584655988, 161.05999216540613, 151.4901289188596, 158.3277520079774, 176.1165888998327, 163.47883975933522, 151.9953203042082, 154.71501211783465, 149.0793495199898, 146.88599768016863, 133.24118879072685, 176.9976767626791, 131.42729881619542, 152.54068734916245, 153.98723734612128, 138.85157035847132, 155.35121203927704, 138.28106459097395, 159.32832721007057, 130.33301255428748, 170.59424669546135, 140.9838989417759, 161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6561402695880122, "mean_inference_ms": 1.9140509692585062, "mean_action_processing_ms": 0.3579033588676387, "mean_env_wait_ms": 2.1261895967020057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003992795944213867, "StateBufferConnector_ms": 0.005308866500854492, "ViewRequirementAgentConnector_ms": 0.20542216300964355}, "num_episodes": 18, "episode_return_max": 177.30990125215723, "episode_return_min": 124.29213890011869, "episode_return_mean": 151.05289277399507, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 477.8167087823491, "num_env_steps_trained_throughput_per_sec": 477.8167087823491, "timesteps_total": 206848, "num_env_steps_sampled_lifetime": 206848, "num_agent_steps_sampled_lifetime": 206848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 206848, "timers": {"training_iteration_time_ms": 2214.982, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2214.982, "sample_time_ms": 909.618, "learn_time_ms": 1288.665, "learn_throughput": 794.621, "synch_weights_time_ms": 16.6}, "counters": {"num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "done": false, "training_iteration": 202, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-51", "timestamp": 1744110531, "time_this_iter_s": 2.1489648818969727, "time_total_s": 443.8841233253479, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 443.8841233253479, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 32.233333333333334, "ram_util_percent": 85.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.802169265598059, "cur_kl_coeff": 3.1115076389305706e-62, "cur_lr": 1e-07, "total_loss": 2.149845302850008, "policy_loss": -0.00016384185291826726, "vf_loss": 9.780364155769348, "vf_explained_var": -4.26165759563446e-05, "kl": 1.5114123556946025e-06, "entropy": 2.950818897783756, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "env_runners": {"episode_reward_max": 177.30990125215723, "episode_reward_min": 124.29213890011869, "episode_reward_mean": 151.0193161773735, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.29213890011869}, "policy_reward_max": {"tplp_policy": 177.30990125215723}, "policy_reward_mean": {"tplp_policy": 151.0193161773735}, "custom_metrics": {"mean_episode_reward_mean": 151.0193161773735, "mean_episode_reward_min": 124.29213890011869, "mean_episode_reward_max": 177.30990125215723}, "hist_stats": {"episode_reward": [161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [161.83109204618322, 167.7276978521505, 143.81365995543726, 172.30625353545213, 173.24821333513017, 154.49881654842207, 146.3499713665561, 146.86353563617487, 153.93382913823626, 161.89081805308572, 150.8504499271924, 163.3688092915324, 160.42620241312576, 147.45916328107756, 169.14169787709784, 138.24337935284302, 150.30029630257226, 150.89372460012277, 136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.656391077554598, "mean_inference_ms": 1.9144852296819612, "mean_action_processing_ms": 0.35796323695130133, "mean_env_wait_ms": 2.1264405870245544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005987405776977539, "StateBufferConnector_ms": 0.004371166229248047, "ViewRequirementAgentConnector_ms": 0.2066783905029297}, "num_episodes": 24, "episode_return_max": 177.30990125215723, "episode_return_min": 124.29213890011869, "episode_return_mean": 151.0193161773735, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.2711271873009, "num_env_steps_trained_throughput_per_sec": 445.2711271873009, "timesteps_total": 207872, "num_env_steps_sampled_lifetime": 207872, "num_agent_steps_sampled_lifetime": 207872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 207872, "timers": {"training_iteration_time_ms": 2222.313, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2222.313, "sample_time_ms": 908.429, "learn_time_ms": 1296.793, "learn_throughput": 789.64, "synch_weights_time_ms": 16.991}, "counters": {"num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "done": false, "training_iteration": 203, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-54", "timestamp": 1744110534, "time_this_iter_s": 2.3066914081573486, "time_total_s": 446.19081473350525, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 446.19081473350525, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 46.699999999999996, "ram_util_percent": 85.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.522129790484905, "cur_kl_coeff": 1.5557538194652853e-62, "cur_lr": 1e-07, "total_loss": 2.1725374422967434, "policy_loss": -0.00024081821320578455, "vf_loss": 9.871660429239274, "vf_explained_var": -3.117434680461883e-05, "kl": 2.7087259630409475e-06, "entropy": 2.9513683930039405, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "env_runners": {"episode_reward_max": 177.30990125215723, "episode_reward_min": 121.07197622707938, "episode_reward_mean": 150.06459038061124, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.07197622707938}, "policy_reward_max": {"tplp_policy": 177.30990125215723}, "policy_reward_mean": {"tplp_policy": 150.06459038061124}, "custom_metrics": {"mean_episode_reward_mean": 150.06459038061124, "mean_episode_reward_min": 121.07197622707938, "mean_episode_reward_max": 177.30990125215723}, "hist_stats": {"episode_reward": [136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [136.14531341270708, 142.232323947729, 149.4120127405212, 146.0449479033171, 166.45665286348057, 155.30492968308312, 151.4634950266959, 147.52723620451258, 157.16382712206916, 162.5905839821312, 158.88847532932166, 144.01928033827897, 147.02940959756236, 153.78047164086354, 154.88708106125404, 144.76842284680512, 135.66528590410837, 140.739266538489, 140.40946016714466, 165.8351566906828, 161.40220427744399, 168.78651461743172, 166.00755573008962, 125.43672871007276, 139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6565076749137924, "mean_inference_ms": 1.9146455467618078, "mean_action_processing_ms": 0.3579889980860145, "mean_env_wait_ms": 2.1265060020931625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070037841796875, "StateBufferConnector_ms": 0.004371166229248047, "ViewRequirementAgentConnector_ms": 0.20420575141906738}, "num_episodes": 18, "episode_return_max": 177.30990125215723, "episode_return_min": 121.07197622707938, "episode_return_mean": 150.06459038061124, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 483.02318540190475, "num_env_steps_trained_throughput_per_sec": 483.02318540190475, "timesteps_total": 208896, "num_env_steps_sampled_lifetime": 208896, "num_agent_steps_sampled_lifetime": 208896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 208896, "timers": {"training_iteration_time_ms": 2230.228, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2230.228, "sample_time_ms": 912.422, "learn_time_ms": 1300.54, "learn_throughput": 787.365, "synch_weights_time_ms": 17.167}, "counters": {"num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "done": false, "training_iteration": 204, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-56", "timestamp": 1744110536, "time_this_iter_s": 2.125636339187622, "time_total_s": 448.31645107269287, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 448.31645107269287, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 36.0, "ram_util_percent": 85.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.014328028261661, "cur_kl_coeff": 7.778769097326426e-63, "cur_lr": 1e-07, "total_loss": 2.1691106997430323, "policy_loss": -0.00014220753218978642, "vf_loss": 9.857615488767625, "vf_explained_var": -2.3506581783294678e-05, "kl": 1.1241725847960238e-06, "entropy": 2.951509580016136, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "env_runners": {"episode_reward_max": 177.30990125215723, "episode_reward_min": 121.07197622707938, "episode_reward_mean": 150.31644997085093, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.07197622707938}, "policy_reward_max": {"tplp_policy": 177.30990125215723}, "policy_reward_mean": {"tplp_policy": 150.31644997085093}, "custom_metrics": {"mean_episode_reward_mean": 150.31644997085093, "mean_episode_reward_min": 121.07197622707938, "mean_episode_reward_max": 177.30990125215723}, "hist_stats": {"episode_reward": [139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [139.3027278056117, 144.8820265768148, 145.77567549605618, 167.56095771010632, 140.69334719268298, 140.26701910736014, 130.9788534061132, 139.46051665989987, 158.5944942478731, 137.89920203793017, 140.32186398329586, 155.4504493875074, 163.30746709632112, 163.47258971144643, 150.33675416457604, 124.29213890011869, 143.90376460522745, 155.3135895475426, 155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6565638611540037, "mean_inference_ms": 1.9145444442091462, "mean_action_processing_ms": 0.3580086955906714, "mean_env_wait_ms": 2.126287108430918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008021116256713867, "StateBufferConnector_ms": 0.0027146339416503906, "ViewRequirementAgentConnector_ms": 0.19918155670166016}, "num_episodes": 24, "episode_return_max": 177.30990125215723, "episode_return_min": 121.07197622707938, "episode_return_mean": 150.31644997085093, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 485.98489192156836, "num_env_steps_trained_throughput_per_sec": 485.98489192156836, "timesteps_total": 209920, "num_env_steps_sampled_lifetime": 209920, "num_agent_steps_sampled_lifetime": 209920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 209920, "timers": {"training_iteration_time_ms": 2219.498, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2219.498, "sample_time_ms": 917.59, "learn_time_ms": 1284.69, "learn_throughput": 797.08, "synch_weights_time_ms": 17.119}, "counters": {"num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "done": false, "training_iteration": 205, "trial_id": "b517c_00000", "date": "2025-04-08_19-08-58", "timestamp": 1744110538, "time_this_iter_s": 2.1119627952575684, "time_total_s": 450.42841386795044, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.42841386795044, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 32.46666666666667, "ram_util_percent": 85.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3198396764695643, "cur_kl_coeff": 3.889384548663213e-63, "cur_lr": 1e-07, "total_loss": 2.185616623610258, "policy_loss": -7.478150073438882e-05, "vf_loss": 9.923337334394455, "vf_explained_var": -6.60531222820282e-05, "kl": 1.0706920113845442e-06, "entropy": 2.9514293298125267, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "env_runners": {"episode_reward_max": 193.1801734303508, "episode_reward_min": 121.07197622707938, "episode_reward_mean": 152.20935132448943, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.07197622707938}, "policy_reward_max": {"tplp_policy": 193.1801734303508}, "policy_reward_mean": {"tplp_policy": 152.20935132448943}, "custom_metrics": {"mean_episode_reward_mean": 152.20935132448943, "mean_episode_reward_min": 121.07197622707938, "mean_episode_reward_max": 193.1801734303508}, "hist_stats": {"episode_reward": [155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.55460112729432, 163.09359964769092, 143.1965949019676, 152.5303413908025, 177.30990125215723, 149.64840935569828, 132.40789568894567, 153.0516752001339, 136.68635632485686, 133.5670709159003, 146.2093115396645, 159.72546410293532, 129.66963049919744, 159.30595618224876, 153.5217759346457, 145.5778564615968, 161.85806090714672, 151.81583101041673, 146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6566034328472677, "mean_inference_ms": 1.914444276755793, "mean_action_processing_ms": 0.3580037497195437, "mean_env_wait_ms": 2.1261692958363256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006028413772583008, "StateBufferConnector_ms": 0.0037126541137695312, "ViewRequirementAgentConnector_ms": 0.21139097213745117}, "num_episodes": 18, "episode_return_max": 193.1801734303508, "episode_return_min": 121.07197622707938, "episode_return_mean": 152.20935132448943, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 446.16106859246275, "num_env_steps_trained_throughput_per_sec": 446.16106859246275, "timesteps_total": 210944, "num_env_steps_sampled_lifetime": 210944, "num_agent_steps_sampled_lifetime": 210944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 210944, "timers": {"training_iteration_time_ms": 2213.54, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.54, "sample_time_ms": 910.774, "learn_time_ms": 1285.378, "learn_throughput": 796.653, "synch_weights_time_ms": 17.387}, "counters": {"num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "done": false, "training_iteration": 206, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-00", "timestamp": 1744110540, "time_this_iter_s": 2.301600933074951, "time_total_s": 452.7300148010254, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71A80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 452.7300148010254, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 34.85, "ram_util_percent": 85.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3855449806898834, "cur_kl_coeff": 1.9446922743316066e-63, "cur_lr": 1e-07, "total_loss": 2.1673380620777607, "policy_loss": -6.920053856447339e-05, "vf_loss": 9.850449270009994, "vf_explained_var": -3.79856675863266e-05, "kl": 9.020442143015117e-07, "entropy": 2.952050468325615, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "env_runners": {"episode_reward_max": 193.1801734303508, "episode_reward_min": 121.07197622707938, "episode_reward_mean": 152.08914158314684, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.07197622707938}, "policy_reward_max": {"tplp_policy": 193.1801734303508}, "policy_reward_mean": {"tplp_policy": 152.08914158314684}, "custom_metrics": {"mean_episode_reward_mean": 152.08914158314684, "mean_episode_reward_min": 121.07197622707938, "mean_episode_reward_max": 193.1801734303508}, "hist_stats": {"episode_reward": [146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [146.26975027285803, 149.48420839124216, 166.77886587618983, 155.10499657869252, 145.04345916476015, 145.31717766473645, 169.8111307500787, 132.78431515890892, 138.05708680590217, 161.39349297028113, 132.54082383655037, 158.68867617815138, 155.06209527301303, 135.0076454430549, 164.81154525184712, 161.8520270482662, 150.38622825796799, 150.83953998360928, 151.7576963872954, 156.83395761648663, 134.26372669953102, 158.15515519995262, 148.0962654613432, 138.64438309174972, 159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6567218705262651, "mean_inference_ms": 1.9146348255530268, "mean_action_processing_ms": 0.35806262993529353, "mean_env_wait_ms": 2.126354913614223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006028175354003906, "StateBufferConnector_ms": 0.00574040412902832, "ViewRequirementAgentConnector_ms": 0.21360301971435547}, "num_episodes": 18, "episode_return_max": 193.1801734303508, "episode_return_min": 121.07197622707938, "episode_return_mean": 152.08914158314684, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 443.5104169463368, "num_env_steps_trained_throughput_per_sec": 443.5104169463368, "timesteps_total": 211968, "num_env_steps_sampled_lifetime": 211968, "num_agent_steps_sampled_lifetime": 211968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 211968, "timers": {"training_iteration_time_ms": 2219.866, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2219.866, "sample_time_ms": 915.934, "learn_time_ms": 1286.564, "learn_throughput": 795.919, "synch_weights_time_ms": 17.369}, "counters": {"num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "done": false, "training_iteration": 207, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-03", "timestamp": 1744110543, "time_this_iter_s": 2.3161823749542236, "time_total_s": 455.0461971759796, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70A40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.0461971759796, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 49.866666666666674, "ram_util_percent": 85.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3981062162667515, "cur_kl_coeff": 9.723461371658033e-64, "cur_lr": 1e-07, "total_loss": 2.168863108754158, "policy_loss": -0.0001193682081066072, "vf_loss": 9.856798553466797, "vf_explained_var": -4.697777330875397e-05, "kl": 1.0772560906424643e-06, "entropy": 2.95217145383358, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "env_runners": {"episode_reward_max": 193.1801734303508, "episode_reward_min": 121.07197622707938, "episode_reward_mean": 153.049662011162, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.07197622707938}, "policy_reward_max": {"tplp_policy": 193.1801734303508}, "policy_reward_mean": {"tplp_policy": 153.049662011162}, "custom_metrics": {"mean_episode_reward_mean": 153.049662011162, "mean_episode_reward_min": 121.07197622707938, "mean_episode_reward_max": 193.1801734303508}, "hist_stats": {"episode_reward": [159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [159.88211629790246, 158.42239775414183, 163.82503068745876, 144.67899934241478, 138.66832594904287, 149.02815508232584, 121.07197622707938, 136.12371721889627, 167.06912409714673, 166.2870567263004, 153.55162345915463, 134.86730665495335, 162.2538684978621, 166.24448289197207, 138.24241559839615, 170.7177857980291, 155.22659884773478, 159.458000206966, 166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6567027204631999, "mean_inference_ms": 1.9145627578682154, "mean_action_processing_ms": 0.3581416038573916, "mean_env_wait_ms": 2.1263074186848527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006433725357055664, "StateBufferConnector_ms": 0.0066869258880615234, "ViewRequirementAgentConnector_ms": 0.18494057655334473}, "num_episodes": 24, "episode_return_max": 193.1801734303508, "episode_return_min": 121.07197622707938, "episode_return_mean": 153.049662011162, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 502.47093525703366, "num_env_steps_trained_throughput_per_sec": 502.47093525703366, "timesteps_total": 212992, "num_env_steps_sampled_lifetime": 212992, "num_agent_steps_sampled_lifetime": 212992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 212992, "timers": {"training_iteration_time_ms": 2203.989, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2203.989, "sample_time_ms": 909.403, "learn_time_ms": 1277.512, "learn_throughput": 801.558, "synch_weights_time_ms": 17.074}, "counters": {"num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "done": false, "training_iteration": 208, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-05", "timestamp": 1744110545, "time_this_iter_s": 2.042269229888916, "time_total_s": 457.08846640586853, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 457.08846640586853, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 31.400000000000002, "ram_util_percent": 85.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.539871644973755, "cur_kl_coeff": 4.8617306858290166e-64, "cur_lr": 1e-07, "total_loss": 2.172658509761095, "policy_loss": -8.656809804961086e-05, "vf_loss": 9.87200175523758, "vf_explained_var": -4.717521369457245e-05, "kl": 1.3164649417918284e-06, "entropy": 2.9525536820292473, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "env_runners": {"episode_reward_max": 193.1801734303508, "episode_reward_min": 121.83858791549686, "episode_reward_mean": 151.99059439369094, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.83858791549686}, "policy_reward_max": {"tplp_policy": 193.1801734303508}, "policy_reward_mean": {"tplp_policy": 151.99059439369094}, "custom_metrics": {"mean_episode_reward_mean": 151.99059439369094, "mean_episode_reward_min": 121.83858791549686, "mean_episode_reward_max": 193.1801734303508}, "hist_stats": {"episode_reward": [166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [166.392780939085, 151.01512009144784, 154.6225001528979, 157.73349946941715, 146.38600358591367, 133.31305892136095, 149.0152039702018, 168.08572304879686, 144.2501895597719, 148.0818727883903, 134.17203206141116, 154.10832227449, 164.09801209030076, 151.31148026623612, 156.43257514990756, 153.2210755775029, 144.11951231939796, 145.08032767853547, 170.56174468018608, 164.67976155088527, 139.21724756241395, 136.59995256650933, 130.25389176806516, 153.96101086194003, 151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6566462077554427, "mean_inference_ms": 1.9144871819198053, "mean_action_processing_ms": 0.3581901881154311, "mean_env_wait_ms": 2.1262306659986923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005417346954345703, "StateBufferConnector_ms": 0.007192134857177734, "ViewRequirementAgentConnector_ms": 0.1864933967590332}, "num_episodes": 18, "episode_return_max": 193.1801734303508, "episode_return_min": 121.83858791549686, "episode_return_mean": 151.99059439369094, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 485.4151468084022, "num_env_steps_trained_throughput_per_sec": 485.4151468084022, "timesteps_total": 214016, "num_env_steps_sampled_lifetime": 214016, "num_agent_steps_sampled_lifetime": 214016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 214016, "timers": {"training_iteration_time_ms": 2185.575, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2185.575, "sample_time_ms": 901.131, "learn_time_ms": 1267.268, "learn_throughput": 808.038, "synch_weights_time_ms": 17.076}, "counters": {"num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "done": false, "training_iteration": 209, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-07", "timestamp": 1744110547, "time_this_iter_s": 2.114682674407959, "time_total_s": 459.2031490802765, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 459.2031490802765, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 29.766666666666666, "ram_util_percent": 85.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3845521554350855, "cur_kl_coeff": 2.4308653429145083e-64, "cur_lr": 1e-07, "total_loss": 2.180086374282837, "policy_loss": -2.479043323546648e-05, "vf_loss": 9.90175604224205, "vf_explained_var": -6.035566329956055e-05, "kl": 6.044766257339019e-07, "entropy": 2.9532784327864645, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "env_runners": {"episode_reward_max": 193.1801734303508, "episode_reward_min": 121.83858791549686, "episode_reward_mean": 152.70001016450436, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.83858791549686}, "policy_reward_max": {"tplp_policy": 193.1801734303508}, "policy_reward_mean": {"tplp_policy": 152.70001016450436}, "custom_metrics": {"mean_episode_reward_mean": 152.70001016450436, "mean_episode_reward_min": 121.83858791549686, "mean_episode_reward_max": 193.1801734303508}, "hist_stats": {"episode_reward": [151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.0145716532786, 167.14128110439827, 176.58277799820794, 158.39308517523088, 193.1801734303508, 164.48785471870605, 140.23074259529463, 157.53644835622563, 157.9790402678181, 148.72173347994172, 141.98574883134495, 147.8295930970871, 162.95864048318242, 169.34031308932722, 153.73632954320195, 155.77033654673465, 121.83858791549686, 125.51225728994228, 179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.656617335174636, "mean_inference_ms": 1.9146919699021736, "mean_action_processing_ms": 0.3582375345398054, "mean_env_wait_ms": 2.126480728950891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033974647521972656, "StateBufferConnector_ms": 0.00955653190612793, "ViewRequirementAgentConnector_ms": 0.19939088821411133}, "num_episodes": 24, "episode_return_max": 193.1801734303508, "episode_return_min": 121.83858791549686, "episode_return_mean": 152.70001016450436, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 420.25745353551247, "num_env_steps_trained_throughput_per_sec": 420.25745353551247, "timesteps_total": 215040, "num_env_steps_sampled_lifetime": 215040, "num_agent_steps_sampled_lifetime": 215040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 2204.899, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2204.899, "sample_time_ms": 900.985, "learn_time_ms": 1286.65, "learn_throughput": 795.865, "synch_weights_time_ms": 17.163}, "counters": {"num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "done": false, "training_iteration": 210, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-09", "timestamp": 1744110549, "time_this_iter_s": 2.4415431022644043, "time_total_s": 461.6446921825409, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 461.6446921825409, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 48.9, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.055249700695276, "cur_kl_coeff": 1.2154326714572541e-64, "cur_lr": 1e-07, "total_loss": 2.171128253638744, "policy_loss": -0.0003890308202244341, "vf_loss": 9.867616981267929, "vf_explained_var": -5.057342350482941e-05, "kl": 4.305307800137048e-06, "entropy": 2.9538696870207786, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "env_runners": {"episode_reward_max": 182.4240467875312, "episode_reward_min": 125.68343984827537, "episode_reward_mean": 152.0498923014556, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.68343984827537}, "policy_reward_max": {"tplp_policy": 182.4240467875312}, "policy_reward_mean": {"tplp_policy": 152.0498923014556}, "custom_metrics": {"mean_episode_reward_mean": 152.0498923014556, "mean_episode_reward_min": 125.68343984827537, "mean_episode_reward_max": 182.4240467875312}, "hist_stats": {"episode_reward": [179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [179.01742223765376, 168.99834295481574, 155.09823833445154, 147.6466949379204, 162.99296021149698, 134.35222631811604, 144.23847743914644, 165.88608842180773, 158.7495839957394, 148.54010832756705, 141.7140124372067, 145.4336024062684, 161.5903102783211, 142.75658266123213, 145.71389014337595, 142.62997199848002, 163.63496928079408, 141.57718809526784, 149.64203465658971, 161.20595583597358, 169.27198184649427, 150.43279193441177, 155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6566525551806337, "mean_inference_ms": 1.9149942966753233, "mean_action_processing_ms": 0.3582969573400287, "mean_env_wait_ms": 2.126749207920472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004406452178955078, "StateBufferConnector_ms": 0.010552644729614258, "ViewRequirementAgentConnector_ms": 0.18458223342895508}, "num_episodes": 18, "episode_return_max": 182.4240467875312, "episode_return_min": 125.68343984827537, "episode_return_mean": 152.0498923014556, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 449.04524058082535, "num_env_steps_trained_throughput_per_sec": 449.04524058082535, "timesteps_total": 216064, "num_env_steps_sampled_lifetime": 216064, "num_agent_steps_sampled_lifetime": 216064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 216064, "timers": {"training_iteration_time_ms": 2213.829, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.829, "sample_time_ms": 907.321, "learn_time_ms": 1288.714, "learn_throughput": 794.59, "synch_weights_time_ms": 17.694}, "counters": {"num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "done": false, "training_iteration": 211, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-12", "timestamp": 1744110552, "time_this_iter_s": 2.286384105682373, "time_total_s": 463.93107628822327, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 463.93107628822327, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4316083688288925, "cur_kl_coeff": 6.077163357286271e-65, "cur_lr": 1e-07, "total_loss": 2.1793712131679057, "policy_loss": -2.4458422558382154e-05, "vf_loss": 9.89964365363121, "vf_explained_var": -3.0040740966796875e-05, "kl": 1.4419560836226308e-06, "entropy": 2.955152389407158, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "env_runners": {"episode_reward_max": 182.4240467875312, "episode_reward_min": 125.68343984827537, "episode_reward_mean": 151.53272831867883, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.68343984827537}, "policy_reward_max": {"tplp_policy": 182.4240467875312}, "policy_reward_mean": {"tplp_policy": 151.53272831867883}, "custom_metrics": {"mean_episode_reward_mean": 151.53272831867883, "mean_episode_reward_min": 125.68343984827537, "mean_episode_reward_max": 182.4240467875312}, "hist_stats": {"episode_reward": [155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.05992845503616, 164.1606478271597, 130.54827144972006, 146.77128105560863, 163.5549766847111, 152.860600720248, 151.97823550637412, 161.83978256994962, 140.48120325238995, 150.19394521479063, 155.7087002835854, 155.5675285032693, 156.65473328865696, 170.41547723899836, 141.12274851964546, 146.3107625051162, 156.07015335263316, 167.972394086563, 135.0246176028491, 142.61253743000464, 148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6567193655766035, "mean_inference_ms": 1.9152309774275702, "mean_action_processing_ms": 0.3582364814484393, "mean_env_wait_ms": 2.1266956205562138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005423307418823242, "StateBufferConnector_ms": 0.007518291473388672, "ViewRequirementAgentConnector_ms": 0.17932844161987305}, "num_episodes": 22, "episode_return_max": 182.4240467875312, "episode_return_min": 125.68343984827537, "episode_return_mean": 151.53272831867883, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 494.8336777033275, "num_env_steps_trained_throughput_per_sec": 494.8336777033275, "timesteps_total": 217088, "num_env_steps_sampled_lifetime": 217088, "num_agent_steps_sampled_lifetime": 217088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 217088, "timers": {"training_iteration_time_ms": 2206.459, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2206.459, "sample_time_ms": 912.335, "learn_time_ms": 1276.993, "learn_throughput": 801.884, "synch_weights_time_ms": 17.03}, "counters": {"num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "done": false, "training_iteration": 212, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-14", "timestamp": 1744110554, "time_this_iter_s": 2.0749075412750244, "time_total_s": 466.0059838294983, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71A80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 466.0059838294983, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 33.36666666666667, "ram_util_percent": 85.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.477831677533686, "cur_kl_coeff": 3.0385816786431353e-65, "cur_lr": 1e-07, "total_loss": 2.1746165230870247, "policy_loss": -0.00010186672443524003, "vf_loss": 9.88143257498741, "vf_explained_var": -7.811784744262695e-05, "kl": 1.2457390429529425e-06, "entropy": 2.956397493183613, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "env_runners": {"episode_reward_max": 182.4240467875312, "episode_reward_min": 125.68343984827537, "episode_reward_mean": 152.09402886131903, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.68343984827537}, "policy_reward_max": {"tplp_policy": 182.4240467875312}, "policy_reward_mean": {"tplp_policy": 152.09402886131903}, "custom_metrics": {"mean_episode_reward_mean": 152.09402886131903, "mean_episode_reward_min": 125.68343984827537, "mean_episode_reward_max": 182.4240467875312}, "hist_stats": {"episode_reward": [148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.38092763547522, 172.82574979522118, 125.68343984827537, 158.39951251807716, 153.6483546187243, 143.10758582195794, 149.24466933513546, 164.4679554761481, 144.43570372875612, 146.35889475765484, 144.67219683271955, 150.7016963497783, 158.19035287200197, 127.97184632535433, 135.14608109523954, 138.84009754730153, 132.87339100798562, 131.1621268523744, 145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6566416042577029, "mean_inference_ms": 1.9153071442159955, "mean_action_processing_ms": 0.35829692137668473, "mean_env_wait_ms": 2.1269886878410698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004050493240356445, "StateBufferConnector_ms": 0.00851583480834961, "ViewRequirementAgentConnector_ms": 0.19382381439208984}, "num_episodes": 20, "episode_return_max": 182.4240467875312, "episode_return_min": 125.68343984827537, "episode_return_mean": 152.09402886131903, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 482.69199386015606, "num_env_steps_trained_throughput_per_sec": 482.69199386015606, "timesteps_total": 218112, "num_env_steps_sampled_lifetime": 218112, "num_agent_steps_sampled_lifetime": 218112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 218112, "timers": {"training_iteration_time_ms": 2188.631, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2188.631, "sample_time_ms": 900.081, "learn_time_ms": 1271.033, "learn_throughput": 805.644, "synch_weights_time_ms": 17.408}, "counters": {"num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "done": false, "training_iteration": 213, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-16", "timestamp": 1744110556, "time_this_iter_s": 2.1277334690093994, "time_total_s": 468.1337172985077, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D71620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 468.1337172985077, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 32.86666666666667, "ram_util_percent": 85.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7027146369218826, "cur_kl_coeff": 1.5192908393215677e-65, "cur_lr": 1e-07, "total_loss": 2.1776507176458835, "policy_loss": -0.00020634281681850553, "vf_loss": 9.894177085161209, "vf_explained_var": -3.219172358512878e-05, "kl": 2.2644279441319525e-06, "entropy": 2.956872096657753, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "env_runners": {"episode_reward_max": 182.4240467875312, "episode_reward_min": 128.05923101558605, "episode_reward_mean": 154.1429608727453, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 128.05923101558605}, "policy_reward_max": {"tplp_policy": 182.4240467875312}, "policy_reward_mean": {"tplp_policy": 154.1429608727453}, "custom_metrics": {"mean_episode_reward_mean": 154.1429608727453, "mean_episode_reward_min": 128.05923101558605, "mean_episode_reward_max": 182.4240467875312}, "hist_stats": {"episode_reward": [145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [145.46633877473226, 176.0140946978484, 142.9856716621244, 168.1935349179168, 148.9723074266232, 140.7347181595328, 152.17075426977138, 144.3955992686682, 157.15694173819787, 173.14790428953643, 154.3117529370441, 160.74507694004774, 182.4240467875312, 160.14274386343803, 147.65829856990098, 161.81040762935035, 163.51529745541166, 149.67526212335395, 157.7030135058834, 158.44507039377598, 135.39628106258445, 142.55384168276925, 138.86459290630307, 159.13094293359603, 170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6567657964972018, "mean_inference_ms": 1.9156326587335166, "mean_action_processing_ms": 0.3582749302366043, "mean_env_wait_ms": 2.127284784682445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005047798156738281, "StateBufferConnector_ms": 0.008017539978027344, "ViewRequirementAgentConnector_ms": 0.1878218650817871}, "num_episodes": 18, "episode_return_max": 182.4240467875312, "episode_return_min": 128.05923101558605, "episode_return_mean": 154.1429608727453, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 440.93167529441524, "num_env_steps_trained_throughput_per_sec": 440.93167529441524, "timesteps_total": 219136, "num_env_steps_sampled_lifetime": 219136, "num_agent_steps_sampled_lifetime": 219136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 219136, "timers": {"training_iteration_time_ms": 2208.868, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2208.868, "sample_time_ms": 908.491, "learn_time_ms": 1282.695, "learn_throughput": 798.319, "synch_weights_time_ms": 17.573}, "counters": {"num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "done": false, "training_iteration": 214, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-19", "timestamp": 1744110559, "time_this_iter_s": 2.3280587196350098, "time_total_s": 470.4617760181427, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBD620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.4617760181427, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 50.46666666666666, "ram_util_percent": 85.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9896765273064374, "cur_kl_coeff": 7.596454196607838e-66, "cur_lr": 1e-07, "total_loss": 2.1761581443250178, "policy_loss": -0.00018625311204232276, "vf_loss": 9.888163590431214, "vf_explained_var": -5.962476134300232e-05, "kl": 1.7261839989402005e-06, "entropy": 2.9569650128483773, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "env_runners": {"episode_reward_max": 182.1795955999603, "episode_reward_min": 126.64183116493388, "episode_reward_mean": 152.42048807642564, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 126.64183116493388}, "policy_reward_max": {"tplp_policy": 182.1795955999603}, "policy_reward_mean": {"tplp_policy": 152.42048807642564}, "custom_metrics": {"mean_episode_reward_mean": 152.42048807642564, "mean_episode_reward_min": 126.64183116493388, "mean_episode_reward_max": 182.1795955999603}, "hist_stats": {"episode_reward": [170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [170.38916713588063, 134.51288736719994, 160.18564747893797, 143.52859269697828, 146.485285945063, 142.668337743266, 142.64787200555145, 146.10093450504468, 172.90469746165536, 158.86813231726194, 166.6435581528713, 137.7871758265066, 140.33886577856083, 149.5336445106433, 156.9794966125555, 161.65789789301832, 147.99176626700373, 135.02010688796395, 144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6569556844529736, "mean_inference_ms": 1.9159509021308627, "mean_action_processing_ms": 0.35825291669186116, "mean_env_wait_ms": 2.127574796281413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00703883171081543, "StateBufferConnector_ms": 0.007129192352294922, "ViewRequirementAgentConnector_ms": 0.19071674346923828}, "num_episodes": 24, "episode_return_max": 182.1795955999603, "episode_return_min": 126.64183116493388, "episode_return_mean": 152.42048807642564, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 479.07137035421323, "num_env_steps_trained_throughput_per_sec": 479.07137035421323, "timesteps_total": 220160, "num_env_steps_sampled_lifetime": 220160, "num_agent_steps_sampled_lifetime": 220160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 220160, "timers": {"training_iteration_time_ms": 2211.909, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2211.909, "sample_time_ms": 915.504, "learn_time_ms": 1278.9, "learn_throughput": 800.688, "synch_weights_time_ms": 17.395}, "counters": {"num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "done": false, "training_iteration": 215, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-21", "timestamp": 1744110561, "time_this_iter_s": 2.1436350345611572, "time_total_s": 472.60541105270386, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D728E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 472.60541105270386, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 39.43333333333333, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.37618127129972, "cur_kl_coeff": 3.798227098303919e-66, "cur_lr": 1e-07, "total_loss": 2.1851633600890636, "policy_loss": -0.00014480448444373906, "vf_loss": 9.924005818367004, "vf_explained_var": -4.868917167186737e-05, "kl": 1.9342166202862554e-06, "entropy": 2.956932881474495, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "env_runners": {"episode_reward_max": 182.1795955999603, "episode_reward_min": 126.64183116493388, "episode_reward_mean": 153.4561231179712, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 126.64183116493388}, "policy_reward_max": {"tplp_policy": 182.1795955999603}, "policy_reward_mean": {"tplp_policy": 153.4561231179712}, "custom_metrics": {"mean_episode_reward_mean": 153.4561231179712, "mean_episode_reward_min": 126.64183116493388, "mean_episode_reward_max": 182.1795955999603}, "hist_stats": {"episode_reward": [144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [144.11941707819796, 154.7981442781236, 149.3102966656917, 157.12891223393908, 143.3387588684587, 176.6786606953499, 149.47124126085313, 149.72398586352836, 163.8383457501639, 159.70486013299038, 128.05923101558605, 136.31201101116358, 158.98845293077989, 159.56312848972567, 158.45222243420284, 138.14731278999815, 162.2948436127248, 151.02122589721702, 156.78828056523884, 148.6558317465556, 152.13067287663847, 162.7087819050479, 143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.657034154216787, "mean_inference_ms": 1.9159644977672738, "mean_action_processing_ms": 0.358173419677694, "mean_env_wait_ms": 2.1276165692974525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050241947174072266, "StateBufferConnector_ms": 0.0077397823333740234, "ViewRequirementAgentConnector_ms": 0.19680285453796387}, "num_episodes": 18, "episode_return_max": 182.1795955999603, "episode_return_min": 126.64183116493388, "episode_return_mean": 153.4561231179712, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 490.6310792880712, "num_env_steps_trained_throughput_per_sec": 490.6310792880712, "timesteps_total": 221184, "num_env_steps_sampled_lifetime": 221184, "num_agent_steps_sampled_lifetime": 221184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 221184, "timers": {"training_iteration_time_ms": 2191.106, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2191.106, "sample_time_ms": 911.349, "learn_time_ms": 1262.382, "learn_throughput": 811.165, "synch_weights_time_ms": 17.136}, "counters": {"num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "done": false, "training_iteration": 216, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-23", "timestamp": 1744110563, "time_this_iter_s": 2.0917909145355225, "time_total_s": 474.6972019672394, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72B60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.6972019672394, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 35.1, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.863472419977188, "cur_kl_coeff": 1.8991135491519596e-66, "cur_lr": 1e-07, "total_loss": 2.177294512838125, "policy_loss": -0.00010416543227620423, "vf_loss": 9.892470753192901, "vf_explained_var": -2.397783100605011e-05, "kl": 1.088351205469351e-06, "entropy": 2.9571900621056555, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "env_runners": {"episode_reward_max": 182.1795955999603, "episode_reward_min": 115.12824586276298, "episode_reward_mean": 153.35189692556244, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.12824586276298}, "policy_reward_max": {"tplp_policy": 182.1795955999603}, "policy_reward_mean": {"tplp_policy": 153.35189692556244}, "custom_metrics": {"mean_episode_reward_mean": 153.35189692556244, "mean_episode_reward_min": 115.12824586276298, "mean_episode_reward_max": 182.1795955999603}, "hist_stats": {"episode_reward": [143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [143.2577749884602, 152.495237535093, 162.15839397115028, 148.75378674458545, 138.52865523783112, 156.44246069241936, 157.98597872849828, 139.33819863252208, 143.5789833089596, 164.19364932699705, 162.12015013047022, 169.8381857836089, 150.71228616950657, 170.58990211178696, 151.14104565606044, 158.82576969432637, 152.9322333996328, 163.30643291773185, 149.19236087210848, 154.98206857966036, 157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6571556137518094, "mean_inference_ms": 1.9159466196444512, "mean_action_processing_ms": 0.3580979864345629, "mean_env_wait_ms": 2.127611969982941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007044792175292969, "StateBufferConnector_ms": 0.006742238998413086, "ViewRequirementAgentConnector_ms": 0.20388007164001465}, "num_episodes": 22, "episode_return_max": 182.1795955999603, "episode_return_min": 115.12824586276298, "episode_return_mean": 153.35189692556244, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 460.3978506599497, "num_env_steps_trained_throughput_per_sec": 460.3978506599497, "timesteps_total": 222208, "num_env_steps_sampled_lifetime": 222208, "num_agent_steps_sampled_lifetime": 222208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 222208, "timers": {"training_iteration_time_ms": 2182.637, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2182.637, "sample_time_ms": 899.762, "learn_time_ms": 1265.409, "learn_throughput": 809.225, "synch_weights_time_ms": 17.227}, "counters": {"num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "done": false, "training_iteration": 217, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-25", "timestamp": 1744110565, "time_this_iter_s": 2.230264902114868, "time_total_s": 476.92746686935425, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 476.92746686935425, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 27.9, "ram_util_percent": 85.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.203069106116891, "cur_kl_coeff": 9.495567745759798e-67, "cur_lr": 1e-07, "total_loss": 2.1849418260157107, "policy_loss": -9.078696748474613e-05, "vf_loss": 9.923060947656632, "vf_explained_var": -6.810352206230164e-05, "kl": 1.2037980495760436e-06, "entropy": 2.957326328754425, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "env_runners": {"episode_reward_max": 186.08666038275996, "episode_reward_min": 115.12824586276298, "episode_reward_mean": 152.61509133704593, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.12824586276298}, "policy_reward_max": {"tplp_policy": 186.08666038275996}, "policy_reward_mean": {"tplp_policy": 152.61509133704593}, "custom_metrics": {"mean_episode_reward_mean": 152.61509133704593, "mean_episode_reward_min": 115.12824586276298, "mean_episode_reward_max": 186.08666038275996}, "hist_stats": {"episode_reward": [157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.15785396517504, 141.11194472769333, 138.43996719732033, 163.54896110736993, 147.25456491116677, 182.1795955999603, 167.05904065990126, 160.65001941365486, 153.09060543328712, 157.12614346808448, 162.49692100399716, 176.7574476321147, 139.41787822545575, 163.9922528055982, 142.60097948917073, 173.94517846908917, 133.54191554470634, 163.51011354419967, 154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6573250135631897, "mean_inference_ms": 1.916104020222014, "mean_action_processing_ms": 0.3580589292642156, "mean_env_wait_ms": 2.1277467339641074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010127782821655273, "StateBufferConnector_ms": 0.006742238998413086, "ViewRequirementAgentConnector_ms": 0.21257662773132324}, "num_episodes": 20, "episode_return_max": 186.08666038275996, "episode_return_min": 115.12824586276298, "episode_return_mean": 152.61509133704593, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 453.03230129081965, "num_env_steps_trained_throughput_per_sec": 453.03230129081965, "timesteps_total": 223232, "num_env_steps_sampled_lifetime": 223232, "num_agent_steps_sampled_lifetime": 223232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 223232, "timers": {"training_iteration_time_ms": 2204.877, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2204.877, "sample_time_ms": 907.241, "learn_time_ms": 1279.99, "learn_throughput": 800.006, "synch_weights_time_ms": 17.405}, "counters": {"num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "done": false, "training_iteration": 218, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-27", "timestamp": 1744110567, "time_this_iter_s": 2.2659659385681152, "time_total_s": 479.19343280792236, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.19343280792236, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 43.76666666666667, "ram_util_percent": 85.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.58658112809062, "cur_kl_coeff": 4.747783872879899e-67, "cur_lr": 1e-07, "total_loss": 2.1810887187719343, "policy_loss": -0.00019310560310259461, "vf_loss": 9.908376252651214, "vf_explained_var": -5.226433277130127e-05, "kl": 2.4828973811633072e-06, "entropy": 2.958122435212135, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "env_runners": {"episode_reward_max": 186.42169009703042, "episode_reward_min": 115.12824586276298, "episode_reward_mean": 151.49970584286595, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 115.12824586276298}, "policy_reward_max": {"tplp_policy": 186.42169009703042}, "policy_reward_mean": {"tplp_policy": 151.49970584286595}, "custom_metrics": {"mean_episode_reward_mean": 151.49970584286595, "mean_episode_reward_min": 115.12824586276298, "mean_episode_reward_max": 186.42169009703042}, "hist_stats": {"episode_reward": [154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [154.96542682538873, 157.88124893662552, 137.54437181790678, 158.17840870424175, 162.34466199840787, 143.43157754298915, 144.03635330907832, 159.58202243258592, 140.33593917056697, 126.64183116493388, 135.65730320594545, 138.07444591855418, 160.71215759767483, 145.99835934992265, 132.1832500699563, 150.04852381615314, 149.8791257060662, 134.99011933604305, 144.09437066176415, 163.6494825954491, 150.17098924111394, 161.91521587370323, 130.64080606985593, 156.47460997758745, 160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6573698072423038, "mean_inference_ms": 1.9160959484020044, "mean_action_processing_ms": 0.35808436463652343, "mean_env_wait_ms": 2.1277794274252266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011423587799072266, "StateBufferConnector_ms": 0.003609895706176758, "ViewRequirementAgentConnector_ms": 0.21687674522399902}, "num_episodes": 18, "episode_return_max": 186.42169009703042, "episode_return_min": 115.12824586276298, "episode_return_mean": 151.49970584286595, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 451.335215890147, "num_env_steps_trained_throughput_per_sec": 451.335215890147, "timesteps_total": 224256, "num_env_steps_sampled_lifetime": 224256, "num_agent_steps_sampled_lifetime": 224256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 224256, "timers": {"training_iteration_time_ms": 2220.806, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2220.806, "sample_time_ms": 915.579, "learn_time_ms": 1287.218, "learn_throughput": 795.514, "synch_weights_time_ms": 17.87}, "counters": {"num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "done": false, "training_iteration": 219, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-30", "timestamp": 1744110570, "time_this_iter_s": 2.2762343883514404, "time_total_s": 481.4696671962738, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2C234C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 481.4696671962738, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 36.333333333333336, "ram_util_percent": 85.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4902566980570553, "cur_kl_coeff": 2.3738919364399495e-67, "cur_lr": 1e-07, "total_loss": 2.1620481133461, "policy_loss": -0.00018783577979775146, "vf_loss": 9.832384258508682, "vf_explained_var": -4.359148442745209e-05, "kl": 1.7230664395295747e-06, "entropy": 2.958601124584675, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "env_runners": {"episode_reward_max": 186.42169009703042, "episode_reward_min": 108.21043347394101, "episode_reward_mean": 153.23274697148304, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 108.21043347394101}, "policy_reward_max": {"tplp_policy": 186.42169009703042}, "policy_reward_mean": {"tplp_policy": 153.23274697148304}, "custom_metrics": {"mean_episode_reward_mean": 153.23274697148304, "mean_episode_reward_min": 108.21043347394101, "mean_episode_reward_max": 186.42169009703042}, "hist_stats": {"episode_reward": [160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [160.5690093349704, 177.6765347404486, 154.07688771642975, 147.97615392786997, 157.9693736301641, 140.5544318193188, 145.5731407246726, 161.5087667307524, 170.51968352417387, 153.94040327534944, 154.1922548160395, 171.7642412459396, 157.13439604610292, 141.95583619998922, 162.83764280773696, 172.4433981531158, 180.57933129553797, 145.49905758442333, 162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6574001421245407, "mean_inference_ms": 1.916002302407302, "mean_action_processing_ms": 0.35809984529894734, "mean_env_wait_ms": 2.127668065967869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012434959411621094, "StateBufferConnector_ms": 0.0036089420318603516, "ViewRequirementAgentConnector_ms": 0.21833539009094238}, "num_episodes": 24, "episode_return_max": 186.42169009703042, "episode_return_min": 108.21043347394101, "episode_return_mean": 153.23274697148304, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 427.6004924561539, "num_env_steps_trained_throughput_per_sec": 427.6004924561539, "timesteps_total": 225280, "num_env_steps_sampled_lifetime": 225280, "num_agent_steps_sampled_lifetime": 225280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 225280, "timers": {"training_iteration_time_ms": 2216.621, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2216.621, "sample_time_ms": 906.778, "learn_time_ms": 1291.173, "learn_throughput": 793.078, "synch_weights_time_ms": 18.531}, "counters": {"num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "done": false, "training_iteration": 220, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-32", "timestamp": 1744110572, "time_this_iter_s": 2.4044930934906006, "time_total_s": 483.8741602897644, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D73420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 483.8741602897644, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 28.625, "ram_util_percent": 84.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.459930348396301, "cur_kl_coeff": 1.1869459682199747e-67, "cur_lr": 1e-07, "total_loss": 2.1659604579210283, "policy_loss": -0.00027062257286161186, "vf_loss": 9.848184978961944, "vf_explained_var": -6.424710154533387e-05, "kl": 2.5473238324941194e-06, "entropy": 2.9581515192985535, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "env_runners": {"episode_reward_max": 186.42169009703042, "episode_reward_min": 108.21043347394101, "episode_reward_mean": 152.0481770496502, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 108.21043347394101}, "policy_reward_max": {"tplp_policy": 186.42169009703042}, "policy_reward_mean": {"tplp_policy": 152.0481770496502}, "custom_metrics": {"mean_episode_reward_mean": 152.0481770496502, "mean_episode_reward_min": 108.21043347394101, "mean_episode_reward_max": 186.42169009703042}, "hist_stats": {"episode_reward": [162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [162.05705013017547, 140.65419064614449, 145.58083622323431, 143.2129322726461, 175.61871247148528, 145.99749663918948, 155.14994896955037, 151.27382842309012, 115.12824586276298, 149.88459021170246, 158.68362876392067, 170.78466206602891, 149.19297556292616, 154.83658800884695, 168.7083723890896, 160.15004343113785, 146.3327184528322, 138.17683295218922, 148.9112010287401, 144.39875547564807, 157.12234832812686, 145.62065916199637, 143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6575395324465313, "mean_inference_ms": 1.9163607755462961, "mean_action_processing_ms": 0.35821746168031765, "mean_env_wait_ms": 2.1280579558437878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014427661895751953, "StateBufferConnector_ms": 0.002993345260620117, "ViewRequirementAgentConnector_ms": 0.22575688362121582}, "num_episodes": 18, "episode_return_max": 186.42169009703042, "episode_return_min": 108.21043347394101, "episode_return_mean": 152.0481770496502, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 375.90559770145325, "num_env_steps_trained_throughput_per_sec": 375.90559770145325, "timesteps_total": 226304, "num_env_steps_sampled_lifetime": 226304, "num_agent_steps_sampled_lifetime": 226304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 226304, "timers": {"training_iteration_time_ms": 2260.991, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2260.991, "sample_time_ms": 918.886, "learn_time_ms": 1322.979, "learn_throughput": 774.011, "synch_weights_time_ms": 18.886}, "counters": {"num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "done": false, "training_iteration": 221, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-35", "timestamp": 1744110575, "time_this_iter_s": 2.7308084964752197, "time_total_s": 486.6049687862396, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 486.6049687862396, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 53.12499999999999, "ram_util_percent": 84.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.605880543589592, "cur_kl_coeff": 5.934729841099874e-68, "cur_lr": 1e-07, "total_loss": 2.1861863531172276, "policy_loss": -8.946459274739027e-05, "vf_loss": 9.92826601266861, "vf_explained_var": -4.5797973871231076e-05, "kl": 1.3750194383987945e-06, "entropy": 2.957906927168369, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "env_runners": {"episode_reward_max": 186.42169009703042, "episode_reward_min": 108.21043347394101, "episode_reward_mean": 153.60835845430714, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 108.21043347394101}, "policy_reward_max": {"tplp_policy": 186.42169009703042}, "policy_reward_mean": {"tplp_policy": 153.60835845430714}, "custom_metrics": {"mean_episode_reward_mean": 153.60835845430714, "mean_episode_reward_min": 108.21043347394101, "mean_episode_reward_max": 186.42169009703042}, "hist_stats": {"episode_reward": [143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [143.45651281709607, 132.2988950053421, 158.42220887136796, 154.41254346777424, 178.30908475554486, 149.6412310008636, 159.32831687595805, 148.32268470218744, 159.78300922569838, 137.37994581536145, 154.03622894865052, 146.79389589752762, 143.46849412338523, 137.997950793333, 186.08666038275996, 135.46531969468774, 136.7432170979858, 152.0037886641075, 145.62310822286005, 151.90056534747177, 186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.657722780345668, "mean_inference_ms": 1.917053486527234, "mean_action_processing_ms": 0.3584021108741706, "mean_env_wait_ms": 2.1287467906894046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016827106475830078, "StateBufferConnector_ms": 0.002993345260620117, "ViewRequirementAgentConnector_ms": 0.2319648265838623}, "num_episodes": 22, "episode_return_max": 186.42169009703042, "episode_return_min": 108.21043347394101, "episode_return_mean": 153.60835845430714, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 467.66706033027236, "num_env_steps_trained_throughput_per_sec": 467.66706033027236, "timesteps_total": 227328, "num_env_steps_sampled_lifetime": 227328, "num_agent_steps_sampled_lifetime": 227328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 227328, "timers": {"training_iteration_time_ms": 2273.012, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2273.012, "sample_time_ms": 927.572, "learn_time_ms": 1326.238, "learn_throughput": 772.109, "synch_weights_time_ms": 18.963}, "counters": {"num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "done": false, "training_iteration": 222, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-37", "timestamp": 1744110577, "time_this_iter_s": 2.194988489151001, "time_total_s": 488.7999572753906, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 488.7999572753906, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 39.9, "ram_util_percent": 85.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7583919763565063, "cur_kl_coeff": 2.967364920549937e-68, "cur_lr": 1e-07, "total_loss": 2.1842937514185907, "policy_loss": -0.00017488786252215505, "vf_loss": 9.92140918970108, "vf_explained_var": -5.365721881389618e-05, "kl": 2.5527841654771065e-06, "entropy": 2.95883644670248, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "env_runners": {"episode_reward_max": 186.42169009703042, "episode_reward_min": 108.21043347394101, "episode_reward_mean": 154.903587651383, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 108.21043347394101}, "policy_reward_max": {"tplp_policy": 186.42169009703042}, "policy_reward_mean": {"tplp_policy": 154.903587651383}, "custom_metrics": {"mean_episode_reward_mean": 154.903587651383, "mean_episode_reward_min": 108.21043347394101, "mean_episode_reward_max": 186.42169009703042}, "hist_stats": {"episode_reward": [186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [186.42169009703042, 128.25569874275635, 139.43294697037106, 150.15749187845518, 161.52663698458952, 156.79081318571903, 151.2656927645891, 181.45318574428978, 150.24468289828823, 151.32729135769108, 152.46483648222133, 143.8170007084659, 149.29766924748498, 152.9448346978219, 139.5355992893236, 119.88308916051798, 151.34778730099907, 145.352372894137, 134.0433556259069, 149.56050947621253, 160.48835936220846, 160.55389755714322, 183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6578695042395963, "mean_inference_ms": 1.9175773403041598, "mean_action_processing_ms": 0.3585776828151825, "mean_env_wait_ms": 2.1292435286791735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015715837478637695, "StateBufferConnector_ms": 0.002993345260620117, "ViewRequirementAgentConnector_ms": 0.21856451034545898}, "num_episodes": 20, "episode_return_max": 186.42169009703042, "episode_return_min": 108.21043347394101, "episode_return_mean": 154.903587651383, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 482.3519385585642, "num_env_steps_trained_throughput_per_sec": 482.3519385585642, "timesteps_total": 228352, "num_env_steps_sampled_lifetime": 228352, "num_agent_steps_sampled_lifetime": 228352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 228352, "timers": {"training_iteration_time_ms": 2273.161, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2273.161, "sample_time_ms": 930.799, "learn_time_ms": 1323.772, "learn_throughput": 773.547, "synch_weights_time_ms": 18.36}, "counters": {"num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "done": false, "training_iteration": 223, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-39", "timestamp": 1744110579, "time_this_iter_s": 2.1290230751037598, "time_total_s": 490.9289803504944, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F2CBE700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 490.9289803504944, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 32.800000000000004, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7663932006806133, "cur_kl_coeff": 1.4836824602749684e-68, "cur_lr": 1e-07, "total_loss": 2.1732950396835804, "policy_loss": -0.0002395769552094862, "vf_loss": 9.87784297466278, "vf_explained_var": -4.3033435940742495e-05, "kl": 1.9033284429426089e-06, "entropy": 2.9592610567808153, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "env_runners": {"episode_reward_max": 183.7591981075997, "episode_reward_min": 108.21043347394101, "episode_reward_mean": 155.63514470179516, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 108.21043347394101}, "policy_reward_max": {"tplp_policy": 183.7591981075997}, "policy_reward_mean": {"tplp_policy": 155.63514470179516}, "custom_metrics": {"mean_episode_reward_mean": 155.63514470179516, "mean_episode_reward_min": 108.21043347394101, "mean_episode_reward_max": 183.7591981075997}, "hist_stats": {"episode_reward": [183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [183.49835790799528, 158.03339467567307, 108.21043347394101, 165.4343710566861, 154.8796835428207, 168.83435357726157, 183.7591981075997, 149.32621541400107, 173.40249192827278, 172.52513229718159, 149.90533650946776, 151.1264909495102, 146.09622113675348, 164.41780620821544, 153.21804774150283, 154.35318283354755, 145.889478877258, 128.4782357299313, 144.5026384219631, 150.34310343273174, 159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6580376731635112, "mean_inference_ms": 1.9180682521277266, "mean_action_processing_ms": 0.3586381479000733, "mean_env_wait_ms": 2.1295054703409697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014420509338378906, "StateBufferConnector_ms": 0.004987001419067383, "ViewRequirementAgentConnector_ms": 0.20910072326660156}, "num_episodes": 22, "episode_return_max": 183.7591981075997, "episode_return_min": 108.21043347394101, "episode_return_mean": 155.63514470179516, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 463.4654569928298, "num_env_steps_trained_throughput_per_sec": 463.4654569928298, "timesteps_total": 229376, "num_env_steps_sampled_lifetime": 229376, "num_agent_steps_sampled_lifetime": 229376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 229376, "timers": {"training_iteration_time_ms": 2261.87, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2261.87, "sample_time_ms": 919.64, "learn_time_ms": 1323.641, "learn_throughput": 773.624, "synch_weights_time_ms": 18.359}, "counters": {"num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "done": false, "training_iteration": 224, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-42", "timestamp": 1744110582, "time_this_iter_s": 2.2160375118255615, "time_total_s": 493.14501786231995, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D73740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.14501786231995, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 33.699999999999996, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8654073068872092, "cur_kl_coeff": 7.418412301374842e-69, "cur_lr": 1e-07, "total_loss": 2.1823392651975153, "policy_loss": -2.9661072767339645e-05, "vf_loss": 9.913034456968308, "vf_explained_var": -5.51033765077591e-05, "kl": 4.796388186616151e-07, "entropy": 2.9588968381285667, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "env_runners": {"episode_reward_max": 192.5301385010111, "episode_reward_min": 124.29270156305111, "episode_reward_mean": 154.9625802394747, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.29270156305111}, "policy_reward_max": {"tplp_policy": 192.5301385010111}, "policy_reward_mean": {"tplp_policy": 154.9625802394747}, "custom_metrics": {"mean_episode_reward_mean": 154.9625802394747, "mean_episode_reward_min": 124.29270156305111, "mean_episode_reward_max": 192.5301385010111}, "hist_stats": {"episode_reward": [159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [159.84489846095485, 169.70041838595515, 140.3690722812454, 148.51612289319533, 157.4727487616161, 127.15345478954386, 157.8193997141925, 157.02224075338214, 167.11852952852666, 135.56986481161698, 139.63099799230787, 166.97944467613686, 155.13394774747994, 143.80238979337375, 156.08167199203967, 161.25260695348908, 183.04025880434273, 151.43468333549308, 167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6580267236522936, "mean_inference_ms": 1.9186146024404707, "mean_action_processing_ms": 0.3588735733023428, "mean_env_wait_ms": 2.130147822261227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011420011520385742, "StateBufferConnector_ms": 0.004987478256225586, "ViewRequirementAgentConnector_ms": 0.20026135444641113}, "num_episodes": 20, "episode_return_max": 192.5301385010111, "episode_return_min": 124.29270156305111, "episode_return_mean": 154.9625802394747, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 431.3537506318452, "num_env_steps_trained_throughput_per_sec": 431.3537506318452, "timesteps_total": 230400, "num_env_steps_sampled_lifetime": 230400, "num_agent_steps_sampled_lifetime": 230400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 230400, "timers": {"training_iteration_time_ms": 2285.515, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2285.515, "sample_time_ms": 921.487, "learn_time_ms": 1345.168, "learn_throughput": 761.243, "synch_weights_time_ms": 18.63}, "counters": {"num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "done": false, "training_iteration": 225, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-44", "timestamp": 1744110584, "time_this_iter_s": 2.37969708442688, "time_total_s": 495.5247149467468, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 495.5247149467468, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 40.725, "ram_util_percent": 85.125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3067648516967894, "cur_kl_coeff": 3.709206150687421e-69, "cur_lr": 1e-07, "total_loss": 2.1848550595343115, "policy_loss": -7.706882315687835e-05, "vf_loss": 9.923364239931107, "vf_explained_var": -6.14263117313385e-05, "kl": 4.2773508452942365e-07, "entropy": 2.9590891659259797, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "env_runners": {"episode_reward_max": 192.5301385010111, "episode_reward_min": 124.29270156305111, "episode_reward_mean": 155.10590630682532, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 124.29270156305111}, "policy_reward_max": {"tplp_policy": 192.5301385010111}, "policy_reward_mean": {"tplp_policy": 155.10590630682532}, "custom_metrics": {"mean_episode_reward_mean": 155.10590630682532, "mean_episode_reward_min": 124.29270156305111, "mean_episode_reward_max": 192.5301385010111}, "hist_stats": {"episode_reward": [167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [167.44892389512972, 172.56832537934432, 143.94989663451318, 162.64849884938482, 124.29270156305111, 164.56240665962375, 162.26598247580887, 177.84048266292473, 137.75833313631574, 166.76050284979243, 147.20961363473603, 159.40437148803736, 152.58622296971126, 157.53579202530076, 154.63235835151497, 155.27619470376172, 156.48670137591418, 168.4770279405872, 166.7769903738744, 150.53848882799323, 143.34396102201532, 176.534100806986, 150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6579788654482515, "mean_inference_ms": 1.9187940209362009, "mean_action_processing_ms": 0.35895703228014475, "mean_env_wait_ms": 2.130166147125516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011420965194702148, "StateBufferConnector_ms": 0.0041162967681884766, "ViewRequirementAgentConnector_ms": 0.21295475959777832}, "num_episodes": 18, "episode_return_max": 192.5301385010111, "episode_return_min": 124.29270156305111, "episode_return_mean": 155.10590630682532, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 477.6790710689549, "num_env_steps_trained_throughput_per_sec": 477.6790710689549, "timesteps_total": 231424, "num_env_steps_sampled_lifetime": 231424, "num_agent_steps_sampled_lifetime": 231424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 231424, "timers": {"training_iteration_time_ms": 2291.174, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2291.174, "sample_time_ms": 924.901, "learn_time_ms": 1347.665, "learn_throughput": 759.832, "synch_weights_time_ms": 18.509}, "counters": {"num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "done": false, "training_iteration": 226, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-46", "timestamp": 1744110586, "time_this_iter_s": 2.1488828659057617, "time_total_s": 497.6735978126526, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 497.6735978126526, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 37.4, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3174351677298546, "cur_kl_coeff": 1.8546030753437105e-69, "cur_lr": 1e-07, "total_loss": 2.1790321074426173, "policy_loss": -0.0001045502838678658, "vf_loss": 9.900117880105972, "vf_explained_var": -8.707605302333832e-05, "kl": 1.503188156348062e-06, "entropy": 2.9589281380176544, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "env_runners": {"episode_reward_max": 192.5301385010111, "episode_reward_min": 125.65395275713085, "episode_reward_mean": 153.8508276346837, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.65395275713085}, "policy_reward_max": {"tplp_policy": 192.5301385010111}, "policy_reward_mean": {"tplp_policy": 153.8508276346837}, "custom_metrics": {"mean_episode_reward_mean": 153.8508276346837, "mean_episode_reward_min": 125.65395275713085, "mean_episode_reward_max": 192.5301385010111}, "hist_stats": {"episode_reward": [150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [150.7894301222893, 162.23061382828905, 155.68985959488074, 168.84884778896034, 179.29946548256714, 158.90939294351, 166.18456236818332, 146.97112613817688, 145.41472170879723, 153.21428103659431, 162.35151024375295, 143.69216003016135, 157.14225132443576, 159.5153528155372, 166.81502386506236, 150.9719888717044, 150.4826564296273, 142.59527499602166, 154.134107937334, 167.7864853722372, 169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6579295232212345, "mean_inference_ms": 1.9188689437852764, "mean_action_processing_ms": 0.35902150596387317, "mean_env_wait_ms": 2.1300319068514106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010005474090576172, "StateBufferConnector_ms": 0.005114078521728516, "ViewRequirementAgentConnector_ms": 0.22011041641235352}, "num_episodes": 22, "episode_return_max": 192.5301385010111, "episode_return_min": 125.65395275713085, "episode_return_mean": 153.8508276346837, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 447.48896308776614, "num_env_steps_trained_throughput_per_sec": 447.48896308776614, "timesteps_total": 232448, "num_env_steps_sampled_lifetime": 232448, "num_agent_steps_sampled_lifetime": 232448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 232448, "timers": {"training_iteration_time_ms": 2297.59, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2297.59, "sample_time_ms": 929.406, "learn_time_ms": 1349.509, "learn_throughput": 758.795, "synch_weights_time_ms": 18.576}, "counters": {"num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "done": false, "training_iteration": 227, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-49", "timestamp": 1744110589, "time_this_iter_s": 2.2954511642456055, "time_total_s": 499.9690489768982, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 499.9690489768982, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 36.86666666666667, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5855533711612226, "cur_kl_coeff": 9.273015376718553e-70, "cur_lr": 1e-07, "total_loss": 2.1782605685293674, "policy_loss": -5.7647837093099954e-05, "vf_loss": 9.897318559885026, "vf_explained_var": -7.18824565410614e-05, "kl": 1.714029416266527e-06, "entropy": 2.9601144298911093, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "env_runners": {"episode_reward_max": 192.5301385010111, "episode_reward_min": 125.65395275713085, "episode_reward_mean": 153.4452112384962, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.65395275713085}, "policy_reward_max": {"tplp_policy": 192.5301385010111}, "policy_reward_mean": {"tplp_policy": 153.4452112384962}, "custom_metrics": {"mean_episode_reward_mean": 153.4452112384962, "mean_episode_reward_min": 125.65395275713085, "mean_episode_reward_max": 192.5301385010111}, "hist_stats": {"episode_reward": [169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [169.85829550586652, 140.26020876692832, 168.65668658054764, 144.6747165478184, 141.7218333061288, 169.31506851302268, 152.67469328893202, 143.75455565121837, 146.42081282199103, 138.93175396548205, 142.32038130103234, 170.5344353090052, 155.60935012881453, 158.68707143064603, 162.3124918670342, 170.06577262311163, 152.78898494939682, 158.72820270537943, 150.00269642946228, 130.08254246604952, 148.11772501101336, 129.9847483368001, 125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6579768590367457, "mean_inference_ms": 1.9190896721233124, "mean_action_processing_ms": 0.3591294784086535, "mean_env_wait_ms": 2.1301667324912668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008008003234863281, "StateBufferConnector_ms": 0.007116556167602539, "ViewRequirementAgentConnector_ms": 0.2314772605895996}, "num_episodes": 20, "episode_return_max": 192.5301385010111, "episode_return_min": 125.65395275713085, "episode_return_mean": 153.4452112384962, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 442.3798482548317, "num_env_steps_trained_throughput_per_sec": 442.3798482548317, "timesteps_total": 233472, "num_env_steps_sampled_lifetime": 233472, "num_agent_steps_sampled_lifetime": 233472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 233472, "timers": {"training_iteration_time_ms": 2303.033, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2303.033, "sample_time_ms": 935.255, "learn_time_ms": 1349.049, "learn_throughput": 759.053, "synch_weights_time_ms": 18.53}, "counters": {"num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "done": false, "training_iteration": 228, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-51", "timestamp": 1744110591, "time_this_iter_s": 2.3211848735809326, "time_total_s": 502.2902338504791, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D73380>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 502.2902338504791, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 45.53333333333333, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.889461746811867, "cur_kl_coeff": 4.6365076883592763e-70, "cur_lr": 1e-07, "total_loss": 2.1707819148898126, "policy_loss": -0.00020300333853811025, "vf_loss": 9.868699491024017, "vf_explained_var": -4.37665730714798e-05, "kl": 2.887034482193518e-06, "entropy": 2.9618993401527405, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "env_runners": {"episode_reward_max": 192.5301385010111, "episode_reward_min": 125.65395275713085, "episode_reward_mean": 153.32400277441522, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.65395275713085}, "policy_reward_max": {"tplp_policy": 192.5301385010111}, "policy_reward_mean": {"tplp_policy": 153.32400277441522}, "custom_metrics": {"mean_episode_reward_mean": 153.32400277441522, "mean_episode_reward_min": 125.65395275713085, "mean_episode_reward_max": 192.5301385010111}, "hist_stats": {"episode_reward": [125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [125.65395275713085, 171.63564549960242, 137.9566610341507, 142.50845864955613, 176.81984032478118, 161.82338340790037, 146.65931571720145, 144.70761783088963, 169.13009539025032, 150.462751579248, 167.14659832267716, 155.62693617712938, 159.28935065375882, 151.78054369114784, 126.96561945566526, 152.40593324283168, 192.5301385010111, 127.77241200752078, 153.52367613451335, 145.2980143433661, 147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6581567434868982, "mean_inference_ms": 1.9195067404229604, "mean_action_processing_ms": 0.3593123726914016, "mean_env_wait_ms": 2.1305407274721215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008378267288208008, "StateBufferConnector_ms": 0.0051229000091552734, "ViewRequirementAgentConnector_ms": 0.26206207275390625}, "num_episodes": 22, "episode_return_max": 192.5301385010111, "episode_return_min": 125.65395275713085, "episode_return_mean": 153.32400277441522, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 457.188645881013, "num_env_steps_trained_throughput_per_sec": 457.188645881013, "timesteps_total": 234496, "num_env_steps_sampled_lifetime": 234496, "num_agent_steps_sampled_lifetime": 234496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 234496, "timers": {"training_iteration_time_ms": 2300.129, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2300.129, "sample_time_ms": 937.855, "learn_time_ms": 1343.801, "learn_throughput": 762.018, "synch_weights_time_ms": 18.153}, "counters": {"num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "done": false, "training_iteration": 229, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-53", "timestamp": 1744110593, "time_this_iter_s": 2.2445011138916016, "time_total_s": 504.5347349643707, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 504.5347349643707, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 37.275, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5868299316614864, "cur_kl_coeff": 2.3182538441796382e-70, "cur_lr": 1e-07, "total_loss": 2.17400214150548, "policy_loss": -0.0001108227763324976, "vf_loss": 9.88152505159378, "vf_explained_var": -5.670525133609772e-05, "kl": 1.225171731093766e-06, "entropy": 2.9626829385757447, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "env_runners": {"episode_reward_max": 184.83305798995136, "episode_reward_min": 127.19873539944544, "episode_reward_mean": 155.02463160867433, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 127.19873539944544}, "policy_reward_max": {"tplp_policy": 184.83305798995136}, "policy_reward_mean": {"tplp_policy": 155.02463160867433}, "custom_metrics": {"mean_episode_reward_mean": 155.02463160867433, "mean_episode_reward_min": 127.19873539944544, "mean_episode_reward_max": 184.83305798995136}, "hist_stats": {"episode_reward": [147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [147.02122727904356, 135.15639521644871, 145.1672239757479, 161.3250162050437, 154.0363755662948, 150.0831435932455, 166.85431561482562, 140.3954612850525, 165.32557317704794, 184.83305798995136, 153.61159014797576, 138.4263926790492, 163.90217129013055, 173.89536965055353, 180.79221790855482, 132.62813635310883, 150.63572178580424, 160.24430318231188, 144.3178133475395, 144.02188955316544, 142.6168088219727, 143.94483671013293, 148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6582395919455243, "mean_inference_ms": 1.9196515297913874, "mean_action_processing_ms": 0.35938382145432024, "mean_env_wait_ms": 2.1307001980385527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006371736526489258, "StateBufferConnector_ms": 0.006293296813964844, "ViewRequirementAgentConnector_ms": 0.26793909072875977}, "num_episodes": 20, "episode_return_max": 184.83305798995136, "episode_return_min": 127.19873539944544, "episode_return_mean": 155.02463160867433, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 500.03694084500484, "num_env_steps_trained_throughput_per_sec": 500.03694084500484, "timesteps_total": 235520, "num_env_steps_sampled_lifetime": 235520, "num_agent_steps_sampled_lifetime": 235520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 235520, "timers": {"training_iteration_time_ms": 2265.438, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2265.438, "sample_time_ms": 932.505, "learn_time_ms": 1315.409, "learn_throughput": 778.465, "synch_weights_time_ms": 17.104}, "counters": {"num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "done": false, "training_iteration": 230, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-55", "timestamp": 1744110595, "time_this_iter_s": 2.052844762802124, "time_total_s": 506.58757972717285, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 506.58757972717285, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 33.36666666666667, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.563982469961047, "cur_kl_coeff": 1.1591269220898191e-70, "cur_lr": 1e-07, "total_loss": 2.16404345408082, "policy_loss": -0.00014302367926575244, "vf_loss": 9.841762661933899, "vf_explained_var": -2.6947259902954103e-05, "kl": 1.5835918945494853e-06, "entropy": 2.962541674077511, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "env_runners": {"episode_reward_max": 182.21568294024505, "episode_reward_min": 125.1641925370651, "episode_reward_mean": 154.66023981142604, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.1641925370651}, "policy_reward_max": {"tplp_policy": 182.21568294024505}, "policy_reward_mean": {"tplp_policy": 154.66023981142604}, "custom_metrics": {"mean_episode_reward_mean": 154.66023981142604, "mean_episode_reward_min": 125.1641925370651, "mean_episode_reward_max": 182.21568294024505}, "hist_stats": {"episode_reward": [148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [148.26995673364948, 141.58968730450556, 152.1883763224028, 139.792912633844, 154.6689281570369, 140.3571178866334, 150.1386307737191, 149.86442178491293, 157.99734311023096, 166.1557100327038, 159.40046944109054, 151.5815083351693, 170.77083660010265, 159.0663087411132, 145.28235101428936, 170.48407813982854, 147.5193718190047, 143.43887385126527, 158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.658390852553796, "mean_inference_ms": 1.9196650629593153, "mean_action_processing_ms": 0.35937476014758274, "mean_env_wait_ms": 2.130584617144933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00537419319152832, "StateBufferConnector_ms": 0.006170034408569336, "ViewRequirementAgentConnector_ms": 0.24781489372253418}, "num_episodes": 22, "episode_return_max": 182.21568294024505, "episode_return_min": 125.1641925370651, "episode_return_mean": 154.66023981142604, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 463.6195954442956, "num_env_steps_trained_throughput_per_sec": 463.6195954442956, "timesteps_total": 236544, "num_env_steps_sampled_lifetime": 236544, "num_agent_steps_sampled_lifetime": 236544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 2213.899, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2213.899, "sample_time_ms": 908.517, "learn_time_ms": 1288.443, "learn_throughput": 794.758, "synch_weights_time_ms": 16.619}, "counters": {"num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "done": false, "training_iteration": 231, "trial_id": "b517c_00000", "date": "2025-04-08_19-09-58", "timestamp": 1744110598, "time_this_iter_s": 2.215045690536499, "time_total_s": 508.80262541770935, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D732E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 508.80262541770935, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 31.799999999999997, "ram_util_percent": 85.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.591083236411214, "cur_kl_coeff": 5.7956346104490954e-71, "cur_lr": 1e-07, "total_loss": 2.1718964472413065, "policy_loss": -0.0001291787950322032, "vf_loss": 9.873012071847915, "vf_explained_var": -5.226433277130127e-05, "kl": 9.140401421525723e-07, "entropy": 2.962273944914341, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "env_runners": {"episode_reward_max": 182.21568294024505, "episode_reward_min": 125.1641925370651, "episode_reward_mean": 155.18003036669776, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.1641925370651}, "policy_reward_max": {"tplp_policy": 182.21568294024505}, "policy_reward_mean": {"tplp_policy": 155.18003036669776}, "custom_metrics": {"mean_episode_reward_mean": 155.18003036669776, "mean_episode_reward_min": 125.1641925370651, "mean_episode_reward_max": 182.21568294024505}, "hist_stats": {"episode_reward": [158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [158.09661012945128, 127.94827963330219, 144.82617097216223, 152.0035925118495, 174.96990670966144, 168.84583946924315, 152.22872342978104, 174.89097390539652, 163.35328304573764, 144.05562788426863, 156.25382765735145, 168.7242765621465, 127.19873539944544, 156.8083975569823, 146.87761419800805, 152.33541998243564, 159.886265621634, 182.21568294024505, 165.49343112571646, 142.67510867708984, 135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6584403126718179, "mean_inference_ms": 1.919893824129788, "mean_action_processing_ms": 0.359506366033865, "mean_env_wait_ms": 2.1309437325773164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027360916137695312, "StateBufferConnector_ms": 0.00516510009765625, "ViewRequirementAgentConnector_ms": 0.2595951557159424}, "num_episodes": 18, "episode_return_max": 182.21568294024505, "episode_return_min": 125.1641925370651, "episode_return_mean": 155.18003036669776, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 423.2604524200877, "num_env_steps_trained_throughput_per_sec": 423.2604524200877, "timesteps_total": 237568, "num_env_steps_sampled_lifetime": 237568, "num_agent_steps_sampled_lifetime": 237568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 237568, "timers": {"training_iteration_time_ms": 2236.872, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2236.872, "sample_time_ms": 909.989, "learn_time_ms": 1309.714, "learn_throughput": 781.85, "synch_weights_time_ms": 16.849}, "counters": {"num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "done": false, "training_iteration": 232, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-00", "timestamp": 1744110600, "time_this_iter_s": 2.425873041152954, "time_total_s": 511.2284984588623, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 511.2284984588623, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 49.86666666666667, "ram_util_percent": 85.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.941906385868788, "cur_kl_coeff": 2.8978173052245477e-71, "cur_lr": 1e-07, "total_loss": 2.1649058744311334, "policy_loss": -0.0002943064202554524, "vf_loss": 9.845367795228958, "vf_explained_var": -4.108026623725891e-05, "kl": 2.692407242863709e-06, "entropy": 2.961417505145073, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "env_runners": {"episode_reward_max": 183.95828565495302, "episode_reward_min": 125.1641925370651, "episode_reward_mean": 154.50250547347463, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.1641925370651}, "policy_reward_max": {"tplp_policy": 183.95828565495302}, "policy_reward_mean": {"tplp_policy": 154.50250547347463}, "custom_metrics": {"mean_episode_reward_mean": 154.50250547347463, "mean_episode_reward_min": 125.1641925370651, "mean_episode_reward_max": 183.95828565495302}, "hist_stats": {"episode_reward": [135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.61993862596907, 127.94925508165494, 159.1525938367169, 157.70836063319013, 174.7387867069746, 158.9240752511024, 145.79910807277375, 157.9155468538877, 148.46256652605368, 150.98031935193342, 137.37987199024272, 152.70253923084948, 152.91317499277378, 169.42771057466535, 158.12869283830182, 128.92303245825295, 163.57965788918034, 140.06051466797877, 160.08274176141896, 144.76515395085667, 147.4721042251616, 142.88202897827543, 151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6584848226625352, "mean_inference_ms": 1.919979403974552, "mean_action_processing_ms": 0.3595089703502522, "mean_env_wait_ms": 2.1309845828294196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0027315616607666016, "StateBufferConnector_ms": 0.0061609745025634766, "ViewRequirementAgentConnector_ms": 0.25091052055358887}, "num_episodes": 20, "episode_return_max": 183.95828565495302, "episode_return_min": 125.1641925370651, "episode_return_mean": 154.50250547347463, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 490.6373005535619, "num_env_steps_trained_throughput_per_sec": 490.6373005535619, "timesteps_total": 238592, "num_env_steps_sampled_lifetime": 238592, "num_agent_steps_sampled_lifetime": 238592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 238592, "timers": {"training_iteration_time_ms": 2233.287, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2233.287, "sample_time_ms": 911.281, "learn_time_ms": 1304.816, "learn_throughput": 784.785, "synch_weights_time_ms": 16.869}, "counters": {"num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "done": false, "training_iteration": 233, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-02", "timestamp": 1744110602, "time_this_iter_s": 2.0932328701019287, "time_total_s": 513.3217313289642, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D73D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 513.3217313289642, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 37.3, "ram_util_percent": 85.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7289441004395485, "cur_kl_coeff": 1.4489086526122739e-71, "cur_lr": 1e-07, "total_loss": 2.1805622577667236, "policy_loss": -0.0002692653506528586, "vf_loss": 9.907829153537751, "vf_explained_var": -4.372261464595795e-05, "kl": 3.1147998441852233e-06, "entropy": 2.9612575069069864, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "env_runners": {"episode_reward_max": 183.95828565495302, "episode_reward_min": 125.1641925370651, "episode_reward_mean": 156.08758955594166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.1641925370651}, "policy_reward_max": {"tplp_policy": 183.95828565495302}, "policy_reward_mean": {"tplp_policy": 156.08758955594166}, "custom_metrics": {"mean_episode_reward_mean": 156.08758955594166, "mean_episode_reward_min": 125.1641925370651, "mean_episode_reward_max": 183.95828565495302}, "hist_stats": {"episode_reward": [151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [151.80450132936238, 138.5433509344283, 175.59248261057905, 179.99891125151257, 164.91560744524395, 175.59290583122603, 157.53434116448526, 145.93852213396823, 160.8538829476078, 157.90772976437472, 166.9488632595135, 178.29261180352114, 165.85996660044452, 178.64871845420654, 161.23649655155788, 159.56729992692604, 152.90677589192205, 167.2627270419276, 139.82055131760362, 125.1641925370651, 155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6585195974435587, "mean_inference_ms": 1.9199699114538933, "mean_action_processing_ms": 0.3594618305202398, "mean_env_wait_ms": 2.1308739697921824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053789615631103516, "StateBufferConnector_ms": 0.009152889251708984, "ViewRequirementAgentConnector_ms": 0.23425507545471191}, "num_episodes": 22, "episode_return_max": 183.95828565495302, "episode_return_min": 125.1641925370651, "episode_return_mean": 156.08758955594166, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 482.46724235912666, "num_env_steps_trained_throughput_per_sec": 482.46724235912666, "timesteps_total": 239616, "num_env_steps_sampled_lifetime": 239616, "num_agent_steps_sampled_lifetime": 239616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 239616, "timers": {"training_iteration_time_ms": 2224.585, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2224.585, "sample_time_ms": 915.779, "learn_time_ms": 1291.542, "learn_throughput": 792.851, "synch_weights_time_ms": 16.944}, "counters": {"num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "done": false, "training_iteration": 234, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-05", "timestamp": 1744110605, "time_this_iter_s": 2.127666711807251, "time_total_s": 515.4493980407715, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 515.4493980407715, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 31.049999999999997, "ram_util_percent": 85.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.601639029756188, "cur_kl_coeff": 7.244543263061369e-72, "cur_lr": 1e-07, "total_loss": 2.167403644323349, "policy_loss": -0.00024060120922513305, "vf_loss": 9.854987937211991, "vf_explained_var": -4.8059597611427306e-05, "kl": 1.7065770154825467e-06, "entropy": 2.961027392745018, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "env_runners": {"episode_reward_max": 183.95828565495302, "episode_reward_min": 129.5995158477339, "episode_reward_mean": 155.73071371383728, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 129.5995158477339}, "policy_reward_max": {"tplp_policy": 183.95828565495302}, "policy_reward_mean": {"tplp_policy": 155.73071371383728}, "custom_metrics": {"mean_episode_reward_mean": 155.73071371383728, "mean_episode_reward_min": 129.5995158477339, "mean_episode_reward_max": 183.95828565495302}, "hist_stats": {"episode_reward": [155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.54177908580706, 176.91489620310193, 161.8843652897475, 163.60911766751443, 155.7445517950399, 146.59943248668588, 171.61193157614136, 144.5200814581503, 133.08693297341767, 167.6046544303322, 149.95294616980516, 165.07948924739247, 130.55041355081232, 156.2086820581175, 160.57268708917408, 138.2937402802796, 149.6222981278024, 160.92555571243278, 144.83472752424575, 144.6528350275028, 151.2216787967748, 141.7354449191668, 135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6586080866248869, "mean_inference_ms": 1.9200164293653077, "mean_action_processing_ms": 0.359436032504994, "mean_env_wait_ms": 2.130818198805778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053789615631103516, "StateBufferConnector_ms": 0.009583234786987305, "ViewRequirementAgentConnector_ms": 0.23892521858215332}, "num_episodes": 20, "episode_return_max": 183.95828565495302, "episode_return_min": 129.5995158477339, "episode_return_mean": 155.73071371383728, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 457.546722960434, "num_env_steps_trained_throughput_per_sec": 457.546722960434, "timesteps_total": 240640, "num_env_steps_sampled_lifetime": 240640, "num_agent_steps_sampled_lifetime": 240640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 240640, "timers": {"training_iteration_time_ms": 2210.995, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2210.995, "sample_time_ms": 909.664, "learn_time_ms": 1284.142, "learn_throughput": 797.42, "synch_weights_time_ms": 16.869}, "counters": {"num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "done": false, "training_iteration": 235, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-07", "timestamp": 1744110607, "time_this_iter_s": 2.2444849014282227, "time_total_s": 517.6938829421997, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 517.6938829421997, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 39.6, "ram_util_percent": 85.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.538430366665125, "cur_kl_coeff": 3.6222716315306846e-72, "cur_lr": 1e-07, "total_loss": 2.159101561456919, "policy_loss": -0.00022141149966046215, "vf_loss": 9.82122483253479, "vf_explained_var": -6.40876591205597e-05, "kl": 1.8559461159209368e-06, "entropy": 2.959832201898098, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "env_runners": {"episode_reward_max": 183.95828565495302, "episode_reward_min": 125.25288864019878, "episode_reward_mean": 155.71065346543418, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.25288864019878}, "policy_reward_max": {"tplp_policy": 183.95828565495302}, "policy_reward_mean": {"tplp_policy": 155.71065346543418}, "custom_metrics": {"mean_episode_reward_mean": 155.71065346543418, "mean_episode_reward_min": 125.25288864019878, "mean_episode_reward_max": 183.95828565495302}, "hist_stats": {"episode_reward": [135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [135.9244001307781, 147.4319288237275, 163.29765989402065, 141.0373046323799, 165.72268924540728, 152.69395956450364, 142.8195277960221, 153.91588314260434, 180.88276713839434, 169.22561700609617, 152.59451712437797, 142.8740987588065, 160.96911342130696, 173.94475331706207, 158.75238560456265, 165.50220889268346, 132.92412563489023, 155.49203871101187, 156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6587690015003362, "mean_inference_ms": 1.9201070812991847, "mean_action_processing_ms": 0.3594485119674766, "mean_env_wait_ms": 2.130969168921995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006384372711181641, "StateBufferConnector_ms": 0.010578632354736328, "ViewRequirementAgentConnector_ms": 0.22845125198364258}, "num_episodes": 22, "episode_return_max": 183.95828565495302, "episode_return_min": 125.25288864019878, "episode_return_mean": 155.71065346543418, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 443.1460717561615, "num_env_steps_trained_throughput_per_sec": 443.1460717561615, "timesteps_total": 241664, "num_env_steps_sampled_lifetime": 241664, "num_agent_steps_sampled_lifetime": 241664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 241664, "timers": {"training_iteration_time_ms": 2227.7, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2227.7, "sample_time_ms": 914.015, "learn_time_ms": 1296.081, "learn_throughput": 790.074, "synch_weights_time_ms": 17.154}, "counters": {"num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "done": false, "training_iteration": 236, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-09", "timestamp": 1744110609, "time_this_iter_s": 2.3165276050567627, "time_total_s": 520.0104105472565, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D728E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.0104105472565, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 44.6, "ram_util_percent": 85.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2210873566567897, "cur_kl_coeff": 1.8111358157653423e-72, "cur_lr": 1e-07, "total_loss": 2.185703694820404, "policy_loss": -6.0629157815128565e-05, "vf_loss": 9.926925390958786, "vf_explained_var": -4.581175744533539e-05, "kl": 1.0048437608212169e-06, "entropy": 2.9596701592206953, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "env_runners": {"episode_reward_max": 183.95828565495302, "episode_reward_min": 125.25288864019878, "episode_reward_mean": 155.97645470000418, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.25288864019878}, "policy_reward_max": {"tplp_policy": 183.95828565495302}, "policy_reward_mean": {"tplp_policy": 155.97645470000418}, "custom_metrics": {"mean_episode_reward_mean": 155.97645470000418, "mean_episode_reward_min": 125.25288864019878, "mean_episode_reward_max": 183.95828565495302}, "hist_stats": {"episode_reward": [156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [156.755361734059, 151.67672053596954, 144.98740978786296, 157.2782245554881, 158.562729264394, 129.5995158477339, 142.16875669186453, 164.37292603774657, 142.92029769026774, 165.22058043341173, 134.39686387444473, 153.9259044631678, 152.83610349305673, 152.55170849378814, 164.6025330284086, 183.95828565495302, 145.47236373736274, 162.23282841971377, 158.67960400763334, 158.9091287132556, 156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.658791647145677, "mean_inference_ms": 1.9200054688632178, "mean_action_processing_ms": 0.3594810932011007, "mean_env_wait_ms": 2.130947428989871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009182453155517578, "StateBufferConnector_ms": 0.011665821075439453, "ViewRequirementAgentConnector_ms": 0.1966705322265625}, "num_episodes": 18, "episode_return_max": 183.95828565495302, "episode_return_min": 125.25288864019878, "episode_return_mean": 155.97645470000418, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 486.97209849723464, "num_env_steps_trained_throughput_per_sec": 486.97209849723464, "timesteps_total": 242688, "num_env_steps_sampled_lifetime": 242688, "num_agent_steps_sampled_lifetime": 242688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 242688, "timers": {"training_iteration_time_ms": 2209.147, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2209.147, "sample_time_ms": 912.456, "learn_time_ms": 1279.273, "learn_throughput": 800.454, "synch_weights_time_ms": 16.861}, "counters": {"num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "done": false, "training_iteration": 237, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-11", "timestamp": 1744110611, "time_this_iter_s": 2.1077916622161865, "time_total_s": 522.1182022094727, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 522.1182022094727, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 36.833333333333336, "ram_util_percent": 85.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6201780177652836, "cur_kl_coeff": 9.055679078826712e-73, "cur_lr": 1e-07, "total_loss": 2.1828202418982983, "policy_loss": -0.00019679051474668084, "vf_loss": 9.916114801168442, "vf_explained_var": -4.548206925392151e-05, "kl": 1.7502261562496458e-06, "entropy": 2.9601166039705276, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "env_runners": {"episode_reward_max": 182.82054349938358, "episode_reward_min": 125.25288864019878, "episode_reward_mean": 156.00039817021442, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.25288864019878}, "policy_reward_max": {"tplp_policy": 182.82054349938358}, "policy_reward_mean": {"tplp_policy": 156.00039817021442}, "custom_metrics": {"mean_episode_reward_mean": 156.00039817021442, "mean_episode_reward_min": 125.25288864019878, "mean_episode_reward_max": 182.82054349938358}, "hist_stats": {"episode_reward": [156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [156.6113433972495, 168.68101176288422, 157.98442091886358, 143.39307064021457, 159.52138859063993, 169.39305230686068, 158.94256228286602, 146.7718458109122, 160.38470880717725, 144.07872260928295, 159.8512575014674, 156.26818753876867, 159.8010310993046, 151.579414456486, 162.82122543823724, 176.28617381858328, 164.19205693592465, 137.35963078438652, 157.89213667223592, 164.67420865167978, 141.67976220441722, 161.40264936752263, 157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6587574462762008, "mean_inference_ms": 1.9198293194273055, "mean_action_processing_ms": 0.35951472258980205, "mean_env_wait_ms": 2.130842712421889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008186101913452148, "StateBufferConnector_ms": 0.014437675476074219, "ViewRequirementAgentConnector_ms": 0.20378708839416504}, "num_episodes": 20, "episode_return_max": 182.82054349938358, "episode_return_min": 125.25288864019878, "episode_return_mean": 156.00039817021442, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 492.2668581192443, "num_env_steps_trained_throughput_per_sec": 492.2668581192443, "timesteps_total": 243712, "num_env_steps_sampled_lifetime": 243712, "num_agent_steps_sampled_lifetime": 243712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 243712, "timers": {"training_iteration_time_ms": 2185.689, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2185.689, "sample_time_ms": 899.372, "learn_time_ms": 1268.431, "learn_throughput": 807.296, "synch_weights_time_ms": 17.429}, "counters": {"num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "done": false, "training_iteration": 238, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-14", "timestamp": 1744110614, "time_this_iter_s": 2.085827112197876, "time_total_s": 524.2040293216705, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D732E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.2040293216705, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 32.833333333333336, "ram_util_percent": 85.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.588096457347274, "cur_kl_coeff": 4.527839539413356e-73, "cur_lr": 1e-07, "total_loss": 2.172719605267048, "policy_loss": -7.858907920308412e-05, "vf_loss": 9.875398194789886, "vf_explained_var": -6.113536655902863e-05, "kl": 1.3505960935425442e-06, "entropy": 2.9605134606361387, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "env_runners": {"episode_reward_max": 182.82054349938358, "episode_reward_min": 125.25288864019878, "episode_reward_mean": 156.16127699665344, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 125.25288864019878}, "policy_reward_max": {"tplp_policy": 182.82054349938358}, "policy_reward_mean": {"tplp_policy": 156.16127699665344}, "custom_metrics": {"mean_episode_reward_mean": 156.16127699665344, "mean_episode_reward_min": 125.25288864019878, "mean_episode_reward_max": 182.82054349938358}, "hist_stats": {"episode_reward": [157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [157.16541227685028, 155.15619958143944, 165.56722011258304, 176.62100415032208, 161.30784839664452, 143.1289179161365, 142.92554339991509, 153.66386543718806, 167.21615215819426, 169.74430503557699, 159.16780825310175, 148.442521975728, 148.97354384179667, 160.40607305786463, 150.25345950377684, 182.82054349938358, 142.97073680566803, 180.08928761293245, 162.1791585909262, 158.57897197040424, 152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6587983574747603, "mean_inference_ms": 1.9197842452684375, "mean_action_processing_ms": 0.35961740466233616, "mean_env_wait_ms": 2.1307845724097136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006165027618408203, "StateBufferConnector_ms": 0.01244354248046875, "ViewRequirementAgentConnector_ms": 0.19643688201904297}, "num_episodes": 22, "episode_return_max": 182.82054349938358, "episode_return_min": 125.25288864019878, "episode_return_mean": 156.16127699665344, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 445.36748914933435, "num_env_steps_trained_throughput_per_sec": 445.36748914933435, "timesteps_total": 244736, "num_env_steps_sampled_lifetime": 244736, "num_agent_steps_sampled_lifetime": 244736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 244736, "timers": {"training_iteration_time_ms": 2191.634, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2191.634, "sample_time_ms": 897.293, "learn_time_ms": 1276.362, "learn_throughput": 802.28, "synch_weights_time_ms": 17.642}, "counters": {"num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "done": false, "training_iteration": 239, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-16", "timestamp": 1744110616, "time_this_iter_s": 2.3049302101135254, "time_total_s": 526.5089595317841, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 526.5089595317841, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 35.775, "ram_util_percent": 85.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7564485374838115, "cur_kl_coeff": 2.263919769706678e-73, "cur_lr": 1e-07, "total_loss": 2.1762133300304414, "policy_loss": -0.0001799318502889946, "vf_loss": 9.8898996591568, "vf_explained_var": -4.9920007586479184e-05, "kl": 1.8636981372832651e-06, "entropy": 2.96081648170948, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "env_runners": {"episode_reward_max": 187.81300141266578, "episode_reward_min": 121.21416383375536, "episode_reward_mean": 155.54020914179358, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.21416383375536}, "policy_reward_max": {"tplp_policy": 187.81300141266578}, "policy_reward_mean": {"tplp_policy": 155.54020914179358}, "custom_metrics": {"mean_episode_reward_mean": 155.54020914179358, "mean_episode_reward_min": 121.21416383375536, "mean_episode_reward_max": 187.81300141266578}, "hist_stats": {"episode_reward": [152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.1671307507438, 157.39309639246923, 137.97690252794743, 146.85656694494102, 155.7815935589155, 159.07267196372922, 125.25288864019878, 153.00489932949176, 142.24817719727625, 142.18926181903674, 162.10538367913114, 159.53242836992263, 177.14060953479083, 140.04839964818663, 163.31198384372226, 142.0235681530372, 131.28107045349, 164.49895447692649, 180.60354614272717, 155.51495264111895, 166.6840331192416, 153.34936798928246, 152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6588229954747601, "mean_inference_ms": 1.9199417649037662, "mean_action_processing_ms": 0.35972987229949616, "mean_env_wait_ms": 2.130919883254125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006165027618408203, "StateBufferConnector_ms": 0.010841131210327148, "ViewRequirementAgentConnector_ms": 0.1973421573638916}, "num_episodes": 20, "episode_return_max": 187.81300141266578, "episode_return_min": 121.21416383375536, "episode_return_mean": 155.54020914179358, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.606232780637, "num_env_steps_trained_throughput_per_sec": 464.606232780637, "timesteps_total": 245760, "num_env_steps_sampled_lifetime": 245760, "num_agent_steps_sampled_lifetime": 245760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 245760, "timers": {"training_iteration_time_ms": 2207.25, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2207.25, "sample_time_ms": 908.388, "learn_time_ms": 1280.526, "learn_throughput": 799.671, "synch_weights_time_ms": 17.999}, "counters": {"num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "done": false, "training_iteration": 240, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-18", "timestamp": 1744110618, "time_this_iter_s": 2.210686445236206, "time_total_s": 528.7196459770203, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 528.7196459770203, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 43.166666666666664, "ram_util_percent": 85.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4982741996645927, "cur_kl_coeff": 1.131959884853339e-73, "cur_lr": 1e-07, "total_loss": 2.175668829679489, "policy_loss": -9.88877029158175e-05, "vf_loss": 9.887361174821853, "vf_explained_var": -6.093457341194153e-05, "kl": 1.1595895972327241e-06, "entropy": 2.960725858807564, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "env_runners": {"episode_reward_max": 187.81300141266578, "episode_reward_min": 121.21416383375536, "episode_reward_mean": 155.73611862240114, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.21416383375536}, "policy_reward_max": {"tplp_policy": 187.81300141266578}, "policy_reward_mean": {"tplp_policy": 155.73611862240114}, "custom_metrics": {"mean_episode_reward_mean": 155.73611862240114, "mean_episode_reward_min": 121.21416383375536, "mean_episode_reward_max": 187.81300141266578}, "hist_stats": {"episode_reward": [152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [152.22486222784613, 152.50533648117622, 158.23570211703966, 159.8763872577188, 158.17493845615223, 155.72016239745807, 154.41339666006124, 163.0540468332747, 137.3300247697121, 153.54736748671348, 148.25985363639165, 168.46389603741682, 151.856404627046, 163.57966699772464, 166.85391850960218, 158.45573669177926, 155.4269105643858, 144.46187583823556, 165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6588357463706517, "mean_inference_ms": 1.92007555491645, "mean_action_processing_ms": 0.35981811047788104, "mean_env_wait_ms": 2.130972588077407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005159616470336914, "StateBufferConnector_ms": 0.008756637573242188, "ViewRequirementAgentConnector_ms": 0.20739245414733887}, "num_episodes": 22, "episode_return_max": 187.81300141266578, "episode_return_min": 121.21416383375536, "episode_return_mean": 155.73611862240114, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 474.1057680069667, "num_env_steps_trained_throughput_per_sec": 474.1057680069667, "timesteps_total": 246784, "num_env_steps_sampled_lifetime": 246784, "num_agent_steps_sampled_lifetime": 246784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 246784, "timers": {"training_iteration_time_ms": 2202.365, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2202.365, "sample_time_ms": 911.92, "learn_time_ms": 1272.364, "learn_throughput": 804.801, "synch_weights_time_ms": 17.744}, "counters": {"num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "done": false, "training_iteration": 241, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-20", "timestamp": 1744110620, "time_this_iter_s": 2.165787696838379, "time_total_s": 530.8854336738586, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 530.8854336738586, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 35.333333333333336, "ram_util_percent": 85.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3246649745851755, "cur_kl_coeff": 5.659799424266695e-74, "cur_lr": 1e-07, "total_loss": 2.1731034487485887, "policy_loss": -9.026121697388589e-05, "vf_loss": 9.87724397778511, "vf_explained_var": -5.528666079044342e-05, "kl": 1.4630556891326306e-06, "entropy": 2.961172786355019, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "env_runners": {"episode_reward_max": 187.81300141266578, "episode_reward_min": 121.21416383375536, "episode_reward_mean": 155.7668822199112, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.21416383375536}, "policy_reward_max": {"tplp_policy": 187.81300141266578}, "policy_reward_mean": {"tplp_policy": 155.7668822199112}, "custom_metrics": {"mean_episode_reward_mean": 155.7668822199112, "mean_episode_reward_min": 121.21416383375536, "mean_episode_reward_max": 187.81300141266578}, "hist_stats": {"episode_reward": [165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [165.267620601134, 127.54556295186988, 143.7507049677874, 153.5555970245267, 145.02442906777716, 140.25216304871378, 159.06103426985965, 159.31993047676897, 175.26181849947335, 155.8567164152055, 151.33110549072381, 152.14219872089492, 150.545238353992, 171.10307738758075, 160.14814418089256, 159.38065146781634, 155.8302407475053, 158.2371734104626, 140.42078599296286, 152.46805890861478, 146.65337635812762, 153.8525001876467, 144.70594732879874, 168.75462710982603, 167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6588676542904682, "mean_inference_ms": 1.9201277267421153, "mean_action_processing_ms": 0.35985672478071096, "mean_env_wait_ms": 2.1309692843163384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.001995086669921875, "StateBufferConnector_ms": 0.008757352828979492, "ViewRequirementAgentConnector_ms": 0.2197420597076416}, "num_episodes": 18, "episode_return_max": 187.81300141266578, "episode_return_min": 121.21416383375536, "episode_return_mean": 155.7668822199112, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 464.68349306161133, "num_env_steps_trained_throughput_per_sec": 464.68349306161133, "timesteps_total": 247808, "num_env_steps_sampled_lifetime": 247808, "num_agent_steps_sampled_lifetime": 247808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 247808, "timers": {"training_iteration_time_ms": 2180.799, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2180.799, "sample_time_ms": 900.446, "learn_time_ms": 1261.253, "learn_throughput": 811.891, "synch_weights_time_ms": 18.661}, "counters": {"num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "done": false, "training_iteration": 242, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-23", "timestamp": 1744110623, "time_this_iter_s": 2.209779739379883, "time_total_s": 533.0952134132385, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D72840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 533.0952134132385, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 34.03333333333334, "ram_util_percent": 85.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.672411559522152, "cur_kl_coeff": 2.8298997121333474e-74, "cur_lr": 1e-07, "total_loss": 2.1668193109333513, "policy_loss": -0.00010589170560706406, "vf_loss": 9.852519696950912, "vf_explained_var": -3.797002136707306e-05, "kl": 1.962943014000018e-06, "entropy": 2.9620473712682722, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "env_runners": {"episode_reward_max": 187.81300141266578, "episode_reward_min": 121.21416383375536, "episode_reward_mean": 156.60815003453848, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 121.21416383375536}, "policy_reward_max": {"tplp_policy": 187.81300141266578}, "policy_reward_mean": {"tplp_policy": 156.60815003453848}, "custom_metrics": {"mean_episode_reward_mean": 156.60815003453848, "mean_episode_reward_min": 121.21416383375536, "mean_episode_reward_max": 187.81300141266578}, "hist_stats": {"episode_reward": [167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216, 153.0347963154468, 144.8629448107444, 160.8336313072608, 167.54444224537835, 154.54137263004304, 143.37694797506603, 165.41907893278213, 164.29878378894597, 164.65611036877365, 156.5049303630634, 142.93584530451392, 154.2514074698676, 165.62181799587648, 163.48482785130363, 164.52710144913308, 152.75436023872476, 141.14599973579362, 163.32736880983686, 145.36713137805083, 171.3504946511135, 177.93581197018082, 142.7441641588636, 155.2583896631362, 158.81772501778983], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [167.83363218217718, 127.21938105088468, 162.08790384912942, 153.45569127425836, 154.50385454842473, 167.7604891069779, 172.55891148704194, 149.55866031224093, 177.66636259802297, 158.40035812583207, 178.53579964848467, 155.2141904360223, 150.5196406436143, 176.63715209302737, 159.98963593550118, 156.86078506224942, 143.94896389901996, 177.73059949605866, 155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216, 153.0347963154468, 144.8629448107444, 160.8336313072608, 167.54444224537835, 154.54137263004304, 143.37694797506603, 165.41907893278213, 164.29878378894597, 164.65611036877365, 156.5049303630634, 142.93584530451392, 154.2514074698676, 165.62181799587648, 163.48482785130363, 164.52710144913308, 152.75436023872476, 141.14599973579362, 163.32736880983686, 145.36713137805083, 171.3504946511135, 177.93581197018082, 142.7441641588636, 155.2583896631362, 158.81772501778983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6591105681244912, "mean_inference_ms": 1.9203749337416218, "mean_action_processing_ms": 0.3598990350499685, "mean_env_wait_ms": 2.1310016719136975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0019960403442382812, "StateBufferConnector_ms": 0.003991603851318359, "ViewRequirementAgentConnector_ms": 0.22315740585327148}, "num_episodes": 24, "episode_return_max": 187.81300141266578, "episode_return_min": 121.21416383375536, "episode_return_mean": 156.60815003453848, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 440.9419964362992, "num_env_steps_trained_throughput_per_sec": 440.9419964362992, "timesteps_total": 248832, "num_env_steps_sampled_lifetime": 248832, "num_agent_steps_sampled_lifetime": 248832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 248832, "timers": {"training_iteration_time_ms": 2204.321, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2204.321, "sample_time_ms": 908.501, "learn_time_ms": 1276.641, "learn_throughput": 802.105, "synch_weights_time_ms": 18.74}, "counters": {"num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "done": false, "training_iteration": 243, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-25", "timestamp": 1744110625, "time_this_iter_s": 2.3278563022613525, "time_total_s": 535.4230697154999, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D73740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 535.4230697154999, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 50.1, "ram_util_percent": 85.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.768933746218681, "cur_kl_coeff": 1.4149498560666737e-74, "cur_lr": 1e-07, "total_loss": 2.1725613735616207, "policy_loss": -0.00021509250800590962, "vf_loss": 9.876215332746506, "vf_explained_var": -5.212239921092987e-05, "kl": 2.8914200328467032e-06, "entropy": 2.962773622572422, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "env_runners": {"episode_reward_max": 187.81300141266578, "episode_reward_min": 106.34955685520333, "episode_reward_mean": 155.40283636974394, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.34955685520333}, "policy_reward_max": {"tplp_policy": 187.81300141266578}, "policy_reward_mean": {"tplp_policy": 155.40283636974394}, "custom_metrics": {"mean_episode_reward_mean": 155.40283636974394, "mean_episode_reward_min": 106.34955685520333, "mean_episode_reward_max": 187.81300141266578}, "hist_stats": {"episode_reward": [155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216, 153.0347963154468, 144.8629448107444, 160.8336313072608, 167.54444224537835, 154.54137263004304, 143.37694797506603, 165.41907893278213, 164.29878378894597, 164.65611036877365, 156.5049303630634, 142.93584530451392, 154.2514074698676, 165.62181799587648, 163.48482785130363, 164.52710144913308, 152.75436023872476, 141.14599973579362, 163.32736880983686, 145.36713137805083, 171.3504946511135, 177.93581197018082, 142.7441641588636, 155.2583896631362, 158.81772501778983, 106.34955685520333, 152.10435972725372, 161.83845759906185, 167.1009975102209, 155.5957846321359, 140.3244154053562, 140.34988977527553, 161.41858099682614, 161.9064657877731, 154.71418400553776, 147.20866556075157, 176.7608410042456, 145.38470855601264, 161.98839981883492, 151.16196242642036, 155.79924600048628, 149.9204330680653, 180.02369654005238], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [155.38617425109985, 143.8337882638071, 138.917592470606, 131.70595442311435, 149.12310568311753, 167.88059603670862, 175.31238903226563, 158.3257519739901, 148.1123724911603, 121.21416383375536, 154.46771846003014, 172.39310682581646, 161.49885327569973, 175.14066811276774, 151.96275615985383, 187.81300141266578, 156.46819544364442, 153.0360365452657, 139.47531020209428, 164.514938036045, 162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216, 153.0347963154468, 144.8629448107444, 160.8336313072608, 167.54444224537835, 154.54137263004304, 143.37694797506603, 165.41907893278213, 164.29878378894597, 164.65611036877365, 156.5049303630634, 142.93584530451392, 154.2514074698676, 165.62181799587648, 163.48482785130363, 164.52710144913308, 152.75436023872476, 141.14599973579362, 163.32736880983686, 145.36713137805083, 171.3504946511135, 177.93581197018082, 142.7441641588636, 155.2583896631362, 158.81772501778983, 106.34955685520333, 152.10435972725372, 161.83845759906185, 167.1009975102209, 155.5957846321359, 140.3244154053562, 140.34988977527553, 161.41858099682614, 161.9064657877731, 154.71418400553776, 147.20866556075157, 176.7608410042456, 145.38470855601264, 161.98839981883492, 151.16196242642036, 155.79924600048628, 149.9204330680653, 180.02369654005238]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6590750385823441, "mean_inference_ms": 1.9204388307200788, "mean_action_processing_ms": 0.35997812233452714, "mean_env_wait_ms": 2.131417399369717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041387081146240234, "StateBufferConnector_ms": 0.005993366241455078, "ViewRequirementAgentConnector_ms": 0.20967960357666016}, "num_episodes": 18, "episode_return_max": 187.81300141266578, "episode_return_min": 106.34955685520333, "episode_return_mean": 155.40283636974394, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 497.6175922771942, "num_env_steps_trained_throughput_per_sec": 497.6175922771942, "timesteps_total": 249856, "num_env_steps_sampled_lifetime": 249856, "num_agent_steps_sampled_lifetime": 249856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 249856, "timers": {"training_iteration_time_ms": 2197.859, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2197.859, "sample_time_ms": 906.611, "learn_time_ms": 1272.337, "learn_throughput": 804.818, "synch_weights_time_ms": 18.472}, "counters": {"num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "done": false, "training_iteration": 244, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-27", "timestamp": 1744110627, "time_this_iter_s": 2.062822103500366, "time_total_s": 537.4858918190002, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D70360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 537.4858918190002, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 36.26666666666667, "ram_util_percent": 85.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.523089875653386, "cur_kl_coeff": 7.074749280333368e-75, "cur_lr": 1e-07, "total_loss": 2.183932114392519, "policy_loss": -0.0001887176767922938, "vf_loss": 9.921646690368652, "vf_explained_var": -6.337836384773254e-05, "kl": 2.1706124463616306e-06, "entropy": 2.9629083812236785, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "env_runners": {"episode_reward_max": 180.02369654005238, "episode_reward_min": 106.34955685520333, "episode_reward_mean": 155.73371965528494, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 106.34955685520333}, "policy_reward_max": {"tplp_policy": 180.02369654005238}, "policy_reward_mean": {"tplp_policy": 155.73371965528494}, "custom_metrics": {"mean_episode_reward_mean": 155.73371965528494, "mean_episode_reward_min": 106.34955685520333, "mean_episode_reward_max": 180.02369654005238}, "hist_stats": {"episode_reward": [162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216, 153.0347963154468, 144.8629448107444, 160.8336313072608, 167.54444224537835, 154.54137263004304, 143.37694797506603, 165.41907893278213, 164.29878378894597, 164.65611036877365, 156.5049303630634, 142.93584530451392, 154.2514074698676, 165.62181799587648, 163.48482785130363, 164.52710144913308, 152.75436023872476, 141.14599973579362, 163.32736880983686, 145.36713137805083, 171.3504946511135, 177.93581197018082, 142.7441641588636, 155.2583896631362, 158.81772501778983, 106.34955685520333, 152.10435972725372, 161.83845759906185, 167.1009975102209, 155.5957846321359, 140.3244154053562, 140.34988977527553, 161.41858099682614, 161.9064657877731, 154.71418400553776, 147.20866556075157, 176.7608410042456, 145.38470855601264, 161.98839981883492, 151.16196242642036, 155.79924600048628, 149.9204330680653, 180.02369654005238, 167.21062337939543, 168.3516858601147, 156.26720631495678, 168.90625503077192, 165.04853824206813, 146.30292524292284, 172.4378074693492, 157.19677596803206, 144.63520992886507, 163.11090808369144, 152.89866252761732, 161.8947616099626, 160.3750449313169, 155.8950804511626, 156.9940252910278, 156.63115609885313, 150.54418553333252, 152.27482987801656, 147.75130755959023, 134.9438120865612], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [162.15785461213622, 142.5006893123801, 158.7991138683625, 148.5694940743688, 148.8012183204655, 125.0926851569112, 130.82239131601403, 169.55485668206015, 148.36718321656085, 164.38813492222798, 157.63732608782263, 161.60383542379313, 171.63081391903933, 133.58162767128005, 158.74345587227432, 167.0482444090796, 154.04778536093804, 154.82735566734002, 172.3196924939198, 153.14442861196883, 162.5724489389622, 175.54939438947136, 147.30197370616895, 163.5194878004322, 155.61949447432957, 161.05373386667858, 166.65284617243003, 154.62565591537424, 145.91736742550364, 143.16502407483756, 132.64050202469062, 140.99025526439087, 168.19150541125825, 156.11476067966606, 151.14110526880606, 143.546864293978, 169.87457546913967, 167.0398521646216, 153.0347963154468, 144.8629448107444, 160.8336313072608, 167.54444224537835, 154.54137263004304, 143.37694797506603, 165.41907893278213, 164.29878378894597, 164.65611036877365, 156.5049303630634, 142.93584530451392, 154.2514074698676, 165.62181799587648, 163.48482785130363, 164.52710144913308, 152.75436023872476, 141.14599973579362, 163.32736880983686, 145.36713137805083, 171.3504946511135, 177.93581197018082, 142.7441641588636, 155.2583896631362, 158.81772501778983, 106.34955685520333, 152.10435972725372, 161.83845759906185, 167.1009975102209, 155.5957846321359, 140.3244154053562, 140.34988977527553, 161.41858099682614, 161.9064657877731, 154.71418400553776, 147.20866556075157, 176.7608410042456, 145.38470855601264, 161.98839981883492, 151.16196242642036, 155.79924600048628, 149.9204330680653, 180.02369654005238, 167.21062337939543, 168.3516858601147, 156.26720631495678, 168.90625503077192, 165.04853824206813, 146.30292524292284, 172.4378074693492, 157.19677596803206, 144.63520992886507, 163.11090808369144, 152.89866252761732, 161.8947616099626, 160.3750449313169, 155.8950804511626, 156.9940252910278, 156.63115609885313, 150.54418553333252, 152.27482987801656, 147.75130755959023, 134.9438120865612]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6591419744089366, "mean_inference_ms": 1.9204580881918576, "mean_action_processing_ms": 0.36003249114363983, "mean_env_wait_ms": 2.131609096686782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005147457122802734, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.2194962501525879}, "num_episodes": 20, "episode_return_max": 180.02369654005238, "episode_return_min": 106.34955685520333, "episode_return_mean": 155.73371965528494, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 437.8294560241052, "num_env_steps_trained_throughput_per_sec": 437.8294560241052, "timesteps_total": 250880, "num_env_steps_sampled_lifetime": 250880, "num_agent_steps_sampled_lifetime": 250880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 250880, "timers": {"training_iteration_time_ms": 2207.938, "restore_workers_time_ms": 0.0, "training_step_time_ms": 2207.932, "sample_time_ms": 911.775, "learn_time_ms": 1277.09, "learn_throughput": 801.823, "synch_weights_time_ms": 18.486}, "counters": {"num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "done": true, "training_iteration": 245, "trial_id": "b517c_00000", "date": "2025-04-08_19-10-30", "timestamp": 1744110630, "time_this_iter_s": 2.345932722091675, "time_total_s": 539.8318245410919, "pid": 24692, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002A3F3D73920>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.8318245410919, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 36.599999999999994, "ram_util_percent": 85.82499999999999}}
