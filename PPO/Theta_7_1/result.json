{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0822415687143803, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 1e-07, "total_loss": 2.2106365501880645, "policy_loss": 0.0002553138474468142, "vf_loss": 9.980968528985978, "vf_explained_var": 7.301568984985352e-07, "kl": 0.00020279199570722995, "entropy": 2.849014538526535, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "env_runners": {"episode_reward_max": 496.76212937905933, "episode_reward_min": 418.06929789102156, "episode_reward_mean": 463.5023207306718, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 900, "policy_reward_min": {"tplp_policy": 418.06929789102156}, "policy_reward_max": {"tplp_policy": 496.76212937905933}, "policy_reward_mean": {"tplp_policy": 463.5023207306718}, "custom_metrics": {"mean_episode_reward_mean": 463.5023207306718, "mean_episode_reward_min": 418.06929789102156, "mean_episode_reward_max": 496.76212937905933}, "hist_stats": {"episode_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4765515759350183, "mean_inference_ms": 5.0082083039478515, "mean_action_processing_ms": 0.8983805946547412, "mean_env_wait_ms": 5.149189892973395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04422267278035482, "StateBufferConnector_ms": 0.011277198791503906, "ViewRequirementAgentConnector_ms": 0.4756384425693088}, "num_episodes": 18, "episode_return_max": 496.76212937905933, "episode_return_min": 418.06929789102156, "episode_return_mean": 463.5023207306718, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 202.75983474121486, "num_env_steps_trained_throughput_per_sec": 202.75983474121486, "timesteps_total": 1024, "num_env_steps_sampled_lifetime": 1024, "num_agent_steps_sampled_lifetime": 1024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 1024, "timers": {"training_iteration_time_ms": 5050.31, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5050.31, "sample_time_ms": 2285.924, "learn_time_ms": 2725.006, "learn_throughput": 375.779, "synch_weights_time_ms": 38.221}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 1024, "num_agent_steps_trained": 1024}, "done": false, "training_iteration": 1, "trial_id": "3bf18_00000", "date": "2025-04-08_23-16-36", "timestamp": 1744125396, "time_this_iter_s": 5.059566020965576, "time_total_s": 5.059566020965576, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA53A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5.059566020965576, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 48.8142857142857, "ram_util_percent": 86.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.907273779064417, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 1e-07, "total_loss": 2.212934412062168, "policy_loss": -2.4905084865167736e-05, "vf_loss": 9.991600114107133, "vf_explained_var": 8.005648851394654e-07, "kl": 2.167565949395822e-06, "entropy": 2.8494092553853987, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "env_runners": {"episode_reward_max": 526.8752965931802, "episode_reward_min": 418.06929789102156, "episode_reward_mean": 465.0131292765795, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 1800, "policy_reward_min": {"tplp_policy": 418.06929789102156}, "policy_reward_max": {"tplp_policy": 526.8752965931802}, "policy_reward_mean": {"tplp_policy": 465.0131292765795}, "custom_metrics": {"mean_episode_reward_mean": 465.0131292765795, "mean_episode_reward_min": 418.06929789102156, "mean_episode_reward_max": 526.8752965931802}, "hist_stats": {"episode_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.464853456671069, "mean_inference_ms": 4.818328570549985, "mean_action_processing_ms": 0.8477356279716832, "mean_env_wait_ms": 4.839797996697839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05172292391459147, "StateBufferConnector_ms": 0.022488832473754883, "ViewRequirementAgentConnector_ms": 0.5779319339328342}, "num_episodes": 18, "episode_return_max": 526.8752965931802, "episode_return_min": 418.06929789102156, "episode_return_mean": 465.0131292765795, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 196.29740045874982, "num_env_steps_trained_throughput_per_sec": 196.29740045874982, "timesteps_total": 2048, "num_env_steps_sampled_lifetime": 2048, "num_agent_steps_sampled_lifetime": 2048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 2048, "timers": {"training_iteration_time_ms": 5133.442, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5133.442, "sample_time_ms": 2069.712, "learn_time_ms": 3027.693, "learn_throughput": 338.211, "synch_weights_time_ms": 35.458}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 2048, "num_agent_steps_trained": 2048}, "done": false, "training_iteration": 2, "trial_id": "3bf18_00000", "date": "2025-04-08_23-16-41", "timestamp": 1744125401, "time_this_iter_s": 5.228758335113525, "time_total_s": 10.288324356079102, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10.288324356079102, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 58.68571428571429, "ram_util_percent": 86.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.080754304304719, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 1e-07, "total_loss": 2.2124230921268464, "policy_loss": -6.828676268924027e-05, "vf_loss": 9.99048371911049, "vf_explained_var": 4.030764102935791e-07, "kl": 1.3927129635327163e-06, "entropy": 2.8512960195541384, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "env_runners": {"episode_reward_max": 526.8752965931802, "episode_reward_min": 417.00195407632435, "episode_reward_mean": 466.17779953930864, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3000, "policy_reward_min": {"tplp_policy": 417.00195407632435}, "policy_reward_max": {"tplp_policy": 526.8752965931802}, "policy_reward_mean": {"tplp_policy": 466.17779953930864}, "custom_metrics": {"mean_episode_reward_mean": 466.17779953930864, "mean_episode_reward_min": 417.00195407632435, "mean_episode_reward_max": 526.8752965931802}, "hist_stats": {"episode_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5027863108174675, "mean_inference_ms": 4.663341548376474, "mean_action_processing_ms": 0.823859683282501, "mean_env_wait_ms": 4.666253201257104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03561735153198242, "StateBufferConnector_ms": 0.03519217173258463, "ViewRequirementAgentConnector_ms": 0.5399064222971598}, "num_episodes": 24, "episode_return_max": 526.8752965931802, "episode_return_min": 417.00195407632435, "episode_return_mean": 466.17779953930864, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 213.41611470396052, "num_env_steps_trained_throughput_per_sec": 213.41611470396052, "timesteps_total": 3072, "num_env_steps_sampled_lifetime": 3072, "num_agent_steps_sampled_lifetime": 3072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 3072, "timers": {"training_iteration_time_ms": 5021.674, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5021.674, "sample_time_ms": 2008.813, "learn_time_ms": 2972.173, "learn_throughput": 344.529, "synch_weights_time_ms": 39.82}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 3072, "num_agent_steps_trained": 3072}, "done": false, "training_iteration": 3, "trial_id": "3bf18_00000", "date": "2025-04-08_23-16-46", "timestamp": 1744125406, "time_this_iter_s": 4.815476179122925, "time_total_s": 15.103800535202026, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA52200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15.103800535202026, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 55.08571428571428, "ram_util_percent": 86.88571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0274503011256457, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 1e-07, "total_loss": 2.2142875477671624, "policy_loss": -1.9700027769431473e-05, "vf_loss": 9.998571985960007, "vf_explained_var": 5.11854887008667e-07, "kl": 9.85587245150299e-07, "entropy": 2.8533575937151907, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "env_runners": {"episode_reward_max": 526.8752965931802, "episode_reward_min": 417.00195407632435, "episode_reward_mean": 464.012359651783, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 3900, "policy_reward_min": {"tplp_policy": 417.00195407632435}, "policy_reward_max": {"tplp_policy": 526.8752965931802}, "policy_reward_mean": {"tplp_policy": 464.012359651783}, "custom_metrics": {"mean_episode_reward_mean": 464.012359651783, "mean_episode_reward_min": 417.00195407632435, "mean_episode_reward_max": 526.8752965931802}, "hist_stats": {"episode_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.64512533038214, 486.55418307192645, 459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.519790329999802, "mean_inference_ms": 4.630696355797975, "mean_action_processing_ms": 0.8212045195173991, "mean_env_wait_ms": 4.597874934629352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03188756796029898, "StateBufferConnector_ms": 0.03890227048824995, "ViewRequirementAgentConnector_ms": 0.5420168240865072}, "num_episodes": 18, "episode_return_max": 526.8752965931802, "episode_return_min": 417.00195407632435, "episode_return_mean": 464.012359651783, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 206.98511883735068, "num_env_steps_trained_throughput_per_sec": 206.98511883735068, "timesteps_total": 4096, "num_env_steps_sampled_lifetime": 4096, "num_agent_steps_sampled_lifetime": 4096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 4096, "timers": {"training_iteration_time_ms": 5003.06, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5003.06, "sample_time_ms": 2040.155, "learn_time_ms": 2923.202, "learn_throughput": 350.301, "synch_weights_time_ms": 39.051}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 4096, "num_agent_steps_trained": 4096}, "done": false, "training_iteration": 4, "trial_id": "3bf18_00000", "date": "2025-04-08_23-16-51", "timestamp": 1744125411, "time_this_iter_s": 4.95706582069397, "time_total_s": 20.060866355895996, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA52DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20.060866355895996, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 63.25714285714285, "ram_util_percent": 86.95714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1842575408518314, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 1e-07, "total_loss": 2.208723297715187, "policy_loss": -1.475842436775565e-05, "vf_loss": 9.976929646730422, "vf_explained_var": 2.127140760421753e-07, "kl": 5.490265543084405e-07, "entropy": 2.8549435526132583, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "env_runners": {"episode_reward_max": 526.8752965931802, "episode_reward_min": 411.3703727884907, "episode_reward_mean": 464.2883219622048, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.3703727884907}, "policy_reward_max": {"tplp_policy": 526.8752965931802}, "policy_reward_mean": {"tplp_policy": 464.2883219622048}, "custom_metrics": {"mean_episode_reward_mean": 464.2883219622048, "mean_episode_reward_min": 411.3703727884907, "mean_episode_reward_max": 526.8752965931802}, "hist_stats": {"episode_reward": [459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.80049513078575, 473.90611253666935, 482.894371852512, 418.06929789102156, 432.05102672486174, 496.76212937905933, 448.69728965231303, 485.4780674461892, 461.6219314198104, 465.51261940219575, 451.2877518449378, 455.5285617410545, 452.3956537814495, 427.8498652270566, 484.17056172218105, 476.8167289976856, 440.0958750213394, 465.5801448124697, 469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5429278821855024, "mean_inference_ms": 4.640668249850204, "mean_action_processing_ms": 0.8308385458959903, "mean_env_wait_ms": 4.5633871688389664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027886152267456055, "StateBufferConnector_ms": 0.03999042510986328, "ViewRequirementAgentConnector_ms": 0.5608727931976318}, "num_episodes": 24, "episode_return_max": 526.8752965931802, "episode_return_min": 411.3703727884907, "episode_return_mean": 464.2883219622048, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 193.16644746567962, "num_env_steps_trained_throughput_per_sec": 193.16644746567962, "timesteps_total": 5120, "num_env_steps_sampled_lifetime": 5120, "num_agent_steps_sampled_lifetime": 5120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 5120, "timers": {"training_iteration_time_ms": 5062.673, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5062.673, "sample_time_ms": 2132.174, "learn_time_ms": 2891.847, "learn_throughput": 354.099, "synch_weights_time_ms": 38.131}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 5120, "num_agent_steps_trained": 5120}, "done": false, "training_iteration": 5, "trial_id": "3bf18_00000", "date": "2025-04-08_23-16-56", "timestamp": 1744125416, "time_this_iter_s": 5.312957048416138, "time_total_s": 25.373823404312134, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51A80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.373823404312134, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 55.51666666666666, "ram_util_percent": 86.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0626967396587133, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 1e-07, "total_loss": 2.2107813097536564, "policy_loss": -0.000156551250256598, "vf_loss": 9.985987311601638, "vf_explained_var": 2.7567148208618164e-07, "kl": 7.998844432741125e-07, "entropy": 2.8555896773934366, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "env_runners": {"episode_reward_max": 526.8752965931802, "episode_reward_min": 411.3703727884907, "episode_reward_mean": 463.63049186128154, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.3703727884907}, "policy_reward_max": {"tplp_policy": 526.8752965931802}, "policy_reward_mean": {"tplp_policy": 463.63049186128154}, "custom_metrics": {"mean_episode_reward_mean": 463.63049186128154, "mean_episode_reward_min": 411.3703727884907, "mean_episode_reward_max": 526.8752965931802}, "hist_stats": {"episode_reward": [469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [469.05936732464374, 526.6198732830898, 526.8752965931802, 448.3840013066383, 422.3360894392676, 463.6179658527572, 473.6341528026387, 428.27316894101847, 431.46638136498353, 479.7427158910023, 429.02210748755255, 494.3540485927958, 465.444442222712, 471.21878726232995, 476.5185067703521, 485.18795583599683, 516.6518358285501, 494.0993119920712, 493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5673380194974258, "mean_inference_ms": 4.5800669089016175, "mean_action_processing_ms": 0.819839206272911, "mean_env_wait_ms": 4.453334290511779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025966882705688477, "StateBufferConnector_ms": 0.04053664207458496, "ViewRequirementAgentConnector_ms": 0.5443158149719238}, "num_episodes": 18, "episode_return_max": 526.8752965931802, "episode_return_min": 411.3703727884907, "episode_return_mean": 463.63049186128154, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 213.2482592578378, "num_env_steps_trained_throughput_per_sec": 213.2482592578378, "timesteps_total": 6144, "num_env_steps_sampled_lifetime": 6144, "num_agent_steps_sampled_lifetime": 6144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 6144, "timers": {"training_iteration_time_ms": 5019.213, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5019.213, "sample_time_ms": 2106.933, "learn_time_ms": 2874.71, "learn_throughput": 356.21, "synch_weights_time_ms": 37.137}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 6144, "num_agent_steps_trained": 6144}, "done": false, "training_iteration": 6, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-01", "timestamp": 1744125421, "time_this_iter_s": 4.8124308586120605, "time_total_s": 30.186254262924194, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C860>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.186254262924194, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 55.68571428571429, "ram_util_percent": 87.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.19494246058166, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 1e-07, "total_loss": 2.20971082597971, "policy_loss": -9.119936730712652e-05, "vf_loss": 9.9816519677639, "vf_explained_var": 1.214444637298584e-07, "kl": 9.577805416799424e-07, "entropy": 2.8561095386743545, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "env_runners": {"episode_reward_max": 523.0926023386652, "episode_reward_min": 411.3703727884907, "episode_reward_mean": 461.34082803532635, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.3703727884907}, "policy_reward_max": {"tplp_policy": 523.0926023386652}, "policy_reward_mean": {"tplp_policy": 461.34082803532635}, "custom_metrics": {"mean_episode_reward_mean": 461.34082803532635, "mean_episode_reward_min": 411.3703727884907, "mean_episode_reward_max": 523.0926023386652}, "hist_stats": {"episode_reward": [493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [493.0384421280139, 431.97494087595993, 417.00195407632435, 439.9934854933647, 457.8205745714833, 456.19596145552583, 460.3597753989302, 477.0746304287585, 431.4724868543571, 469.03611368101343, 523.0926023386652, 489.91036078145083, 465.72182773511514, 467.15673230243294, 450.09330398562184, 480.7144847169901, 477.14179281206793, 472.89832100884155, 488.894345811862, 458.53789591190707, 473.8748021418402, 437.4393360705126, 437.64876734165745, 432.82303041875076, 433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5850565359396744, "mean_inference_ms": 4.5685684961784085, "mean_action_processing_ms": 0.8226690102454293, "mean_env_wait_ms": 4.424705054636345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01746201515197754, "StateBufferConnector_ms": 0.03740262985229492, "ViewRequirementAgentConnector_ms": 0.48577117919921875}, "num_episodes": 18, "episode_return_max": 523.0926023386652, "episode_return_min": 411.3703727884907, "episode_return_mean": 461.34082803532635, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 228.17609442216502, "num_env_steps_trained_throughput_per_sec": 228.17609442216502, "timesteps_total": 7168, "num_env_steps_sampled_lifetime": 7168, "num_agent_steps_sampled_lifetime": 7168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 7168, "timers": {"training_iteration_time_ms": 4943.292, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4943.292, "sample_time_ms": 2064.056, "learn_time_ms": 2841.092, "learn_throughput": 360.425, "synch_weights_time_ms": 36.428}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 7168, "num_agent_steps_trained": 7168}, "done": false, "training_iteration": 7, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-06", "timestamp": 1744125426, "time_this_iter_s": 4.4988508224487305, "time_total_s": 34.685105085372925, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA53EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 34.685105085372925, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.92857142857143, "ram_util_percent": 87.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9567556500434877, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 1e-07, "total_loss": 2.209863393753767, "policy_loss": -0.0001074665691703558, "vf_loss": 9.982821351289749, "vf_explained_var": 8.046627044677735e-08, "kl": 1.0520706590355644e-06, "entropy": 2.857344700396061, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "env_runners": {"episode_reward_max": 550.8084548320728, "episode_reward_min": 411.3703727884907, "episode_reward_mean": 463.8792642816641, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.3703727884907}, "policy_reward_max": {"tplp_policy": 550.8084548320728}, "policy_reward_mean": {"tplp_policy": 463.8792642816641}, "custom_metrics": {"mean_episode_reward_mean": 463.8792642816641, "mean_episode_reward_min": 411.3703727884907, "mean_episode_reward_max": 550.8084548320728}, "hist_stats": {"episode_reward": [433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [433.465711158102, 463.3451420075473, 434.52323793331254, 459.80724597048135, 479.5974993273034, 471.3315217075979, 476.36504149919153, 458.5112267573248, 463.066917413768, 461.4646137258415, 458.8934915308266, 442.88583163688696, 446.39092988823086, 450.20379313580804, 460.5628610971554, 491.4092179307675, 462.4731933748026, 461.3238994136141, 450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5895781179903623, "mean_inference_ms": 4.608429073437325, "mean_action_processing_ms": 0.8332896944962093, "mean_env_wait_ms": 4.429491398917961, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015719175338745117, "StateBufferConnector_ms": 0.03706169128417969, "ViewRequirementAgentConnector_ms": 0.499265193939209}, "num_episodes": 24, "episode_return_max": 550.8084548320728, "episode_return_min": 411.3703727884907, "episode_return_mean": 463.8792642816641, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 195.45649592209568, "num_env_steps_trained_throughput_per_sec": 195.45649592209568, "timesteps_total": 8192, "num_env_steps_sampled_lifetime": 8192, "num_agent_steps_sampled_lifetime": 8192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 4980.258, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4980.258, "sample_time_ms": 2090.444, "learn_time_ms": 2851.564, "learn_throughput": 359.101, "synch_weights_time_ms": 36.749}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "training_iteration": 8, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-11", "timestamp": 1744125431, "time_this_iter_s": 5.252286911010742, "time_total_s": 39.93739199638367, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0D440>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.93739199638367, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.357142857142854, "ram_util_percent": 87.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7200135841965674, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 1e-07, "total_loss": 2.2140563681721686, "policy_loss": -2.1595280850306152e-05, "vf_loss": 10.0, "vf_explained_var": -8.866190910339356e-08, "kl": 1.0659528691725483e-06, "entropy": 2.8592202022671698, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "env_runners": {"episode_reward_max": 550.8084548320728, "episode_reward_min": 411.3703727884907, "episode_reward_mean": 465.32759979804337, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.3703727884907}, "policy_reward_max": {"tplp_policy": 550.8084548320728}, "policy_reward_mean": {"tplp_policy": 465.32759979804337}, "custom_metrics": {"mean_episode_reward_mean": 465.32759979804337, "mean_episode_reward_min": 411.3703727884907, "mean_episode_reward_max": 550.8084548320728}, "hist_stats": {"episode_reward": [450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.1644771884607, 488.2502894249576, 485.7435228578643, 467.9544469934723, 483.5598529425734, 446.0489752177408, 445.7590109943347, 411.3703727884907, 461.31876513827683, 458.2337231342121, 507.8947395050415, 440.59566014403293, 473.6508571518701, 423.0658078464961, 496.1648634309549, 514.1872282920144, 443.3403266416431, 461.1603174464735, 463.12870693830166, 465.78212741945765, 522.18835072476, 472.70793677385944, 447.35235240379063, 429.5610381257632, 482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.586088429515857, "mean_inference_ms": 4.6117171910211745, "mean_action_processing_ms": 0.8387676185881842, "mean_env_wait_ms": 4.431577856389179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217283248901367, "StateBufferConnector_ms": 0.029614686965942383, "ViewRequirementAgentConnector_ms": 0.47681212425231934}, "num_episodes": 18, "episode_return_max": 550.8084548320728, "episode_return_min": 411.3703727884907, "episode_return_mean": 465.32759979804337, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 207.81758596286275, "num_env_steps_trained_throughput_per_sec": 207.81758596286275, "timesteps_total": 9216, "num_env_steps_sampled_lifetime": 9216, "num_agent_steps_sampled_lifetime": 9216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 9216, "timers": {"training_iteration_time_ms": 4974.384, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4974.384, "sample_time_ms": 2071.91, "learn_time_ms": 2863.756, "learn_throughput": 357.572, "synch_weights_time_ms": 37.383}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 9216, "num_agent_steps_trained": 9216}, "done": false, "training_iteration": 9, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-16", "timestamp": 1744125436, "time_this_iter_s": 4.936541318893433, "time_total_s": 44.8739333152771, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0CC20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44.8739333152771, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 87.16666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.374587406218052, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 1e-07, "total_loss": 2.2137312814593315, "policy_loss": -0.000166600538068451, "vf_loss": 10.0, "vf_explained_var": -1.2367963790893556e-07, "kl": 1.4013555902359087e-06, "entropy": 2.86102109849453, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "env_runners": {"episode_reward_max": 550.8084548320728, "episode_reward_min": 406.3401657662601, "episode_reward_mean": 465.31711585152186, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.3401657662601}, "policy_reward_max": {"tplp_policy": 550.8084548320728}, "policy_reward_mean": {"tplp_policy": 465.31711585152186}, "custom_metrics": {"mean_episode_reward_mean": 465.31711585152186, "mean_episode_reward_min": 406.3401657662601, "mean_episode_reward_max": 550.8084548320728}, "hist_stats": {"episode_reward": [482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.8624580121566, 485.253440780598, 433.1342410596549, 464.22370711630913, 472.4657215250305, 449.7991707141588, 482.4535017723332, 420.4344162021312, 455.05420782588067, 435.98097441287814, 486.9876973566002, 507.3778971368415, 413.4647397975766, 448.78817732405423, 446.0640272851444, 451.47770564037796, 463.22042583525973, 465.44711911149153, 445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5664602455266459, "mean_inference_ms": 4.565949801293405, "mean_action_processing_ms": 0.8356320087272949, "mean_env_wait_ms": 4.39239987902598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009913206100463867, "StateBufferConnector_ms": 0.04749131202697754, "ViewRequirementAgentConnector_ms": 0.45993661880493164}, "num_episodes": 24, "episode_return_max": 550.8084548320728, "episode_return_min": 406.3401657662601, "episode_return_mean": 465.31711585152186, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 239.34548103095995, "num_env_steps_trained_throughput_per_sec": 239.34548103095995, "timesteps_total": 10240, "num_env_steps_sampled_lifetime": 10240, "num_agent_steps_sampled_lifetime": 10240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 10240, "timers": {"training_iteration_time_ms": 4904.779, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4904.779, "sample_time_ms": 2046.848, "learn_time_ms": 2819.694, "learn_throughput": 363.16, "synch_weights_time_ms": 37.037}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 10240, "num_agent_steps_trained": 10240}, "done": false, "training_iteration": 10, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-21", "timestamp": 1744125441, "time_this_iter_s": 4.289388179779053, "time_total_s": 49.16332149505615, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.16332149505615, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.36666666666667, "ram_util_percent": 87.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.361256455257535, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 1e-07, "total_loss": 2.2137722931802273, "policy_loss": -3.458104329183698e-05, "vf_loss": 10.0, "vf_explained_var": -1.2516975402832032e-07, "kl": 4.3598387615695345e-07, "entropy": 2.861931113898754, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "env_runners": {"episode_reward_max": 550.8084548320728, "episode_reward_min": 406.3401657662601, "episode_reward_mean": 465.08442439040283, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.3401657662601}, "policy_reward_max": {"tplp_policy": 550.8084548320728}, "policy_reward_mean": {"tplp_policy": 465.08442439040283}, "custom_metrics": {"mean_episode_reward_mean": 465.08442439040283, "mean_episode_reward_min": 406.3401657662601, "mean_episode_reward_max": 550.8084548320728}, "hist_stats": {"episode_reward": [445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [445.0615707064609, 481.55769799089256, 464.1249468824454, 474.43552653467947, 455.51062989853773, 474.59802739950453, 460.7508185819343, 453.3003186765537, 436.38772863773335, 412.13017353107773, 460.46306037686014, 466.55904672125376, 458.95678943053696, 457.6969132949924, 471.6563525703927, 471.68248001545487, 484.21448729596653, 475.08472246699876, 456.7961764647118, 447.14829649742506, 484.844276124925, 432.3079249398331, 441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5586763825194927, "mean_inference_ms": 4.55395617410063, "mean_action_processing_ms": 0.8350635846566926, "mean_env_wait_ms": 4.384758748680529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00624537467956543, "StateBufferConnector_ms": 0.0540769100189209, "ViewRequirementAgentConnector_ms": 0.4705829620361328}, "num_episodes": 18, "episode_return_max": 550.8084548320728, "episode_return_min": 406.3401657662601, "episode_return_mean": 465.08442439040283, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.5130836470672, "num_env_steps_trained_throughput_per_sec": 210.5130836470672, "timesteps_total": 11264, "num_env_steps_sampled_lifetime": 11264, "num_agent_steps_sampled_lifetime": 11264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 11264, "timers": {"training_iteration_time_ms": 4886.179, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4886.179, "sample_time_ms": 2047.198, "learn_time_ms": 2801.503, "learn_throughput": 365.518, "synch_weights_time_ms": 36.392}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 11264, "num_agent_steps_trained": 11264}, "done": false, "training_iteration": 11, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-26", "timestamp": 1744125446, "time_this_iter_s": 4.880213737487793, "time_total_s": 54.043535232543945, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.043535232543945, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 53.4, "ram_util_percent": 87.08333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8771161671727894, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 1e-07, "total_loss": 2.213701157271862, "policy_loss": -3.3276877366006376e-05, "vf_loss": 10.0, "vf_explained_var": -1.2218952178955077e-07, "kl": 5.185925997464036e-07, "entropy": 2.862655591964722, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "env_runners": {"episode_reward_max": 550.8084548320728, "episode_reward_min": 406.3401657662601, "episode_reward_mean": 465.6704236672296, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 406.3401657662601}, "policy_reward_max": {"tplp_policy": 550.8084548320728}, "policy_reward_mean": {"tplp_policy": 465.6704236672296}, "custom_metrics": {"mean_episode_reward_mean": 465.6704236672296, "mean_episode_reward_min": 406.3401657662601, "mean_episode_reward_max": 550.8084548320728}, "hist_stats": {"episode_reward": [441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [441.97999652877405, 499.01462462294785, 445.9117507289462, 494.4571248513074, 485.65388435754045, 457.4110687817915, 464.0303497122345, 463.4235225420855, 457.89298249056975, 511.95080260606824, 441.1293600062964, 477.7097553035622, 550.8084548320728, 452.4616186510907, 503.0365901187929, 470.9362341485651, 449.90280337281877, 495.6527855299004, 455.0045200289897, 433.3570206963934, 463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5533860455262865, "mean_inference_ms": 4.537772068822765, "mean_action_processing_ms": 0.8336826502493198, "mean_env_wait_ms": 4.366395329361407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009089469909667969, "StateBufferConnector_ms": 0.05187869071960449, "ViewRequirementAgentConnector_ms": 0.4653158187866211}, "num_episodes": 22, "episode_return_max": 550.8084548320728, "episode_return_min": 406.3401657662601, "episode_return_mean": 465.6704236672296, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 213.46154390181945, "num_env_steps_trained_throughput_per_sec": 213.46154390181945, "timesteps_total": 12288, "num_env_steps_sampled_lifetime": 12288, "num_agent_steps_sampled_lifetime": 12288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 12288, "timers": {"training_iteration_time_ms": 4844.233, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4844.233, "sample_time_ms": 2034.518, "learn_time_ms": 2771.758, "learn_throughput": 369.441, "synch_weights_time_ms": 36.872}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 12288, "num_agent_steps_trained": 12288}, "done": false, "training_iteration": 12, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-30", "timestamp": 1744125450, "time_this_iter_s": 4.8188557624816895, "time_total_s": 58.862390995025635, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA509A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.862390995025635, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 48.81428571428571, "ram_util_percent": 87.08571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.161757778376341, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 1e-07, "total_loss": 2.2132477663457393, "policy_loss": -9.871201473288238e-05, "vf_loss": 9.998776119947433, "vf_explained_var": -9.909272193908692e-08, "kl": 7.297288593388629e-07, "entropy": 2.863475562632084, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "env_runners": {"episode_reward_max": 533.9957090423303, "episode_reward_min": 384.5815595283792, "episode_reward_mean": 462.4347381487962, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 384.5815595283792}, "policy_reward_max": {"tplp_policy": 533.9957090423303}, "policy_reward_mean": {"tplp_policy": 462.4347381487962}, "custom_metrics": {"mean_episode_reward_mean": 462.4347381487962, "mean_episode_reward_min": 384.5815595283792, "mean_episode_reward_max": 533.9957090423303}, "hist_stats": {"episode_reward": [463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.3480777459358, 457.3430481297875, 455.42814072197393, 449.46714588000395, 466.5441769125734, 474.4340078341972, 499.366972419297, 500.1828331494422, 456.7378909289801, 454.8383265057847, 480.7706511856563, 456.42408569281577, 465.80368312342915, 471.9496910835632, 494.6390698084521, 484.8155852992163, 464.3715885538576, 440.2949167184899, 443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5421499893788484, "mean_inference_ms": 4.510083015446473, "mean_action_processing_ms": 0.8304859623541837, "mean_env_wait_ms": 4.351547342866367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01009225845336914, "StateBufferConnector_ms": 0.04324650764465332, "ViewRequirementAgentConnector_ms": 0.45746612548828125}, "num_episodes": 20, "episode_return_max": 533.9957090423303, "episode_return_min": 384.5815595283792, "episode_return_mean": 462.4347381487962, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 222.64710481393143, "num_env_steps_trained_throughput_per_sec": 222.64710481393143, "timesteps_total": 13312, "num_env_steps_sampled_lifetime": 13312, "num_agent_steps_sampled_lifetime": 13312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 13312, "timers": {"training_iteration_time_ms": 4824.34, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4824.34, "sample_time_ms": 2040.898, "learn_time_ms": 2747.285, "learn_throughput": 372.732, "synch_weights_time_ms": 35.216}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 13312, "num_agent_steps_trained": 13312}, "done": false, "training_iteration": 13, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-35", "timestamp": 1744125455, "time_this_iter_s": 4.6107177734375, "time_total_s": 63.473108768463135, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0D3A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.473108768463135, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 54.4, "ram_util_percent": 87.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9920185770839454, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 1e-07, "total_loss": 2.2134533531963827, "policy_loss": -0.00011388752027414739, "vf_loss": 10.0, "vf_explained_var": -3.4831464290618896e-07, "kl": 9.376156106744027e-07, "entropy": 2.8643276542425156, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "env_runners": {"episode_reward_max": 535.3673055382002, "episode_reward_min": 384.5815595283792, "episode_reward_mean": 461.3511914818828, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 384.5815595283792}, "policy_reward_max": {"tplp_policy": 535.3673055382002}, "policy_reward_mean": {"tplp_policy": 461.3511914818828}, "custom_metrics": {"mean_episode_reward_mean": 461.3511914818828, "mean_episode_reward_min": 384.5815595283792, "mean_episode_reward_max": 535.3673055382002}, "hist_stats": {"episode_reward": [443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [443.41106898350836, 445.26608330997476, 475.0165662524115, 469.04700829767336, 479.0349300392461, 503.6141138452199, 480.9398656449668, 515.1230310404565, 459.72097692968055, 454.1131964486254, 449.8791909277459, 471.04802417144174, 444.2425655302014, 441.960539083976, 482.831887605344, 461.24063342928724, 491.7202350934568, 406.3401657662601, 436.7629684254216, 466.89877319079363, 486.9710801646695, 488.28594541998115, 448.7034378040705, 465.9499688621614, 452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.534492014595776, "mean_inference_ms": 4.4859518766225275, "mean_action_processing_ms": 0.8257576814294404, "mean_env_wait_ms": 4.335443403974165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012092828750610352, "StateBufferConnector_ms": 0.04361295700073242, "ViewRequirementAgentConnector_ms": 0.4400358200073242}, "num_episodes": 18, "episode_return_max": 535.3673055382002, "episode_return_min": 384.5815595283792, "episode_return_mean": 461.3511914818828, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 244.7594185224169, "num_env_steps_trained_throughput_per_sec": 244.7594185224169, "timesteps_total": 14336, "num_env_steps_sampled_lifetime": 14336, "num_agent_steps_sampled_lifetime": 14336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 14336, "timers": {"training_iteration_time_ms": 4747.988, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4747.988, "sample_time_ms": 2004.595, "learn_time_ms": 2707.481, "learn_throughput": 378.211, "synch_weights_time_ms": 34.972}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 14336, "num_agent_steps_trained": 14336}, "done": false, "training_iteration": 14, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-40", "timestamp": 1744125460, "time_this_iter_s": 4.194550275802612, "time_total_s": 67.66765904426575, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0CC20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67.66765904426575, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 52.300000000000004, "ram_util_percent": 87.16666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0582310296595097, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 1e-07, "total_loss": 2.2111153922975064, "policy_loss": -0.00010885463561862707, "vf_loss": 9.991224437952042, "vf_explained_var": -2.3096799850463867e-07, "kl": 1.2677247631653898e-06, "entropy": 2.8658183738589287, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "env_runners": {"episode_reward_max": 535.3673055382002, "episode_reward_min": 384.5815595283792, "episode_reward_mean": 460.19035053855873, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 384.5815595283792}, "policy_reward_max": {"tplp_policy": 535.3673055382002}, "policy_reward_mean": {"tplp_policy": 460.19035053855873}, "custom_metrics": {"mean_episode_reward_mean": 460.19035053855873, "mean_episode_reward_min": 384.5815595283792, "mean_episode_reward_max": 535.3673055382002}, "hist_stats": {"episode_reward": [452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [452.0763749608907, 472.578133577503, 428.8639594838188, 466.57161294419683, 449.42115901019974, 445.19493579102095, 489.3799166775601, 438.44603630506407, 451.37766451613953, 463.0527690731867, 455.7525169909209, 472.0592008669307, 454.38059681391627, 482.36485254877454, 449.8497331759441, 455.19761339427976, 452.3603050925483, 444.52881172308724, 479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5300530424777643, "mean_inference_ms": 4.476069487607092, "mean_action_processing_ms": 0.8217790087037209, "mean_env_wait_ms": 4.325662006740625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188911437988281, "StateBufferConnector_ms": 0.018828868865966797, "ViewRequirementAgentConnector_ms": 0.43025875091552734}, "num_episodes": 24, "episode_return_max": 535.3673055382002, "episode_return_min": 384.5815595283792, "episode_return_mean": 460.19035053855873, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 190.6487177633091, "num_env_steps_trained_throughput_per_sec": 190.6487177633091, "timesteps_total": 15360, "num_env_steps_sampled_lifetime": 15360, "num_agent_steps_sampled_lifetime": 15360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 15360, "timers": {"training_iteration_time_ms": 4754.989, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4754.989, "sample_time_ms": 1977.213, "learn_time_ms": 2741.953, "learn_throughput": 373.456, "synch_weights_time_ms": 34.882}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 15360, "num_agent_steps_trained": 15360}, "done": false, "training_iteration": 15, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-45", "timestamp": 1744125465, "time_this_iter_s": 5.38540506362915, "time_total_s": 73.0530641078949, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.0530641078949, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 55.728571428571435, "ram_util_percent": 87.38571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8536756984889506, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 1e-07, "total_loss": 2.2108262300491335, "policy_loss": -5.0031300634145734e-05, "vf_loss": 9.990477246046066, "vf_explained_var": -5.982816219329834e-07, "kl": 7.807275545168579e-07, "entropy": 2.8674305781722067, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "env_runners": {"episode_reward_max": 535.3673055382002, "episode_reward_min": 384.5815595283792, "episode_reward_mean": 462.47090550895723, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 384.5815595283792}, "policy_reward_max": {"tplp_policy": 535.3673055382002}, "policy_reward_mean": {"tplp_policy": 462.47090550895723}, "custom_metrics": {"mean_episode_reward_mean": 462.47090550895723, "mean_episode_reward_min": 384.5815595283792, "mean_episode_reward_max": 535.3673055382002}, "hist_stats": {"episode_reward": [479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [479.96435071149637, 431.99527373054724, 477.50456854878746, 438.35588965190715, 470.0961669627086, 504.22910033338763, 451.76665060894896, 462.1181528269372, 483.5366137435942, 447.8835697745089, 468.9413160182386, 468.65289554543597, 477.3648332296031, 473.0249372340783, 458.1086726930409, 434.58181804907736, 451.33078833131054, 446.2392081368324, 533.9957090423303, 427.28826073343464, 459.4429441144228, 480.3618667392013, 474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5232725906310278, "mean_inference_ms": 4.462406307979482, "mean_action_processing_ms": 0.8196335103325058, "mean_env_wait_ms": 4.312711837929587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012688875198364258, "StateBufferConnector_ms": 0.011212825775146484, "ViewRequirementAgentConnector_ms": 0.43376612663269043}, "num_episodes": 18, "episode_return_max": 535.3673055382002, "episode_return_min": 384.5815595283792, "episode_return_mean": 462.47090550895723, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 221.5333440653602, "num_env_steps_trained_throughput_per_sec": 221.5333440653602, "timesteps_total": 16384, "num_env_steps_sampled_lifetime": 16384, "num_agent_steps_sampled_lifetime": 16384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 4737.031, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4737.031, "sample_time_ms": 1978.163, "learn_time_ms": 2721.496, "learn_throughput": 376.264, "synch_weights_time_ms": 36.431}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "training_iteration": 16, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-50", "timestamp": 1744125470, "time_this_iter_s": 4.6372387409210205, "time_total_s": 77.69030284881592, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA52980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.69030284881592, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 47.9, "ram_util_percent": 87.54285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0654440946877, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 1e-07, "total_loss": 2.2034569442272187, "policy_loss": -7.300617871806026e-05, "vf_loss": 9.961607950925828, "vf_explained_var": -4.723668098449707e-07, "kl": 8.486035596444452e-07, "entropy": 2.8687201365828514, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "env_runners": {"episode_reward_max": 535.3673055382002, "episode_reward_min": 384.5815595283792, "episode_reward_mean": 461.26877423669043, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 384.5815595283792}, "policy_reward_max": {"tplp_policy": 535.3673055382002}, "policy_reward_mean": {"tplp_policy": 461.26877423669043}, "custom_metrics": {"mean_episode_reward_mean": 461.26877423669043, "mean_episode_reward_min": 384.5815595283792, "mean_episode_reward_max": 535.3673055382002}, "hist_stats": {"episode_reward": [474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.1462837609378, 437.3800154857485, 507.7593377120053, 474.3326441338417, 436.35553133262243, 428.3794985637537, 423.90146758716713, 442.30760615796623, 384.5815595283792, 472.8616297979777, 491.244945805726, 466.58679986154624, 459.44993828233436, 460.4890950439524, 447.65766370525535, 462.5521299366206, 458.73850469859804, 459.62723581934796, 476.5566164617059, 439.13990748008223, 464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5187825341793733, "mean_inference_ms": 4.455214842040802, "mean_action_processing_ms": 0.8198713471314142, "mean_env_wait_ms": 4.313739578033998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008853912353515625, "StateBufferConnector_ms": 0.016495466232299805, "ViewRequirementAgentConnector_ms": 0.47281360626220703}, "num_episodes": 22, "episode_return_max": 535.3673055382002, "episode_return_min": 384.5815595283792, "episode_return_mean": 461.26877423669043, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.2725503813099, "num_env_steps_trained_throughput_per_sec": 217.2725503813099, "timesteps_total": 17408, "num_env_steps_sampled_lifetime": 17408, "num_agent_steps_sampled_lifetime": 17408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 17408, "timers": {"training_iteration_time_ms": 4759.552, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4759.552, "sample_time_ms": 2004.533, "learn_time_ms": 2718.371, "learn_throughput": 376.696, "synch_weights_time_ms": 36.641}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 17408, "num_agent_steps_trained": 17408}, "done": false, "training_iteration": 17, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-55", "timestamp": 1744125475, "time_this_iter_s": 4.721397161483765, "time_total_s": 82.41170001029968, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.41170001029968, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 61.31666666666667, "ram_util_percent": 87.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0689472280442716, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 1e-07, "total_loss": 2.212914824485779, "policy_loss": -7.513879099860788e-05, "vf_loss": 10.0, "vf_explained_var": -8.087605237960815e-07, "kl": 9.826771639520614e-07, "entropy": 2.8701002687215804, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "env_runners": {"episode_reward_max": 535.3673055382002, "episode_reward_min": 400.76809499846416, "episode_reward_mean": 463.22766125412295, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.76809499846416}, "policy_reward_max": {"tplp_policy": 535.3673055382002}, "policy_reward_mean": {"tplp_policy": 463.22766125412295}, "custom_metrics": {"mean_episode_reward_mean": 463.22766125412295, "mean_episode_reward_min": 400.76809499846416, "mean_episode_reward_max": 535.3673055382002}, "hist_stats": {"episode_reward": [464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.3984152928847, 480.9375279670972, 438.9517051756364, 438.46796246210835, 400.76809499846416, 454.23461525204493, 466.8097551122733, 466.52828028506815, 535.3673055382002, 488.8848102308142, 441.3161539121313, 489.644781929061, 454.7079607142011, 446.27639390166996, 490.68361102553126, 454.7313272631332, 442.03786145562736, 471.9645583934543, 404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5126135784498558, "mean_inference_ms": 4.443276276267425, "mean_action_processing_ms": 0.818036155944535, "mean_env_wait_ms": 4.304621771125522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012448787689208984, "StateBufferConnector_ms": 0.017967939376831055, "ViewRequirementAgentConnector_ms": 0.46807026863098145}, "num_episodes": 20, "episode_return_max": 535.3673055382002, "episode_return_min": 400.76809499846416, "episode_return_mean": 463.22766125412295, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 242.5270629229539, "num_env_steps_trained_throughput_per_sec": 242.5270629229539, "timesteps_total": 18432, "num_env_steps_sampled_lifetime": 18432, "num_agent_steps_sampled_lifetime": 18432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 18432, "timers": {"training_iteration_time_ms": 4657.871, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4657.871, "sample_time_ms": 1940.426, "learn_time_ms": 2679.934, "learn_throughput": 382.099, "synch_weights_time_ms": 37.505}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 18432, "num_agent_steps_trained": 18432}, "done": false, "training_iteration": 18, "trial_id": "3bf18_00000", "date": "2025-04-08_23-17-59", "timestamp": 1744125479, "time_this_iter_s": 4.250712871551514, "time_total_s": 86.6624128818512, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 86.6624128818512, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 50.400000000000006, "ram_util_percent": 87.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8990647993981837, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 1e-07, "total_loss": 2.2117059387266638, "policy_loss": -6.173297297209501e-05, "vf_loss": 9.995949840545654, "vf_explained_var": -5.241483449935913e-07, "kl": 1.4139090388276542e-06, "entropy": 2.872197814285755, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "env_runners": {"episode_reward_max": 521.4583850018715, "episode_reward_min": 404.4533451677691, "episode_reward_mean": 462.2790933011506, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 404.4533451677691}, "policy_reward_max": {"tplp_policy": 521.4583850018715}, "policy_reward_mean": {"tplp_policy": 462.2790933011506}, "custom_metrics": {"mean_episode_reward_mean": 462.2790933011506, "mean_episode_reward_min": 404.4533451677691, "mean_episode_reward_max": 521.4583850018715}, "hist_stats": {"episode_reward": [404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [404.4533451677691, 473.2921883559279, 470.1506362388122, 489.7753244665222, 473.79674798480545, 431.80205957476613, 496.7622698541092, 445.1576722005196, 445.54667498676525, 486.7898179007575, 454.3980169079105, 498.0876738583852, 451.80993758826486, 472.93540946455687, 475.4300036235817, 462.9346160830026, 446.9877220532309, 461.57788792516084, 448.28120349860177, 455.17685893770334, 456.8525840210186, 436.0370913929222, 485.2606909696829, 434.2228644986756, 483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.510060064511251, "mean_inference_ms": 4.441931204643965, "mean_action_processing_ms": 0.8183219873834751, "mean_env_wait_ms": 4.301545976298524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012972116470336914, "StateBufferConnector_ms": 0.015820026397705078, "ViewRequirementAgentConnector_ms": 0.4867990016937256}, "num_episodes": 18, "episode_return_max": 521.4583850018715, "episode_return_min": 404.4533451677691, "episode_return_mean": 462.2790933011506, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 190.41108607941166, "num_env_steps_trained_throughput_per_sec": 190.41108607941166, "timesteps_total": 19456, "num_env_steps_sampled_lifetime": 19456, "num_agent_steps_sampled_lifetime": 19456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 19456, "timers": {"training_iteration_time_ms": 4702.915, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4702.915, "sample_time_ms": 1962.294, "learn_time_ms": 2702.749, "learn_throughput": 378.874, "synch_weights_time_ms": 37.867}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 19456, "num_agent_steps_trained": 19456}, "done": false, "training_iteration": 19, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-04", "timestamp": 1744125484, "time_this_iter_s": 5.390399217605591, "time_total_s": 92.05281209945679, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C680>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.05281209945679, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 54.137499999999996, "ram_util_percent": 87.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.120021638274193, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 1e-07, "total_loss": 2.207841642946005, "policy_loss": -7.241331622935832e-05, "vf_loss": 9.981438130140305, "vf_explained_var": -1.5106052160263062e-06, "kl": 1.2839573368061964e-06, "entropy": 2.8744545608758925, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "env_runners": {"episode_reward_max": 528.6237978082501, "episode_reward_min": 409.0288894381254, "episode_reward_mean": 462.022649473172, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 409.0288894381254}, "policy_reward_max": {"tplp_policy": 528.6237978082501}, "policy_reward_mean": {"tplp_policy": 462.022649473172}, "custom_metrics": {"mean_episode_reward_mean": 462.022649473172, "mean_episode_reward_min": 409.0288894381254, "mean_episode_reward_max": 528.6237978082501}, "hist_stats": {"episode_reward": [483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.54151245118294, 457.4316356531484, 453.4725662319732, 463.0729673041624, 498.84155569604235, 481.3432012432702, 502.6697654288283, 463.033584097914, 493.45651773120716, 491.30715023942685, 439.6165495665289, 509.38760904912067, 479.9646177297664, 459.1150866546752, 416.75722213250344, 439.01659330772094, 476.79102419330087, 459.9524422256869, 473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5050404981250705, "mean_inference_ms": 4.435126307652333, "mean_action_processing_ms": 0.8174398814289782, "mean_env_wait_ms": 4.298597188294582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016335487365722656, "StateBufferConnector_ms": 0.016950607299804688, "ViewRequirementAgentConnector_ms": 0.5062661170959473}, "num_episodes": 24, "episode_return_max": 528.6237978082501, "episode_return_min": 409.0288894381254, "episode_return_mean": 462.022649473172, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 211.613428247893, "num_env_steps_trained_throughput_per_sec": 211.613428247893, "timesteps_total": 20480, "num_env_steps_sampled_lifetime": 20480, "num_agent_steps_sampled_lifetime": 20480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 20480, "timers": {"training_iteration_time_ms": 4758.983, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4758.881, "sample_time_ms": 1994.157, "learn_time_ms": 2727.178, "learn_throughput": 375.48, "synch_weights_time_ms": 37.54}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 20480, "num_agent_steps_trained": 20480}, "done": false, "training_iteration": 20, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-09", "timestamp": 1744125489, "time_this_iter_s": 4.852028131484985, "time_total_s": 96.90484023094177, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.90484023094177, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.36666666666665, "ram_util_percent": 87.88333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.793291363492608, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 1e-07, "total_loss": 2.2088746026158335, "policy_loss": -4.195081419311464e-05, "vf_loss": 9.986179894208908, "vf_explained_var": -1.3828277587890625e-06, "kl": 9.261313452579856e-07, "entropy": 2.8762841001152992, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "env_runners": {"episode_reward_max": 574.2458409959471, "episode_reward_min": 409.0288894381254, "episode_reward_mean": 462.55289367311497, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 409.0288894381254}, "policy_reward_max": {"tplp_policy": 574.2458409959471}, "policy_reward_mean": {"tplp_policy": 462.55289367311497}, "custom_metrics": {"mean_episode_reward_mean": 462.55289367311497, "mean_episode_reward_min": 409.0288894381254, "mean_episode_reward_max": 574.2458409959471}, "hist_stats": {"episode_reward": [473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.27708678961613, 428.03794049223495, 447.0710528616956, 472.05197229537816, 468.46064773952764, 475.7279913417063, 485.63210339941014, 415.87557668587544, 476.19436215600973, 426.7077712939682, 465.6897636378144, 472.0203929544982, 457.3852133375762, 448.2226535452699, 473.5356229674212, 429.32498892184736, 414.4532701195317, 439.54365014344194, 506.54529722991117, 494.06963520141767, 462.875557267557, 431.3818929979255, 476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.501957583285912, "mean_inference_ms": 4.43098605435492, "mean_action_processing_ms": 0.8167522851749647, "mean_env_wait_ms": 4.2943127794719205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01860666275024414, "StateBufferConnector_ms": 0.021300554275512695, "ViewRequirementAgentConnector_ms": 0.5394699573516846}, "num_episodes": 18, "episode_return_max": 574.2458409959471, "episode_return_min": 409.0288894381254, "episode_return_mean": 462.55289367311497, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504, "num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 197.05070862176592, "num_env_steps_trained_throughput_per_sec": 197.05070862176592, "timesteps_total": 21504, "num_env_steps_sampled_lifetime": 21504, "num_agent_steps_sampled_lifetime": 21504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 21504, "timers": {"training_iteration_time_ms": 4792.215, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4792.113, "sample_time_ms": 1956.8, "learn_time_ms": 2797.601, "learn_throughput": 366.028, "synch_weights_time_ms": 37.707}, "counters": {"num_env_steps_sampled": 21504, "num_env_steps_trained": 21504, "num_agent_steps_sampled": 21504, "num_agent_steps_trained": 21504}, "done": false, "training_iteration": 21, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-15", "timestamp": 1744125495, "time_this_iter_s": 5.207513093948364, "time_total_s": 102.11235332489014, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EFC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.11235332489014, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 57.737500000000004, "ram_util_percent": 87.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.064869073033333, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 1e-07, "total_loss": 2.2093531377613544, "policy_loss": -6.598652107641101e-05, "vf_loss": 9.988927865028382, "vf_explained_var": -1.2952834367752075e-06, "kl": 1.2153525587255133e-06, "entropy": 2.8781282559037207, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "env_runners": {"episode_reward_max": 574.2458409959471, "episode_reward_min": 408.9760517711921, "episode_reward_mean": 462.69791337971503, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 408.9760517711921}, "policy_reward_max": {"tplp_policy": 574.2458409959471}, "policy_reward_mean": {"tplp_policy": 462.69791337971503}, "custom_metrics": {"mean_episode_reward_mean": 462.69791337971503, "mean_episode_reward_min": 408.9760517711921, "mean_episode_reward_max": 574.2458409959471}, "hist_stats": {"episode_reward": [476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [476.6569204874721, 462.4806156102689, 467.77006582253307, 460.76945723434693, 496.7268158045031, 513.2977446707582, 469.21229375216785, 457.53974744912205, 521.4583850018715, 443.6776020983001, 469.70392000821727, 445.87530151923966, 410.3961027611868, 471.7366793322668, 459.0811696922495, 430.73139264967097, 507.0767422415496, 441.48870649762114, 468.60229399623347, 453.37391656586084, 445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4975647432575254, "mean_inference_ms": 4.423994287888438, "mean_action_processing_ms": 0.8154948778087291, "mean_env_wait_ms": 4.286458095735884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020540237426757812, "StateBufferConnector_ms": 0.020830869674682617, "ViewRequirementAgentConnector_ms": 0.5098550319671631}, "num_episodes": 22, "episode_return_max": 574.2458409959471, "episode_return_min": 408.9760517711921, "episode_return_mean": 462.69791337971503, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528, "num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 215.3181612501162, "num_env_steps_trained_throughput_per_sec": 215.3181612501162, "timesteps_total": 22528, "num_env_steps_sampled_lifetime": 22528, "num_agent_steps_sampled_lifetime": 22528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 22528, "timers": {"training_iteration_time_ms": 4788.079, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4787.977, "sample_time_ms": 1978.219, "learn_time_ms": 2772.269, "learn_throughput": 369.373, "synch_weights_time_ms": 37.484}, "counters": {"num_env_steps_sampled": 22528, "num_env_steps_trained": 22528, "num_agent_steps_sampled": 22528, "num_agent_steps_trained": 22528}, "done": false, "training_iteration": 22, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-20", "timestamp": 1744125500, "time_this_iter_s": 4.7669758796691895, "time_total_s": 106.87932920455933, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA52980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.87932920455933, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 54.08571428571428, "ram_util_percent": 87.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.990496622771025, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 1e-07, "total_loss": 2.2049088194966315, "policy_loss": -0.00010080887004733085, "vf_loss": 9.971780049800874, "vf_explained_var": -1.9550323486328123e-06, "kl": 6.244926207266133e-07, "entropy": 2.879353941977024, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "env_runners": {"episode_reward_max": 574.2458409959471, "episode_reward_min": 403.0178263462989, "episode_reward_mean": 462.41051003494175, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0178263462989}, "policy_reward_max": {"tplp_policy": 574.2458409959471}, "policy_reward_mean": {"tplp_policy": 462.41051003494175}, "custom_metrics": {"mean_episode_reward_mean": 462.41051003494175, "mean_episode_reward_min": 403.0178263462989, "mean_episode_reward_max": 574.2458409959471}, "hist_stats": {"episode_reward": [445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [445.27925991003497, 446.9358171258448, 445.9099186371537, 416.8323828828791, 496.77648663355325, 443.7259949907221, 464.9809457742564, 489.3054891231171, 480.53886202677245, 436.8870950274782, 448.7766695815773, 444.15289081589873, 463.76995482747583, 443.2811578431992, 444.2751298055505, 498.4500600445636, 444.9428351126805, 472.8491389057432, 450.71252143482985, 447.1247223086485, 423.3860551141301, 492.5099473820703, 483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4947784094803813, "mean_inference_ms": 4.42375965583536, "mean_action_processing_ms": 0.8152362034596038, "mean_env_wait_ms": 4.2831419149288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01895308494567871, "StateBufferConnector_ms": 0.02070021629333496, "ViewRequirementAgentConnector_ms": 0.5038561820983887}, "num_episodes": 20, "episode_return_max": 574.2458409959471, "episode_return_min": 403.0178263462989, "episode_return_mean": 462.41051003494175, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552, "num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 239.63610832013975, "num_env_steps_trained_throughput_per_sec": 239.63610832013975, "timesteps_total": 23552, "num_env_steps_sampled_lifetime": 23552, "num_agent_steps_sampled_lifetime": 23552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 23552, "timers": {"training_iteration_time_ms": 4755.473, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4755.371, "sample_time_ms": 1967.146, "learn_time_ms": 2750.624, "learn_throughput": 372.279, "synch_weights_time_ms": 37.595}, "counters": {"num_env_steps_sampled": 23552, "num_env_steps_trained": 23552, "num_agent_steps_sampled": 23552, "num_agent_steps_trained": 23552}, "done": false, "training_iteration": 23, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-24", "timestamp": 1744125504, "time_this_iter_s": 4.284518241882324, "time_total_s": 111.16384744644165, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.16384744644165, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.93333333333334, "ram_util_percent": 87.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.831255954876542, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 1e-07, "total_loss": 2.2028997376561166, "policy_loss": 1.4599453425034881e-05, "vf_loss": 9.963537216186523, "vf_explained_var": -7.722526788711548e-07, "kl": 3.1461282323369534e-07, "entropy": 2.8799916818737983, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "env_runners": {"episode_reward_max": 574.2458409959471, "episode_reward_min": 403.0178263462989, "episode_reward_mean": 463.659411152895, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0178263462989}, "policy_reward_max": {"tplp_policy": 574.2458409959471}, "policy_reward_mean": {"tplp_policy": 463.659411152895}, "custom_metrics": {"mean_episode_reward_mean": 463.659411152895, "mean_episode_reward_min": 403.0178263462989, "mean_episode_reward_max": 574.2458409959471}, "hist_stats": {"episode_reward": [483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.82445918190285, 462.0202962589334, 431.9153281620745, 451.34796433415585, 477.931645781854, 494.39988552009214, 466.10983459748763, 503.66912518941814, 459.461407034622, 528.6237978082501, 409.0288894381254, 473.2472939131854, 414.23249459817094, 448.4884966592369, 475.74201693282066, 437.24838416175743, 436.00152199448604, 447.05685293091767, 419.4569741239907, 530.2587795298213, 503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4913638335490744, "mean_inference_ms": 4.416851348778584, "mean_action_processing_ms": 0.8147398594815719, "mean_env_wait_ms": 4.277190493119931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019713401794433594, "StateBufferConnector_ms": 0.022789478302001953, "ViewRequirementAgentConnector_ms": 0.4882631301879883}, "num_episodes": 22, "episode_return_max": 574.2458409959471, "episode_return_min": 403.0178263462989, "episode_return_mean": 463.659411152895, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 245.29371138664933, "num_env_steps_trained_throughput_per_sec": 245.29371138664933, "timesteps_total": 24576, "num_env_steps_sampled_lifetime": 24576, "num_agent_steps_sampled_lifetime": 24576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 4754.562, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4754.459, "sample_time_ms": 1982.93, "learn_time_ms": 2734.316, "learn_throughput": 374.5, "synch_weights_time_ms": 37.207}, "counters": {"num_env_steps_sampled": 24576, "num_env_steps_trained": 24576, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "training_iteration": 24, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-28", "timestamp": 1744125508, "time_this_iter_s": 4.186385631561279, "time_total_s": 115.35023307800293, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA509A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.35023307800293, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.720000000000006, "ram_util_percent": 87.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.285133931785822, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 1e-07, "total_loss": 2.2093584656715395, "policy_loss": -0.00014970084885135293, "vf_loss": 9.990836185216903, "vf_explained_var": -1.792237162590027e-06, "kl": 2.2584511307321973e-06, "entropy": 2.882008804380894, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "env_runners": {"episode_reward_max": 574.2458409959471, "episode_reward_min": 403.0178263462989, "episode_reward_mean": 464.00044342522955, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0178263462989}, "policy_reward_max": {"tplp_policy": 574.2458409959471}, "policy_reward_mean": {"tplp_policy": 464.00044342522955}, "custom_metrics": {"mean_episode_reward_mean": 464.00044342522955, "mean_episode_reward_min": 403.0178263462989, "mean_episode_reward_max": 574.2458409959471}, "hist_stats": {"episode_reward": [503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [503.9345968094305, 470.4253154730527, 436.72502671865203, 464.5364872433745, 574.2458409959471, 473.9776446204236, 428.7298021541685, 431.45895778574913, 474.8129457072414, 493.9629822052061, 459.0891026095918, 484.4124459911705, 471.4343938809375, 463.53096723861864, 473.197694802442, 467.6060630409344, 461.61737679157835, 457.7615229056969, 460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4856308355438501, "mean_inference_ms": 4.409986824233332, "mean_action_processing_ms": 0.8137777475906834, "mean_env_wait_ms": 4.272598676604787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017037153244018555, "StateBufferConnector_ms": 0.018918514251708984, "ViewRequirementAgentConnector_ms": 0.44516873359680176}, "num_episodes": 20, "episode_return_max": 574.2458409959471, "episode_return_min": 403.0178263462989, "episode_return_mean": 464.00044342522955, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600, "num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 230.56002118913727, "num_env_steps_trained_throughput_per_sec": 230.56002118913727, "timesteps_total": 25600, "num_env_steps_sampled_lifetime": 25600, "num_agent_steps_sampled_lifetime": 25600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 25600, "timers": {"training_iteration_time_ms": 4661.584, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4661.482, "sample_time_ms": 1962.203, "learn_time_ms": 2662.231, "learn_throughput": 384.64, "synch_weights_time_ms": 37.043}, "counters": {"num_env_steps_sampled": 25600, "num_env_steps_trained": 25600, "num_agent_steps_sampled": 25600, "num_agent_steps_trained": 25600}, "done": false, "training_iteration": 25, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-33", "timestamp": 1744125513, "time_this_iter_s": 4.455755233764648, "time_total_s": 119.80598831176758, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EB60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.80598831176758, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 48.883333333333326, "ram_util_percent": 87.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8082941945642235, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 1e-07, "total_loss": 2.2115252085030077, "policy_loss": -3.489855444058776e-05, "vf_loss": 10.0, "vf_explained_var": -1.255422830581665e-06, "kl": 8.960748467679025e-07, "entropy": 2.884398876130581, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "env_runners": {"episode_reward_max": 520.4092420863775, "episode_reward_min": 403.0178263462989, "episode_reward_mean": 461.65285431414645, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0178263462989}, "policy_reward_max": {"tplp_policy": 520.4092420863775}, "policy_reward_mean": {"tplp_policy": 461.65285431414645}, "custom_metrics": {"mean_episode_reward_mean": 461.65285431414645, "mean_episode_reward_min": 403.0178263462989, "mean_episode_reward_max": 520.4092420863775}, "hist_stats": {"episode_reward": [460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [460.25609481487027, 452.24574819306923, 451.7379589102119, 420.69968544651556, 439.9090154886775, 485.98661324829743, 466.9063925211284, 472.73063319417656, 481.92277828831084, 421.5967254983094, 463.2679673638217, 454.96888012248667, 408.9760517711921, 443.33274697606436, 454.6272346702228, 436.3305360643586, 506.842204041744, 492.65722452919664, 483.0814147297922, 461.1316084699247, 494.1344618924903, 491.99512489847916, 452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4816833026009504, "mean_inference_ms": 4.407229525565956, "mean_action_processing_ms": 0.8131339973152385, "mean_env_wait_ms": 4.269388956707413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012407541275024414, "StateBufferConnector_ms": 0.02289748191833496, "ViewRequirementAgentConnector_ms": 0.4152700901031494}, "num_episodes": 18, "episode_return_max": 520.4092420863775, "episode_return_min": 403.0178263462989, "episode_return_mean": 461.65285431414645, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624, "num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 219.04983546656516, "num_env_steps_trained_throughput_per_sec": 219.04983546656516, "timesteps_total": 26624, "num_env_steps_sampled_lifetime": 26624, "num_agent_steps_sampled_lifetime": 26624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 26624, "timers": {"training_iteration_time_ms": 4666.825, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4666.722, "sample_time_ms": 1968.214, "learn_time_ms": 2662.88, "learn_throughput": 384.546, "synch_weights_time_ms": 35.623}, "counters": {"num_env_steps_sampled": 26624, "num_env_steps_trained": 26624, "num_agent_steps_sampled": 26624, "num_agent_steps_trained": 26624}, "done": false, "training_iteration": 26, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-38", "timestamp": 1744125518, "time_this_iter_s": 4.689320087432861, "time_total_s": 124.49530839920044, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0CAE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.49530839920044, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 52.771428571428565, "ram_util_percent": 87.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0869687288999557, "cur_kl_coeff": 2.980232238769531e-09, "cur_lr": 1e-07, "total_loss": 2.2089458130300046, "policy_loss": -7.391957333311439e-05, "vf_loss": 9.990475541353225, "vf_explained_var": -1.5236437320709229e-06, "kl": 1.1028246398314678e-06, "entropy": 2.885991396009922, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "env_runners": {"episode_reward_max": 520.4092420863775, "episode_reward_min": 403.0178263462989, "episode_reward_mean": 463.1362681782365, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0178263462989}, "policy_reward_max": {"tplp_policy": 520.4092420863775}, "policy_reward_mean": {"tplp_policy": 463.1362681782365}, "custom_metrics": {"mean_episode_reward_mean": 463.1362681782365, "mean_episode_reward_min": 403.0178263462989, "mean_episode_reward_max": 520.4092420863775}, "hist_stats": {"episode_reward": [452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [452.4469133516201, 484.04261037782567, 445.1072881080882, 479.7653112906939, 466.711176302504, 403.0178263462989, 469.7979054248537, 411.3614886752978, 435.73255919858804, 490.29203406936665, 477.01659523303357, 442.0245104325922, 462.9477909627701, 475.4016178782585, 473.96040129629665, 482.4793137887879, 451.671839534602, 509.00876965565936, 482.19890556385457, 488.07196653106706, 450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4762359226668271, "mean_inference_ms": 4.4017054132540085, "mean_action_processing_ms": 0.8117197004067019, "mean_env_wait_ms": 4.263305464878645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014009952545166016, "StateBufferConnector_ms": 0.018386125564575195, "ViewRequirementAgentConnector_ms": 0.3959801197052002}, "num_episodes": 22, "episode_return_max": 520.4092420863775, "episode_return_min": 403.0178263462989, "episode_return_mean": 463.1362681782365, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648, "num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 227.30146314986553, "num_env_steps_trained_throughput_per_sec": 227.30146314986553, "timesteps_total": 27648, "num_env_steps_sampled_lifetime": 27648, "num_agent_steps_sampled_lifetime": 27648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 27648, "timers": {"training_iteration_time_ms": 4646.03, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4645.928, "sample_time_ms": 1937.306, "learn_time_ms": 2673.033, "learn_throughput": 383.085, "synch_weights_time_ms": 35.589}, "counters": {"num_env_steps_sampled": 27648, "num_env_steps_trained": 27648, "num_agent_steps_sampled": 27648, "num_agent_steps_trained": 27648}, "done": false, "training_iteration": 27, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-42", "timestamp": 1744125522, "time_this_iter_s": 4.515178918838501, "time_total_s": 129.01048731803894, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.01048731803894, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 55.583333333333336, "ram_util_percent": 87.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0496994398534296, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 1e-07, "total_loss": 2.2040030635893344, "policy_loss": -0.0001522775157354772, "vf_loss": 9.971441066265106, "vf_explained_var": -1.3075768947601318e-06, "kl": 1.0629897853720039e-06, "entropy": 2.887049174308777, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "env_runners": {"episode_reward_max": 520.4092420863775, "episode_reward_min": 407.4664919682182, "episode_reward_mean": 461.3174352523258, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 407.4664919682182}, "policy_reward_max": {"tplp_policy": 520.4092420863775}, "policy_reward_mean": {"tplp_policy": 461.3174352523258}, "custom_metrics": {"mean_episode_reward_mean": 461.3174352523258, "mean_episode_reward_min": 407.4664919682182, "mean_episode_reward_max": 520.4092420863775}, "hist_stats": {"episode_reward": [450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.46217990762875, 409.99104016469244, 466.91086004755925, 448.2254036883875, 454.49407956130966, 467.39869572991097, 462.25566843160925, 434.160238177847, 477.9182301030816, 480.30236316943274, 464.4018736238063, 442.7356733237487, 412.81297070603944, 473.2420935300637, 492.62460042345134, 471.40081077526366, 482.8946475555196, 469.42344269505537, 463.5960257964265, 470.7716775977526, 447.4550060418089, 498.2775370419545, 448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4761282538099305, "mean_inference_ms": 4.402649307204445, "mean_action_processing_ms": 0.8119088255615381, "mean_env_wait_ms": 4.2626837619603215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0195920467376709, "StateBufferConnector_ms": 0.018659591674804688, "ViewRequirementAgentConnector_ms": 0.42780303955078125}, "num_episodes": 20, "episode_return_max": 520.4092420863775, "episode_return_min": 407.4664919682182, "episode_return_mean": 461.3174352523258, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672, "num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 206.14501593952278, "num_env_steps_trained_throughput_per_sec": 206.14501593952278, "timesteps_total": 28672, "num_env_steps_sampled_lifetime": 28672, "num_agent_steps_sampled_lifetime": 28672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 28672, "timers": {"training_iteration_time_ms": 4720.547, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4720.445, "sample_time_ms": 1988.633, "learn_time_ms": 2696.855, "learn_throughput": 379.702, "synch_weights_time_ms": 34.956}, "counters": {"num_env_steps_sampled": 28672, "num_env_steps_trained": 28672, "num_agent_steps_sampled": 28672, "num_agent_steps_trained": 28672}, "done": false, "training_iteration": 28, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-47", "timestamp": 1744125527, "time_this_iter_s": 4.980241775512695, "time_total_s": 133.99072909355164, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F9C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.99072909355164, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 54.971428571428575, "ram_util_percent": 87.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8813615780323745, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 1e-07, "total_loss": 2.2087703086435795, "policy_loss": -7.122548995539547e-05, "vf_loss": 9.99048609137535, "vf_explained_var": -1.2274831533432007e-06, "kl": 9.725709664509808e-07, "entropy": 2.8877999246120454, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "env_runners": {"episode_reward_max": 520.4092420863775, "episode_reward_min": 407.4664919682182, "episode_reward_mean": 463.71622880524745, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 407.4664919682182}, "policy_reward_max": {"tplp_policy": 520.4092420863775}, "policy_reward_mean": {"tplp_policy": 463.71622880524745}, "custom_metrics": {"mean_episode_reward_mean": 463.71622880524745, "mean_episode_reward_min": 407.4664919682182, "mean_episode_reward_max": 520.4092420863775}, "hist_stats": {"episode_reward": [448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [448.25868046569013, 460.1229772814363, 478.43768328763053, 454.9540154724547, 460.9168109285868, 453.01494211649015, 441.6387829380486, 488.8141986103106, 461.8145320232432, 475.96676494290716, 478.8905310216577, 453.2696546323457, 520.4092420863775, 465.5310229368961, 450.2134281335468, 436.7798022841954, 436.47335159396874, 472.92971154520944, 474.329025385543, 468.4085611742373, 513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.476653937716824, "mean_inference_ms": 4.40642954633299, "mean_action_processing_ms": 0.8117564989538935, "mean_env_wait_ms": 4.262308425517159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029666662216186523, "StateBufferConnector_ms": 0.022241592407226562, "ViewRequirementAgentConnector_ms": 0.4914567470550537}, "num_episodes": 22, "episode_return_max": 520.4092420863775, "episode_return_min": 407.4664919682182, "episode_return_mean": 463.71622880524745, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696, "num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 209.05271317686078, "num_env_steps_trained_throughput_per_sec": 209.05271317686078, "timesteps_total": 29696, "num_env_steps_sampled_lifetime": 29696, "num_agent_steps_sampled_lifetime": 29696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 29696, "timers": {"training_iteration_time_ms": 4672.592, "restore_workers_time_ms": 0.102, "training_step_time_ms": 4672.49, "sample_time_ms": 1985.441, "learn_time_ms": 2653.0, "learn_throughput": 385.978, "synch_weights_time_ms": 33.996}, "counters": {"num_env_steps_sampled": 29696, "num_env_steps_trained": 29696, "num_agent_steps_sampled": 29696, "num_agent_steps_trained": 29696}, "done": false, "training_iteration": 29, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-52", "timestamp": 1744125532, "time_this_iter_s": 4.911417722702026, "time_total_s": 138.90214681625366, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EF20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 138.90214681625366, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 54.442857142857136, "ram_util_percent": 87.62857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.104081251099706, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 1e-07, "total_loss": 2.2100267991423608, "policy_loss": -4.8622378380969165e-05, "vf_loss": 9.995971953868866, "vf_explained_var": -1.9934028387069703e-06, "kl": 7.026872121507211e-07, "entropy": 2.8891755402088166, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "env_runners": {"episode_reward_max": 522.6070239157208, "episode_reward_min": 390.4105341130374, "episode_reward_mean": 463.0147743514733, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 390.4105341130374}, "policy_reward_max": {"tplp_policy": 522.6070239157208}, "policy_reward_mean": {"tplp_policy": 463.0147743514733}, "custom_metrics": {"mean_episode_reward_mean": 463.0147743514733, "mean_episode_reward_min": 390.4105341130374, "mean_episode_reward_max": 522.6070239157208}, "hist_stats": {"episode_reward": [513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [513.8430220692148, 457.62658260458875, 438.5383087820836, 462.5446697196576, 478.0877275984553, 445.615892287579, 435.0442956143076, 494.1106939513833, 436.7238452877803, 433.4457145945976, 448.2322068819447, 461.43428971064844, 486.1372039316171, 431.5887776853929, 446.24565612490613, 444.74378246196466, 444.25870346330754, 444.206414395315, 480.94053488067703, 471.42294259186144, 448.54898646008655, 455.7597317703863, 437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4778884926625901, "mean_inference_ms": 4.408729148121841, "mean_action_processing_ms": 0.8115865781762293, "mean_env_wait_ms": 4.260100973980153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02966761589050293, "StateBufferConnector_ms": 0.02700352668762207, "ViewRequirementAgentConnector_ms": 0.5481307506561279}, "num_episodes": 20, "episode_return_max": 522.6070239157208, "episode_return_min": 390.4105341130374, "episode_return_mean": 463.0147743514733, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720, "num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 226.8787311006465, "num_env_steps_trained_throughput_per_sec": 226.8787311006465, "timesteps_total": 30720, "num_env_steps_sampled_lifetime": 30720, "num_agent_steps_sampled_lifetime": 30720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 30720, "timers": {"training_iteration_time_ms": 4640.033, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4640.033, "sample_time_ms": 1952.056, "learn_time_ms": 2653.032, "learn_throughput": 385.974, "synch_weights_time_ms": 34.893}, "counters": {"num_env_steps_sampled": 30720, "num_env_steps_trained": 30720, "num_agent_steps_sampled": 30720, "num_agent_steps_trained": 30720}, "done": false, "training_iteration": 30, "trial_id": "3bf18_00000", "date": "2025-04-08_23-18-57", "timestamp": 1744125537, "time_this_iter_s": 4.530765056610107, "time_total_s": 143.43291187286377, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.43291187286377, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 51.1, "ram_util_percent": 87.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9403314389288426, "cur_kl_coeff": 1.862645149230957e-10, "cur_lr": 1e-07, "total_loss": 2.2061321452260017, "policy_loss": -8.476970251649618e-05, "vf_loss": 9.980935823917388, "vf_explained_var": -1.6704201698303222e-06, "kl": 7.873769913402385e-07, "entropy": 2.890170179307461, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "env_runners": {"episode_reward_max": 522.6070239157208, "episode_reward_min": 390.4105341130374, "episode_reward_mean": 465.01807363397086, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 390.4105341130374}, "policy_reward_max": {"tplp_policy": 522.6070239157208}, "policy_reward_mean": {"tplp_policy": 465.01807363397086}, "custom_metrics": {"mean_episode_reward_mean": 465.01807363397086, "mean_episode_reward_min": 390.4105341130374, "mean_episode_reward_max": 522.6070239157208}, "hist_stats": {"episode_reward": [437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [437.52125831194854, 474.4207274498396, 497.6239205952319, 483.0753683956194, 506.9802550708476, 467.1239515054925, 445.6546772236855, 489.97914913609685, 506.4826469977493, 474.86584781773354, 463.94995939210685, 407.640238612124, 477.6261760584994, 450.25475545335223, 496.6172276645581, 468.7250142958292, 430.54323104951123, 452.02403193556637, 440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4820982833545195, "mean_inference_ms": 4.417336045010753, "mean_action_processing_ms": 0.8129463985233688, "mean_env_wait_ms": 4.263040915345507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033687591552734375, "StateBufferConnector_ms": 0.0182037353515625, "ViewRequirementAgentConnector_ms": 0.5663011074066162}, "num_episodes": 22, "episode_return_max": 522.6070239157208, "episode_return_min": 390.4105341130374, "episode_return_mean": 465.01807363397086, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744, "num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 192.40467019639715, "num_env_steps_trained_throughput_per_sec": 192.40467019639715, "timesteps_total": 31744, "num_env_steps_sampled_lifetime": 31744, "num_agent_steps_sampled_lifetime": 31744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 31744, "timers": {"training_iteration_time_ms": 4652.582, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4652.582, "sample_time_ms": 2022.818, "learn_time_ms": 2594.899, "learn_throughput": 394.62, "synch_weights_time_ms": 34.812}, "counters": {"num_env_steps_sampled": 31744, "num_env_steps_trained": 31744, "num_agent_steps_sampled": 31744, "num_agent_steps_trained": 31744}, "done": false, "training_iteration": 31, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-02", "timestamp": 1744125542, "time_this_iter_s": 5.339792966842651, "time_total_s": 148.77270483970642, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EF20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 148.77270483970642, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 56.557142857142864, "ram_util_percent": 87.65714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.933436119928956, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 1e-07, "total_loss": 2.2085068076848984, "policy_loss": -0.00011136066168546677, "vf_loss": 9.99132684469223, "vf_explained_var": -1.4446675777435303e-06, "kl": 2.008908021267075e-06, "entropy": 2.8921356692910196, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "env_runners": {"episode_reward_max": 522.6070239157208, "episode_reward_min": 390.4105341130374, "episode_reward_mean": 463.9119712261287, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 390.4105341130374}, "policy_reward_max": {"tplp_policy": 522.6070239157208}, "policy_reward_mean": {"tplp_policy": 463.9119712261287}, "custom_metrics": {"mean_episode_reward_mean": 463.9119712261287, "mean_episode_reward_min": 390.4105341130374, "mean_episode_reward_max": 522.6070239157208}, "hist_stats": {"episode_reward": [440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [440.4337976472136, 428.95921520537183, 423.73337396994407, 487.10847875997416, 477.93902745548667, 444.64682178003716, 427.6377338963633, 482.5863904929643, 430.905476731118, 503.18956246926973, 449.2775049604332, 407.4664919682182, 507.70925195066843, 445.15018064900784, 456.3401045777076, 479.18655317900675, 472.8103832744626, 453.5259194786641, 501.35972667987363, 493.6289530124371, 464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4849175953028633, "mean_inference_ms": 4.428546205863597, "mean_action_processing_ms": 0.8135002906352362, "mean_env_wait_ms": 4.26968147347713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0316319465637207, "StateBufferConnector_ms": 0.023865461349487305, "ViewRequirementAgentConnector_ms": 0.5795791149139404}, "num_episodes": 18, "episode_return_max": 522.6070239157208, "episode_return_min": 390.4105341130374, "episode_return_mean": 463.9119712261287, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 235.90296300771703, "num_env_steps_trained_throughput_per_sec": 235.90296300771703, "timesteps_total": 32768, "num_env_steps_sampled_lifetime": 32768, "num_agent_steps_sampled_lifetime": 32768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 4611.185, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4611.083, "sample_time_ms": 2011.642, "learn_time_ms": 2564.141, "learn_throughput": 399.354, "synch_weights_time_ms": 35.248}, "counters": {"num_env_steps_sampled": 32768, "num_env_steps_trained": 32768, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "training_iteration": 32, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-07", "timestamp": 1744125547, "time_this_iter_s": 4.36034083366394, "time_total_s": 153.13304567337036, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0ED40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.13304567337036, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 51.25, "ram_util_percent": 87.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.820455339550972, "cur_kl_coeff": 4.656612873077392e-11, "cur_lr": 1e-07, "total_loss": 2.2081354297697544, "policy_loss": -3.950682003051042e-06, "vf_loss": 9.990486079454422, "vf_explained_var": -1.3694167137145997e-06, "kl": 1.0929271391013628e-06, "entropy": 2.8948212251067162, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "env_runners": {"episode_reward_max": 522.6070239157208, "episode_reward_min": 390.4105341130374, "episode_reward_mean": 463.5982387240913, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 390.4105341130374}, "policy_reward_max": {"tplp_policy": 522.6070239157208}, "policy_reward_mean": {"tplp_policy": 463.5982387240913}, "custom_metrics": {"mean_episode_reward_mean": 463.5982387240913, "mean_episode_reward_min": 390.4105341130374, "mean_episode_reward_max": 522.6070239157208}, "hist_stats": {"episode_reward": [464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.04730233175655, 446.3839410636864, 443.30982317718406, 488.2954168121728, 502.87843318177147, 494.5742079986294, 439.8910527101982, 481.02947572626783, 462.22862758975134, 482.91844235411475, 495.23100430281056, 461.7953369521574, 470.05013733284704, 485.200607722861, 487.6401562531655, 459.8686558739523, 429.0294214540602, 455.0767997447924, 473.10147003644846, 464.0954810735709, 476.01261445535016, 461.0199986015786, 461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4877148373662425, "mean_inference_ms": 4.4429060259190996, "mean_action_processing_ms": 0.8151923725989755, "mean_env_wait_ms": 4.275983275218571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02819037437438965, "StateBufferConnector_ms": 0.020770788192749023, "ViewRequirementAgentConnector_ms": 0.6028101444244385}, "num_episodes": 20, "episode_return_max": 522.6070239157208, "episode_return_min": 390.4105341130374, "episode_return_mean": 463.5982387240913, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792, "num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 172.01252404889567, "num_env_steps_trained_throughput_per_sec": 172.01252404889567, "timesteps_total": 33792, "num_env_steps_sampled_lifetime": 33792, "num_agent_steps_sampled_lifetime": 33792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 33792, "timers": {"training_iteration_time_ms": 4779.175, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4779.074, "sample_time_ms": 2074.116, "learn_time_ms": 2669.392, "learn_throughput": 383.608, "synch_weights_time_ms": 35.514}, "counters": {"num_env_steps_sampled": 33792, "num_env_steps_trained": 33792, "num_agent_steps_sampled": 33792, "num_agent_steps_trained": 33792}, "done": false, "training_iteration": 33, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-13", "timestamp": 1744125553, "time_this_iter_s": 5.965691566467285, "time_total_s": 159.09873723983765, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.09873723983765, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 70.0625, "ram_util_percent": 87.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.34045864790678, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 1e-07, "total_loss": 2.2101744666695593, "policy_loss": -8.566604810766876e-05, "vf_loss": 10.0, "vf_explained_var": -1.810118556022644e-06, "kl": 1.8697614263096796e-06, "entropy": 2.8973986178636553, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "env_runners": {"episode_reward_max": 522.6070239157208, "episode_reward_min": 390.4105341130374, "episode_reward_mean": 463.06195084575177, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 390.4105341130374}, "policy_reward_max": {"tplp_policy": 522.6070239157208}, "policy_reward_mean": {"tplp_policy": 463.06195084575177}, "custom_metrics": {"mean_episode_reward_mean": 463.06195084575177, "mean_episode_reward_min": 390.4105341130374, "mean_episode_reward_max": 522.6070239157208}, "hist_stats": {"episode_reward": [461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [461.9686533632577, 429.25780332351303, 390.4105341130374, 507.83608358477323, 450.53458747316455, 463.96178563839345, 464.7490707537843, 433.35462233557945, 483.81507028111287, 477.07027690109567, 437.04437645983523, 495.7993320916146, 465.5004094648179, 453.91969469269156, 452.944093445159, 522.6070239157208, 435.3031511052387, 447.9190914836445, 433.8872157358813, 428.83058518254, 487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4931118543937865, "mean_inference_ms": 4.461227614537782, "mean_action_processing_ms": 0.8179406523949582, "mean_env_wait_ms": 4.2910349497814035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016056537628173828, "StateBufferConnector_ms": 0.02274775505065918, "ViewRequirementAgentConnector_ms": 0.5703732967376709}, "num_episodes": 22, "episode_return_max": 522.6070239157208, "episode_return_min": 390.4105341130374, "episode_return_mean": 463.06195084575177, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816, "num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 192.42222066610674, "num_env_steps_trained_throughput_per_sec": 192.42222066610674, "timesteps_total": 34816, "num_env_steps_sampled_lifetime": 34816, "num_agent_steps_sampled_lifetime": 34816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 34816, "timers": {"training_iteration_time_ms": 4893.88, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4893.778, "sample_time_ms": 2127.074, "learn_time_ms": 2731.33, "learn_throughput": 374.909, "synch_weights_time_ms": 35.222}, "counters": {"num_env_steps_sampled": 34816, "num_env_steps_trained": 34816, "num_agent_steps_sampled": 34816, "num_agent_steps_trained": 34816}, "done": false, "training_iteration": 34, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-18", "timestamp": 1744125558, "time_this_iter_s": 5.3291895389556885, "time_total_s": 164.42792677879333, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EF20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.42792677879333, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 59.287499999999994, "ram_util_percent": 86.0625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4366250611841678, "cur_kl_coeff": 1.164153218269348e-11, "cur_lr": 1e-07, "total_loss": 2.2059893742203713, "policy_loss": -0.00017132882785517723, "vf_loss": 9.984549939632416, "vf_explained_var": -3.4909695386886598e-06, "kl": 1.537364750880954e-06, "entropy": 2.89976772069931, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "env_runners": {"episode_reward_max": 540.1803902156985, "episode_reward_min": 420.07970776559836, "episode_reward_mean": 463.93988728509066, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.07970776559836}, "policy_reward_max": {"tplp_policy": 540.1803902156985}, "policy_reward_mean": {"tplp_policy": 463.93988728509066}, "custom_metrics": {"mean_episode_reward_mean": 463.93988728509066, "mean_episode_reward_min": 420.07970776559836, "mean_episode_reward_max": 540.1803902156985}, "hist_stats": {"episode_reward": [487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.8388868716758, 487.6637998346243, 481.0666478136098, 475.4128125200481, 434.154664312284, 464.22009689811625, 442.73367122566634, 469.1524711442351, 514.6441134913883, 443.40261426989434, 486.29440289189904, 487.99632709983837, 486.4333290037638, 439.9306786335826, 477.4048194390526, 420.07970776559836, 458.735777975698, 506.827614545404, 421.29157261390486, 511.4281018488004, 486.05848121796595, 491.59413071050943, 462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4984492304425518, "mean_inference_ms": 4.479829844403541, "mean_action_processing_ms": 0.8206840690299657, "mean_env_wait_ms": 4.306099320752668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017616987228393555, "StateBufferConnector_ms": 0.01884937286376953, "ViewRequirementAgentConnector_ms": 0.5812523365020752}, "num_episodes": 20, "episode_return_max": 540.1803902156985, "episode_return_min": 420.07970776559836, "episode_return_mean": 463.93988728509066, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840, "num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.15499679457577, "num_env_steps_trained_throughput_per_sec": 204.15499679457577, "timesteps_total": 35840, "num_env_steps_sampled_lifetime": 35840, "num_agent_steps_sampled_lifetime": 35840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 35840, "timers": {"training_iteration_time_ms": 4951.324, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4951.222, "sample_time_ms": 2130.914, "learn_time_ms": 2785.146, "learn_throughput": 367.665, "synch_weights_time_ms": 35.009}, "counters": {"num_env_steps_sampled": 35840, "num_env_steps_trained": 35840, "num_agent_steps_sampled": 35840, "num_agent_steps_trained": 35840}, "done": false, "training_iteration": 35, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-24", "timestamp": 1744125564, "time_this_iter_s": 5.02394700050354, "time_total_s": 169.45187377929688, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F240>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.45187377929688, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.01428571428572, "ram_util_percent": 86.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.415785140544176, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 1e-07, "total_loss": 2.2096353121101857, "policy_loss": -0.0001241224817931652, "vf_loss": 9.999743396043778, "vf_explained_var": -1.7434358596801758e-06, "kl": 1.781685800537891e-06, "entropy": 2.9017640739679336, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "env_runners": {"episode_reward_max": 543.74700794889, "episode_reward_min": 422.1387872007364, "episode_reward_mean": 463.9232564919292, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 422.1387872007364}, "policy_reward_max": {"tplp_policy": 543.74700794889}, "policy_reward_mean": {"tplp_policy": 463.9232564919292}, "custom_metrics": {"mean_episode_reward_mean": 463.9232564919292, "mean_episode_reward_min": 422.1387872007364, "mean_episode_reward_max": 543.74700794889}, "hist_stats": {"episode_reward": [462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.36463559093164, 482.94601135689715, 471.279594467987, 462.41208946529764, 467.7076703626979, 465.0723037705364, 445.96348536267845, 442.3084218547007, 450.3896735113925, 424.8204325963967, 487.8860384845401, 448.8637761918175, 469.52454585476494, 478.8738210785246, 436.6852113225474, 445.7478729813954, 469.51532098182224, 447.1731927059381, 473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4996163692504414, "mean_inference_ms": 4.4857100014384175, "mean_action_processing_ms": 0.8210496495951486, "mean_env_wait_ms": 4.311687537360203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0166776180267334, "StateBufferConnector_ms": 0.021384239196777344, "ViewRequirementAgentConnector_ms": 0.5513849258422852}, "num_episodes": 22, "episode_return_max": 543.74700794889, "episode_return_min": 422.1387872007364, "episode_return_mean": 463.9232564919292, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864, "num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 238.5166570028274, "num_env_steps_trained_throughput_per_sec": 238.5166570028274, "timesteps_total": 36864, "num_env_steps_sampled_lifetime": 36864, "num_agent_steps_sampled_lifetime": 36864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 36864, "timers": {"training_iteration_time_ms": 4913.17, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4913.069, "sample_time_ms": 2086.694, "learn_time_ms": 2790.736, "learn_throughput": 366.928, "synch_weights_time_ms": 35.486}, "counters": {"num_env_steps_sampled": 36864, "num_env_steps_trained": 36864, "num_agent_steps_sampled": 36864, "num_agent_steps_trained": 36864}, "done": false, "training_iteration": 36, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-28", "timestamp": 1744125568, "time_this_iter_s": 4.306290626525879, "time_total_s": 173.75816440582275, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0D3A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.75816440582275, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 52.400000000000006, "ram_util_percent": 87.03333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1889311622828247, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 1e-07, "total_loss": 2.2095437705516816, "policy_loss": -4.789854283444583e-05, "vf_loss": 10.0, "vf_explained_var": -2.590566873550415e-06, "kl": 1.197610358127932e-06, "entropy": 2.904083305597305, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "env_runners": {"episode_reward_max": 543.74700794889, "episode_reward_min": 412.77127200927777, "episode_reward_mean": 465.3144054915536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.77127200927777}, "policy_reward_max": {"tplp_policy": 543.74700794889}, "policy_reward_mean": {"tplp_policy": 465.3144054915536}, "custom_metrics": {"mean_episode_reward_mean": 465.3144054915536, "mean_episode_reward_min": 412.77127200927777, "mean_episode_reward_max": 543.74700794889}, "hist_stats": {"episode_reward": [473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.92781075966855, 456.5543901611581, 496.4625380618146, 446.0646044260495, 445.6512786184255, 440.13006154022764, 480.40762469284516, 440.1577979248299, 471.3778443142431, 455.1328259357116, 455.94622904077613, 438.0932369966911, 471.71204517119276, 443.0641701282924, 455.00556836798097, 484.1519531114614, 453.7809932520496, 457.9122117433062, 422.1387872007364, 492.7934906533996, 501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5015679185989206, "mean_inference_ms": 4.492865382558779, "mean_action_processing_ms": 0.8218185492100356, "mean_env_wait_ms": 4.31904640456693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0162351131439209, "StateBufferConnector_ms": 0.019799470901489258, "ViewRequirementAgentConnector_ms": 0.5529413223266602}, "num_episodes": 18, "episode_return_max": 543.74700794889, "episode_return_min": 412.77127200927777, "episode_return_mean": 465.3144054915536, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888, "num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 207.8011464807967, "num_env_steps_trained_throughput_per_sec": 207.8011464807967, "timesteps_total": 37888, "num_env_steps_sampled_lifetime": 37888, "num_agent_steps_sampled_lifetime": 37888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 37888, "timers": {"training_iteration_time_ms": 4955.446, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4955.344, "sample_time_ms": 2132.304, "learn_time_ms": 2787.929, "learn_throughput": 367.298, "synch_weights_time_ms": 34.959}, "counters": {"num_env_steps_sampled": 37888, "num_env_steps_trained": 37888, "num_agent_steps_sampled": 37888, "num_agent_steps_trained": 37888}, "done": false, "training_iteration": 37, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-33", "timestamp": 1744125573, "time_this_iter_s": 4.936290979385376, "time_total_s": 178.69445538520813, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.69445538520813, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 56.871428571428574, "ram_util_percent": 86.91428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.645196894556284, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 1e-07, "total_loss": 2.2074164360761643, "policy_loss": -0.00024095723638311027, "vf_loss": 9.99334858059883, "vf_explained_var": -2.0477920770645143e-06, "kl": 3.0922941923527957e-06, "entropy": 2.9067974895238877, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "env_runners": {"episode_reward_max": 543.74700794889, "episode_reward_min": 412.77127200927777, "episode_reward_mean": 467.2725381080048, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.77127200927777}, "policy_reward_max": {"tplp_policy": 543.74700794889}, "policy_reward_mean": {"tplp_policy": 467.2725381080048}, "custom_metrics": {"mean_episode_reward_mean": 467.2725381080048, "mean_episode_reward_min": 412.77127200927777, "mean_episode_reward_max": 543.74700794889}, "hist_stats": {"episode_reward": [501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [501.11327980816145, 476.9075232568603, 501.82162335668744, 457.2336526442008, 456.29632269322343, 436.71925676903874, 451.2685295880968, 473.1948078159924, 462.0955415638747, 431.2467047791908, 475.0682741118635, 484.82942859195055, 502.6426868969055, 427.20082877927337, 469.83083278882015, 484.22573033256907, 482.6858840265425, 477.6423298528039, 443.7402787466852, 459.353824658298, 426.31761915197995, 464.57254327937807, 495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5023187416633261, "mean_inference_ms": 4.495981480325744, "mean_action_processing_ms": 0.8228378861529424, "mean_env_wait_ms": 4.3248782104935986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018626689910888672, "StateBufferConnector_ms": 0.022796154022216797, "ViewRequirementAgentConnector_ms": 0.49820470809936523}, "num_episodes": 20, "episode_return_max": 543.74700794889, "episode_return_min": 412.77127200927777, "episode_return_mean": 467.2725381080048, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912, "num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 205.485234278394, "num_env_steps_trained_throughput_per_sec": 205.485234278394, "timesteps_total": 38912, "num_env_steps_sampled_lifetime": 38912, "num_agent_steps_sampled_lifetime": 38912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 38912, "timers": {"training_iteration_time_ms": 4957.041, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4956.939, "sample_time_ms": 2143.46, "learn_time_ms": 2779.459, "learn_throughput": 368.417, "synch_weights_time_ms": 33.745}, "counters": {"num_env_steps_sampled": 38912, "num_env_steps_trained": 38912, "num_agent_steps_sampled": 38912, "num_agent_steps_trained": 38912}, "done": false, "training_iteration": 38, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-38", "timestamp": 1744125578, "time_this_iter_s": 4.991997480392456, "time_total_s": 183.6864528656006, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51B20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.6864528656006, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 59.228571428571435, "ram_util_percent": 86.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.158288525044918, "cur_kl_coeff": 7.275957614183425e-13, "cur_lr": 1e-07, "total_loss": 2.206969171017408, "policy_loss": 1.9921630155295134e-05, "vf_loss": 9.991492182016373, "vf_explained_var": -1.6026198863983154e-06, "kl": 3.5634228741088235e-07, "entropy": 2.9092380121350288, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "env_runners": {"episode_reward_max": 543.74700794889, "episode_reward_min": 400.8274303193111, "episode_reward_mean": 467.0860658561462, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.8274303193111}, "policy_reward_max": {"tplp_policy": 543.74700794889}, "policy_reward_mean": {"tplp_policy": 467.0860658561462}, "custom_metrics": {"mean_episode_reward_mean": 467.0860658561462, "mean_episode_reward_min": 400.8274303193111, "mean_episode_reward_max": 543.74700794889}, "hist_stats": {"episode_reward": [495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [495.13517007895763, 485.05680043389896, 444.3763983555379, 467.0914690458134, 457.7652536680859, 469.10804643591126, 435.9486543888596, 436.93755513111404, 458.38821518783857, 436.88991545476483, 490.9926686580187, 457.94390620939254, 447.9960797484697, 450.64520551805987, 448.64456746587916, 445.98765206925395, 464.52899478182167, 540.1803902156985, 432.12187232371673, 507.8926560442022, 475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.500227802842832, "mean_inference_ms": 4.492287560261172, "mean_action_processing_ms": 0.8222387328305691, "mean_env_wait_ms": 4.32287466319432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02188587188720703, "StateBufferConnector_ms": 0.018079757690429688, "ViewRequirementAgentConnector_ms": 0.48245906829833984}, "num_episodes": 22, "episode_return_max": 543.74700794889, "episode_return_min": 400.8274303193111, "episode_return_mean": 467.0860658561462, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936, "num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 216.60549701026662, "num_env_steps_trained_throughput_per_sec": 216.60549701026662, "timesteps_total": 39936, "num_env_steps_sampled_lifetime": 39936, "num_agent_steps_sampled_lifetime": 39936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 39936, "timers": {"training_iteration_time_ms": 4939.961, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4939.86, "sample_time_ms": 2116.788, "learn_time_ms": 2788.882, "learn_throughput": 367.172, "synch_weights_time_ms": 33.866}, "counters": {"num_env_steps_sampled": 39936, "num_env_steps_trained": 39936, "num_agent_steps_sampled": 39936, "num_agent_steps_trained": 39936}, "done": false, "training_iteration": 39, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-43", "timestamp": 1744125583, "time_this_iter_s": 4.740344524383545, "time_total_s": 188.42679738998413, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.42679738998413, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 86.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.137738712131977, "cur_kl_coeff": 3.6379788070917126e-13, "cur_lr": 1e-07, "total_loss": 2.204100693762302, "policy_loss": -0.00011995964450761676, "vf_loss": 9.98094820380211, "vf_explained_var": -2.6550143957138063e-06, "kl": 1.0724170188769478e-06, "entropy": 2.910163904726505, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "env_runners": {"episode_reward_max": 543.74700794889, "episode_reward_min": 400.8274303193111, "episode_reward_mean": 466.6833772358813, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.8274303193111}, "policy_reward_max": {"tplp_policy": 543.74700794889}, "policy_reward_mean": {"tplp_policy": 466.6833772358813}, "custom_metrics": {"mean_episode_reward_mean": 466.6833772358813, "mean_episode_reward_min": 400.8274303193111, "mean_episode_reward_max": 543.74700794889}, "hist_stats": {"episode_reward": [475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.31673483082295, 456.1166737960212, 543.74700794889, 438.396744212959, 440.96469666533045, 436.00999510259726, 498.20925231776835, 455.65496963305293, 478.8918273845288, 477.12472951864873, 469.74722713289964, 490.1702702885301, 497.7535501781519, 452.79903286153615, 432.47879246979824, 430.20470835092976, 487.092454137741, 481.31362843917117, 508.6648228888655, 482.029996285262, 502.1376319337165, 462.70089989749886, 474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4983008028423948, "mean_inference_ms": 4.4863267005393395, "mean_action_processing_ms": 0.8217426278268926, "mean_env_wait_ms": 4.319881238871922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022321701049804688, "StateBufferConnector_ms": 0.017526865005493164, "ViewRequirementAgentConnector_ms": 0.4368863105773926}, "num_episodes": 20, "episode_return_max": 543.74700794889, "episode_return_min": 400.8274303193111, "episode_return_mean": 466.6833772358813, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 227.04038817594258, "num_env_steps_trained_throughput_per_sec": 227.04038817594258, "timesteps_total": 40960, "num_env_steps_sampled_lifetime": 40960, "num_agent_steps_sampled_lifetime": 40960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 4939.64, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4939.538, "sample_time_ms": 2127.367, "learn_time_ms": 2778.346, "learn_throughput": 368.565, "synch_weights_time_ms": 33.502}, "counters": {"num_env_steps_sampled": 40960, "num_env_steps_trained": 40960, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "training_iteration": 40, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-48", "timestamp": 1744125588, "time_this_iter_s": 4.5315186977386475, "time_total_s": 192.95831608772278, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.95831608772278, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 58.88333333333333, "ram_util_percent": 85.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0184534795582296, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 1e-07, "total_loss": 2.205184601992369, "policy_loss": 1.0667782044038177e-05, "vf_loss": 9.985253870487213, "vf_explained_var": -2.715364098548889e-06, "kl": 5.212293928913425e-07, "entropy": 2.911395309865475, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "env_runners": {"episode_reward_max": 503.68613634374515, "episode_reward_min": 400.8274303193111, "episode_reward_mean": 465.494439126444, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.8274303193111}, "policy_reward_max": {"tplp_policy": 503.68613634374515}, "policy_reward_mean": {"tplp_policy": 465.494439126444}, "custom_metrics": {"mean_episode_reward_mean": 465.494439126444, "mean_episode_reward_min": 400.8274303193111, "mean_episode_reward_max": 503.68613634374515}, "hist_stats": {"episode_reward": [474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.2534662498669, 480.74263155634463, 460.22433778333044, 470.18733250549474, 426.81103762338824, 453.23888927205655, 501.9762437419111, 461.2355274941239, 439.01714644641044, 422.28518140195723, 412.77127200927777, 484.1496659395407, 475.09622973789266, 486.3149306743307, 481.8204372924233, 503.68613634374515, 474.6514246648561, 489.03144655039847, 462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4990455325945582, "mean_inference_ms": 4.489152181854164, "mean_action_processing_ms": 0.822803148991263, "mean_env_wait_ms": 4.323988033453258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023055315017700195, "StateBufferConnector_ms": 0.023941516876220703, "ViewRequirementAgentConnector_ms": 0.4869651794433594}, "num_episodes": 22, "episode_return_max": 503.68613634374515, "episode_return_min": 400.8274303193111, "episode_return_mean": 465.494439126444, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984, "num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 214.8901063141248, "num_env_steps_trained_throughput_per_sec": 214.8901063141248, "timesteps_total": 41984, "num_env_steps_sampled_lifetime": 41984, "num_agent_steps_sampled_lifetime": 41984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 41984, "timers": {"training_iteration_time_ms": 4883.951, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4883.849, "sample_time_ms": 2088.132, "learn_time_ms": 2761.996, "learn_throughput": 370.746, "synch_weights_time_ms": 33.281}, "counters": {"num_env_steps_sampled": 41984, "num_env_steps_trained": 41984, "num_agent_steps_sampled": 41984, "num_agent_steps_trained": 41984}, "done": false, "training_iteration": 41, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-52", "timestamp": 1744125592, "time_this_iter_s": 4.772887468338013, "time_total_s": 197.7312035560608, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.7312035560608, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 55.583333333333336, "ram_util_percent": 85.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.922552425414324, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 1e-07, "total_loss": 2.20577257797122, "policy_loss": -3.9021758129820225e-05, "vf_loss": 9.988165265321731, "vf_explained_var": -3.2518059015274047e-06, "kl": 2.774987829745612e-07, "entropy": 2.9122971072793007, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "env_runners": {"episode_reward_max": 505.50782344037145, "episode_reward_min": 400.8274303193111, "episode_reward_mean": 464.82262634728477, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.8274303193111}, "policy_reward_max": {"tplp_policy": 505.50782344037145}, "policy_reward_mean": {"tplp_policy": 464.82262634728477}, "custom_metrics": {"mean_episode_reward_mean": 464.82262634728477, "mean_episode_reward_min": 400.8274303193111, "mean_episode_reward_max": 505.50782344037145}, "hist_stats": {"episode_reward": [462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.3276470117876, 480.0126298117424, 475.18504901818676, 446.00267688743565, 466.19314267586446, 485.75258714682286, 454.61923723849173, 484.65932642950236, 494.47344529807106, 458.59321979445684, 445.59690294285326, 467.8786871301196, 490.1490852285041, 471.67563706180806, 470.6407002963571, 455.23315941791026, 429.08425995766225, 474.51845918313467, 460.11435125271754, 466.22740136691993, 436.51704468272163, 469.6739979539624, 484.49661596937, 473.8896072219381, 400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4998050319002771, "mean_inference_ms": 4.48692192327982, "mean_action_processing_ms": 0.8230181953066824, "mean_env_wait_ms": 4.323406845874987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021051406860351562, "StateBufferConnector_ms": 0.022030115127563477, "ViewRequirementAgentConnector_ms": 0.4866316318511963}, "num_episodes": 18, "episode_return_max": 505.50782344037145, "episode_return_min": 400.8274303193111, "episode_return_mean": 464.82262634728477, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008, "num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 201.0637074857033, "num_env_steps_trained_throughput_per_sec": 201.0637074857033, "timesteps_total": 43008, "num_env_steps_sampled_lifetime": 43008, "num_agent_steps_sampled_lifetime": 43008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 43008, "timers": {"training_iteration_time_ms": 4959.064, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4959.064, "sample_time_ms": 2098.462, "learn_time_ms": 2827.2, "learn_throughput": 362.196, "synch_weights_time_ms": 32.961}, "counters": {"num_env_steps_sampled": 43008, "num_env_steps_trained": 43008, "num_agent_steps_sampled": 43008, "num_agent_steps_trained": 43008}, "done": false, "training_iteration": 42, "trial_id": "3bf18_00000", "date": "2025-04-08_23-19-58", "timestamp": 1744125598, "time_this_iter_s": 5.106755971908569, "time_total_s": 202.83795952796936, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.83795952796936, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 55.58571428571428, "ram_util_percent": 86.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0246168185025453, "cur_kl_coeff": 4.547473508864641e-14, "cur_lr": 1e-07, "total_loss": 2.2085840098559855, "policy_loss": -7.477359613403678e-05, "vf_loss": 10.0, "vf_explained_var": -1.2345612049102782e-06, "kl": 1.4059008129715944e-06, "entropy": 2.913412131369114, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "env_runners": {"episode_reward_max": 520.8088160624977, "episode_reward_min": 400.8274303193111, "episode_reward_mean": 465.5323398066536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.8274303193111}, "policy_reward_max": {"tplp_policy": 520.8088160624977}, "policy_reward_mean": {"tplp_policy": 465.5323398066536}, "custom_metrics": {"mean_episode_reward_mean": 465.5323398066536, "mean_episode_reward_min": 400.8274303193111, "mean_episode_reward_max": 520.8088160624977}, "hist_stats": {"episode_reward": [400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [400.8274303193111, 475.54776303125027, 470.04382098222044, 472.34347799557287, 473.6462697010684, 463.3058826551934, 497.7006287885399, 456.5710702743431, 446.33448066258904, 436.5262340925058, 440.95561463791756, 489.364727047723, 481.09819030602637, 483.5655703105355, 473.80255240121994, 474.8075466529013, 466.6413335385418, 480.11413044453656, 502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5013578705258426, "mean_inference_ms": 4.477784293893682, "mean_action_processing_ms": 0.8221724696257456, "mean_env_wait_ms": 4.316848976194572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01869940757751465, "StateBufferConnector_ms": 0.020538806915283203, "ViewRequirementAgentConnector_ms": 0.4935176372528076}, "num_episodes": 24, "episode_return_max": 520.8088160624977, "episode_return_min": 400.8274303193111, "episode_return_mean": 465.5323398066536, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032, "num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 190.7798779221581, "num_env_steps_trained_throughput_per_sec": 190.7798779221581, "timesteps_total": 44032, "num_env_steps_sampled_lifetime": 44032, "num_agent_steps_sampled_lifetime": 44032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 44032, "timers": {"training_iteration_time_ms": 4900.502, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4900.502, "sample_time_ms": 2069.668, "learn_time_ms": 2797.133, "learn_throughput": 366.089, "synch_weights_time_ms": 33.211}, "counters": {"num_env_steps_sampled": 44032, "num_env_steps_trained": 44032, "num_agent_steps_sampled": 44032, "num_agent_steps_trained": 44032}, "done": false, "training_iteration": 43, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-03", "timestamp": 1744125603, "time_this_iter_s": 5.388359069824219, "time_total_s": 208.22631859779358, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0D3A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.22631859779358, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 67.2125, "ram_util_percent": 87.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.782154730334878, "cur_kl_coeff": 2.2737367544323204e-14, "cur_lr": 1e-07, "total_loss": 2.2050972513854505, "policy_loss": -0.0002213947824202478, "vf_loss": 9.98746262192726, "vf_explained_var": -4.431977868080139e-06, "kl": 2.209823015331125e-06, "entropy": 2.9154701694846152, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "env_runners": {"episode_reward_max": 556.3554911624615, "episode_reward_min": 413.290484116387, "episode_reward_mean": 466.548276007315, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.290484116387}, "policy_reward_max": {"tplp_policy": 556.3554911624615}, "policy_reward_mean": {"tplp_policy": 466.548276007315}, "custom_metrics": {"mean_episode_reward_mean": 466.548276007315, "mean_episode_reward_min": 413.290484116387, "mean_episode_reward_max": 556.3554911624615}, "hist_stats": {"episode_reward": [502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [502.50160953217784, 456.450003852097, 425.2938196855305, 467.4495127275506, 427.86043879005814, 445.7703290846846, 459.4920778651997, 460.05499729233804, 479.60993251295173, 458.2993923249113, 451.5473117276878, 462.7891045581922, 497.03737541371805, 462.1600391848207, 459.7786969293309, 479.44519606765, 435.1417112336699, 455.9255964231589, 452.2118620622597, 472.1163683882607, 444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5016443842732872, "mean_inference_ms": 4.474854914579936, "mean_action_processing_ms": 0.8217939691018493, "mean_env_wait_ms": 4.317519642747267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014221668243408203, "StateBufferConnector_ms": 0.020361661911010742, "ViewRequirementAgentConnector_ms": 0.489886999130249}, "num_episodes": 18, "episode_return_max": 556.3554911624615, "episode_return_min": 413.290484116387, "episode_return_mean": 466.548276007315, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056, "num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.2648237579351, "num_env_steps_trained_throughput_per_sec": 217.2648237579351, "timesteps_total": 45056, "num_env_steps_sampled_lifetime": 45056, "num_agent_steps_sampled_lifetime": 45056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 45056, "timers": {"training_iteration_time_ms": 4839.654, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4839.654, "sample_time_ms": 2022.073, "learn_time_ms": 2783.302, "learn_throughput": 367.908, "synch_weights_time_ms": 33.771}, "counters": {"num_env_steps_sampled": 45056, "num_env_steps_trained": 45056, "num_agent_steps_sampled": 45056, "num_agent_steps_trained": 45056}, "done": false, "training_iteration": 44, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-08", "timestamp": 1744125608, "time_this_iter_s": 4.722129583358765, "time_total_s": 212.94844818115234, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51F80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.94844818115234, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 86.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.983783594146371, "cur_kl_coeff": 1.1368683772161602e-14, "cur_lr": 1e-07, "total_loss": 2.20156299546361, "policy_loss": -2.0023813704028726e-05, "vf_loss": 9.97306267619133, "vf_explained_var": -3.7942081689834595e-06, "kl": 5.405594594998231e-07, "entropy": 2.91682638078928, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "env_runners": {"episode_reward_max": 556.3554911624615, "episode_reward_min": 387.5814052046845, "episode_reward_mean": 468.68763028418306, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 387.5814052046845}, "policy_reward_max": {"tplp_policy": 556.3554911624615}, "policy_reward_mean": {"tplp_policy": 468.68763028418306}, "custom_metrics": {"mean_episode_reward_mean": 468.68763028418306, "mean_episode_reward_min": 387.5814052046845, "mean_episode_reward_max": 556.3554911624615}, "hist_stats": {"episode_reward": [444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [444.8614280736581, 476.1756688391736, 470.458949661772, 462.8336657586309, 471.680411076368, 471.4080500739537, 439.19088038400963, 499.13443182769936, 492.52111581870975, 429.5812032666116, 462.90889035640356, 496.67181846834717, 454.1321731068614, 456.99148565392375, 474.5863291243437, 467.9933170351251, 445.21778815971237, 471.12529946119395, 478.0690791515475, 488.7616195824197, 425.42728590105094, 471.34446066026544, 442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.50165650015741, "mean_inference_ms": 4.4687188150068895, "mean_action_processing_ms": 0.8213056666703406, "mean_env_wait_ms": 4.313719295577589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017653465270996094, "StateBufferConnector_ms": 0.019954442977905273, "ViewRequirementAgentConnector_ms": 0.45247769355773926}, "num_episodes": 20, "episode_return_max": 556.3554911624615, "episode_return_min": 387.5814052046845, "episode_return_mean": 468.68763028418306, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080, "num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 259.0212478044088, "num_env_steps_trained_throughput_per_sec": 259.0212478044088, "timesteps_total": 46080, "num_env_steps_sampled_lifetime": 46080, "num_agent_steps_sampled_lifetime": 46080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 46080, "timers": {"training_iteration_time_ms": 4733.408, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4733.408, "sample_time_ms": 1991.061, "learn_time_ms": 2708.062, "learn_throughput": 378.13, "synch_weights_time_ms": 33.779}, "counters": {"num_env_steps_sampled": 46080, "num_env_steps_trained": 46080, "num_agent_steps_sampled": 46080, "num_agent_steps_trained": 46080}, "done": false, "training_iteration": 45, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-12", "timestamp": 1744125612, "time_this_iter_s": 3.9639172554016113, "time_total_s": 216.91236543655396, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.91236543655396, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 54.58333333333334, "ram_util_percent": 86.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.008370315656066, "cur_kl_coeff": 5.684341886080801e-15, "cur_lr": 1e-07, "total_loss": 2.206734547764063, "policy_loss": -4.146423889324069e-05, "vf_loss": 9.994183385372162, "vf_explained_var": -3.7062913179397582e-06, "kl": 4.358937474219227e-07, "entropy": 2.9176982447504995, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "env_runners": {"episode_reward_max": 556.3554911624615, "episode_reward_min": 387.5814052046845, "episode_reward_mean": 469.4545333687158, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 387.5814052046845}, "policy_reward_max": {"tplp_policy": 556.3554911624615}, "policy_reward_mean": {"tplp_policy": 469.4545333687158}, "custom_metrics": {"mean_episode_reward_mean": 469.4545333687158, "mean_episode_reward_min": 387.5814052046845, "mean_episode_reward_max": 556.3554911624615}, "hist_stats": {"episode_reward": [442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [442.88438598183626, 482.6180459117031, 424.92305234090355, 479.6212350444515, 466.37256788263534, 475.88491637010947, 456.26036611836344, 472.09588819563146, 505.50782344037145, 480.615877822075, 445.94820389398205, 474.75533315036574, 448.0230565864951, 462.33052567619666, 466.0783491957324, 449.62068519925293, 472.90039362882345, 431.51624063737097, 467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5005775476333825, "mean_inference_ms": 4.459551557985238, "mean_action_processing_ms": 0.819350692704418, "mean_env_wait_ms": 4.3072723029601105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024535655975341797, "StateBufferConnector_ms": 0.011378765106201172, "ViewRequirementAgentConnector_ms": 0.4136319160461426}, "num_episodes": 22, "episode_return_max": 556.3554911624615, "episode_return_min": 387.5814052046845, "episode_return_mean": 469.4545333687158, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104, "num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 244.35674125644243, "num_env_steps_trained_throughput_per_sec": 244.35674125644243, "timesteps_total": 47104, "num_env_steps_sampled_lifetime": 47104, "num_agent_steps_sampled_lifetime": 47104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 47104, "timers": {"training_iteration_time_ms": 4723.148, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4723.148, "sample_time_ms": 2021.502, "learn_time_ms": 2666.727, "learn_throughput": 383.991, "synch_weights_time_ms": 34.305}, "counters": {"num_env_steps_sampled": 47104, "num_env_steps_trained": 47104, "num_agent_steps_sampled": 47104, "num_agent_steps_trained": 47104}, "done": false, "training_iteration": 46, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-16", "timestamp": 1744125616, "time_this_iter_s": 4.206572532653809, "time_total_s": 221.11893796920776, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0FF60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.11893796920776, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 55.06666666666667, "ram_util_percent": 86.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.111218849569559, "cur_kl_coeff": 2.8421709430404005e-15, "cur_lr": 1e-07, "total_loss": 2.200061801075935, "policy_loss": -8.978008409030736e-05, "vf_loss": 9.96798271536827, "vf_explained_var": -3.047659993171692e-06, "kl": 8.210492463245345e-07, "entropy": 2.9184409618377685, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "env_runners": {"episode_reward_max": 556.3554911624615, "episode_reward_min": 387.5814052046845, "episode_reward_mean": 470.1273943164966, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 387.5814052046845}, "policy_reward_max": {"tplp_policy": 556.3554911624615}, "policy_reward_mean": {"tplp_policy": 470.1273943164966}, "custom_metrics": {"mean_episode_reward_mean": 470.1273943164966, "mean_episode_reward_min": 387.5814052046845, "mean_episode_reward_max": 556.3554911624615}, "hist_stats": {"episode_reward": [467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.36517684940907, 477.03030036315363, 455.72561371615313, 475.6938717521208, 472.0504449070102, 489.2908663083898, 440.83260090456685, 467.61076713418777, 468.72661177643744, 456.30555139079456, 495.8689538404454, 450.22019053823703, 475.2155882044186, 499.93346713095787, 425.25169323869295, 472.6260024074929, 468.3848245595291, 516.3511439717313, 520.8088160624977, 435.23436881089845, 456.43885866624214, 483.10387011567536, 475.5098040299404, 413.290484116387, 445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5001611714398246, "mean_inference_ms": 4.455358809820444, "mean_action_processing_ms": 0.818657398657397, "mean_env_wait_ms": 4.303795335430974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04247784614562988, "StateBufferConnector_ms": 0.013227224349975586, "ViewRequirementAgentConnector_ms": 0.42972469329833984}, "num_episodes": 18, "episode_return_max": 556.3554911624615, "episode_return_min": 387.5814052046845, "episode_return_mean": 470.1273943164966, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128, "num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 226.82271639144332, "num_env_steps_trained_throughput_per_sec": 226.82271639144332, "timesteps_total": 48128, "num_env_steps_sampled_lifetime": 48128, "num_agent_steps_sampled_lifetime": 48128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 48128, "timers": {"training_iteration_time_ms": 4681.823, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4681.823, "sample_time_ms": 2012.107, "learn_time_ms": 2634.843, "learn_throughput": 388.638, "synch_weights_time_ms": 34.259}, "counters": {"num_env_steps_sampled": 48128, "num_env_steps_trained": 48128, "num_agent_steps_sampled": 48128, "num_agent_steps_trained": 48128}, "done": false, "training_iteration": 47, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-21", "timestamp": 1744125621, "time_this_iter_s": 4.523692846298218, "time_total_s": 225.64263081550598, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 225.64263081550598, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 61.32000000000001, "ram_util_percent": 86.43999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2559336356818678, "cur_kl_coeff": 1.4210854715202003e-15, "cur_lr": 1e-07, "total_loss": 2.20610129237175, "policy_loss": -0.00016249103355221451, "vf_loss": 9.992629718780517, "vf_explained_var": -4.2084604501724245e-06, "kl": 9.769022702665887e-07, "entropy": 2.918936422467232, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "env_runners": {"episode_reward_max": 556.3554911624615, "episode_reward_min": 387.5814052046845, "episode_reward_mean": 468.79437590450755, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 387.5814052046845}, "policy_reward_max": {"tplp_policy": 556.3554911624615}, "policy_reward_mean": {"tplp_policy": 468.79437590450755}, "custom_metrics": {"mean_episode_reward_mean": 468.79437590450755, "mean_episode_reward_min": 387.5814052046845, "mean_episode_reward_max": 556.3554911624615}, "hist_stats": {"episode_reward": [445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [445.34697356893986, 452.82092189911566, 480.6852618897054, 443.4844572887889, 454.4014253484037, 481.18119401615775, 495.7896261818931, 471.3854670055029, 488.0313318196938, 447.7052705584359, 441.9728041097682, 462.326742348947, 556.3554911624615, 481.7827311616264, 477.7549691194207, 514.96538828294, 482.5560848704636, 509.74444267205007, 504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.496971540250774, "mean_inference_ms": 4.446369762629266, "mean_action_processing_ms": 0.816667864037114, "mean_env_wait_ms": 4.29477754769417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04132699966430664, "StateBufferConnector_ms": 0.01775336265563965, "ViewRequirementAgentConnector_ms": 0.3894062042236328}, "num_episodes": 24, "episode_return_max": 556.3554911624615, "episode_return_min": 387.5814052046845, "episode_return_mean": 468.79437590450755, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.6216579079235, "num_env_steps_trained_throughput_per_sec": 309.6216579079235, "timesteps_total": 49152, "num_env_steps_sampled_lifetime": 49152, "num_agent_steps_sampled_lifetime": 49152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 4514.216, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4514.116, "sample_time_ms": 1923.442, "learn_time_ms": 2556.265, "learn_throughput": 400.584, "synch_weights_time_ms": 33.818}, "counters": {"num_env_steps_sampled": 49152, "num_env_steps_trained": 49152, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "training_iteration": 48, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-24", "timestamp": 1744125624, "time_this_iter_s": 3.3173255920410156, "time_total_s": 228.959956407547, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EAC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 228.959956407547, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 45.14, "ram_util_percent": 86.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0007507499307393, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 1e-07, "total_loss": 2.204953997582197, "policy_loss": -0.00010313093662261963, "vf_loss": 9.98806791305542, "vf_explained_var": -3.2119452953338625e-06, "kl": 9.691270019374088e-07, "entropy": 2.919598600268364, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "env_runners": {"episode_reward_max": 534.0852857201342, "episode_reward_min": 387.5814052046845, "episode_reward_mean": 466.9182498250469, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 387.5814052046845}, "policy_reward_max": {"tplp_policy": 534.0852857201342}, "policy_reward_mean": {"tplp_policy": 466.9182498250469}, "custom_metrics": {"mean_episode_reward_mean": 466.9182498250469, "mean_episode_reward_min": 387.5814052046845, "mean_episode_reward_max": 534.0852857201342}, "hist_stats": {"episode_reward": [504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [504.43739818961456, 495.5485219693838, 445.8088078706312, 440.2285306658863, 469.0617236678079, 465.0531605673904, 447.2617834646201, 501.9844371001111, 498.53770665672687, 510.28768432619404, 464.6409748721753, 387.5814052046845, 460.9627529841424, 496.01682920148517, 457.50056967042894, 441.785770766032, 473.0315135717033, 472.84070505152346, 486.5992501370753, 472.0416058509766, 508.0735102937412, 487.9500163620337, 463.6176129900851, 438.0445887243133, 419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4929332483183786, "mean_inference_ms": 4.434541054582108, "mean_action_processing_ms": 0.8144412033425606, "mean_env_wait_ms": 4.283586691685523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0403294563293457, "StateBufferConnector_ms": 0.02075338363647461, "ViewRequirementAgentConnector_ms": 0.3696269989013672}, "num_episodes": 18, "episode_return_max": 534.0852857201342, "episode_return_min": 387.5814052046845, "episode_return_mean": 466.9182498250469, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176, "num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 214.30710646778283, "num_env_steps_trained_throughput_per_sec": 214.30710646778283, "timesteps_total": 50176, "num_env_steps_sampled_lifetime": 50176, "num_agent_steps_sampled_lifetime": 50176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 50176, "timers": {"training_iteration_time_ms": 4519.286, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4519.187, "sample_time_ms": 1867.772, "learn_time_ms": 2615.648, "learn_throughput": 391.49, "synch_weights_time_ms": 35.276}, "counters": {"num_env_steps_sampled": 50176, "num_env_steps_trained": 50176, "num_agent_steps_sampled": 50176, "num_agent_steps_trained": 50176}, "done": false, "training_iteration": 49, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-29", "timestamp": 1744125629, "time_this_iter_s": 4.796019077301025, "time_total_s": 233.75597548484802, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0ECA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.75597548484802, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 56.65714285714286, "ram_util_percent": 86.41428571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4267088394612073, "cur_kl_coeff": 3.5527136788005006e-16, "cur_lr": 1e-07, "total_loss": 2.2028291635215282, "policy_loss": -0.0002137211209628731, "vf_loss": 9.980910497903825, "vf_explained_var": -6.593763828277588e-06, "kl": 2.9214971950741742e-06, "entropy": 2.9218471482396127, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "env_runners": {"episode_reward_max": 534.0852857201342, "episode_reward_min": 394.0109108286704, "episode_reward_mean": 467.60272916549684, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 394.0109108286704}, "policy_reward_max": {"tplp_policy": 534.0852857201342}, "policy_reward_mean": {"tplp_policy": 467.60272916549684}, "custom_metrics": {"mean_episode_reward_mean": 467.60272916549684, "mean_episode_reward_min": 394.0109108286704, "mean_episode_reward_max": 534.0852857201342}, "hist_stats": {"episode_reward": [419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [419.29270772894273, 456.6581846303767, 473.99868038926326, 487.19778298174884, 458.01486731343266, 468.328670983475, 481.4353933999653, 481.9324185692809, 444.77898028210143, 480.2971269967361, 480.92696054982105, 450.06033777271483, 451.38199365649695, 426.96847408016544, 476.08121048217777, 534.0852857201342, 458.5029662723655, 458.853304394891, 449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.488920464509353, "mean_inference_ms": 4.4187738251191435, "mean_action_processing_ms": 0.811441782096648, "mean_env_wait_ms": 4.267119165477245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03545570373535156, "StateBufferConnector_ms": 0.022224903106689453, "ViewRequirementAgentConnector_ms": 0.39467453956604004}, "num_episodes": 24, "episode_return_max": 534.0852857201342, "episode_return_min": 394.0109108286704, "episode_return_mean": 467.60272916549684, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200, "num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.51501314319688, "num_env_steps_trained_throughput_per_sec": 210.51501314319688, "timesteps_total": 51200, "num_env_steps_sampled_lifetime": 51200, "num_agent_steps_sampled_lifetime": 51200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 51200, "timers": {"training_iteration_time_ms": 4554.691, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4554.592, "sample_time_ms": 1867.352, "learn_time_ms": 2650.991, "learn_throughput": 386.271, "synch_weights_time_ms": 35.756}, "counters": {"num_env_steps_sampled": 51200, "num_env_steps_trained": 51200, "num_agent_steps_sampled": 51200, "num_agent_steps_trained": 51200}, "done": false, "training_iteration": 50, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-34", "timestamp": 1744125634, "time_this_iter_s": 4.885282754898071, "time_total_s": 238.6412582397461, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA516C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.6412582397461, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 61.68333333333334, "ram_util_percent": 86.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8962115850299597, "cur_kl_coeff": 1.7763568394002503e-16, "cur_lr": 1e-07, "total_loss": 2.2044272877275946, "policy_loss": -7.601814577355981e-05, "vf_loss": 9.987723118066787, "vf_explained_var": -5.20758330821991e-06, "kl": 8.910927471461605e-07, "entropy": 2.9242746502161028, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "env_runners": {"episode_reward_max": 556.6400586948588, "episode_reward_min": 394.0109108286704, "episode_reward_mean": 468.50666449039585, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 394.0109108286704}, "policy_reward_max": {"tplp_policy": 556.6400586948588}, "policy_reward_mean": {"tplp_policy": 468.50666449039585}, "custom_metrics": {"mean_episode_reward_mean": 468.50666449039585, "mean_episode_reward_min": 394.0109108286704, "mean_episode_reward_max": 556.6400586948588}, "hist_stats": {"episode_reward": [449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [449.21350844389883, 496.2627546866412, 459.930934036475, 467.3584914149127, 454.93466870229787, 455.6612612199091, 476.9643499286209, 460.91361656538595, 499.35087404158264, 477.96935360373664, 460.36566101564813, 420.675329635431, 478.1172765313501, 486.1336579612802, 463.8262911993779, 480.20874220056123, 464.89951899534606, 475.3574926060726, 484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4860093233966696, "mean_inference_ms": 4.410898928368711, "mean_action_processing_ms": 0.8108046218312631, "mean_env_wait_ms": 4.262601067688731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02943563461303711, "StateBufferConnector_ms": 0.017850399017333984, "ViewRequirementAgentConnector_ms": 0.4222869873046875}, "num_episodes": 18, "episode_return_max": 556.6400586948588, "episode_return_min": 394.0109108286704, "episode_return_mean": 468.50666449039585, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224, "num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 184.10317606330145, "num_env_steps_trained_throughput_per_sec": 184.10317606330145, "timesteps_total": 52224, "num_env_steps_sampled_lifetime": 52224, "num_agent_steps_sampled_lifetime": 52224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 52224, "timers": {"training_iteration_time_ms": 4634.379, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4634.279, "sample_time_ms": 1883.339, "learn_time_ms": 2713.824, "learn_throughput": 377.327, "synch_weights_time_ms": 36.742}, "counters": {"num_env_steps_sampled": 52224, "num_env_steps_trained": 52224, "num_agent_steps_sampled": 52224, "num_agent_steps_trained": 52224}, "done": false, "training_iteration": 51, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-40", "timestamp": 1744125640, "time_this_iter_s": 5.576117277145386, "time_total_s": 244.21737551689148, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F420>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.21737551689148, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 61.337500000000006, "ram_util_percent": 87.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0999573048204185, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 1e-07, "total_loss": 2.2008740052580835, "policy_loss": -9.012160589918494e-05, "vf_loss": 9.974034017324447, "vf_explained_var": -7.126480340957642e-06, "kl": 1.097673148010847e-06, "entropy": 2.925443744659424, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "env_runners": {"episode_reward_max": 556.6400586948588, "episode_reward_min": 394.0109108286704, "episode_reward_mean": 470.41956124168166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 394.0109108286704}, "policy_reward_max": {"tplp_policy": 556.6400586948588}, "policy_reward_mean": {"tplp_policy": 470.41956124168166}, "custom_metrics": {"mean_episode_reward_mean": 470.41956124168166, "mean_episode_reward_min": 394.0109108286704, "mean_episode_reward_max": 556.6400586948588}, "hist_stats": {"episode_reward": [484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [484.2417815481093, 522.2237623723097, 437.74033308073115, 394.0109108286704, 488.74752018814837, 492.21871397944983, 460.4120105197042, 449.2743988541008, 481.17038963693415, 435.51155955175926, 445.52682779512253, 487.42700227926383, 516.9726981122736, 457.8394964736207, 431.13457266002854, 484.6295688747618, 467.697999920162, 468.30022165097495, 439.04044676907813, 451.69965552330035, 440.861576630126, 448.62957074643765, 469.4906720452046, 478.4028288515983, 467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4828169401811535, "mean_inference_ms": 4.400164167425149, "mean_action_processing_ms": 0.809065744196473, "mean_env_wait_ms": 4.254303014503968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014061450958251953, "StateBufferConnector_ms": 0.016367673873901367, "ViewRequirementAgentConnector_ms": 0.3940136432647705}, "num_episodes": 18, "episode_return_max": 556.6400586948588, "episode_return_min": 394.0109108286704, "episode_return_mean": 470.41956124168166, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248, "num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.17595536464876, "num_env_steps_trained_throughput_per_sec": 210.17595536464876, "timesteps_total": 53248, "num_env_steps_sampled_lifetime": 53248, "num_agent_steps_sampled_lifetime": 53248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 53248, "timers": {"training_iteration_time_ms": 4612.298, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4612.198, "sample_time_ms": 1871.292, "learn_time_ms": 2703.434, "learn_throughput": 378.777, "synch_weights_time_ms": 37.098}, "counters": {"num_env_steps_sampled": 53248, "num_env_steps_trained": 53248, "num_agent_steps_sampled": 53248, "num_agent_steps_trained": 53248}, "done": false, "training_iteration": 52, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-45", "timestamp": 1744125645, "time_this_iter_s": 4.9056923389434814, "time_total_s": 249.12306785583496, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.12306785583496, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 59.02857142857143, "ram_util_percent": 87.45714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.225998267158866, "cur_kl_coeff": 4.440892098500626e-17, "cur_lr": 1e-07, "total_loss": 2.2063611119985582, "policy_loss": -0.00015739783411845566, "vf_loss": 9.996702241897584, "vf_explained_var": -4.297122359275818e-06, "kl": 1.1455741041777045e-06, "entropy": 2.926570476591587, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "env_runners": {"episode_reward_max": 556.6400586948588, "episode_reward_min": 418.2399375102058, "episode_reward_mean": 471.0986858435167, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.2399375102058}, "policy_reward_max": {"tplp_policy": 556.6400586948588}, "policy_reward_mean": {"tplp_policy": 471.0986858435167}, "custom_metrics": {"mean_episode_reward_mean": 471.0986858435167, "mean_episode_reward_min": 418.2399375102058, "mean_episode_reward_max": 556.6400586948588}, "hist_stats": {"episode_reward": [467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.19497319334147, 473.8205144862796, 439.6112280766982, 447.99894563210944, 493.21542607275717, 472.1585622726444, 485.70850498228185, 475.21870568161916, 471.702857131165, 434.5331534104167, 508.3856422984874, 458.9666157648394, 485.0234171662976, 452.33525116466495, 440.0516352069758, 446.85904192086383, 484.56642273984403, 522.1862094155316, 481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4822422918892142, "mean_inference_ms": 4.397229231806748, "mean_action_processing_ms": 0.8091575471259677, "mean_env_wait_ms": 4.252858918353907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020826339721679688, "StateBufferConnector_ms": 0.013546466827392578, "ViewRequirementAgentConnector_ms": 0.4854283332824707}, "num_episodes": 24, "episode_return_max": 556.6400586948588, "episode_return_min": 418.2399375102058, "episode_return_mean": 471.0986858435167, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272, "num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 180.02172415599767, "num_env_steps_trained_throughput_per_sec": 180.02172415599767, "timesteps_total": 54272, "num_env_steps_sampled_lifetime": 54272, "num_agent_steps_sampled_lifetime": 54272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 54272, "timers": {"training_iteration_time_ms": 4644.374, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4644.274, "sample_time_ms": 1893.717, "learn_time_ms": 2714.064, "learn_throughput": 377.294, "synch_weights_time_ms": 36.17}, "counters": {"num_env_steps_sampled": 54272, "num_env_steps_trained": 54272, "num_agent_steps_sampled": 54272, "num_agent_steps_trained": 54272}, "done": false, "training_iteration": 53, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-51", "timestamp": 1744125651, "time_this_iter_s": 5.701521158218384, "time_total_s": 254.82458901405334, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA511C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.82458901405334, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 66.62857142857143, "ram_util_percent": 87.92857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9166743084788322, "cur_kl_coeff": 2.220446049250313e-17, "cur_lr": 1e-07, "total_loss": 2.205344895273447, "policy_loss": -0.00012144497013650834, "vf_loss": 9.992606121301652, "vf_explained_var": -6.8034976720809935e-06, "kl": 7.138917469173834e-07, "entropy": 2.9268518328666686, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "env_runners": {"episode_reward_max": 556.6400586948588, "episode_reward_min": 418.2399375102058, "episode_reward_mean": 471.39519322893415, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.2399375102058}, "policy_reward_max": {"tplp_policy": 556.6400586948588}, "policy_reward_mean": {"tplp_policy": 471.39519322893415}, "custom_metrics": {"mean_episode_reward_mean": 471.39519322893415, "mean_episode_reward_min": 418.2399375102058, "mean_episode_reward_max": 556.6400586948588}, "hist_stats": {"episode_reward": [481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.5119950289603, 460.3805412011681, 483.87337714619593, 457.4846226214588, 456.6187281917911, 503.61594239233403, 489.32800581916297, 445.3620964379775, 457.7493012966715, 486.3162413288299, 488.00432828958935, 489.4096737167463, 464.8404471623475, 481.2366201199496, 457.74598979349065, 493.9289913540215, 440.3946195647392, 475.71632180091956, 443.97025235518544, 436.82938182658546, 475.2132700514169, 481.06141454883914, 489.12030054661705, 458.61006009953974, 466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.482340994473827, "mean_inference_ms": 4.3964782783323635, "mean_action_processing_ms": 0.809414308937348, "mean_env_wait_ms": 4.253332613106361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02182745933532715, "StateBufferConnector_ms": 0.01193690299987793, "ViewRequirementAgentConnector_ms": 0.4782388210296631}, "num_episodes": 18, "episode_return_max": 556.6400586948588, "episode_return_min": 418.2399375102058, "episode_return_mean": 471.39519322893415, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296, "num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 292.04785351012913, "num_env_steps_trained_throughput_per_sec": 292.04785351012913, "timesteps_total": 55296, "num_env_steps_sampled_lifetime": 55296, "num_agent_steps_sampled_lifetime": 55296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 55296, "timers": {"training_iteration_time_ms": 4523.687, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4523.588, "sample_time_ms": 1841.55, "learn_time_ms": 2646.023, "learn_throughput": 386.996, "synch_weights_time_ms": 35.807}, "counters": {"num_env_steps_sampled": 55296, "num_env_steps_trained": 55296, "num_agent_steps_sampled": 55296, "num_agent_steps_trained": 55296}, "done": false, "training_iteration": 54, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-54", "timestamp": 1744125654, "time_this_iter_s": 3.5147836208343506, "time_total_s": 258.3393726348877, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.3393726348877, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 45.22, "ram_util_percent": 88.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1878874197602274, "cur_kl_coeff": 1.1102230246251564e-17, "cur_lr": 1e-07, "total_loss": 2.2003130346536635, "policy_loss": -2.4495366960763932e-05, "vf_loss": 9.972239536046981, "vf_explained_var": -3.2186508178710938e-06, "kl": 4.62818402441334e-07, "entropy": 2.9272233232855798, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "env_runners": {"episode_reward_max": 556.6400586948588, "episode_reward_min": 415.51041936624597, "episode_reward_mean": 469.9941039316107, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.51041936624597}, "policy_reward_max": {"tplp_policy": 556.6400586948588}, "policy_reward_mean": {"tplp_policy": 469.9941039316107}, "custom_metrics": {"mean_episode_reward_mean": 469.9941039316107, "mean_episode_reward_min": 415.51041936624597, "mean_episode_reward_max": 556.6400586948588}, "hist_stats": {"episode_reward": [466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.4699084025259, 440.5968901070735, 455.15539969655254, 529.566589564616, 455.20796474558557, 475.7451719357681, 431.1028750439216, 481.39340342905814, 484.72951632531635, 418.4147516171466, 460.2820371858325, 489.625405878376, 556.6400586948588, 493.6097519535221, 472.8054915184564, 420.1133019492246, 483.1721185594577, 503.8569636146291, 520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4815989447699411, "mean_inference_ms": 4.393623162200019, "mean_action_processing_ms": 0.8092655076242152, "mean_env_wait_ms": 4.251728151429684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01743340492248535, "StateBufferConnector_ms": 0.010960817337036133, "ViewRequirementAgentConnector_ms": 0.4553401470184326}, "num_episodes": 24, "episode_return_max": 556.6400586948588, "episode_return_min": 415.51041936624597, "episode_return_mean": 469.9941039316107, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320, "num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 228.77230132785354, "num_env_steps_trained_throughput_per_sec": 228.77230132785354, "timesteps_total": 56320, "num_env_steps_sampled_lifetime": 56320, "num_agent_steps_sampled_lifetime": 56320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 56320, "timers": {"training_iteration_time_ms": 4575.96, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4575.86, "sample_time_ms": 1835.152, "learn_time_ms": 2704.25, "learn_throughput": 378.663, "synch_weights_time_ms": 36.149}, "counters": {"num_env_steps_sampled": 56320, "num_env_steps_trained": 56320, "num_agent_steps_sampled": 56320, "num_agent_steps_trained": 56320}, "done": false, "training_iteration": 55, "trial_id": "3bf18_00000", "date": "2025-04-08_23-20-59", "timestamp": 1744125659, "time_this_iter_s": 4.486010313034058, "time_total_s": 262.82538294792175, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.82538294792175, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 52.19999999999999, "ram_util_percent": 88.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.863004495948553, "cur_kl_coeff": 5.551115123125782e-18, "cur_lr": 1e-07, "total_loss": 2.205514355003834, "policy_loss": -1.4470831956714392e-06, "vf_loss": 9.993600249290466, "vf_explained_var": -5.242973566055298e-06, "kl": 9.809501885893468e-07, "entropy": 2.9288424000144007, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "env_runners": {"episode_reward_max": 541.3762212455873, "episode_reward_min": 415.51041936624597, "episode_reward_mean": 469.177101909107, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.51041936624597}, "policy_reward_max": {"tplp_policy": 541.3762212455873}, "policy_reward_mean": {"tplp_policy": 469.177101909107}, "custom_metrics": {"mean_episode_reward_mean": 469.177101909107, "mean_episode_reward_min": 415.51041936624597, "mean_episode_reward_max": 541.3762212455873}, "hist_stats": {"episode_reward": [520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [520.6792530741884, 496.7226543878669, 486.61478671471605, 458.7434924394532, 454.8472472806102, 483.0768653043344, 456.4623959543382, 500.42711818369094, 453.62475166122624, 459.08060550498504, 419.99495906414217, 482.06382491337246, 512.0922868264829, 492.1726125838275, 500.5227130031897, 455.2788088465989, 421.01110332784407, 446.60814032740626, 470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4802778491629072, "mean_inference_ms": 4.389182658907563, "mean_action_processing_ms": 0.808381272581164, "mean_env_wait_ms": 4.2477420524033365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017946243286132812, "StateBufferConnector_ms": 0.01146554946899414, "ViewRequirementAgentConnector_ms": 0.43297576904296875}, "num_episodes": 18, "episode_return_max": 541.3762212455873, "episode_return_min": 415.51041936624597, "episode_return_mean": 469.177101909107, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 230.06461763505055, "num_env_steps_trained_throughput_per_sec": 230.06461763505055, "timesteps_total": 57344, "num_env_steps_sampled_lifetime": 57344, "num_agent_steps_sampled_lifetime": 57344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 4601.993, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4601.893, "sample_time_ms": 1829.295, "learn_time_ms": 2736.362, "learn_throughput": 374.219, "synch_weights_time_ms": 36.034}, "counters": {"num_env_steps_sampled": 57344, "num_env_steps_trained": 57344, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "training_iteration": 56, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-04", "timestamp": 1744125664, "time_this_iter_s": 4.460712909698486, "time_total_s": 267.28609585762024, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.28609585762024, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 54.48333333333333, "ram_util_percent": 88.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0802119806408883, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 1e-07, "total_loss": 2.2025865368545055, "policy_loss": -3.730437601916492e-05, "vf_loss": 9.982670670747757, "vf_explained_var": -3.988295793533325e-06, "kl": 5.560807071702811e-07, "entropy": 2.9304383605718614, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "env_runners": {"episode_reward_max": 541.3762212455873, "episode_reward_min": 415.51041936624597, "episode_reward_mean": 468.6228241417679, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.51041936624597}, "policy_reward_max": {"tplp_policy": 541.3762212455873}, "policy_reward_mean": {"tplp_policy": 468.6228241417679}, "custom_metrics": {"mean_episode_reward_mean": 468.6228241417679, "mean_episode_reward_min": 415.51041936624597, "mean_episode_reward_max": 541.3762212455873}, "hist_stats": {"episode_reward": [470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.1115052597164, 467.2357840131215, 474.1660285094262, 454.7621072312528, 538.6388078563496, 438.96699336888776, 473.10108969654607, 431.79876335613403, 461.92061053244447, 445.7316248938694, 503.7852330782567, 418.2399375102058, 507.6702115858953, 487.7940667658972, 446.88728507937816, 487.9777727776715, 480.85961822850766, 460.4227037718411, 455.23166302222694, 462.6336950037383, 487.7557749077351, 477.8064589710205, 456.8532610105715, 453.09591147001055, 457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4793778184235848, "mean_inference_ms": 4.386838941207118, "mean_action_processing_ms": 0.8082425792008265, "mean_env_wait_ms": 4.245269971792836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03039836883544922, "StateBufferConnector_ms": 0.010945320129394531, "ViewRequirementAgentConnector_ms": 0.4508495330810547}, "num_episodes": 18, "episode_return_max": 541.3762212455873, "episode_return_min": 415.51041936624597, "episode_return_mean": 468.6228241417679, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368, "num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.59521653471882, "num_env_steps_trained_throughput_per_sec": 210.59521653471882, "timesteps_total": 58368, "num_env_steps_sampled_lifetime": 58368, "num_agent_steps_sampled_lifetime": 58368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 58368, "timers": {"training_iteration_time_ms": 4636.78, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4636.68, "sample_time_ms": 1843.02, "learn_time_ms": 2756.557, "learn_throughput": 371.478, "synch_weights_time_ms": 36.9}, "counters": {"num_env_steps_sampled": 58368, "num_env_steps_trained": 58368, "num_agent_steps_sampled": 58368, "num_agent_steps_trained": 58368}, "done": false, "training_iteration": 57, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-09", "timestamp": 1744125669, "time_this_iter_s": 4.8784520626068115, "time_total_s": 272.16454792022705, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB465C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 272.16454792022705, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 47.91428571428571, "ram_util_percent": 88.37142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0241470128297805, "cur_kl_coeff": 1.3877787807814456e-18, "cur_lr": 1e-07, "total_loss": 2.199852856993675, "policy_loss": -8.443620754405856e-05, "vf_loss": 9.97211109995842, "vf_explained_var": -4.462897777557373e-06, "kl": 5.726711190770506e-07, "entropy": 2.930904766917229, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "env_runners": {"episode_reward_max": 544.6889997918644, "episode_reward_min": 415.51041936624597, "episode_reward_mean": 468.5227521062818, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.51041936624597}, "policy_reward_max": {"tplp_policy": 544.6889997918644}, "policy_reward_mean": {"tplp_policy": 468.5227521062818}, "custom_metrics": {"mean_episode_reward_mean": 468.5227521062818, "mean_episode_reward_min": 415.51041936624597, "mean_episode_reward_max": 544.6889997918644}, "hist_stats": {"episode_reward": [457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [457.73297718637616, 448.55173567045637, 452.31131903042757, 501.670527045965, 428.67552736521145, 493.17011219981754, 441.9662416678145, 431.5345306889005, 541.3762212455873, 533.5964843388746, 478.8289941340308, 485.86969206842645, 472.17364856423274, 451.5951149330163, 495.0063158130902, 465.17923072575803, 439.48832050223467, 453.1735929457837, 415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4767628836665943, "mean_inference_ms": 4.37853530430146, "mean_action_processing_ms": 0.8067009456778743, "mean_env_wait_ms": 4.237883228363975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028516292572021484, "StateBufferConnector_ms": 0.008587360382080078, "ViewRequirementAgentConnector_ms": 0.4189114570617676}, "num_episodes": 24, "episode_return_max": 544.6889997918644, "episode_return_min": 415.51041936624597, "episode_return_mean": 468.5227521062818, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392, "num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 232.91591064225574, "num_env_steps_trained_throughput_per_sec": 232.91591064225574, "timesteps_total": 59392, "num_env_steps_sampled_lifetime": 59392, "num_agent_steps_sampled_lifetime": 59392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 59392, "timers": {"training_iteration_time_ms": 4745.697, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4745.697, "sample_time_ms": 1884.8, "learn_time_ms": 2822.874, "learn_throughput": 362.751, "synch_weights_time_ms": 37.923}, "counters": {"num_env_steps_sampled": 59392, "num_env_steps_trained": 59392, "num_agent_steps_sampled": 59392, "num_agent_steps_trained": 59392}, "done": false, "training_iteration": 58, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-13", "timestamp": 1744125673, "time_this_iter_s": 4.71361517906189, "time_total_s": 276.87816309928894, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.87816309928894, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 54.300000000000004, "ram_util_percent": 88.28333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.242970446869731, "cur_kl_coeff": 6.938893903907228e-19, "cur_lr": 1e-07, "total_loss": 2.204284342378378, "policy_loss": -0.0001553041220176965, "vf_loss": 9.990485882759094, "vf_explained_var": -5.836039781570434e-06, "kl": 1.5062292227252527e-06, "entropy": 2.931818334758282, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "env_runners": {"episode_reward_max": 544.6889997918644, "episode_reward_min": 403.0039078179237, "episode_reward_mean": 467.21629743287536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0039078179237}, "policy_reward_max": {"tplp_policy": 544.6889997918644}, "policy_reward_mean": {"tplp_policy": 467.21629743287536}, "custom_metrics": {"mean_episode_reward_mean": 467.21629743287536, "mean_episode_reward_min": 403.0039078179237, "mean_episode_reward_max": 544.6889997918644}, "hist_stats": {"episode_reward": [415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [415.51041936624597, 452.13408705551626, 491.366468877083, 470.693559526263, 460.7312957753016, 516.9557748993112, 420.5706631271286, 465.2098861299288, 471.63221146230813, 467.3927076641882, 499.2018477435313, 451.9169364915797, 471.08238902904594, 490.9563573518311, 491.0983379300806, 485.6207182747537, 468.5112744639237, 435.4474678605559, 424.76034525189954, 451.8999980239286, 483.2780540731737, 479.5808791365847, 445.45576067577383, 495.6030910475587, 458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4763376896822504, "mean_inference_ms": 4.375787312458857, "mean_action_processing_ms": 0.8063757510675339, "mean_env_wait_ms": 4.235689613229347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0332486629486084, "StateBufferConnector_ms": 0.013831853866577148, "ViewRequirementAgentConnector_ms": 0.4833700656890869}, "num_episodes": 18, "episode_return_max": 544.6889997918644, "episode_return_min": 403.0039078179237, "episode_return_mean": 467.21629743287536, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416, "num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 194.72538619506645, "num_env_steps_trained_throughput_per_sec": 194.72538619506645, "timesteps_total": 60416, "num_env_steps_sampled_lifetime": 60416, "num_agent_steps_sampled_lifetime": 60416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 60416, "timers": {"training_iteration_time_ms": 4793.747, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4793.747, "sample_time_ms": 1964.688, "learn_time_ms": 2791.096, "learn_throughput": 366.881, "synch_weights_time_ms": 37.862}, "counters": {"num_env_steps_sampled": 60416, "num_env_steps_trained": 60416, "num_agent_steps_sampled": 60416, "num_agent_steps_trained": 60416}, "done": false, "training_iteration": 59, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-19", "timestamp": 1744125679, "time_this_iter_s": 5.2708046436309814, "time_total_s": 282.1489677429199, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.1489677429199, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 52.45714285714286, "ram_util_percent": 88.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1137906573712826, "cur_kl_coeff": 3.469446951953614e-19, "cur_lr": 1e-07, "total_loss": 2.199167862534523, "policy_loss": -4.205158329568803e-05, "vf_loss": 9.970359599590301, "vf_explained_var": -6.863102316856384e-06, "kl": 1.3386307984752932e-06, "entropy": 2.933800022304058, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "env_runners": {"episode_reward_max": 544.6889997918644, "episode_reward_min": 403.0039078179237, "episode_reward_mean": 466.63614026682706, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0039078179237}, "policy_reward_max": {"tplp_policy": 544.6889997918644}, "policy_reward_mean": {"tplp_policy": 466.63614026682706}, "custom_metrics": {"mean_episode_reward_mean": 466.63614026682706, "mean_episode_reward_min": 403.0039078179237, "mean_episode_reward_max": 544.6889997918644}, "hist_stats": {"episode_reward": [458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.52153198824493, 523.1948958072937, 444.278889418826, 476.1977012556175, 435.0786029897584, 471.6519736535548, 488.63690648987125, 529.4399792609524, 479.81467294934134, 457.9725037107039, 448.00111047104315, 465.8372721878184, 444.20478135524877, 491.69546029989004, 439.8921181530647, 441.31014625699135, 456.1083974302443, 506.78775290745506, 478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4778443032594992, "mean_inference_ms": 4.377749855905664, "mean_action_processing_ms": 0.8068502012964568, "mean_env_wait_ms": 4.237152525811036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04411745071411133, "StateBufferConnector_ms": 0.018857955932617188, "ViewRequirementAgentConnector_ms": 0.5846621990203857}, "num_episodes": 24, "episode_return_max": 544.6889997918644, "episode_return_min": 403.0039078179237, "episode_return_mean": 466.63614026682706, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440, "num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 190.62939096175458, "num_env_steps_trained_throughput_per_sec": 190.62939096175458, "timesteps_total": 61440, "num_env_steps_sampled_lifetime": 61440, "num_agent_steps_sampled_lifetime": 61440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 61440, "timers": {"training_iteration_time_ms": 4844.489, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4844.489, "sample_time_ms": 2004.803, "learn_time_ms": 2801.958, "learn_throughput": 365.459, "synch_weights_time_ms": 37.627}, "counters": {"num_env_steps_sampled": 61440, "num_env_steps_trained": 61440, "num_agent_steps_sampled": 61440, "num_agent_steps_trained": 61440}, "done": false, "training_iteration": 60, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-24", "timestamp": 1744125684, "time_this_iter_s": 5.385531425476074, "time_total_s": 287.534499168396, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.534499168396, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 60.39999999999999, "ram_util_percent": 88.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.901873754709959, "cur_kl_coeff": 1.734723475976807e-19, "cur_lr": 1e-07, "total_loss": 2.206421506404877, "policy_loss": 8.518830873072147e-06, "vf_loss": 10.0, "vf_explained_var": -6.168335676193237e-06, "kl": 6.615511294327803e-07, "entropy": 2.9358700662851334, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "env_runners": {"episode_reward_max": 544.6889997918644, "episode_reward_min": 403.0039078179237, "episode_reward_mean": 467.5268782441746, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0039078179237}, "policy_reward_max": {"tplp_policy": 544.6889997918644}, "policy_reward_mean": {"tplp_policy": 467.5268782441746}, "custom_metrics": {"mean_episode_reward_mean": 467.5268782441746, "mean_episode_reward_min": 403.0039078179237, "mean_episode_reward_max": 544.6889997918644}, "hist_stats": {"episode_reward": [478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [478.8592747644756, 482.6370559180585, 452.02584554805946, 486.4365518076981, 442.76987366472457, 490.1472850100309, 478.31838064022713, 488.1209852071788, 496.38961785593955, 441.34522689985636, 446.23257246704026, 475.1234116752247, 455.3818743937223, 477.1881028087578, 453.00291823392206, 437.7207154317571, 468.620600208022, 419.1177991106013, 544.6889997918644, 479.7986904560418, 439.69855255487334, 448.60463986362555, 487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4802582716490804, "mean_inference_ms": 4.384009309867517, "mean_action_processing_ms": 0.8083562061546413, "mean_env_wait_ms": 4.24208859378537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04621696472167969, "StateBufferConnector_ms": 0.04608511924743652, "ViewRequirementAgentConnector_ms": 0.5919132232666016}, "num_episodes": 18, "episode_return_max": 544.6889997918644, "episode_return_min": 403.0039078179237, "episode_return_mean": 467.5268782441746, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464, "num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 164.8561572439556, "num_env_steps_trained_throughput_per_sec": 164.8561572439556, "timesteps_total": 62464, "num_env_steps_sampled_lifetime": 62464, "num_agent_steps_sampled_lifetime": 62464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 62464, "timers": {"training_iteration_time_ms": 4909.426, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4909.426, "sample_time_ms": 2049.872, "learn_time_ms": 2822.076, "learn_throughput": 362.853, "synch_weights_time_ms": 37.378}, "counters": {"num_env_steps_sampled": 62464, "num_env_steps_trained": 62464, "num_agent_steps_sampled": 62464, "num_agent_steps_trained": 62464}, "done": false, "training_iteration": 61, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-31", "timestamp": 1744125691, "time_this_iter_s": 6.228840351104736, "time_total_s": 293.76333951950073, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.76333951950073, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 64.1875, "ram_util_percent": 88.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9998366929590703, "cur_kl_coeff": 8.673617379884035e-20, "cur_lr": 1e-07, "total_loss": 2.201182294636965, "policy_loss": -6.469147629104555e-05, "vf_loss": 9.980086833238602, "vf_explained_var": -3.7472695112228393e-06, "kl": 1.3672375406170722e-06, "entropy": 2.9377472773194313, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "env_runners": {"episode_reward_max": 523.5561727537765, "episode_reward_min": 403.0039078179237, "episode_reward_mean": 467.827760511673, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0039078179237}, "policy_reward_max": {"tplp_policy": 523.5561727537765}, "policy_reward_mean": {"tplp_policy": 467.827760511673}, "custom_metrics": {"mean_episode_reward_mean": 467.827760511673, "mean_episode_reward_min": 403.0039078179237, "mean_episode_reward_max": 523.5561727537765}, "hist_stats": {"episode_reward": [487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.33023698289566, 464.83346651023663, 469.92307767246706, 499.89137808233437, 462.76137678869287, 454.3374685148156, 458.16667706430326, 446.490732697393, 475.5321717949227, 453.7245700034946, 482.4123104535876, 467.6490123092345, 462.9977477157479, 503.48122991800403, 459.9118707348319, 458.55458488300116, 457.68701857859634, 467.2254916625107, 464.04642834351847, 446.1148771827644, 423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.482646642650248, "mean_inference_ms": 4.388013801872692, "mean_action_processing_ms": 0.8092778817885049, "mean_env_wait_ms": 4.244409343861935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03342580795288086, "StateBufferConnector_ms": 0.044974565505981445, "ViewRequirementAgentConnector_ms": 0.6169416904449463}, "num_episodes": 22, "episode_return_max": 523.5561727537765, "episode_return_min": 403.0039078179237, "episode_return_mean": 467.827760511673, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488, "num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.81849470096057, "num_env_steps_trained_throughput_per_sec": 217.81849470096057, "timesteps_total": 63488, "num_env_steps_sampled_lifetime": 63488, "num_agent_steps_sampled_lifetime": 63488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 63488, "timers": {"training_iteration_time_ms": 4892.332, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4892.332, "sample_time_ms": 2053.473, "learn_time_ms": 2800.718, "learn_throughput": 365.621, "synch_weights_time_ms": 38.04}, "counters": {"num_env_steps_sampled": 63488, "num_env_steps_trained": 63488, "num_agent_steps_sampled": 63488, "num_agent_steps_trained": 63488}, "done": false, "training_iteration": 62, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-35", "timestamp": 1744125695, "time_this_iter_s": 4.715731859207153, "time_total_s": 298.4790713787079, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 298.4790713787079, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 50.457142857142856, "ram_util_percent": 88.55714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7622192692011596, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 1e-07, "total_loss": 2.2035746321082117, "policy_loss": -3.0228745890781285e-05, "vf_loss": 9.99044571518898, "vf_explained_var": -6.42240047454834e-06, "kl": 1.4682028565360384e-06, "entropy": 2.9400655329227448, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "env_runners": {"episode_reward_max": 543.8948852443203, "episode_reward_min": 403.0039078179237, "episode_reward_mean": 468.0973740071967, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.0039078179237}, "policy_reward_max": {"tplp_policy": 543.8948852443203}, "policy_reward_mean": {"tplp_policy": 468.0973740071967}, "custom_metrics": {"mean_episode_reward_mean": 468.0973740071967, "mean_episode_reward_min": 403.0039078179237, "mean_episode_reward_max": 543.8948852443203}, "hist_stats": {"episode_reward": [423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [423.71038475222883, 455.43535971383665, 469.1651693989107, 488.24765624837875, 454.84870434568256, 476.1878863779626, 456.2497693412147, 457.7907613647476, 464.67028472236336, 486.28776421054226, 515.7147241518661, 435.6504874073689, 454.39847176332364, 466.17630888893353, 523.5561727537765, 403.0039078179237, 485.3398088499374, 471.39425376282, 459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4861972474042733, "mean_inference_ms": 4.399017060439689, "mean_action_processing_ms": 0.8120833457737792, "mean_env_wait_ms": 4.255119295533598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398394584655762, "StateBufferConnector_ms": 0.04646944999694824, "ViewRequirementAgentConnector_ms": 0.6353363990783691}, "num_episodes": 20, "episode_return_max": 543.8948852443203, "episode_return_min": 403.0039078179237, "episode_return_mean": 468.0973740071967, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512, "num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 161.45762178818592, "num_env_steps_trained_throughput_per_sec": 161.45762178818592, "timesteps_total": 64512, "num_env_steps_sampled_lifetime": 64512, "num_agent_steps_sampled_lifetime": 64512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 64512, "timers": {"training_iteration_time_ms": 4957.734, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4957.734, "sample_time_ms": 2106.853, "learn_time_ms": 2811.623, "learn_throughput": 364.202, "synch_weights_time_ms": 39.057}, "counters": {"num_env_steps_sampled": 64512, "num_env_steps_trained": 64512, "num_agent_steps_sampled": 64512, "num_agent_steps_trained": 64512}, "done": false, "training_iteration": 63, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-42", "timestamp": 1744125702, "time_this_iter_s": 6.355936765670776, "time_total_s": 304.83500814437866, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA51DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 304.83500814437866, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 61.975, "ram_util_percent": 88.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1110518779605627, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 1e-07, "total_loss": 2.20326826646924, "policy_loss": -0.00013925363891758024, "vf_loss": 9.990445601940156, "vf_explained_var": -6.33634626865387e-06, "kl": 1.5121502058512704e-06, "entropy": 2.942038710415363, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "env_runners": {"episode_reward_max": 543.8948852443203, "episode_reward_min": 424.00393258352636, "episode_reward_mean": 468.81176671007955, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.00393258352636}, "policy_reward_max": {"tplp_policy": 543.8948852443203}, "policy_reward_mean": {"tplp_policy": 468.81176671007955}, "custom_metrics": {"mean_episode_reward_mean": 468.81176671007955, "mean_episode_reward_min": 424.00393258352636, "mean_episode_reward_max": 543.8948852443203}, "hist_stats": {"episode_reward": [459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.20158259975364, 499.1502727651871, 442.5424823845843, 490.9244744148016, 458.72202609528847, 457.6911754719034, 447.04584063777367, 428.11331413966144, 448.66732582399635, 438.4469144718749, 476.20306420491335, 480.2325484292192, 459.87996000930434, 472.40104390397124, 461.09627766901036, 497.4205325183471, 446.3698404777388, 455.45288771776285, 449.20363241401765, 513.030132361749, 458.79728698784095, 451.26813652121416, 475.6400513510971, 431.04704508267594, 499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4899165400024075, "mean_inference_ms": 4.41023039945102, "mean_action_processing_ms": 0.8148248782781919, "mean_env_wait_ms": 4.264281214071416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030971527099609375, "StateBufferConnector_ms": 0.044252634048461914, "ViewRequirementAgentConnector_ms": 0.6361629962921143}, "num_episodes": 18, "episode_return_max": 543.8948852443203, "episode_return_min": 424.00393258352636, "episode_return_mean": 468.81176671007955, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 191.89272297489867, "num_env_steps_trained_throughput_per_sec": 191.89272297489867, "timesteps_total": 65536, "num_env_steps_sampled_lifetime": 65536, "num_agent_steps_sampled_lifetime": 65536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 5140.738, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5140.738, "sample_time_ms": 2204.703, "learn_time_ms": 2895.967, "learn_throughput": 353.595, "synch_weights_time_ms": 39.867}, "counters": {"num_env_steps_sampled": 65536, "num_env_steps_trained": 65536, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "training_iteration": 64, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-47", "timestamp": 1744125707, "time_this_iter_s": 5.357824802398682, "time_total_s": 310.19283294677734, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.19283294677734, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 58.585714285714275, "ram_util_percent": 88.25714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3377713900059462, "cur_kl_coeff": 1.0842021724855043e-20, "cur_lr": 1e-07, "total_loss": 2.202881249785423, "policy_loss": -0.00011784869129769505, "vf_loss": 9.98970524072647, "vf_explained_var": -4.176050424575806e-06, "kl": 2.438823407846513e-06, "entropy": 2.9442721575498583, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "env_runners": {"episode_reward_max": 543.8948852443203, "episode_reward_min": 423.95940002636416, "episode_reward_mean": 469.86373522703195, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.95940002636416}, "policy_reward_max": {"tplp_policy": 543.8948852443203}, "policy_reward_mean": {"tplp_policy": 469.86373522703195}, "custom_metrics": {"mean_episode_reward_mean": 469.86373522703195, "mean_episode_reward_min": 423.95940002636416, "mean_episode_reward_max": 543.8948852443203}, "hist_stats": {"episode_reward": [499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.21534317963693, 512.4721637036332, 473.8324409303047, 454.1756037934981, 483.7587174437709, 505.0971009892991, 480.297013110183, 453.6229058122064, 467.43324338216723, 496.72098863679054, 451.3543579334429, 453.29337844844537, 478.7149399409583, 472.13861845581425, 494.42864398324207, 464.4559381435055, 500.29769635510684, 480.11259073737585, 477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.496111127619846, "mean_inference_ms": 4.427942140435086, "mean_action_processing_ms": 0.8193024043136348, "mean_env_wait_ms": 4.28030421377417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021175384521484375, "StateBufferConnector_ms": 0.04311633110046387, "ViewRequirementAgentConnector_ms": 0.6577768325805664}, "num_episodes": 24, "episode_return_max": 543.8948852443203, "episode_return_min": 423.95940002636416, "episode_return_mean": 469.86373522703195, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560, "num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 163.18404922473877, "num_env_steps_trained_throughput_per_sec": 163.18404922473877, "timesteps_total": 66560, "num_env_steps_sampled_lifetime": 66560, "num_agent_steps_sampled_lifetime": 66560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 66560, "timers": {"training_iteration_time_ms": 5320.643, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5320.643, "sample_time_ms": 2384.741, "learn_time_ms": 2895.858, "learn_throughput": 353.608, "synch_weights_time_ms": 39.818}, "counters": {"num_env_steps_sampled": 66560, "num_env_steps_trained": 66560, "num_agent_steps_sampled": 66560, "num_agent_steps_trained": 66560}, "done": false, "training_iteration": 65, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-54", "timestamp": 1744125714, "time_this_iter_s": 6.289862155914307, "time_total_s": 316.48269510269165, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 316.48269510269165, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 57.78571428571428, "ram_util_percent": 88.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2441727690398694, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 1e-07, "total_loss": 2.205207934975624, "policy_loss": -8.126681204885244e-05, "vf_loss": 10.0, "vf_explained_var": -5.624070763587952e-06, "kl": 1.7205021248578588e-06, "entropy": 2.947107933461666, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "env_runners": {"episode_reward_max": 543.8948852443203, "episode_reward_min": 423.95940002636416, "episode_reward_mean": 468.06349664240906, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.95940002636416}, "policy_reward_max": {"tplp_policy": 543.8948852443203}, "policy_reward_mean": {"tplp_policy": 468.06349664240906}, "custom_metrics": {"mean_episode_reward_mean": 468.06349664240906, "mean_episode_reward_min": 423.95940002636416, "mean_episode_reward_max": 543.8948852443203}, "hist_stats": {"episode_reward": [477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [477.81811730118966, 489.72564933749493, 473.25980255489895, 473.018004768026, 439.16047732257414, 449.87338497641304, 471.68235321340006, 468.89521635560556, 455.47639411997415, 517.7504358094089, 469.41140893514296, 490.9231770823248, 469.884085698082, 424.00393258352636, 438.52864945179243, 472.9358678030737, 462.16700950394744, 430.48880193174574, 491.5742043411136, 465.3299408793263, 435.11140518675995, 543.8948852443203, 474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4997278727932233, "mean_inference_ms": 4.43692417012236, "mean_action_processing_ms": 0.8216101683292841, "mean_env_wait_ms": 4.288921310817393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014838933944702148, "StateBufferConnector_ms": 0.016448974609375, "ViewRequirementAgentConnector_ms": 0.6448030471801758}, "num_episodes": 18, "episode_return_max": 543.8948852443203, "episode_return_min": 423.95940002636416, "episode_return_mean": 468.06349664240906, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584, "num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 216.0763701710714, "num_env_steps_trained_throughput_per_sec": 216.0763701710714, "timesteps_total": 67584, "num_env_steps_sampled_lifetime": 67584, "num_agent_steps_sampled_lifetime": 67584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 67584, "timers": {"training_iteration_time_ms": 5349.457, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5349.457, "sample_time_ms": 2401.809, "learn_time_ms": 2908.823, "learn_throughput": 352.032, "synch_weights_time_ms": 38.6}, "counters": {"num_env_steps_sampled": 67584, "num_env_steps_trained": 67584, "num_agent_steps_sampled": 67584, "num_agent_steps_trained": 67584}, "done": false, "training_iteration": 66, "trial_id": "3bf18_00000", "date": "2025-04-08_23-21-59", "timestamp": 1744125719, "time_this_iter_s": 4.750896453857422, "time_total_s": 321.2335915565491, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.2335915565491, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 50.214285714285715, "ram_util_percent": 88.45714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9192045267671345, "cur_kl_coeff": 2.710505431213761e-21, "cur_lr": 1e-07, "total_loss": 2.2050688937306404, "policy_loss": -4.250855417922139e-05, "vf_loss": 10.0, "vf_explained_var": -2.5443732738494873e-06, "kl": 9.079515000301464e-07, "entropy": 2.9488859504461287, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "env_runners": {"episode_reward_max": 522.059976879245, "episode_reward_min": 423.95940002636416, "episode_reward_mean": 468.09765404025165, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.95940002636416}, "policy_reward_max": {"tplp_policy": 522.059976879245}, "policy_reward_mean": {"tplp_policy": 468.09765404025165}, "custom_metrics": {"mean_episode_reward_mean": 468.09765404025165, "mean_episode_reward_min": 423.95940002636416, "mean_episode_reward_max": 522.059976879245}, "hist_stats": {"episode_reward": [474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.2818200017611, 454.2590844306866, 486.2615787291503, 449.5663890539163, 433.1639995527387, 445.1921601702759, 468.16713423721495, 484.99210830908385, 469.0184888088086, 522.059976879245, 443.0818442218621, 489.200131589393, 471.2677060108527, 478.80477634246313, 464.0543796762841, 439.447414496169, 464.94020522008583, 453.26758928463477, 496.2812848661993, 443.0538813443037, 509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5039531607978216, "mean_inference_ms": 4.446864224902065, "mean_action_processing_ms": 0.8242103609303413, "mean_env_wait_ms": 4.298684069665481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01584148406982422, "StateBufferConnector_ms": 0.016460180282592773, "ViewRequirementAgentConnector_ms": 0.6469473838806152}, "num_episodes": 22, "episode_return_max": 522.059976879245, "episode_return_min": 423.95940002636416, "episode_return_mean": 468.09765404025165, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608, "num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 224.06310499781387, "num_env_steps_trained_throughput_per_sec": 224.06310499781387, "timesteps_total": 68608, "num_env_steps_sampled_lifetime": 68608, "num_agent_steps_sampled_lifetime": 68608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 68608, "timers": {"training_iteration_time_ms": 5320.231, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5320.231, "sample_time_ms": 2362.963, "learn_time_ms": 2918.746, "learn_throughput": 350.836, "synch_weights_time_ms": 38.145}, "counters": {"num_env_steps_sampled": 68608, "num_env_steps_trained": 68608, "num_agent_steps_sampled": 68608, "num_agent_steps_trained": 68608}, "done": false, "training_iteration": 67, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-03", "timestamp": 1744125723, "time_this_iter_s": 4.5839011669158936, "time_total_s": 325.81749272346497, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47060>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.81749272346497, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 56.66666666666668, "ram_util_percent": 88.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.130600923486054, "cur_kl_coeff": 1.3552527156068804e-21, "cur_lr": 1e-07, "total_loss": 2.195008970797062, "policy_loss": -0.00010334820108255371, "vf_loss": 9.960787028074265, "vf_explained_var": -5.957484245300293e-06, "kl": 1.6728594534498597e-06, "entropy": 2.950844256579876, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "env_runners": {"episode_reward_max": 533.790715637696, "episode_reward_min": 418.86669515191124, "episode_reward_mean": 469.5028862553702, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.86669515191124}, "policy_reward_max": {"tplp_policy": 533.790715637696}, "policy_reward_mean": {"tplp_policy": 469.5028862553702}, "custom_metrics": {"mean_episode_reward_mean": 469.5028862553702, "mean_episode_reward_min": 418.86669515191124, "mean_episode_reward_max": 533.790715637696}, "hist_stats": {"episode_reward": [509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.8403134372634, 483.60923285720344, 481.7710876974979, 454.7694242087484, 468.85199286107223, 449.48957144075234, 487.9451431061356, 492.706594151333, 445.1874923561102, 448.684523936637, 495.92807586530284, 450.3926604504365, 472.89464285499247, 442.3457256887689, 457.9903802922984, 477.52511874505956, 469.11811259772026, 476.9779506949443, 458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5066160220754443, "mean_inference_ms": 4.453478356707852, "mean_action_processing_ms": 0.8258639633176729, "mean_env_wait_ms": 4.304176766082654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011131525039672852, "StateBufferConnector_ms": 0.014977693557739258, "ViewRequirementAgentConnector_ms": 0.586162805557251}, "num_episodes": 20, "episode_return_max": 533.790715637696, "episode_return_min": 418.86669515191124, "episode_return_mean": 469.5028862553702, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632, "num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 214.61187164963084, "num_env_steps_trained_throughput_per_sec": 214.61187164963084, "timesteps_total": 69632, "num_env_steps_sampled_lifetime": 69632, "num_agent_steps_sampled_lifetime": 69632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 69632, "timers": {"training_iteration_time_ms": 5357.727, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5357.727, "sample_time_ms": 2388.69, "learn_time_ms": 2929.321, "learn_throughput": 349.569, "synch_weights_time_ms": 39.341}, "counters": {"num_env_steps_sampled": 69632, "num_env_steps_trained": 69632, "num_agent_steps_sampled": 69632, "num_agent_steps_trained": 69632}, "done": false, "training_iteration": 68, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-08", "timestamp": 1744125728, "time_this_iter_s": 4.785236835479736, "time_total_s": 330.6027295589447, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 330.6027295589447, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 57.74285714285714, "ram_util_percent": 88.51428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1888216339051723, "cur_kl_coeff": 6.776263578034402e-22, "cur_lr": 1e-07, "total_loss": 2.2046624422073364, "policy_loss": -8.254990389104933e-05, "vf_loss": 10.0, "vf_explained_var": -5.640089511871338e-06, "kl": 9.796306040144031e-07, "entropy": 2.952549970149994, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "env_runners": {"episode_reward_max": 533.790715637696, "episode_reward_min": 412.8299044303014, "episode_reward_mean": 470.1658094387162, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.8299044303014}, "policy_reward_max": {"tplp_policy": 533.790715637696}, "policy_reward_mean": {"tplp_policy": 470.1658094387162}, "custom_metrics": {"mean_episode_reward_mean": 470.1658094387162, "mean_episode_reward_min": 412.8299044303014, "mean_episode_reward_max": 533.790715637696}, "hist_stats": {"episode_reward": [458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.82292564124435, 437.41253108479094, 501.02780109455136, 458.42967641805984, 493.0360528865394, 435.61203507799695, 471.63012632997527, 465.62833740724795, 476.57051136953606, 447.7408874871896, 442.7218672839583, 486.08145795882484, 502.574803837273, 460.62891076398137, 514.0267929870092, 454.8766506837315, 463.9379396811361, 473.12912498771385, 486.54867480576326, 436.16637845295224, 423.95940002636416, 467.0857505904226, 475.24194393341924, 457.76359107238443, 483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.507525994911627, "mean_inference_ms": 4.454939515093921, "mean_action_processing_ms": 0.8265996277983944, "mean_env_wait_ms": 4.307265705320651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012972593307495117, "StateBufferConnector_ms": 0.010045528411865234, "ViewRequirementAgentConnector_ms": 0.5157623291015625}, "num_episodes": 18, "episode_return_max": 533.790715637696, "episode_return_min": 412.8299044303014, "episode_return_mean": 470.1658094387162, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656, "num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 242.98986144663516, "num_env_steps_trained_throughput_per_sec": 242.98986144663516, "timesteps_total": 70656, "num_env_steps_sampled_lifetime": 70656, "num_agent_steps_sampled_lifetime": 70656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 70656, "timers": {"training_iteration_time_ms": 5253.275, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5253.176, "sample_time_ms": 2365.527, "learn_time_ms": 2849.401, "learn_throughput": 359.374, "synch_weights_time_ms": 37.872}, "counters": {"num_env_steps_sampled": 70656, "num_env_steps_trained": 70656, "num_agent_steps_sampled": 70656, "num_agent_steps_trained": 70656}, "done": false, "training_iteration": 69, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-13", "timestamp": 1744125733, "time_this_iter_s": 4.225571155548096, "time_total_s": 334.8283007144928, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 334.8283007144928, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 48.63333333333333, "ram_util_percent": 88.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3274716094136236, "cur_kl_coeff": 3.388131789017201e-22, "cur_lr": 1e-07, "total_loss": 2.201452512294054, "policy_loss": -8.893025806173682e-05, "vf_loss": 9.987760466337203, "vf_explained_var": -6.2160193920135495e-06, "kl": 1.593530655252806e-06, "entropy": 2.9539866626262663, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "env_runners": {"episode_reward_max": 533.790715637696, "episode_reward_min": 412.8299044303014, "episode_reward_mean": 470.62038572224134, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.8299044303014}, "policy_reward_max": {"tplp_policy": 533.790715637696}, "policy_reward_mean": {"tplp_policy": 470.62038572224134}, "custom_metrics": {"mean_episode_reward_mean": 470.62038572224134, "mean_episode_reward_min": 412.8299044303014, "mean_episode_reward_max": 533.790715637696}, "hist_stats": {"episode_reward": [483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.7127370572008, 471.7425872396609, 487.57152755612407, 455.50267513805784, 498.1833994781419, 444.9167318419272, 427.60292589877236, 426.4901774377092, 454.04757863413516, 514.9094929148056, 463.99479067242316, 474.7196996062094, 479.52816949919736, 510.9632879500895, 432.408859385742, 482.0976512010963, 477.22747851193566, 446.6117939938653, 482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5058139895025093, "mean_inference_ms": 4.449288617434966, "mean_action_processing_ms": 0.8259037912040051, "mean_env_wait_ms": 4.303571784767143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014280319213867188, "StateBufferConnector_ms": 0.009688377380371094, "ViewRequirementAgentConnector_ms": 0.47395801544189453}, "num_episodes": 24, "episode_return_max": 533.790715637696, "episode_return_min": 412.8299044303014, "episode_return_mean": 470.62038572224134, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680, "num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 219.46810317256205, "num_env_steps_trained_throughput_per_sec": 219.46810317256205, "timesteps_total": 71680, "num_env_steps_sampled_lifetime": 71680, "num_agent_steps_sampled_lifetime": 71680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 71680, "timers": {"training_iteration_time_ms": 5182.69, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5182.591, "sample_time_ms": 2305.634, "learn_time_ms": 2838.894, "learn_throughput": 360.704, "synch_weights_time_ms": 37.686}, "counters": {"num_env_steps_sampled": 71680, "num_env_steps_trained": 71680, "num_agent_steps_sampled": 71680, "num_agent_steps_trained": 71680}, "done": false, "training_iteration": 70, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-17", "timestamp": 1744125737, "time_this_iter_s": 4.679860830307007, "time_total_s": 339.5081615447998, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA52C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 339.5081615447998, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 70.41666666666667, "ram_util_percent": 88.63333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2931099206209185, "cur_kl_coeff": 1.6940658945086005e-22, "cur_lr": 1e-07, "total_loss": 2.202270924299955, "policy_loss": -7.881995989009739e-05, "vf_loss": 9.991754162311555, "vf_explained_var": -6.241351366043091e-06, "kl": 1.2348088472863283e-06, "entropy": 2.9558878019452095, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "env_runners": {"episode_reward_max": 533.790715637696, "episode_reward_min": 412.8299044303014, "episode_reward_mean": 470.74795355317656, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.8299044303014}, "policy_reward_max": {"tplp_policy": 533.790715637696}, "policy_reward_mean": {"tplp_policy": 470.74795355317656}, "custom_metrics": {"mean_episode_reward_mean": 470.74795355317656, "mean_episode_reward_min": 412.8299044303014, "mean_episode_reward_max": 533.790715637696}, "hist_stats": {"episode_reward": [482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.9199950554619, 477.11514677326403, 481.5491420125257, 472.3034287092429, 457.0579046914877, 461.2521175183736, 454.7990695512702, 490.4512809803158, 469.58399001354974, 477.9380483136218, 461.53102132805753, 451.8491685178333, 444.8148908469406, 493.5011239942203, 488.10185331024275, 477.2477838648448, 454.3031322746436, 465.7716460384285, 455.7635870648851, 472.6353408193908, 467.7841558422131, 452.6669806071351, 479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5056875744245752, "mean_inference_ms": 4.448221396640182, "mean_action_processing_ms": 0.8256739230401854, "mean_env_wait_ms": 4.302820943512717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019042253494262695, "StateBufferConnector_ms": 0.014744997024536133, "ViewRequirementAgentConnector_ms": 0.533989429473877}, "num_episodes": 18, "episode_return_max": 533.790715637696, "episode_return_min": 412.8299044303014, "episode_return_mean": 470.74795355317656, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704, "num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 188.436388831073, "num_env_steps_trained_throughput_per_sec": 188.436388831073, "timesteps_total": 72704, "num_env_steps_sampled_lifetime": 72704, "num_agent_steps_sampled_lifetime": 72704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 72704, "timers": {"training_iteration_time_ms": 5104.962, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5104.863, "sample_time_ms": 2280.569, "learn_time_ms": 2786.384, "learn_throughput": 367.501, "synch_weights_time_ms": 37.534}, "counters": {"num_env_steps_sampled": 72704, "num_env_steps_trained": 72704, "num_agent_steps_sampled": 72704, "num_agent_steps_trained": 72704}, "done": false, "training_iteration": 71, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-23", "timestamp": 1744125743, "time_this_iter_s": 5.749849319458008, "time_total_s": 345.2580108642578, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C7C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 345.2580108642578, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 59.525, "ram_util_percent": 86.875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.173013601079583, "cur_kl_coeff": 8.470329472543003e-23, "cur_lr": 1e-07, "total_loss": 2.2017936654388905, "policy_loss": -8.74778430443257e-05, "vf_loss": 9.990441817045213, "vf_explained_var": -5.9638172388076786e-06, "kl": 1.0217188497918527e-06, "entropy": 2.9572930172085763, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "env_runners": {"episode_reward_max": 533.790715637696, "episode_reward_min": 412.8299044303014, "episode_reward_mean": 469.3787344662617, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.8299044303014}, "policy_reward_max": {"tplp_policy": 533.790715637696}, "policy_reward_mean": {"tplp_policy": 469.3787344662617}, "custom_metrics": {"mean_episode_reward_mean": 469.3787344662617, "mean_episode_reward_min": 412.8299044303014, "mean_episode_reward_max": 533.790715637696}, "hist_stats": {"episode_reward": [479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [479.17111252371717, 468.85932047233155, 455.4048066672814, 480.98518784231015, 455.9349512717726, 513.8372853600464, 482.36072141533657, 532.3022042638944, 450.9424986378701, 481.99892934986275, 488.5735269137734, 418.86669515191124, 461.272013350668, 472.5944750368736, 476.4189619422466, 460.68802138971114, 533.790715637696, 436.43261106033276, 489.94349834144936, 498.4005276700424, 466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5069385769503236, "mean_inference_ms": 4.450786811110226, "mean_action_processing_ms": 0.8261854536990407, "mean_env_wait_ms": 4.305067725916668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01874542236328125, "StateBufferConnector_ms": 0.021462202072143555, "ViewRequirementAgentConnector_ms": 0.5338375568389893}, "num_episodes": 22, "episode_return_max": 533.790715637696, "episode_return_min": 412.8299044303014, "episode_return_mean": 469.3787344662617, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 182.80984039451474, "num_env_steps_trained_throughput_per_sec": 182.80984039451474, "timesteps_total": 73728, "num_env_steps_sampled_lifetime": 73728, "num_agent_steps_sampled_lifetime": 73728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 5194.991, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5194.892, "sample_time_ms": 2372.203, "learn_time_ms": 2786.223, "learn_throughput": 367.523, "synch_weights_time_ms": 36.088}, "counters": {"num_env_steps_sampled": 73728, "num_env_steps_trained": 73728, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "training_iteration": 72, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-29", "timestamp": 1744125749, "time_this_iter_s": 5.6106181144714355, "time_total_s": 350.86862897872925, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.86862897872925, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 86.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.129072222113609, "cur_kl_coeff": 4.2351647362715013e-23, "cur_lr": 1e-07, "total_loss": 2.201703006774187, "policy_loss": -3.594286972656846e-05, "vf_loss": 9.990441673994065, "vf_explained_var": -3.754720091819763e-06, "kl": 9.940963312471408e-07, "entropy": 2.9587147355079653, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "env_runners": {"episode_reward_max": 538.7551057128516, "episode_reward_min": 412.8299044303014, "episode_reward_mean": 467.2167603407122, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 412.8299044303014}, "policy_reward_max": {"tplp_policy": 538.7551057128516}, "policy_reward_mean": {"tplp_policy": 467.2167603407122}, "custom_metrics": {"mean_episode_reward_mean": 467.2167603407122, "mean_episode_reward_min": 412.8299044303014, "mean_episode_reward_max": 538.7551057128516}, "hist_stats": {"episode_reward": [466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.9393070825465, 493.49420562789265, 500.4405388013643, 521.2427951706127, 412.8299044303014, 457.9913309892508, 522.2238216253539, 425.78656741196363, 498.54443904417855, 450.0832591395126, 461.52571654221, 433.99773786108875, 491.5745007094345, 471.4778795571303, 464.3827019404967, 471.4416296320417, 451.6066053547284, 444.05753816671944, 436.8083630939841, 478.23402249522013, 456.836267431128, 445.8646189835622, 474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5079643362994062, "mean_inference_ms": 4.452308565886288, "mean_action_processing_ms": 0.8266835173856393, "mean_env_wait_ms": 4.3071521081992294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01766657829284668, "StateBufferConnector_ms": 0.021656274795532227, "ViewRequirementAgentConnector_ms": 0.542123556137085}, "num_episodes": 20, "episode_return_max": 538.7551057128516, "episode_return_min": 412.8299044303014, "episode_return_mean": 467.2167603407122, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752, "num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 165.94132162006636, "num_env_steps_trained_throughput_per_sec": 165.94132162006636, "timesteps_total": 74752, "num_env_steps_sampled_lifetime": 74752, "num_agent_steps_sampled_lifetime": 74752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 74752, "timers": {"training_iteration_time_ms": 5177.854, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5177.755, "sample_time_ms": 2283.934, "learn_time_ms": 2857.323, "learn_throughput": 358.377, "synch_weights_time_ms": 36.221}, "counters": {"num_env_steps_sampled": 74752, "num_env_steps_trained": 74752, "num_agent_steps_sampled": 74752, "num_agent_steps_trained": 74752}, "done": false, "training_iteration": 73, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-35", "timestamp": 1744125755, "time_this_iter_s": 6.187818288803101, "time_total_s": 357.05644726753235, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C0E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.05644726753235, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 71.0888888888889, "ram_util_percent": 87.21111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6980301097035406, "cur_kl_coeff": 2.1175823681357507e-23, "cur_lr": 1e-07, "total_loss": 2.2022499620914457, "policy_loss": -0.00018109158554580063, "vf_loss": 9.993823331594466, "vf_explained_var": -1.4774501323699952e-06, "kl": 1.543797122693924e-06, "entropy": 2.9602477073669435, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "env_runners": {"episode_reward_max": 538.7551057128516, "episode_reward_min": 417.25676653379725, "episode_reward_mean": 468.99604515850166, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.25676653379725}, "policy_reward_max": {"tplp_policy": 538.7551057128516}, "policy_reward_mean": {"tplp_policy": 468.99604515850166}, "custom_metrics": {"mean_episode_reward_mean": 468.99604515850166, "mean_episode_reward_min": 417.25676653379725, "mean_episode_reward_max": 538.7551057128516}, "hist_stats": {"episode_reward": [474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.75911288015743, 491.40487786923677, 476.9659882176033, 470.1917967013131, 430.2331940260412, 527.3120653804143, 453.34357789620543, 482.0927618119612, 482.0927322872093, 458.991112088533, 460.00120358549526, 533.5794976482006, 458.7755292144455, 483.3538768450408, 441.83104024311797, 472.6046587694681, 477.9315698894374, 447.2397893353703, 458.6490190293062, 450.8773897899171, 481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5108513501304914, "mean_inference_ms": 4.458330246707772, "mean_action_processing_ms": 0.827253584835828, "mean_env_wait_ms": 4.310246582266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01833176612854004, "StateBufferConnector_ms": 0.019116878509521484, "ViewRequirementAgentConnector_ms": 0.5884346961975098}, "num_episodes": 22, "episode_return_max": 538.7551057128516, "episode_return_min": 417.25676653379725, "episode_return_mean": 468.99604515850166, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776, "num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 137.0258632463815, "num_env_steps_trained_throughput_per_sec": 137.0258632463815, "timesteps_total": 75776, "num_env_steps_sampled_lifetime": 75776, "num_agent_steps_sampled_lifetime": 75776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 75776, "timers": {"training_iteration_time_ms": 5391.527, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5391.428, "sample_time_ms": 2294.811, "learn_time_ms": 3059.158, "learn_throughput": 334.733, "synch_weights_time_ms": 37.182}, "counters": {"num_env_steps_sampled": 75776, "num_env_steps_trained": 75776, "num_agent_steps_sampled": 75776, "num_agent_steps_trained": 75776}, "done": false, "training_iteration": 74, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-43", "timestamp": 1744125763, "time_this_iter_s": 7.489171743392944, "time_total_s": 364.5456190109253, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 364.5456190109253, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 83.36666666666666, "ram_util_percent": 90.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.961287319846451, "cur_kl_coeff": 1.0587911840678753e-23, "cur_lr": 1e-07, "total_loss": 2.1981209978461265, "policy_loss": -1.4969485346227884e-05, "vf_loss": 9.977105838060378, "vf_explained_var": -3.6969780921936034e-06, "kl": 4.185426675462622e-07, "entropy": 2.9614048182964323, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "env_runners": {"episode_reward_max": 538.7551057128516, "episode_reward_min": 417.25676653379725, "episode_reward_mean": 468.66244175858657, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.25676653379725}, "policy_reward_max": {"tplp_policy": 538.7551057128516}, "policy_reward_mean": {"tplp_policy": 468.66244175858657}, "custom_metrics": {"mean_episode_reward_mean": 468.66244175858657, "mean_episode_reward_min": 417.25676653379725, "mean_episode_reward_max": 538.7551057128516}, "hist_stats": {"episode_reward": [481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.08055107575325, 476.05558412627516, 477.09914816968904, 514.6221760680243, 472.3575152902784, 476.4590846680792, 458.8931999171361, 454.74859833140914, 454.02071348082416, 433.4656976259448, 474.5637835427185, 452.4287645613654, 520.3939004349165, 494.47963818751265, 435.18366807711567, 459.60991473433904, 465.6416723653274, 453.9233892538068, 464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5129425170117101, "mean_inference_ms": 4.466549206316606, "mean_action_processing_ms": 0.828653379270297, "mean_env_wait_ms": 4.317724476015072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014763355255126953, "StateBufferConnector_ms": 0.020298480987548828, "ViewRequirementAgentConnector_ms": 0.5862898826599121}, "num_episodes": 20, "episode_return_max": 538.7551057128516, "episode_return_min": 417.25676653379725, "episode_return_mean": 468.66244175858657, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800, "num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 261.2276146756906, "num_env_steps_trained_throughput_per_sec": 261.2276146756906, "timesteps_total": 76800, "num_env_steps_sampled_lifetime": 76800, "num_agent_steps_sampled_lifetime": 76800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 76800, "timers": {"training_iteration_time_ms": 5156.01, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5155.911, "sample_time_ms": 2133.597, "learn_time_ms": 2985.368, "learn_throughput": 343.006, "synch_weights_time_ms": 36.795}, "counters": {"num_env_steps_sampled": 76800, "num_env_steps_trained": 76800, "num_agent_steps_sampled": 76800, "num_agent_steps_trained": 76800}, "done": false, "training_iteration": 75, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-47", "timestamp": 1744125767, "time_this_iter_s": 3.92850661277771, "time_total_s": 368.474125623703, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 368.474125623703, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 52.779999999999994, "ram_util_percent": 90.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.724147532135248, "cur_kl_coeff": 5.293955920339377e-24, "cur_lr": 1e-07, "total_loss": 2.2021470569074153, "policy_loss": -0.0001415419828845188, "vf_loss": 9.99450887441635, "vf_explained_var": -7.602199912071228e-06, "kl": 2.435232079878169e-06, "entropy": 2.9633861109614372, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "env_runners": {"episode_reward_max": 538.7551057128516, "episode_reward_min": 416.7477388991847, "episode_reward_mean": 467.20453839166663, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.7477388991847}, "policy_reward_max": {"tplp_policy": 538.7551057128516}, "policy_reward_mean": {"tplp_policy": 467.20453839166663}, "custom_metrics": {"mean_episode_reward_mean": 467.20453839166663, "mean_episode_reward_min": 416.7477388991847, "mean_episode_reward_max": 538.7551057128516}, "hist_stats": {"episode_reward": [464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.9740579477063, 522.10457781866, 431.41334680950854, 423.73240366228043, 472.0545341733966, 445.9128404167542, 441.04001015656587, 493.91257771025715, 477.9710748578873, 485.83880645230084, 474.9441633913092, 486.3592987009829, 464.40335485253496, 449.5944299500498, 474.41364623416064, 452.68773801915444, 459.36289706857576, 428.04842404014255, 434.0347781264688, 471.6508774286275, 461.2263759670413, 428.6736111121273, 453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5126467985135599, "mean_inference_ms": 4.466074357366214, "mean_action_processing_ms": 0.8285946608388435, "mean_env_wait_ms": 4.318032661860039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014502525329589844, "StateBufferConnector_ms": 0.017855167388916016, "ViewRequirementAgentConnector_ms": 0.5084669589996338}, "num_episodes": 18, "episode_return_max": 538.7551057128516, "episode_return_min": 416.7477388991847, "episode_return_mean": 467.20453839166663, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824, "num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 256.92164111428394, "num_env_steps_trained_throughput_per_sec": 256.92164111428394, "timesteps_total": 77824, "num_env_steps_sampled_lifetime": 77824, "num_agent_steps_sampled_lifetime": 77824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 77824, "timers": {"training_iteration_time_ms": 5080.668, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5080.569, "sample_time_ms": 2067.863, "learn_time_ms": 2975.377, "learn_throughput": 344.158, "synch_weights_time_ms": 37.179}, "counters": {"num_env_steps_sampled": 77824, "num_env_steps_trained": 77824, "num_agent_steps_sampled": 77824, "num_agent_steps_trained": 77824}, "done": false, "training_iteration": 76, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-51", "timestamp": 1744125771, "time_this_iter_s": 3.9984822273254395, "time_total_s": 372.47260785102844, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 372.47260785102844, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 47.46666666666667, "ram_util_percent": 90.68333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.166489256173372, "cur_kl_coeff": 2.6469779601696883e-24, "cur_lr": 1e-07, "total_loss": 2.202307288348675, "policy_loss": -6.637892220169306e-05, "vf_loss": 9.995941317081451, "vf_explained_var": -6.685405969619751e-06, "kl": 1.2564801015635396e-06, "entropy": 2.9661166846752165, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "env_runners": {"episode_reward_max": 546.6510392431469, "episode_reward_min": 411.98978606544034, "episode_reward_mean": 471.3321047783955, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.98978606544034}, "policy_reward_max": {"tplp_policy": 546.6510392431469}, "policy_reward_mean": {"tplp_policy": 471.3321047783955}, "custom_metrics": {"mean_episode_reward_mean": 471.3321047783955, "mean_episode_reward_min": 411.98978606544034, "mean_episode_reward_max": 546.6510392431469}, "hist_stats": {"episode_reward": [453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.9441187250101, 417.25676653379725, 510.53544716342714, 448.90983713266513, 538.7551057128516, 466.1114446778838, 467.0803788498714, 468.6850778862766, 484.80561247344235, 466.3791247542706, 451.3212654647766, 478.018169229215, 464.863593720792, 480.1293942634995, 452.44701088252464, 474.61194364560066, 463.64150674441885, 445.1848668046982, 477.4413642976811, 435.5339564610868, 450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5106721033237338, "mean_inference_ms": 4.462220336519573, "mean_action_processing_ms": 0.8274280453680519, "mean_env_wait_ms": 4.315177271953681, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01897883415222168, "StateBufferConnector_ms": 0.012624502182006836, "ViewRequirementAgentConnector_ms": 0.4631524085998535}, "num_episodes": 22, "episode_return_max": 546.6510392431469, "episode_return_min": 411.98978606544034, "episode_return_mean": 471.3321047783955, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848, "num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 223.02402820499134, "num_env_steps_trained_throughput_per_sec": 223.02402820499134, "timesteps_total": 78848, "num_env_steps_sampled_lifetime": 78848, "num_agent_steps_sampled_lifetime": 78848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 78848, "timers": {"training_iteration_time_ms": 5082.798, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5082.698, "sample_time_ms": 2056.378, "learn_time_ms": 2988.488, "learn_throughput": 342.648, "synch_weights_time_ms": 37.73}, "counters": {"num_env_steps_sampled": 78848, "num_env_steps_trained": 78848, "num_agent_steps_sampled": 78848, "num_agent_steps_trained": 78848}, "done": false, "training_iteration": 77, "trial_id": "3bf18_00000", "date": "2025-04-08_23-22-56", "timestamp": 1744125776, "time_this_iter_s": 4.603641986846924, "time_total_s": 377.07624983787537, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA50F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 377.07624983787537, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 58.21666666666667, "ram_util_percent": 90.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1361150301992895, "cur_kl_coeff": 1.3234889800848442e-24, "cur_lr": 1e-07, "total_loss": 2.2001347787678243, "policy_loss": -7.3197454912588e-05, "vf_loss": 9.987931817770004, "vf_explained_var": -6.001815199851989e-06, "kl": 1.088329772391816e-06, "entropy": 2.9677497893571854, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "env_runners": {"episode_reward_max": 546.6510392431469, "episode_reward_min": 411.98978606544034, "episode_reward_mean": 472.5566049928229, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.98978606544034}, "policy_reward_max": {"tplp_policy": 546.6510392431469}, "policy_reward_mean": {"tplp_policy": 472.5566049928229}, "custom_metrics": {"mean_episode_reward_mean": 472.5566049928229, "mean_episode_reward_min": 411.98978606544034, "mean_episode_reward_max": 546.6510392431469}, "hist_stats": {"episode_reward": [450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.60217690567896, 496.8098397999267, 501.5079632348087, 500.5799368265442, 493.261107068092, 517.9107382215365, 469.5263872078553, 438.0208695807109, 466.8548971335233, 487.8583248830678, 445.56742304699003, 485.0385611231365, 477.81785275923727, 457.37218950095075, 466.1993276539571, 469.66757842692607, 506.890168662375, 445.5224272474392, 487.403101751187, 457.9260410769563, 499.46630004225193, 445.44692979556953, 499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5088226411796664, "mean_inference_ms": 4.459578594391667, "mean_action_processing_ms": 0.8265128001159863, "mean_env_wait_ms": 4.3130757708956295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01806020736694336, "StateBufferConnector_ms": 0.011908531188964844, "ViewRequirementAgentConnector_ms": 0.4669358730316162}, "num_episodes": 20, "episode_return_max": 546.6510392431469, "episode_return_min": 411.98978606544034, "episode_return_mean": 472.5566049928229, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872, "num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.91084120667688, "num_env_steps_trained_throughput_per_sec": 204.91084120667688, "timesteps_total": 79872, "num_env_steps_sampled_lifetime": 79872, "num_agent_steps_sampled_lifetime": 79872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 79872, "timers": {"training_iteration_time_ms": 5105.387, "restore_workers_time_ms": 0.099, "training_step_time_ms": 5105.288, "sample_time_ms": 2070.191, "learn_time_ms": 2998.598, "learn_throughput": 341.493, "synch_weights_time_ms": 36.396}, "counters": {"num_env_steps_sampled": 79872, "num_env_steps_trained": 79872, "num_agent_steps_sampled": 79872, "num_agent_steps_trained": 79872}, "done": false, "training_iteration": 78, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-01", "timestamp": 1744125781, "time_this_iter_s": 5.007314920425415, "time_total_s": 382.0835647583008, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 382.0835647583008, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 56.92857142857143, "ram_util_percent": 90.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.940921477228403, "cur_kl_coeff": 6.617444900424221e-25, "cur_lr": 1e-07, "total_loss": 2.20103824660182, "policy_loss": 2.586920163594186e-06, "vf_loss": 9.991923624277115, "vf_explained_var": -8.011981844902038e-06, "kl": 8.682243158864011e-07, "entropy": 2.969452512264252, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "env_runners": {"episode_reward_max": 546.6510392431469, "episode_reward_min": 411.98978606544034, "episode_reward_mean": 471.86198777070734, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.98978606544034}, "policy_reward_max": {"tplp_policy": 546.6510392431469}, "policy_reward_mean": {"tplp_policy": 471.86198777070734}, "custom_metrics": {"mean_episode_reward_mean": 471.86198777070734, "mean_episode_reward_min": 411.98978606544034, "mean_episode_reward_max": 546.6510392431469}, "hist_stats": {"episode_reward": [499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.92115908075164, 494.0691297477965, 441.3343238960866, 488.42095045777086, 451.26780684865366, 469.20091466997735, 465.51260108950333, 508.0035134428969, 447.94068524206216, 506.00757237449113, 449.1561143747952, 466.9076009027633, 493.8259991715219, 448.24334392876017, 442.3701107395996, 441.80478403522034, 462.55731610007564, 477.41329757641654, 462.44247231394877, 449.6040294315618, 499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5062209982465304, "mean_inference_ms": 4.4535326093819405, "mean_action_processing_ms": 0.8247629192286804, "mean_env_wait_ms": 4.308202094367852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016844987869262695, "StateBufferConnector_ms": 0.020422935485839844, "ViewRequirementAgentConnector_ms": 0.41364502906799316}, "num_episodes": 22, "episode_return_max": 546.6510392431469, "episode_return_min": 411.98978606544034, "episode_return_mean": 471.86198777070734, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896, "num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 234.43111954620775, "num_env_steps_trained_throughput_per_sec": 234.43111954620775, "timesteps_total": 80896, "num_env_steps_sampled_lifetime": 80896, "num_agent_steps_sampled_lifetime": 80896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 80896, "timers": {"training_iteration_time_ms": 5120.903, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5120.772, "sample_time_ms": 2078.265, "learn_time_ms": 3004.863, "learn_throughput": 340.781, "synch_weights_time_ms": 37.265}, "counters": {"num_env_steps_sampled": 80896, "num_env_steps_trained": 80896, "num_agent_steps_sampled": 80896, "num_agent_steps_trained": 80896}, "done": false, "training_iteration": 79, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-05", "timestamp": 1744125785, "time_this_iter_s": 4.401880502700806, "time_total_s": 386.4854452610016, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.4854452610016, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 48.83333333333334, "ram_util_percent": 90.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.900892636552453, "cur_kl_coeff": 3.3087224502121104e-25, "cur_lr": 1e-07, "total_loss": 2.2028069525957106, "policy_loss": -2.810977166518569e-05, "vf_loss": 10.0, "vf_explained_var": -8.024647831916809e-06, "kl": 1.0841094574498556e-06, "entropy": 2.9716494143009187, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "env_runners": {"episode_reward_max": 546.6510392431469, "episode_reward_min": 411.98978606544034, "episode_reward_mean": 472.3800622964959, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 411.98978606544034}, "policy_reward_max": {"tplp_policy": 546.6510392431469}, "policy_reward_mean": {"tplp_policy": 472.3800622964959}, "custom_metrics": {"mean_episode_reward_mean": 472.3800622964959, "mean_episode_reward_min": 411.98978606544034, "mean_episode_reward_max": 546.6510392431469}, "hist_stats": {"episode_reward": [499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.0543258274001, 423.3987896473094, 475.097283534704, 463.8213341961077, 463.659301937903, 464.9955884198089, 512.6960949080079, 490.1835455667768, 445.1846135464562, 416.7477388991847, 461.0076381633919, 500.715678652678, 425.42648668388705, 417.8033295938602, 456.79557652151703, 480.6028353740218, 453.3181314641502, 485.68217822222744, 464.1647345938642, 437.1772439762242, 476.64330107901407, 463.4284050305275, 470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5039850106373631, "mean_inference_ms": 4.449522412365961, "mean_action_processing_ms": 0.8235072292253269, "mean_env_wait_ms": 4.304543740414336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01841568946838379, "StateBufferConnector_ms": 0.022125720977783203, "ViewRequirementAgentConnector_ms": 0.4281625747680664}, "num_episodes": 20, "episode_return_max": 546.6510392431469, "episode_return_min": 411.98978606544034, "episode_return_mean": 472.3800622964959, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 228.8513766567474, "num_env_steps_trained_throughput_per_sec": 228.8513766567474, "timesteps_total": 81920, "num_env_steps_sampled_lifetime": 81920, "num_agent_steps_sampled_lifetime": 81920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 5101.772, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5101.641, "sample_time_ms": 2106.592, "learn_time_ms": 2958.144, "learn_throughput": 346.163, "synch_weights_time_ms": 36.527}, "counters": {"num_env_steps_sampled": 81920, "num_env_steps_trained": 81920, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "training_iteration": 80, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-10", "timestamp": 1744125790, "time_this_iter_s": 4.488269567489624, "time_total_s": 390.9737148284912, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 390.9737148284912, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 56.43333333333334, "ram_util_percent": 90.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1864214804023505, "cur_kl_coeff": 1.6543612251060552e-25, "cur_lr": 1e-07, "total_loss": 2.1955206006765366, "policy_loss": -6.675972836092114e-05, "vf_loss": 9.971786588430405, "vf_explained_var": -4.088133573532105e-06, "kl": 1.1242982262515966e-06, "entropy": 2.973592720925808, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "env_runners": {"episode_reward_max": 546.6510392431469, "episode_reward_min": 410.4515433630444, "episode_reward_mean": 474.44480993181446, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 410.4515433630444}, "policy_reward_max": {"tplp_policy": 546.6510392431469}, "policy_reward_mean": {"tplp_policy": 474.44480993181446}, "custom_metrics": {"mean_episode_reward_mean": 474.44480993181446, "mean_episode_reward_min": 410.4515433630444, "mean_episode_reward_max": 546.6510392431469}, "hist_stats": {"episode_reward": [470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [470.93573741567576, 472.9369830145442, 481.29936263450236, 479.59186428240395, 411.98978606544034, 485.4114786348975, 519.8573819213575, 454.6862235367952, 483.7531030029147, 546.6510392431469, 519.5857947035499, 490.1489137668672, 523.9902725120639, 505.91618607664753, 476.7727569982206, 453.1695853943315, 470.112714088555, 513.663711770641, 466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5046657390716265, "mean_inference_ms": 4.450792287816637, "mean_action_processing_ms": 0.8229857549166717, "mean_env_wait_ms": 4.304514857292903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01697850227355957, "StateBufferConnector_ms": 0.02443552017211914, "ViewRequirementAgentConnector_ms": 0.5009005069732666}, "num_episodes": 22, "episode_return_max": 546.6510392431469, "episode_return_min": 410.4515433630444, "episode_return_mean": 474.44480993181446, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944, "num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 175.5351111517631, "num_env_steps_trained_throughput_per_sec": 175.5351111517631, "timesteps_total": 82944, "num_env_steps_sampled_lifetime": 82944, "num_agent_steps_sampled_lifetime": 82944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 82944, "timers": {"training_iteration_time_ms": 5141.712, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5141.581, "sample_time_ms": 2124.084, "learn_time_ms": 2980.94, "learn_throughput": 343.516, "synch_weights_time_ms": 36.041}, "counters": {"num_env_steps_sampled": 82944, "num_env_steps_trained": 82944, "num_agent_steps_sampled": 82944, "num_agent_steps_trained": 82944}, "done": false, "training_iteration": 81, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-16", "timestamp": 1744125796, "time_this_iter_s": 5.84844183921814, "time_total_s": 396.82215666770935, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44E00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 396.82215666770935, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 56.0625, "ram_util_percent": 90.0375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9664763074368237, "cur_kl_coeff": 8.271806125530276e-26, "cur_lr": 1e-07, "total_loss": 2.2013894699513914, "policy_loss": 1.0327098425477744e-05, "vf_loss": 9.995468425750733, "vf_explained_var": -7.554888725280762e-06, "kl": 3.5038255381536486e-07, "entropy": 2.9748795479536057, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "env_runners": {"episode_reward_max": 544.6304283645457, "episode_reward_min": 410.4515433630444, "episode_reward_mean": 471.85689127860553, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 410.4515433630444}, "policy_reward_max": {"tplp_policy": 544.6304283645457}, "policy_reward_mean": {"tplp_policy": 471.85689127860553}, "custom_metrics": {"mean_episode_reward_mean": 471.85689127860553, "mean_episode_reward_min": 410.4515433630444, "mean_episode_reward_max": 544.6304283645457}, "hist_stats": {"episode_reward": [466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.65532170579297, 468.87627262480925, 477.04764508228334, 544.6304283645457, 469.0455553122626, 487.15885177047727, 468.2354703139829, 512.3338633400663, 423.5153658842973, 490.34619949142245, 457.99629316782296, 439.79558347080456, 475.3870935866302, 477.2602807627162, 465.85392514636806, 482.53822205239504, 456.56876283328717, 421.084446097374, 422.99042992172843, 455.110315541206, 491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5047474687259175, "mean_inference_ms": 4.4563509803149675, "mean_action_processing_ms": 0.8239512732095906, "mean_env_wait_ms": 4.307225474095272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013248205184936523, "StateBufferConnector_ms": 0.022919654846191406, "ViewRequirementAgentConnector_ms": 0.535940408706665}, "num_episodes": 18, "episode_return_max": 544.6304283645457, "episode_return_min": 410.4515433630444, "episode_return_mean": 471.85689127860553, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968, "num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 236.57589809191134, "num_env_steps_trained_throughput_per_sec": 236.57589809191134, "timesteps_total": 83968, "num_env_steps_sampled_lifetime": 83968, "num_agent_steps_sampled_lifetime": 83968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 83968, "timers": {"training_iteration_time_ms": 5014.409, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5014.278, "sample_time_ms": 2060.027, "learn_time_ms": 2917.335, "learn_throughput": 351.005, "synch_weights_time_ms": 36.4}, "counters": {"num_env_steps_sampled": 83968, "num_env_steps_trained": 83968, "num_agent_steps_sampled": 83968, "num_agent_steps_trained": 83968}, "done": false, "training_iteration": 82, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-21", "timestamp": 1744125801, "time_this_iter_s": 4.341599702835083, "time_total_s": 401.16375637054443, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 401.16375637054443, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.150000000000006, "ram_util_percent": 90.21666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.248436961323023, "cur_kl_coeff": 4.135903062765138e-26, "cur_lr": 1e-07, "total_loss": 2.198359651863575, "policy_loss": -0.0001677284250035882, "vf_loss": 9.984688293933868, "vf_explained_var": -1.0138005018234253e-05, "kl": 2.352985331816049e-06, "entropy": 2.976446859538555, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "env_runners": {"episode_reward_max": 517.8375316318755, "episode_reward_min": 410.4515433630444, "episode_reward_mean": 471.5719233098058, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 410.4515433630444}, "policy_reward_max": {"tplp_policy": 517.8375316318755}, "policy_reward_mean": {"tplp_policy": 471.5719233098058}, "custom_metrics": {"mean_episode_reward_mean": 471.5719233098058, "mean_episode_reward_min": 410.4515433630444, "mean_episode_reward_max": 517.8375316318755}, "hist_stats": {"episode_reward": [491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.5793628907247, 481.29918381928053, 479.6959645265041, 501.24563557735974, 483.2849062039512, 477.81367616882756, 428.4152437497693, 491.30604845532605, 471.0629297569653, 492.24100828725125, 446.96255322285776, 467.69724840034047, 474.9552288281855, 475.6433131198886, 479.1716825822574, 464.2620478053865, 507.99152075423916, 461.05765379340033, 483.2185131045357, 460.78395322718285, 469.85138427295885, 450.0677245052472, 484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5040878104994184, "mean_inference_ms": 4.455571906275248, "mean_action_processing_ms": 0.8237408412927287, "mean_env_wait_ms": 4.30500890731614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01917243003845215, "StateBufferConnector_ms": 0.023883342742919922, "ViewRequirementAgentConnector_ms": 0.5054299831390381}, "num_episodes": 20, "episode_return_max": 517.8375316318755, "episode_return_min": 410.4515433630444, "episode_return_mean": 471.5719233098058, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992, "num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 241.29416094583536, "num_env_steps_trained_throughput_per_sec": 241.29416094583536, "timesteps_total": 84992, "num_env_steps_sampled_lifetime": 84992, "num_agent_steps_sampled_lifetime": 84992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 84992, "timers": {"training_iteration_time_ms": 4821.701, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4821.571, "sample_time_ms": 1993.253, "learn_time_ms": 2792.307, "learn_throughput": 366.722, "synch_weights_time_ms": 35.493}, "counters": {"num_env_steps_sampled": 84992, "num_env_steps_trained": 84992, "num_agent_steps_sampled": 84992, "num_agent_steps_trained": 84992}, "done": false, "training_iteration": 83, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-25", "timestamp": 1744125805, "time_this_iter_s": 4.257001876831055, "time_total_s": 405.4207582473755, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 405.4207582473755, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 52.68333333333334, "ram_util_percent": 90.16666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6398912228643896, "cur_kl_coeff": 2.067951531382569e-26, "cur_lr": 1e-07, "total_loss": 2.195387464761734, "policy_loss": -0.0001959123066626489, "vf_loss": 9.973870521783828, "vf_explained_var": -9.302422404289245e-06, "kl": 2.0462358557349346e-06, "entropy": 2.978842456638813, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "env_runners": {"episode_reward_max": 553.1282457487581, "episode_reward_min": 410.4515433630444, "episode_reward_mean": 471.0415229559165, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 410.4515433630444}, "policy_reward_max": {"tplp_policy": 553.1282457487581}, "policy_reward_mean": {"tplp_policy": 471.0415229559165}, "custom_metrics": {"mean_episode_reward_mean": 471.0415229559165, "mean_episode_reward_min": 410.4515433630444, "mean_episode_reward_max": 553.1282457487581}, "hist_stats": {"episode_reward": [484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [484.90820236063564, 446.53492196888584, 430.79073801737036, 469.1763917300096, 488.9902996289526, 470.4521610248747, 465.4392721611009, 459.72099786109317, 517.8375316318755, 468.77948602311375, 502.2881865139659, 488.97646531438664, 422.71305028444954, 466.96125762250176, 488.1320044436969, 465.72827780494373, 480.50397620951685, 479.9588486239265, 489.30799284364116, 468.1934992859083, 476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.504039289383137, "mean_inference_ms": 4.457608825440778, "mean_action_processing_ms": 0.8240497490620953, "mean_env_wait_ms": 4.304809158738895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016602277755737305, "StateBufferConnector_ms": 0.015937089920043945, "ViewRequirementAgentConnector_ms": 0.5246636867523193}, "num_episodes": 22, "episode_return_max": 553.1282457487581, "episode_return_min": 410.4515433630444, "episode_return_mean": 471.0415229559165, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016, "num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 180.97002848055945, "num_env_steps_trained_throughput_per_sec": 180.97002848055945, "timesteps_total": 86016, "num_env_steps_sampled_lifetime": 86016, "num_agent_steps_sampled_lifetime": 86016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 86016, "timers": {"training_iteration_time_ms": 4640.237, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4640.106, "sample_time_ms": 1973.687, "learn_time_ms": 2631.926, "learn_throughput": 389.069, "synch_weights_time_ms": 33.873}, "counters": {"num_env_steps_sampled": 86016, "num_env_steps_trained": 86016, "num_agent_steps_sampled": 86016, "num_agent_steps_trained": 86016}, "done": false, "training_iteration": 84, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-31", "timestamp": 1744125811, "time_this_iter_s": 5.672086477279663, "time_total_s": 411.09284472465515, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 411.09284472465515, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 57.875, "ram_util_percent": 90.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.246186312288046, "cur_kl_coeff": 1.0339757656912845e-26, "cur_lr": 1e-07, "total_loss": 2.1993191920220854, "policy_loss": -0.00023058283841237426, "vf_loss": 9.990431398153305, "vf_explained_var": -6.216764450073242e-06, "kl": 2.4781077550273256e-06, "entropy": 2.9805806249380113, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "env_runners": {"episode_reward_max": 553.1282457487581, "episode_reward_min": 410.4515433630444, "episode_reward_mean": 471.22077379454936, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 410.4515433630444}, "policy_reward_max": {"tplp_policy": 553.1282457487581}, "policy_reward_mean": {"tplp_policy": 471.22077379454936}, "custom_metrics": {"mean_episode_reward_mean": 471.22077379454936, "mean_episode_reward_min": 410.4515433630444, "mean_episode_reward_max": 553.1282457487581}, "hist_stats": {"episode_reward": [476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [476.7885437169518, 513.1986522186863, 442.39948755821723, 478.72143161625456, 457.2219403196963, 443.0779927983779, 492.8555142694848, 485.70547398387697, 499.33398891320087, 439.2132663609785, 463.4703673278863, 490.88311621615276, 410.4515433630444, 466.089697899734, 513.3072840563726, 468.930954625658, 451.72552145198284, 493.019147112588, 471.4714782259624, 468.7120252062245, 483.6374262703405, 475.57311614936776, 427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5041485598917166, "mean_inference_ms": 4.461314914532967, "mean_action_processing_ms": 0.8246836735275782, "mean_env_wait_ms": 4.304855458969474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014094352722167969, "StateBufferConnector_ms": 0.018718957901000977, "ViewRequirementAgentConnector_ms": 0.5427312850952148}, "num_episodes": 20, "episode_return_max": 553.1282457487581, "episode_return_min": 410.4515433630444, "episode_return_mean": 471.22077379454936, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040, "num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 196.2797011151514, "num_env_steps_trained_throughput_per_sec": 196.2797011151514, "timesteps_total": 87040, "num_env_steps_sampled_lifetime": 87040, "num_agent_steps_sampled_lifetime": 87040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 87040, "timers": {"training_iteration_time_ms": 4769.946, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4769.815, "sample_time_ms": 2013.669, "learn_time_ms": 2720.059, "learn_throughput": 376.462, "synch_weights_time_ms": 35.467}, "counters": {"num_env_steps_sampled": 87040, "num_env_steps_trained": 87040, "num_agent_steps_sampled": 87040, "num_agent_steps_trained": 87040}, "done": false, "training_iteration": 85, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-36", "timestamp": 1744125816, "time_this_iter_s": 5.294717788696289, "time_total_s": 416.38756251335144, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0EDE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 416.38756251335144, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 61.942857142857136, "ram_util_percent": 90.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.712419991195202, "cur_kl_coeff": 5.1698788284564225e-27, "cur_lr": 1e-07, "total_loss": 2.201766323298216, "policy_loss": -1.5915330732241272e-05, "vf_loss": 10.0, "vf_explained_var": -9.088218212127685e-06, "kl": 1.111713359477906e-06, "entropy": 2.9821776375174522, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "env_runners": {"episode_reward_max": 553.1282457487581, "episode_reward_min": 413.59751409217296, "episode_reward_mean": 473.9704019578128, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.59751409217296}, "policy_reward_max": {"tplp_policy": 553.1282457487581}, "policy_reward_mean": {"tplp_policy": 473.9704019578128}, "custom_metrics": {"mean_episode_reward_mean": 473.9704019578128, "mean_episode_reward_min": 413.59751409217296, "mean_episode_reward_max": 553.1282457487581}, "hist_stats": {"episode_reward": [427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [427.73014077280624, 489.6144791667117, 489.41779008848624, 465.81558394195247, 450.727947085252, 488.54155228669373, 470.3326309127566, 480.62236129571477, 483.0161829594418, 477.393586509442, 470.5298764102527, 471.65634391565317, 484.0451699748703, 477.81174996746734, 471.323770974687, 443.89132105975233, 478.9634218630222, 468.91051301273, 456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.503558630705266, "mean_inference_ms": 4.462740190618558, "mean_action_processing_ms": 0.824832457473193, "mean_env_wait_ms": 4.302745455704706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0139617919921875, "StateBufferConnector_ms": 0.015766620635986328, "ViewRequirementAgentConnector_ms": 0.5313653945922852}, "num_episodes": 22, "episode_return_max": 553.1282457487581, "episode_return_min": 413.59751409217296, "episode_return_mean": 473.9704019578128, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064, "num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 248.396790145391, "num_env_steps_trained_throughput_per_sec": 248.396790145391, "timesteps_total": 88064, "num_env_steps_sampled_lifetime": 88064, "num_agent_steps_sampled_lifetime": 88064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 88064, "timers": {"training_iteration_time_ms": 4783.625, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4783.352, "sample_time_ms": 2068.136, "learn_time_ms": 2679.651, "learn_throughput": 382.139, "synch_weights_time_ms": 34.943}, "counters": {"num_env_steps_sampled": 88064, "num_env_steps_trained": 88064, "num_agent_steps_sampled": 88064, "num_agent_steps_trained": 88064}, "done": false, "training_iteration": 86, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-40", "timestamp": 1744125820, "time_this_iter_s": 4.130337476730347, "time_total_s": 420.5178999900818, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 420.5178999900818, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 90.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2778442218899726, "cur_kl_coeff": 2.5849394142282113e-27, "cur_lr": 1e-07, "total_loss": 2.199101210385561, "policy_loss": -6.073417607694864e-05, "vf_loss": 9.990327095985412, "vf_explained_var": -4.589557647705078e-06, "kl": 1.1538573255198692e-06, "entropy": 2.9841981813311578, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "env_runners": {"episode_reward_max": 553.1282457487581, "episode_reward_min": 413.59751409217296, "episode_reward_mean": 473.2133425712261, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.59751409217296}, "policy_reward_max": {"tplp_policy": 553.1282457487581}, "policy_reward_mean": {"tplp_policy": 473.2133425712261}, "custom_metrics": {"mean_episode_reward_mean": 473.2133425712261, "mean_episode_reward_min": 413.59751409217296, "mean_episode_reward_max": 553.1282457487581}, "hist_stats": {"episode_reward": [456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [456.93970505707006, 469.8239147309246, 475.2527755551987, 476.1625348815906, 473.62492299567197, 416.80964133564675, 477.50775534143617, 464.43971476266995, 444.5643369128361, 444.7620263055042, 449.62922906993697, 481.18730380332966, 462.1796657388202, 472.3472405255989, 482.5155532470129, 447.3335030929042, 482.1877977234839, 508.7919736349155, 489.5440352482978, 434.1411554736033, 501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5030873313548017, "mean_inference_ms": 4.46498259848031, "mean_action_processing_ms": 0.8256143686919782, "mean_env_wait_ms": 4.302336778386882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016312599182128906, "StateBufferConnector_ms": 0.01880192756652832, "ViewRequirementAgentConnector_ms": 0.5301802158355713}, "num_episodes": 18, "episode_return_max": 553.1282457487581, "episode_return_min": 413.59751409217296, "episode_return_mean": 473.2133425712261, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088, "num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 207.18864175016546, "num_env_steps_trained_throughput_per_sec": 207.18864175016546, "timesteps_total": 89088, "num_env_steps_sampled_lifetime": 89088, "num_agent_steps_sampled_lifetime": 89088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 89088, "timers": {"training_iteration_time_ms": 4818.717, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4818.444, "sample_time_ms": 2127.249, "learn_time_ms": 2656.234, "learn_throughput": 385.508, "synch_weights_time_ms": 34.443}, "counters": {"num_env_steps_sampled": 89088, "num_env_steps_trained": 89088, "num_agent_steps_sampled": 89088, "num_agent_steps_trained": 89088}, "done": false, "training_iteration": 87, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-45", "timestamp": 1744125825, "time_this_iter_s": 4.951356887817383, "time_total_s": 425.46925687789917, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 425.46925687789917, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 53.74285714285715, "ram_util_percent": 90.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0392354909330606, "cur_kl_coeff": 1.2924697071141056e-27, "cur_lr": 1e-07, "total_loss": 2.201339427381754, "policy_loss": -3.271697205491364e-05, "vf_loss": 10.0, "vf_explained_var": -6.3676387071609495e-06, "kl": 1.6468529474789052e-06, "entropy": 2.9862783372402193, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "env_runners": {"episode_reward_max": 553.1282457487581, "episode_reward_min": 413.59751409217296, "episode_reward_mean": 475.172200257173, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.59751409217296}, "policy_reward_max": {"tplp_policy": 553.1282457487581}, "policy_reward_mean": {"tplp_policy": 475.172200257173}, "custom_metrics": {"mean_episode_reward_mean": 475.172200257173, "mean_episode_reward_min": 413.59751409217296, "mean_episode_reward_max": 553.1282457487581}, "hist_stats": {"episode_reward": [501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [501.63578712279184, 494.27922899253093, 553.1282457487581, 431.9219433877382, 458.31768154394456, 491.56658286251434, 518.504000854605, 471.06996258972663, 552.6474391569955, 423.26396096614747, 494.3316619235066, 429.01837610610056, 441.81506596153724, 446.22472309337957, 421.34938794725826, 432.0503132073968, 451.2381811167172, 528.3687268327569, 490.5527315214281, 431.5975560057909, 464.9503274589203, 487.80048450084746, 518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5031323094626798, "mean_inference_ms": 4.469407884237132, "mean_action_processing_ms": 0.8267826481665032, "mean_env_wait_ms": 4.3030185196913155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026483774185180664, "StateBufferConnector_ms": 0.02131366729736328, "ViewRequirementAgentConnector_ms": 0.5494518280029297}, "num_episodes": 20, "episode_return_max": 553.1282457487581, "episode_return_min": 413.59751409217296, "episode_return_mean": 475.172200257173, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 215.1421394578497, "num_env_steps_trained_throughput_per_sec": 215.1421394578497, "timesteps_total": 90112, "num_env_steps_sampled_lifetime": 90112, "num_agent_steps_sampled_lifetime": 90112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 4794.952, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4794.679, "sample_time_ms": 2086.018, "learn_time_ms": 2673.719, "learn_throughput": 382.987, "synch_weights_time_ms": 34.311}, "counters": {"num_env_steps_sampled": 90112, "num_env_steps_trained": 90112, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "training_iteration": 88, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-50", "timestamp": 1744125830, "time_this_iter_s": 4.770149230957031, "time_total_s": 430.2394061088562, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 430.2394061088562, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 55.11666666666667, "ram_util_percent": 90.08333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0823520865291356, "cur_kl_coeff": 6.462348535570528e-28, "cur_lr": 1e-07, "total_loss": 2.2009799651801587, "policy_loss": -6.882830057293176e-05, "vf_loss": 10.0, "vf_explained_var": -5.463510751724243e-06, "kl": 2.3419994423803937e-06, "entropy": 2.9895120069384573, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "env_runners": {"episode_reward_max": 544.3335706364581, "episode_reward_min": 413.59751409217296, "episode_reward_mean": 474.5386439260224, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.59751409217296}, "policy_reward_max": {"tplp_policy": 544.3335706364581}, "policy_reward_mean": {"tplp_policy": 474.5386439260224}, "custom_metrics": {"mean_episode_reward_mean": 474.5386439260224, "mean_episode_reward_min": 413.59751409217296, "mean_episode_reward_max": 544.3335706364581}, "hist_stats": {"episode_reward": [518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [518.8320310038035, 474.45234245174936, 515.2561951204259, 453.5990800493154, 498.6891394012633, 457.5519607784768, 413.59751409217296, 449.4427378801268, 472.099702935073, 475.14324956385275, 448.4913230370228, 490.0190646220372, 468.7383679046806, 477.024323452943, 512.7771642851739, 446.91145567560517, 461.71229927696527, 486.22988172767907, 464.36739530788356, 466.398976083164, 445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5030175233712877, "mean_inference_ms": 4.472336517867503, "mean_action_processing_ms": 0.8279724003747875, "mean_env_wait_ms": 4.303514180470554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03162240982055664, "StateBufferConnector_ms": 0.022797346115112305, "ViewRequirementAgentConnector_ms": 0.5839951038360596}, "num_episodes": 22, "episode_return_max": 544.3335706364581, "episode_return_min": 413.59751409217296, "episode_return_mean": 474.5386439260224, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136, "num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 222.66578104285315, "num_env_steps_trained_throughput_per_sec": 222.66578104285315, "timesteps_total": 91136, "num_env_steps_sampled_lifetime": 91136, "num_agent_steps_sampled_lifetime": 91136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 91136, "timers": {"training_iteration_time_ms": 4817.901, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4817.759, "sample_time_ms": 2097.252, "learn_time_ms": 2686.389, "learn_throughput": 381.181, "synch_weights_time_ms": 33.763}, "counters": {"num_env_steps_sampled": 91136, "num_env_steps_trained": 91136, "num_agent_steps_sampled": 91136, "num_agent_steps_trained": 91136}, "done": false, "training_iteration": 89, "trial_id": "3bf18_00000", "date": "2025-04-08_23-23-55", "timestamp": 1744125835, "time_this_iter_s": 4.616424322128296, "time_total_s": 434.8558304309845, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 434.8558304309845, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 54.43333333333333, "ram_util_percent": 89.98333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0919470105320217, "cur_kl_coeff": 3.231174267785264e-28, "cur_lr": 1e-07, "total_loss": 2.200725479424, "policy_loss": -3.227883717045188e-05, "vf_loss": 10.0, "vf_explained_var": -8.57040286064148e-06, "kl": 1.4316563027527708e-06, "entropy": 2.992422227561474, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "env_runners": {"episode_reward_max": 544.3335706364581, "episode_reward_min": 424.9056551935797, "episode_reward_mean": 474.67742687690753, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.9056551935797}, "policy_reward_max": {"tplp_policy": 544.3335706364581}, "policy_reward_mean": {"tplp_policy": 474.67742687690753}, "custom_metrics": {"mean_episode_reward_mean": 474.67742687690753, "mean_episode_reward_min": 424.9056551935797, "mean_episode_reward_max": 544.3335706364581}, "hist_stats": {"episode_reward": [445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [445.8927354480186, 463.4293966059893, 528.7178403152003, 500.25115844857413, 478.6372492001818, 491.71517171825803, 494.8944937003458, 544.3335706364581, 457.2539826947376, 513.1688079708641, 453.1347691893797, 476.5781958518783, 489.2981167988701, 468.7228602493609, 483.6013917390735, 485.77176744084187, 512.3580893948841, 493.5489707088982, 498.09987067034666, 450.5759758141647, 480.87066881119114, 452.01433214770606, 474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5026099947356955, "mean_inference_ms": 4.47395358076986, "mean_action_processing_ms": 0.8289608316701771, "mean_env_wait_ms": 4.304440918701022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03857016563415527, "StateBufferConnector_ms": 0.01713728904724121, "ViewRequirementAgentConnector_ms": 0.5738358497619629}, "num_episodes": 20, "episode_return_max": 544.3335706364581, "episode_return_min": 424.9056551935797, "episode_return_mean": 474.67742687690753, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160, "num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.28077286164202, "num_env_steps_trained_throughput_per_sec": 204.28077286164202, "timesteps_total": 92160, "num_env_steps_sampled_lifetime": 92160, "num_agent_steps_sampled_lifetime": 92160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 92160, "timers": {"training_iteration_time_ms": 4871.72, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4871.578, "sample_time_ms": 2118.948, "learn_time_ms": 2717.488, "learn_throughput": 376.819, "synch_weights_time_ms": 34.787}, "counters": {"num_env_steps_sampled": 92160, "num_env_steps_trained": 92160, "num_agent_steps_sampled": 92160, "num_agent_steps_trained": 92160}, "done": false, "training_iteration": 90, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-00", "timestamp": 1744125840, "time_this_iter_s": 5.025623559951782, "time_total_s": 439.8814539909363, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC153A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 439.8814539909363, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 54.58571428571429, "ram_util_percent": 89.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9572119921445847, "cur_kl_coeff": 1.615587133892632e-28, "cur_lr": 1e-07, "total_loss": 2.200484303385019, "policy_loss": -3.8559915265068415e-05, "vf_loss": 10.0, "vf_explained_var": -9.726732969284058e-06, "kl": 1.449922432072981e-06, "entropy": 2.9947713971138, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "env_runners": {"episode_reward_max": 525.0235217200366, "episode_reward_min": 395.14929196339654, "episode_reward_mean": 470.982265009853, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.14929196339654}, "policy_reward_max": {"tplp_policy": 525.0235217200366}, "policy_reward_mean": {"tplp_policy": 470.982265009853}, "custom_metrics": {"mean_episode_reward_mean": 470.982265009853, "mean_episode_reward_min": 395.14929196339654, "mean_episode_reward_max": 525.0235217200366}, "hist_stats": {"episode_reward": [474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.77459871706355, 508.7486676980961, 463.668626351151, 472.42206997621804, 490.3256424426444, 471.943139202805, 481.2977588040492, 457.72397915375564, 457.5548539783308, 438.83623457523674, 475.0411321500282, 465.73497286564054, 467.6857782836386, 436.7222904993575, 465.2022587908299, 454.0714790912798, 459.4446946611716, 477.665471343077, 483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.502987360801572, "mean_inference_ms": 4.477865803960721, "mean_action_processing_ms": 0.8300659530373816, "mean_env_wait_ms": 4.306699832857113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045595645904541016, "StateBufferConnector_ms": 0.016615867614746094, "ViewRequirementAgentConnector_ms": 0.554288387298584}, "num_episodes": 22, "episode_return_max": 525.0235217200366, "episode_return_min": 395.14929196339654, "episode_return_mean": 470.982265009853, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184, "num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 165.6411989166559, "num_env_steps_trained_throughput_per_sec": 165.6411989166559, "timesteps_total": 93184, "num_env_steps_sampled_lifetime": 93184, "num_agent_steps_sampled_lifetime": 93184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 93184, "timers": {"training_iteration_time_ms": 4906.565, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4906.422, "sample_time_ms": 2090.628, "learn_time_ms": 2779.876, "learn_throughput": 368.362, "synch_weights_time_ms": 35.701}, "counters": {"num_env_steps_sampled": 93184, "num_env_steps_trained": 93184, "num_agent_steps_sampled": 93184, "num_agent_steps_trained": 93184}, "done": false, "training_iteration": 91, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-07", "timestamp": 1744125847, "time_this_iter_s": 6.197991847991943, "time_total_s": 446.0794458389282, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 446.0794458389282, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 54.375, "ram_util_percent": 90.1625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4418141968548297, "cur_kl_coeff": 8.07793566946316e-29, "cur_lr": 1e-07, "total_loss": 2.196043983846903, "policy_loss": -0.0002843752154149115, "vf_loss": 9.983721977472305, "vf_explained_var": -6.858259439468384e-06, "kl": 1.8925555310911336e-06, "entropy": 2.9960211724042893, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "env_runners": {"episode_reward_max": 525.0235217200366, "episode_reward_min": 395.14929196339654, "episode_reward_mean": 471.2177264492956, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.14929196339654}, "policy_reward_max": {"tplp_policy": 525.0235217200366}, "policy_reward_mean": {"tplp_policy": 471.2177264492956}, "custom_metrics": {"mean_episode_reward_mean": 471.2177264492956, "mean_episode_reward_min": 395.14929196339654, "mean_episode_reward_max": 525.0235217200366}, "hist_stats": {"episode_reward": [483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.72643411740694, 489.9366433977071, 446.3869034259281, 488.9071374568547, 453.3838824867524, 495.5829637792223, 463.7172255852821, 488.4077076306801, 496.2351545952252, 477.2617072955507, 473.9677392966534, 479.90370025324705, 495.6542640035986, 487.966775532778, 480.96995172170926, 448.33281047894405, 440.4217875307561, 477.7575994385894, 503.3584562234923, 449.65484155411366, 492.4775311296071, 469.79552032083177, 462.58530250871047, 453.120445183355, 446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.503135516974111, "mean_inference_ms": 4.48004957003418, "mean_action_processing_ms": 0.830375856797117, "mean_env_wait_ms": 4.307675058106266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05350065231323242, "StateBufferConnector_ms": 0.013573884963989258, "ViewRequirementAgentConnector_ms": 0.49803948402404785}, "num_episodes": 18, "episode_return_max": 525.0235217200366, "episode_return_min": 395.14929196339654, "episode_return_mean": 471.2177264492956, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208, "num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 226.52161029980246, "num_env_steps_trained_throughput_per_sec": 226.52161029980246, "timesteps_total": 94208, "num_env_steps_sampled_lifetime": 94208, "num_agent_steps_sampled_lifetime": 94208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 94208, "timers": {"training_iteration_time_ms": 4925.777, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4925.634, "sample_time_ms": 2073.168, "learn_time_ms": 2816.486, "learn_throughput": 363.574, "synch_weights_time_ms": 35.763}, "counters": {"num_env_steps_sampled": 94208, "num_env_steps_trained": 94208, "num_agent_steps_sampled": 94208, "num_agent_steps_trained": 94208}, "done": false, "training_iteration": 92, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-11", "timestamp": 1744125851, "time_this_iter_s": 4.534953832626343, "time_total_s": 450.61439967155457, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB477E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 450.61439967155457, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 52.442857142857136, "ram_util_percent": 89.81428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4070404201745985, "cur_kl_coeff": 4.03896783473158e-29, "cur_lr": 1e-07, "total_loss": 2.1972654074430467, "policy_loss": -0.00012603611103259026, "vf_loss": 9.988166040182113, "vf_explained_var": -2.076849341392517e-06, "kl": 1.9434690734065894e-06, "entropy": 2.996500815451145, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "env_runners": {"episode_reward_max": 547.336504070424, "episode_reward_min": 395.14929196339654, "episode_reward_mean": 468.9753806221839, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.14929196339654}, "policy_reward_max": {"tplp_policy": 547.336504070424}, "policy_reward_mean": {"tplp_policy": 468.9753806221839}, "custom_metrics": {"mean_episode_reward_mean": 468.9753806221839, "mean_episode_reward_min": 395.14929196339654, "mean_episode_reward_max": 547.336504070424}, "hist_stats": {"episode_reward": [446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [446.90364450414995, 475.6301086385664, 476.3225944566736, 459.38427662767316, 494.22896359899875, 469.9395450693599, 456.34112085470485, 470.68340199324257, 449.64564465259633, 484.3507266346057, 512.6803683955633, 489.9455307551859, 487.53795510415085, 438.94485348570873, 460.0880633164146, 448.6578407786414, 516.8678384109887, 449.7305542198143, 459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5044903602483988, "mean_inference_ms": 4.483417249163268, "mean_action_processing_ms": 0.8308487869774772, "mean_env_wait_ms": 4.309082499389137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03433966636657715, "StateBufferConnector_ms": 0.014317989349365234, "ViewRequirementAgentConnector_ms": 0.4666109085083008}, "num_episodes": 24, "episode_return_max": 547.336504070424, "episode_return_min": 395.14929196339654, "episode_return_mean": 468.9753806221839, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232, "num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 201.8053657706644, "num_env_steps_trained_throughput_per_sec": 201.8053657706644, "timesteps_total": 95232, "num_env_steps_sampled_lifetime": 95232, "num_agent_steps_sampled_lifetime": 95232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 95232, "timers": {"training_iteration_time_ms": 5008.818, "restore_workers_time_ms": 0.143, "training_step_time_ms": 5008.675, "sample_time_ms": 2153.688, "learn_time_ms": 2818.239, "learn_throughput": 363.347, "synch_weights_time_ms": 36.432}, "counters": {"num_env_steps_sampled": 95232, "num_env_steps_trained": 95232, "num_agent_steps_sampled": 95232, "num_agent_steps_trained": 95232}, "done": false, "training_iteration": 93, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-16", "timestamp": 1744125856, "time_this_iter_s": 5.08637809753418, "time_total_s": 455.70077776908875, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 455.70077776908875, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 60.05714285714286, "ram_util_percent": 89.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.909067137539387, "cur_kl_coeff": 2.01948391736579e-29, "cur_lr": 1e-07, "total_loss": 2.200168093293905, "policy_loss": -2.090148045681417e-05, "vf_loss": 10.0, "vf_explained_var": -7.192045450210571e-06, "kl": 7.837958031053916e-07, "entropy": 2.9981099769473074, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "env_runners": {"episode_reward_max": 547.336504070424, "episode_reward_min": 395.14929196339654, "episode_reward_mean": 469.02416500229714, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.14929196339654}, "policy_reward_max": {"tplp_policy": 547.336504070424}, "policy_reward_mean": {"tplp_policy": 469.02416500229714}, "custom_metrics": {"mean_episode_reward_mean": 469.02416500229714, "mean_episode_reward_min": 395.14929196339654, "mean_episode_reward_max": 547.336504070424}, "hist_stats": {"episode_reward": [459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.07958516888635, 498.515249663726, 484.29174705433934, 475.70059644844457, 488.28743600904755, 468.880879603602, 503.5695837480187, 486.53713212846, 439.80339728021386, 460.8036373174691, 483.70919723724006, 424.9056551935797, 514.2740137524115, 465.8409979086489, 454.72313580840085, 432.6650890101732, 485.3321679195567, 471.6946058549027, 450.9024485635557, 465.0243889030551, 502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5049488715552173, "mean_inference_ms": 4.489027435478935, "mean_action_processing_ms": 0.8317363965355427, "mean_env_wait_ms": 4.312439952283189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035053253173828125, "StateBufferConnector_ms": 0.01818680763244629, "ViewRequirementAgentConnector_ms": 0.49904894828796387}, "num_episodes": 18, "episode_return_max": 547.336504070424, "episode_return_min": 395.14929196339654, "episode_return_mean": 469.02416500229714, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256, "num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 195.67896086618782, "num_env_steps_trained_throughput_per_sec": 195.67896086618782, "timesteps_total": 96256, "num_env_steps_sampled_lifetime": 96256, "num_agent_steps_sampled_lifetime": 96256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 96256, "timers": {"training_iteration_time_ms": 4966.284, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4966.142, "sample_time_ms": 2146.195, "learn_time_ms": 2782.53, "learn_throughput": 368.01, "synch_weights_time_ms": 37.204}, "counters": {"num_env_steps_sampled": 96256, "num_env_steps_trained": 96256, "num_agent_steps_sampled": 96256, "num_agent_steps_trained": 96256}, "done": false, "training_iteration": 94, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-22", "timestamp": 1744125862, "time_this_iter_s": 5.247719049453735, "time_total_s": 460.9484968185425, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E0C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 460.9484968185425, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 56.82857142857143, "ram_util_percent": 88.74285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.129234241694212, "cur_kl_coeff": 1.009741958682895e-29, "cur_lr": 1e-07, "total_loss": 2.1942249938845633, "policy_loss": -7.085265824571251e-05, "vf_loss": 9.976979875564576, "vf_explained_var": -1.0075420141220092e-05, "kl": 1.232117927330023e-06, "entropy": 2.9994911685585977, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "env_runners": {"episode_reward_max": 551.1698171760303, "episode_reward_min": 395.14929196339654, "episode_reward_mean": 471.0516422684809, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.14929196339654}, "policy_reward_max": {"tplp_policy": 551.1698171760303}, "policy_reward_mean": {"tplp_policy": 471.0516422684809}, "custom_metrics": {"mean_episode_reward_mean": 471.0516422684809, "mean_episode_reward_min": 395.14929196339654, "mean_episode_reward_max": 551.1698171760303}, "hist_stats": {"episode_reward": [502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [502.91371570560796, 525.0235217200366, 452.12062836559846, 450.33448861255107, 498.73086768849356, 462.7890081287526, 457.43438040817426, 466.49771745782476, 438.323636028485, 446.59694103552425, 521.6048683948718, 477.8301886050339, 395.14929196339654, 493.2234825278566, 436.44102488260853, 453.0193378465328, 473.0172029144271, 481.16284094846776, 453.7345452673225, 491.47870288158384, 495.6524360139798, 448.65390654381656, 510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5064244053418918, "mean_inference_ms": 4.493552067694249, "mean_action_processing_ms": 0.8324135796929018, "mean_env_wait_ms": 4.313874377122167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028022050857543945, "StateBufferConnector_ms": 0.01577448844909668, "ViewRequirementAgentConnector_ms": 0.47853803634643555}, "num_episodes": 20, "episode_return_max": 551.1698171760303, "episode_return_min": 395.14929196339654, "episode_return_mean": 471.0516422684809, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280, "num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 222.2664381643333, "num_env_steps_trained_throughput_per_sec": 222.2664381643333, "timesteps_total": 97280, "num_env_steps_sampled_lifetime": 97280, "num_agent_steps_sampled_lifetime": 97280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 97280, "timers": {"training_iteration_time_ms": 4905.288, "restore_workers_time_ms": 0.143, "training_step_time_ms": 4905.146, "sample_time_ms": 2134.786, "learn_time_ms": 2734.1, "learn_throughput": 374.529, "synch_weights_time_ms": 36.047}, "counters": {"num_env_steps_sampled": 97280, "num_env_steps_trained": 97280, "num_agent_steps_sampled": 97280, "num_agent_steps_trained": 97280}, "done": false, "training_iteration": 95, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-26", "timestamp": 1744125866, "time_this_iter_s": 4.620422840118408, "time_total_s": 465.5689196586609, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA50F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 465.5689196586609, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 55.96666666666666, "ram_util_percent": 88.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1699029384180903, "cur_kl_coeff": 5.048709793414475e-30, "cur_lr": 1e-07, "total_loss": 2.1885882534086702, "policy_loss": -1.9620376406237485e-06, "vf_loss": 9.954596829414367, "vf_explained_var": -9.662657976150513e-06, "kl": 2.4960939235540993e-07, "entropy": 3.000589856505394, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "env_runners": {"episode_reward_max": 551.1698171760303, "episode_reward_min": 403.13195233075396, "episode_reward_mean": 470.80546607768736, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.13195233075396}, "policy_reward_max": {"tplp_policy": 551.1698171760303}, "policy_reward_mean": {"tplp_policy": 470.80546607768736}, "custom_metrics": {"mean_episode_reward_mean": 470.80546607768736, "mean_episode_reward_min": 403.13195233075396, "mean_episode_reward_max": 551.1698171760303}, "hist_stats": {"episode_reward": [510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [510.0248047061967, 464.79551670564865, 447.94337699316566, 461.44764501029096, 453.7323254902346, 488.7410397937039, 433.26354684759974, 444.5637674841859, 485.4174391557223, 439.001690374495, 473.8034568629892, 473.64387357736746, 469.30792355339855, 502.11136636570967, 463.725426207378, 486.58025084275914, 547.336504070424, 473.9936121535308, 448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.507917288689688, "mean_inference_ms": 4.4975182428952705, "mean_action_processing_ms": 0.8333912792282128, "mean_env_wait_ms": 4.314905451077521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026938915252685547, "StateBufferConnector_ms": 0.016778945922851562, "ViewRequirementAgentConnector_ms": 0.4889252185821533}, "num_episodes": 22, "episode_return_max": 551.1698171760303, "episode_return_min": 403.13195233075396, "episode_return_mean": 470.80546607768736, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 218.1238975517831, "num_env_steps_trained_throughput_per_sec": 218.1238975517831, "timesteps_total": 98304, "num_env_steps_sampled_lifetime": 98304, "num_agent_steps_sampled_lifetime": 98304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 4962.503, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4962.503, "sample_time_ms": 2166.941, "learn_time_ms": 2758.798, "learn_throughput": 371.176, "synch_weights_time_ms": 36.551}, "counters": {"num_env_steps_sampled": 98304, "num_env_steps_trained": 98304, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "training_iteration": 96, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-31", "timestamp": 1744125871, "time_this_iter_s": 4.7055323123931885, "time_total_s": 470.2744519710541, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 470.2744519710541, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 56.050000000000004, "ram_util_percent": 88.68333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4104079857468603, "cur_kl_coeff": 2.5243548967072376e-30, "cur_lr": 1e-07, "total_loss": 2.197201019525528, "policy_loss": -0.00016155673656612635, "vf_loss": 9.990425783395768, "vf_explained_var": -8.514896035194396e-06, "kl": 2.753134235489174e-06, "entropy": 3.002438548207283, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "env_runners": {"episode_reward_max": 551.1698171760303, "episode_reward_min": 403.13195233075396, "episode_reward_mean": 471.3869334461233, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 403.13195233075396}, "policy_reward_max": {"tplp_policy": 551.1698171760303}, "policy_reward_mean": {"tplp_policy": 471.3869334461233}, "custom_metrics": {"mean_episode_reward_mean": 471.3869334461233, "mean_episode_reward_min": 403.13195233075396, "mean_episode_reward_max": 551.1698171760303}, "hist_stats": {"episode_reward": [448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [448.6175160107648, 467.45711658078943, 436.38109847853883, 465.4800681068702, 436.7075684559192, 492.9651028845644, 458.831975920875, 510.85360533710434, 467.8266580192818, 441.4449268425342, 403.13195233075396, 471.1476158815508, 455.25262280561674, 445.50144584404705, 489.614470454743, 469.544004952035, 498.17985856695594, 482.8736367150401, 436.6926305523254, 491.8673112944219, 439.83045566861455, 443.74614430852455, 454.15860398619674, 449.00673068280497, 439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5096305573104098, "mean_inference_ms": 4.502165765446938, "mean_action_processing_ms": 0.8345927415424164, "mean_env_wait_ms": 4.316553046786875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01618814468383789, "StateBufferConnector_ms": 0.018240928649902344, "ViewRequirementAgentConnector_ms": 0.5346524715423584}, "num_episodes": 18, "episode_return_max": 551.1698171760303, "episode_return_min": 403.13195233075396, "episode_return_mean": 471.3869334461233, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328, "num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 219.85494663831548, "num_env_steps_trained_throughput_per_sec": 219.85494663831548, "timesteps_total": 99328, "num_env_steps_sampled_lifetime": 99328, "num_agent_steps_sampled_lifetime": 99328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 99328, "timers": {"training_iteration_time_ms": 4934.029, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4934.029, "sample_time_ms": 2166.652, "learn_time_ms": 2731.193, "learn_throughput": 374.928, "synch_weights_time_ms": 35.971}, "counters": {"num_env_steps_sampled": 99328, "num_env_steps_trained": 99328, "num_agent_steps_sampled": 99328, "num_agent_steps_trained": 99328}, "done": false, "training_iteration": 97, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-36", "timestamp": 1744125876, "time_this_iter_s": 4.669690132141113, "time_total_s": 474.9441421031952, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 474.9441421031952, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 54.19999999999999, "ram_util_percent": 89.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.32561112716794, "cur_kl_coeff": 1.2621774483536188e-30, "cur_lr": 1e-07, "total_loss": 2.1975446112453936, "policy_loss": -3.0453450744971632e-05, "vf_loss": 9.992452764511109, "vf_explained_var": -9.940937161445618e-06, "kl": 1.7364942594966237e-06, "entropy": 3.0053811073303223, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "env_runners": {"episode_reward_max": 551.1698171760303, "episode_reward_min": 413.4443348680395, "episode_reward_mean": 476.09906110810704, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.4443348680395}, "policy_reward_max": {"tplp_policy": 551.1698171760303}, "policy_reward_mean": {"tplp_policy": 476.09906110810704}, "custom_metrics": {"mean_episode_reward_mean": 476.09906110810704, "mean_episode_reward_min": 413.4443348680395, "mean_episode_reward_max": 551.1698171760303}, "hist_stats": {"episode_reward": [439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [439.4832509675801, 478.1930200367281, 473.4727544617242, 503.75420037310533, 532.5893136293868, 478.14156620915423, 459.705841218701, 486.562081739196, 456.23896301991505, 469.1901225846166, 481.1869261931998, 453.55886127793923, 445.72229282723816, 495.85150403746024, 482.6930552976509, 453.25238096576936, 517.9310312498624, 508.8427275556465, 462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5107395388232403, "mean_inference_ms": 4.504505944817106, "mean_action_processing_ms": 0.8353237487358656, "mean_env_wait_ms": 4.315212043278338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017912864685058594, "StateBufferConnector_ms": 0.011803627014160156, "ViewRequirementAgentConnector_ms": 0.49208855628967285}, "num_episodes": 24, "episode_return_max": 551.1698171760303, "episode_return_min": 413.4443348680395, "episode_return_mean": 476.09906110810704, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352, "num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 238.7377749347663, "num_env_steps_trained_throughput_per_sec": 238.7377749347663, "timesteps_total": 100352, "num_env_steps_sampled_lifetime": 100352, "num_agent_steps_sampled_lifetime": 100352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 100352, "timers": {"training_iteration_time_ms": 4886.987, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4886.987, "sample_time_ms": 2134.813, "learn_time_ms": 2716.16, "learn_throughput": 377.003, "synch_weights_time_ms": 35.913}, "counters": {"num_env_steps_sampled": 100352, "num_env_steps_trained": 100352, "num_agent_steps_sampled": 100352, "num_agent_steps_trained": 100352}, "done": false, "training_iteration": 98, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-40", "timestamp": 1744125880, "time_this_iter_s": 4.299588441848755, "time_total_s": 479.24373054504395, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 479.24373054504395, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 49.36666666666667, "ram_util_percent": 89.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6322967860847712, "cur_kl_coeff": 6.310887241768094e-31, "cur_lr": 1e-07, "total_loss": 2.1985145561397075, "policy_loss": -6.65367755573243e-05, "vf_loss": 9.997408926486969, "vf_explained_var": -7.255002856254578e-06, "kl": 1.2960050322696758e-06, "entropy": 3.007711336016655, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "env_runners": {"episode_reward_max": 551.1698171760303, "episode_reward_min": 413.4443348680395, "episode_reward_mean": 474.3790140925884, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.4443348680395}, "policy_reward_max": {"tplp_policy": 551.1698171760303}, "policy_reward_mean": {"tplp_policy": 474.3790140925884}, "custom_metrics": {"mean_episode_reward_mean": 474.3790140925884, "mean_episode_reward_min": 413.4443348680395, "mean_episode_reward_max": 551.1698171760303}, "hist_stats": {"episode_reward": [462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.2624141409965, 544.1191750519554, 464.72548913392717, 444.3889259924307, 442.21887718210337, 433.50837738124255, 478.21422172043617, 442.1153027364343, 445.9038598420711, 457.0508025597676, 475.632434188661, 481.55428009293047, 532.1799176347764, 510.99810532385635, 489.8754861883494, 448.7276418059411, 551.1698171760303, 485.8697842346914, 459.8705138435109, 482.4639249715993, 500.3710996172923, 483.49028855944067, 477.78853740687316, 488.9603048650762, 463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.511066382124307, "mean_inference_ms": 4.505411264862025, "mean_action_processing_ms": 0.8358340418136595, "mean_env_wait_ms": 4.3145251559015705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016908645629882812, "StateBufferConnector_ms": 0.01243138313293457, "ViewRequirementAgentConnector_ms": 0.4727768898010254}, "num_episodes": 18, "episode_return_max": 551.1698171760303, "episode_return_min": 413.4443348680395, "episode_return_mean": 474.3790140925884, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376, "num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 206.14356148519718, "num_env_steps_trained_throughput_per_sec": 206.14356148519718, "timesteps_total": 101376, "num_env_steps_sampled_lifetime": 101376, "num_agent_steps_sampled_lifetime": 101376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 101376, "timers": {"training_iteration_time_ms": 4923.846, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4923.846, "sample_time_ms": 2136.778, "learn_time_ms": 2752.0, "learn_throughput": 372.093, "synch_weights_time_ms": 34.968}, "counters": {"num_env_steps_sampled": 101376, "num_env_steps_trained": 101376, "num_agent_steps_sampled": 101376, "num_agent_steps_trained": 101376}, "done": false, "training_iteration": 99, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-46", "timestamp": 1744125886, "time_this_iter_s": 4.982221841812134, "time_total_s": 484.2259523868561, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 484.2259523868561, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 65.04285714285716, "ram_util_percent": 89.41428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2013078425079584, "cur_kl_coeff": 3.155443620884047e-31, "cur_lr": 1e-07, "total_loss": 2.1954765386879442, "policy_loss": -9.122051997110248e-05, "vf_loss": 9.985791617631913, "vf_explained_var": -9.16793942451477e-06, "kl": 8.122858896841833e-07, "entropy": 3.008801332116127, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "env_runners": {"episode_reward_max": 553.2712312280831, "episode_reward_min": 413.4443348680395, "episode_reward_mean": 473.46016078031704, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.4443348680395}, "policy_reward_max": {"tplp_policy": 553.2712312280831}, "policy_reward_mean": {"tplp_policy": 473.46016078031704}, "custom_metrics": {"mean_episode_reward_mean": 473.46016078031704, "mean_episode_reward_min": 413.4443348680395, "mean_episode_reward_max": 553.2712312280831}, "hist_stats": {"episode_reward": [463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.3044524070132, 488.14106205338027, 415.6184956931457, 471.8491394386673, 486.93438836188017, 470.8567680558869, 413.4443348680395, 461.41887502775353, 451.96064969203263, 438.9499814401723, 429.5580105655002, 496.69962642863015, 441.75974759879045, 458.3606155255293, 531.8399471288593, 483.47435131251893, 501.00612124524366, 470.03648331288275, 491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5119262244981806, "mean_inference_ms": 4.503644743722825, "mean_action_processing_ms": 0.8357566369478394, "mean_env_wait_ms": 4.31238825528855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016776323318481445, "StateBufferConnector_ms": 0.02117633819580078, "ViewRequirementAgentConnector_ms": 0.46612095832824707}, "num_episodes": 24, "episode_return_max": 553.2712312280831, "episode_return_min": 413.4443348680395, "episode_return_mean": 473.46016078031704, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400, "num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 215.77348304057747, "num_env_steps_trained_throughput_per_sec": 215.77348304057747, "timesteps_total": 102400, "num_env_steps_sampled_lifetime": 102400, "num_agent_steps_sampled_lifetime": 102400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 102400, "timers": {"training_iteration_time_ms": 4897.147, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4897.147, "sample_time_ms": 2118.992, "learn_time_ms": 2743.405, "learn_throughput": 373.259, "synch_weights_time_ms": 34.599}, "counters": {"num_env_steps_sampled": 102400, "num_env_steps_trained": 102400, "num_agent_steps_sampled": 102400, "num_agent_steps_trained": 102400}, "done": false, "training_iteration": 100, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-50", "timestamp": 1744125890, "time_this_iter_s": 4.771095514297485, "time_total_s": 488.99704790115356, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0C400>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 488.99704790115356, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 54.41428571428572, "ram_util_percent": 89.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5141284435987474, "cur_kl_coeff": 1.5777218104420235e-31, "cur_lr": 1e-07, "total_loss": 2.198812000453472, "policy_loss": -0.00013555600307881832, "vf_loss": 10.0, "vf_explained_var": -1.2131035327911377e-05, "kl": 2.5744191292642604e-06, "entropy": 3.0105244383215903, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "env_runners": {"episode_reward_max": 553.2712312280831, "episode_reward_min": 415.1143163157958, "episode_reward_mean": 475.44993925846893, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.1143163157958}, "policy_reward_max": {"tplp_policy": 553.2712312280831}, "policy_reward_mean": {"tplp_policy": 475.44993925846893}, "custom_metrics": {"mean_episode_reward_mean": 475.44993925846893, "mean_episode_reward_min": 415.1143163157958, "mean_episode_reward_max": 553.2712312280831}, "hist_stats": {"episode_reward": [491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.4994545104572, 528.124234710081, 470.417397567587, 495.63115534992465, 484.9257263072167, 503.95679578909187, 499.2425257948266, 486.5633204289115, 454.9554171954086, 446.3711152078778, 444.99697707216677, 529.7931615258, 449.96645899461504, 453.14458166760227, 426.17733286882714, 440.7720434898759, 464.3488248600204, 464.32564080950743, 497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5114567865570427, "mean_inference_ms": 4.503931000150598, "mean_action_processing_ms": 0.8360434833285235, "mean_env_wait_ms": 4.313047369403059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020396709442138672, "StateBufferConnector_ms": 0.02067279815673828, "ViewRequirementAgentConnector_ms": 0.47597336769104004}, "num_episodes": 18, "episode_return_max": 553.2712312280831, "episode_return_min": 415.1143163157958, "episode_return_mean": 475.44993925846893, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424, "num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 208.5023030092136, "num_env_steps_trained_throughput_per_sec": 208.5023030092136, "timesteps_total": 103424, "num_env_steps_sampled_lifetime": 103424, "num_agent_steps_sampled_lifetime": 103424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 103424, "timers": {"training_iteration_time_ms": 4770.065, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4770.065, "sample_time_ms": 2082.133, "learn_time_ms": 2653.708, "learn_throughput": 385.875, "synch_weights_time_ms": 33.964}, "counters": {"num_env_steps_sampled": 103424, "num_env_steps_trained": 103424, "num_agent_steps_sampled": 103424, "num_agent_steps_trained": 103424}, "done": false, "training_iteration": 101, "trial_id": "3bf18_00000", "date": "2025-04-08_23-24-55", "timestamp": 1744125895, "time_this_iter_s": 4.924475908279419, "time_total_s": 493.921523809433, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15C60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 493.921523809433, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 58.550000000000004, "ram_util_percent": 89.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2837035924196245, "cur_kl_coeff": 7.888609052210117e-32, "cur_lr": 1e-07, "total_loss": 2.1961770012974737, "policy_loss": -0.00011274162679910659, "vf_loss": 9.990485626459122, "vf_explained_var": -6.004422903060913e-06, "kl": 1.4872017124467618e-06, "entropy": 3.0133167073130607, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "env_runners": {"episode_reward_max": 553.2712312280831, "episode_reward_min": 415.1143163157958, "episode_reward_mean": 475.1000113647869, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.1143163157958}, "policy_reward_max": {"tplp_policy": 553.2712312280831}, "policy_reward_mean": {"tplp_policy": 475.1000113647869}, "custom_metrics": {"mean_episode_reward_mean": 475.1000113647869, "mean_episode_reward_min": 415.1143163157958, "mean_episode_reward_max": 553.2712312280831}, "hist_stats": {"episode_reward": [497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.31411164211346, 484.8787183185609, 510.81919926007623, 484.26333343974704, 432.67404743956155, 466.7871495183953, 519.7586036190534, 443.3970810272491, 483.2083549478179, 464.91341861605827, 467.67385078284354, 466.1518505726335, 483.6223635007024, 490.28234227046244, 462.125307417879, 490.5655242473884, 541.5129749302556, 478.992065344042, 458.9563812952196, 489.489132687134, 504.5683366909433, 477.6972736415741, 466.151781249125, 469.25651370899345, 478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5112304528866367, "mean_inference_ms": 4.502243129647822, "mean_action_processing_ms": 0.8355116761686721, "mean_env_wait_ms": 4.312141047580932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020534038543701172, "StateBufferConnector_ms": 0.027469158172607422, "ViewRequirementAgentConnector_ms": 0.4892241954803467}, "num_episodes": 18, "episode_return_max": 553.2712312280831, "episode_return_min": 415.1143163157958, "episode_return_mean": 475.1000113647869, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448, "num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 242.93678108972483, "num_env_steps_trained_throughput_per_sec": 242.93678108972483, "timesteps_total": 104448, "num_env_steps_sampled_lifetime": 104448, "num_agent_steps_sampled_lifetime": 104448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 104448, "timers": {"training_iteration_time_ms": 4739.52, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4739.52, "sample_time_ms": 2090.138, "learn_time_ms": 2616.125, "learn_throughput": 391.419, "synch_weights_time_ms": 32.997}, "counters": {"num_env_steps_sampled": 104448, "num_env_steps_trained": 104448, "num_agent_steps_sampled": 104448, "num_agent_steps_trained": 104448}, "done": false, "training_iteration": 102, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-00", "timestamp": 1744125900, "time_this_iter_s": 4.226930141448975, "time_total_s": 498.14845395088196, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 498.14845395088196, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 54.633333333333326, "ram_util_percent": 89.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.420247607678175, "cur_kl_coeff": 3.9443045261050587e-32, "cur_lr": 1e-07, "total_loss": 2.19247323051095, "policy_loss": -9.804709115996957e-05, "vf_loss": 9.97626114487648, "vf_explained_var": -8.223578333854675e-06, "kl": 1.6987148181338286e-06, "entropy": 3.014940010011196, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "env_runners": {"episode_reward_max": 553.2712312280831, "episode_reward_min": 408.62551771016285, "episode_reward_mean": 471.85578646029734, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 408.62551771016285}, "policy_reward_max": {"tplp_policy": 553.2712312280831}, "policy_reward_mean": {"tplp_policy": 471.85578646029734}, "custom_metrics": {"mean_episode_reward_mean": 471.85578646029734, "mean_episode_reward_min": 408.62551771016285, "mean_episode_reward_max": 553.2712312280831}, "hist_stats": {"episode_reward": [478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [478.0216616906717, 470.2179780033442, 473.7116241869252, 495.4779406953225, 462.4706609729722, 495.9856720264639, 471.17058692880374, 468.4037142290126, 448.6825118758796, 477.298780619004, 465.2214798466105, 478.1329039835701, 452.2717071078198, 425.03636266758207, 474.855905063021, 471.9974072378832, 478.8151870341781, 454.3022744460989, 487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5111988171278068, "mean_inference_ms": 4.5010943067619, "mean_action_processing_ms": 0.8350904687171173, "mean_env_wait_ms": 4.311867836688611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020366907119750977, "StateBufferConnector_ms": 0.0285489559173584, "ViewRequirementAgentConnector_ms": 0.5296463966369629}, "num_episodes": 24, "episode_return_max": 553.2712312280831, "episode_return_min": 408.62551771016285, "episode_return_mean": 471.85578646029734, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472, "num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 265.6973452209932, "num_env_steps_trained_throughput_per_sec": 265.6973452209932, "timesteps_total": 105472, "num_env_steps_sampled_lifetime": 105472, "num_agent_steps_sampled_lifetime": 105472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 105472, "timers": {"training_iteration_time_ms": 4617.501, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4617.501, "sample_time_ms": 2037.882, "learn_time_ms": 2547.342, "learn_throughput": 401.988, "synch_weights_time_ms": 32.116}, "counters": {"num_env_steps_sampled": 105472, "num_env_steps_trained": 105472, "num_agent_steps_sampled": 105472, "num_agent_steps_trained": 105472}, "done": false, "training_iteration": 103, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-04", "timestamp": 1744125904, "time_this_iter_s": 3.863635540008545, "time_total_s": 502.0120894908905, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44180>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 502.0120894908905, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 45.51666666666667, "ram_util_percent": 89.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2583110563457014, "cur_kl_coeff": 1.9721522630525293e-32, "cur_lr": 1e-07, "total_loss": 2.194992308318615, "policy_loss": -7.942458614706993e-05, "vf_loss": 9.987153607606889, "vf_explained_var": -5.454570055007935e-06, "kl": 1.519497709390194e-06, "entropy": 3.0171667113900185, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "env_runners": {"episode_reward_max": 553.2712312280831, "episode_reward_min": 408.62551771016285, "episode_reward_mean": 470.8546918527586, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 408.62551771016285}, "policy_reward_max": {"tplp_policy": 553.2712312280831}, "policy_reward_mean": {"tplp_policy": 470.8546918527586}, "custom_metrics": {"mean_episode_reward_mean": 470.8546918527586, "mean_episode_reward_min": 408.62551771016285, "mean_episode_reward_max": 553.2712312280831}, "hist_stats": {"episode_reward": [487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.80013745198454, 473.5229729373625, 424.25408593819316, 441.12872433778654, 553.2712312280831, 498.83858572929853, 480.6091031860132, 487.7450801647105, 485.45258117916086, 479.15636570991103, 462.4539188573634, 476.2096404843539, 474.71765309569196, 482.86360572777005, 477.07260395328706, 461.16074358156453, 415.1143163157958, 481.34404072733554, 466.35327398641545, 505.3484339375368, 426.77340774639003, 517.2662826669739, 468.0205581903306, 440.8902295242034, 482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5103997735255303, "mean_inference_ms": 4.4979186182064845, "mean_action_processing_ms": 0.834245549029517, "mean_env_wait_ms": 4.309098343181765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020886659622192383, "StateBufferConnector_ms": 0.028487443923950195, "ViewRequirementAgentConnector_ms": 0.49546146392822266}, "num_episodes": 18, "episode_return_max": 553.2712312280831, "episode_return_min": 408.62551771016285, "episode_return_mean": 470.8546918527586, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 292.2961775671626, "num_env_steps_trained_throughput_per_sec": 292.2961775671626, "timesteps_total": 106496, "num_env_steps_sampled_lifetime": 106496, "num_agent_steps_sampled_lifetime": 106496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 4444.524, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4444.524, "sample_time_ms": 1956.235, "learn_time_ms": 2456.856, "learn_throughput": 416.793, "synch_weights_time_ms": 31.165}, "counters": {"num_env_steps_sampled": 106496, "num_env_steps_trained": 106496, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "training_iteration": 104, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-07", "timestamp": 1744125907, "time_this_iter_s": 3.510401725769043, "time_total_s": 505.52249121665955, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0E7A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 505.52249121665955, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 46.1, "ram_util_percent": 89.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3601212134584784, "cur_kl_coeff": 9.860761315262647e-33, "cur_lr": 1e-07, "total_loss": 2.1953913353383543, "policy_loss": -9.933089022524655e-05, "vf_loss": 9.989547818899155, "vf_explained_var": -8.944794535636902e-06, "kl": 1.4993227035020596e-06, "entropy": 3.018962751328945, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "env_runners": {"episode_reward_max": 552.1145185750761, "episode_reward_min": 408.62551771016285, "episode_reward_mean": 470.87324633260704, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 408.62551771016285}, "policy_reward_max": {"tplp_policy": 552.1145185750761}, "policy_reward_mean": {"tplp_policy": 470.87324633260704}, "custom_metrics": {"mean_episode_reward_mean": 470.87324633260704, "mean_episode_reward_min": 408.62551771016285, "mean_episode_reward_max": 552.1145185750761}, "hist_stats": {"episode_reward": [482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.11220069349315, 447.5365537397031, 484.45626260731444, 484.03483814235983, 454.2205670839053, 537.6178735778578, 451.26645428442407, 488.1451578173383, 447.75403718034687, 470.34554527512296, 480.52817252377, 453.25341392087876, 457.53421340047834, 552.1145185750761, 480.97130043353224, 493.389001000988, 463.8087016774586, 466.6789164346572, 453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5078281326225476, "mean_inference_ms": 4.490367247503864, "mean_action_processing_ms": 0.832705315080719, "mean_env_wait_ms": 4.301775839107849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01960921287536621, "StateBufferConnector_ms": 0.020229101181030273, "ViewRequirementAgentConnector_ms": 0.4478037357330322}, "num_episodes": 24, "episode_return_max": 552.1145185750761, "episode_return_min": 408.62551771016285, "episode_return_mean": 470.87324633260704, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520, "num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 288.4694230493727, "num_env_steps_trained_throughput_per_sec": 288.4694230493727, "timesteps_total": 107520, "num_env_steps_sampled_lifetime": 107520, "num_agent_steps_sampled_lifetime": 107520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 107520, "timers": {"training_iteration_time_ms": 4338.793, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4338.793, "sample_time_ms": 1871.028, "learn_time_ms": 2436.65, "learn_throughput": 420.249, "synch_weights_time_ms": 30.846}, "counters": {"num_env_steps_sampled": 107520, "num_env_steps_trained": 107520, "num_agent_steps_sampled": 107520, "num_agent_steps_trained": 107520}, "done": false, "training_iteration": 105, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-11", "timestamp": 1744125911, "time_this_iter_s": 3.559680461883545, "time_total_s": 509.0821716785431, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 509.0821716785431, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 46.82, "ram_util_percent": 89.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4394028268754484, "cur_kl_coeff": 4.9303806576313234e-33, "cur_lr": 1e-07, "total_loss": 2.1953458219766615, "policy_loss": -0.00010373081895522773, "vf_loss": 9.990230882167817, "vf_explained_var": -8.73766839504242e-06, "kl": 1.8127963143044213e-06, "entropy": 3.0210816875100135, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "env_runners": {"episode_reward_max": 529.7998797396235, "episode_reward_min": 408.62551771016285, "episode_reward_mean": 470.1391272231608, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 408.62551771016285}, "policy_reward_max": {"tplp_policy": 529.7998797396235}, "policy_reward_mean": {"tplp_policy": 470.1391272231608}, "custom_metrics": {"mean_episode_reward_mean": 470.1391272231608, "mean_episode_reward_min": 408.62551771016285, "mean_episode_reward_max": 529.7998797396235}, "hist_stats": {"episode_reward": [453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.5056594000554, 490.4900496728551, 469.74757073183514, 477.125591139258, 495.08055956298796, 438.18787635363253, 496.480627786819, 493.883442001301, 472.3700801801068, 451.87322414551824, 466.0403099242019, 466.4817695189988, 517.898506537581, 483.09010588316454, 427.2399513583698, 470.2364324727856, 449.4317180168973, 455.14559912771654, 419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.50505149965135, "mean_inference_ms": 4.482107319016031, "mean_action_processing_ms": 0.8310709758156605, "mean_env_wait_ms": 4.2940265564083555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01779770851135254, "StateBufferConnector_ms": 0.020476579666137695, "ViewRequirementAgentConnector_ms": 0.4117567539215088}, "num_episodes": 18, "episode_return_max": 529.7998797396235, "episode_return_min": 408.62551771016285, "episode_return_mean": 470.1391272231608, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544, "num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 280.01973231604876, "num_env_steps_trained_throughput_per_sec": 280.01973231604876, "timesteps_total": 108544, "num_env_steps_sampled_lifetime": 108544, "num_agent_steps_sampled_lifetime": 108544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 108544, "timers": {"training_iteration_time_ms": 4235.024, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4235.024, "sample_time_ms": 1784.222, "learn_time_ms": 2419.85, "learn_throughput": 423.167, "synch_weights_time_ms": 30.683}, "counters": {"num_env_steps_sampled": 108544, "num_env_steps_trained": 108544, "num_agent_steps_sampled": 108544, "num_agent_steps_trained": 108544}, "done": false, "training_iteration": 106, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-15", "timestamp": 1744125915, "time_this_iter_s": 3.6686673164367676, "time_total_s": 512.7508389949799, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 512.7508389949799, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 46.120000000000005, "ram_util_percent": 89.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4053261309862135, "cur_kl_coeff": 2.4651903288156617e-33, "cur_lr": 1e-07, "total_loss": 2.196317182481289, "policy_loss": -0.0001319483621045947, "vf_loss": 9.99541153907776, "vf_explained_var": -1.1258944869041444e-05, "kl": 2.7885036415487008e-06, "entropy": 3.024037405848503, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "env_runners": {"episode_reward_max": 546.1571995861657, "episode_reward_min": 408.62551771016285, "episode_reward_mean": 471.4400347753385, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 408.62551771016285}, "policy_reward_max": {"tplp_policy": 546.1571995861657}, "policy_reward_mean": {"tplp_policy": 471.4400347753385}, "custom_metrics": {"mean_episode_reward_mean": 471.4400347753385, "mean_episode_reward_min": 408.62551771016285, "mean_episode_reward_max": 546.1571995861657}, "hist_stats": {"episode_reward": [419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [419.7389070172989, 529.7998797396235, 450.04284702795724, 465.83861206763817, 463.78003707789094, 451.0303176655238, 471.346742663683, 468.730243938079, 446.53252534359984, 465.9219189755797, 514.0752948704501, 446.7478247252883, 465.4408333298646, 440.2610912315296, 408.62551771016285, 478.1976529355938, 507.4655984909366, 490.07387152214386, 481.7245979051863, 475.466950614104, 492.3358407179296, 472.8828030041929, 459.95444334066957, 464.5945769772181, 444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5014896696016171, "mean_inference_ms": 4.471588483383689, "mean_action_processing_ms": 0.8289855019219875, "mean_env_wait_ms": 4.284830874491696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018792152404785156, "StateBufferConnector_ms": 0.012321710586547852, "ViewRequirementAgentConnector_ms": 0.3698282241821289}, "num_episodes": 18, "episode_return_max": 546.1571995861657, "episode_return_min": 408.62551771016285, "episode_return_mean": 471.4400347753385, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568, "num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 289.80080283867954, "num_env_steps_trained_throughput_per_sec": 289.80080283867954, "timesteps_total": 109568, "num_env_steps_sampled_lifetime": 109568, "num_agent_steps_sampled_lifetime": 109568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 109568, "timers": {"training_iteration_time_ms": 4122.608, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4122.608, "sample_time_ms": 1701.831, "learn_time_ms": 2389.397, "learn_throughput": 428.56, "synch_weights_time_ms": 31.112}, "counters": {"num_env_steps_sampled": 109568, "num_env_steps_trained": 109568, "num_agent_steps_sampled": 109568, "num_agent_steps_trained": 109568}, "done": false, "training_iteration": 107, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-18", "timestamp": 1744125918, "time_this_iter_s": 3.5434834957122803, "time_total_s": 516.2943224906921, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14EA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 516.2943224906921, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 44.33999999999999, "ram_util_percent": 89.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.08274868093431, "cur_kl_coeff": 1.2325951644078308e-33, "cur_lr": 1e-07, "total_loss": 2.194280508160591, "policy_loss": -2.361835213378072e-05, "vf_loss": 9.98797681927681, "vf_explained_var": -9.538605809211731e-06, "kl": 1.2328819207332863e-06, "entropy": 3.0269007995724677, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "env_runners": {"episode_reward_max": 546.1571995861657, "episode_reward_min": 400.91492163026544, "episode_reward_mean": 473.5044498817536, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.91492163026544}, "policy_reward_max": {"tplp_policy": 546.1571995861657}, "policy_reward_mean": {"tplp_policy": 473.5044498817536}, "custom_metrics": {"mean_episode_reward_mean": 473.5044498817536, "mean_episode_reward_min": 400.91492163026544, "mean_episode_reward_max": 546.1571995861657}, "hist_stats": {"episode_reward": [444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [444.57186870794067, 494.81531633405626, 473.0033844107495, 485.40961789657365, 474.679610354573, 452.59746098115215, 464.4100526878719, 448.7899076258822, 463.54965588812667, 446.6651955223116, 489.89930111193416, 461.64584964637885, 451.1010570975305, 481.41422638649544, 416.14368280569414, 468.71969008613524, 470.2490643914686, 450.49400941442497, 443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4963188221989718, "mean_inference_ms": 4.45659043237017, "mean_action_processing_ms": 0.8260430616383957, "mean_env_wait_ms": 4.2718718338932185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018466472625732422, "StateBufferConnector_ms": 0.00905299186706543, "ViewRequirementAgentConnector_ms": 0.3227381706237793}, "num_episodes": 24, "episode_return_max": 546.1571995861657, "episode_return_min": 400.91492163026544, "episode_return_mean": 473.5044498817536, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592, "num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 275.62952440164514, "num_env_steps_trained_throughput_per_sec": 275.62952440164514, "timesteps_total": 110592, "num_env_steps_sampled_lifetime": 110592, "num_agent_steps_sampled_lifetime": 110592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 110592, "timers": {"training_iteration_time_ms": 4065.199, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4065.199, "sample_time_ms": 1697.089, "learn_time_ms": 2334.493, "learn_throughput": 438.639, "synch_weights_time_ms": 33.348}, "counters": {"num_env_steps_sampled": 110592, "num_env_steps_trained": 110592, "num_agent_steps_sampled": 110592, "num_agent_steps_trained": 110592}, "done": false, "training_iteration": 108, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-22", "timestamp": 1744125922, "time_this_iter_s": 3.7794439792633057, "time_total_s": 520.0737664699554, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47CE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 520.0737664699554, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 48.480000000000004, "ram_util_percent": 89.16}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1009066209197043, "cur_kl_coeff": 6.162975822039154e-34, "cur_lr": 1e-07, "total_loss": 2.190015323460102, "policy_loss": 2.7797406073659658e-05, "vf_loss": 9.971477842330932, "vf_explained_var": -1.3335049152374267e-05, "kl": 5.894006018802855e-07, "entropy": 3.028819338977337, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "env_runners": {"episode_reward_max": 546.1571995861657, "episode_reward_min": 400.91492163026544, "episode_reward_mean": 475.9682338462497, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.91492163026544}, "policy_reward_max": {"tplp_policy": 546.1571995861657}, "policy_reward_mean": {"tplp_policy": 475.9682338462497}, "custom_metrics": {"mean_episode_reward_mean": 475.9682338462497, "mean_episode_reward_min": 400.91492163026544, "mean_episode_reward_max": 546.1571995861657}, "hist_stats": {"episode_reward": [443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [443.94423921861784, 493.2084535969264, 461.33935390359227, 470.70453563680434, 512.5644557052202, 511.2551948134988, 470.3206990222425, 491.1750685915952, 440.96295743410275, 464.29014339840785, 488.59293259967103, 473.1479228767659, 446.19600483712657, 504.9727589801052, 476.0386663580625, 528.1582729239691, 417.59273116721096, 446.2542883325411, 452.2760601707288, 505.94173631605213, 481.0915646821175, 468.4519102711113, 470.7744901965462, 461.9476784019334, 456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.49332816786743, "mean_inference_ms": 4.448669555020435, "mean_action_processing_ms": 0.824346085424269, "mean_env_wait_ms": 4.264586388954595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020864248275756836, "StateBufferConnector_ms": 0.013005733489990234, "ViewRequirementAgentConnector_ms": 0.358875036239624}, "num_episodes": 18, "episode_return_max": 546.1571995861657, "episode_return_min": 400.91492163026544, "episode_return_mean": 475.9682338462497, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616, "num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 214.18330640105273, "num_env_steps_trained_throughput_per_sec": 214.18330640105273, "timesteps_total": 111616, "num_env_steps_sampled_lifetime": 111616, "num_agent_steps_sampled_lifetime": 111616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 111616, "timers": {"training_iteration_time_ms": 4046.653, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4046.553, "sample_time_ms": 1701.771, "learn_time_ms": 2310.674, "learn_throughput": 443.161, "synch_weights_time_ms": 33.839}, "counters": {"num_env_steps_sampled": 111616, "num_env_steps_trained": 111616, "num_agent_steps_sampled": 111616, "num_agent_steps_trained": 111616}, "done": false, "training_iteration": 109, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-27", "timestamp": 1744125927, "time_this_iter_s": 4.796060800552368, "time_total_s": 524.8698272705078, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB471A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 524.8698272705078, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 58.471428571428575, "ram_util_percent": 89.42857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1448647636920213, "cur_kl_coeff": 3.081487911019577e-34, "cur_lr": 1e-07, "total_loss": 2.1945367351174356, "policy_loss": -5.628325161524117e-05, "vf_loss": 9.990416914224625, "vf_explained_var": -8.738785982131959e-06, "kl": 8.786272517991023e-07, "entropy": 3.0301119863986967, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "env_runners": {"episode_reward_max": 546.1571995861657, "episode_reward_min": 400.91492163026544, "episode_reward_mean": 474.4955995751888, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.91492163026544}, "policy_reward_max": {"tplp_policy": 546.1571995861657}, "policy_reward_mean": {"tplp_policy": 474.4955995751888}, "custom_metrics": {"mean_episode_reward_mean": 474.4955995751888, "mean_episode_reward_min": 400.91492163026544, "mean_episode_reward_max": 546.1571995861657}, "hist_stats": {"episode_reward": [456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [456.2427169145987, 489.0301353733805, 481.4479625824571, 461.7752059730863, 416.52359069135815, 527.4912566558503, 467.0809867159779, 449.20178769858046, 485.3186023411233, 487.7618871775736, 487.3866048599103, 456.6191248468896, 467.1837378560106, 481.3337423020361, 509.8900874225055, 465.3462194142668, 485.0496337205981, 469.45876788386687, 546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4909015294748935, "mean_inference_ms": 4.442325532281818, "mean_action_processing_ms": 0.8226865444178617, "mean_env_wait_ms": 4.25839438226498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01512908935546875, "StateBufferConnector_ms": 0.01495814323425293, "ViewRequirementAgentConnector_ms": 0.3879237174987793}, "num_episodes": 24, "episode_return_max": 546.1571995861657, "episode_return_min": 400.91492163026544, "episode_return_mean": 474.4955995751888, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640, "num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 203.29846320811774, "num_env_steps_trained_throughput_per_sec": 203.29846320811774, "timesteps_total": 112640, "num_env_steps_sampled_lifetime": 112640, "num_agent_steps_sampled_lifetime": 112640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 112640, "timers": {"training_iteration_time_ms": 4075.774, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4075.674, "sample_time_ms": 1710.366, "learn_time_ms": 2300.675, "learn_throughput": 445.087, "synch_weights_time_ms": 64.415}, "counters": {"num_env_steps_sampled": 112640, "num_env_steps_trained": 112640, "num_agent_steps_sampled": 112640, "num_agent_steps_trained": 112640}, "done": false, "training_iteration": 110, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-32", "timestamp": 1744125932, "time_this_iter_s": 5.048641204833984, "time_total_s": 529.9184684753418, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB45800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 529.9184684753418, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 54.771428571428565, "ram_util_percent": 89.52857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.305713598430157, "cur_kl_coeff": 1.5407439555097886e-34, "cur_lr": 1e-07, "total_loss": 2.1968018732964993, "policy_loss": -3.227584238629788e-05, "vf_loss": 10.0, "vf_explained_var": -5.7604163885116575e-06, "kl": 1.0085899591949498e-06, "entropy": 3.0316584572196006, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "env_runners": {"episode_reward_max": 546.1571995861657, "episode_reward_min": 400.91492163026544, "episode_reward_mean": 473.4472723050145, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.91492163026544}, "policy_reward_max": {"tplp_policy": 546.1571995861657}, "policy_reward_mean": {"tplp_policy": 473.4472723050145}, "custom_metrics": {"mean_episode_reward_mean": 473.4472723050145, "mean_episode_reward_min": 400.91492163026544, "mean_episode_reward_max": 546.1571995861657}, "hist_stats": {"episode_reward": [546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [546.1571995861657, 463.87073998000994, 457.48990030694625, 455.307008636164, 474.657129406389, 476.6991310350888, 481.203341183849, 514.2555282071241, 445.04851026376656, 483.4001771901314, 502.8586442809301, 450.02098684683926, 483.65495860248956, 449.7890152048808, 469.8559612295557, 495.6231954670527, 467.3285713876589, 514.6796623968222, 491.36877876672935, 481.7810289989396, 456.8725331417389, 484.0201187531491, 453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.490320955676164, "mean_inference_ms": 4.441034635457816, "mean_action_processing_ms": 0.8218954660273586, "mean_env_wait_ms": 4.2566347754812455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01380467414855957, "StateBufferConnector_ms": 0.03624868392944336, "ViewRequirementAgentConnector_ms": 0.4439089298248291}, "num_episodes": 18, "episode_return_max": 546.1571995861657, "episode_return_min": 400.91492163026544, "episode_return_mean": 473.4472723050145, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664, "num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 207.76805420180105, "num_env_steps_trained_throughput_per_sec": 207.76805420180105, "timesteps_total": 113664, "num_env_steps_sampled_lifetime": 113664, "num_agent_steps_sampled_lifetime": 113664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 113664, "timers": {"training_iteration_time_ms": 4077.51, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4077.41, "sample_time_ms": 1734.127, "learn_time_ms": 2278.637, "learn_throughput": 449.391, "synch_weights_time_ms": 64.436}, "counters": {"num_env_steps_sampled": 113664, "num_env_steps_trained": 113664, "num_agent_steps_sampled": 113664, "num_agent_steps_trained": 113664}, "done": false, "training_iteration": 111, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-38", "timestamp": 1744125938, "time_this_iter_s": 4.947322607040405, "time_total_s": 534.8657910823822, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44FE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 534.8657910823822, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 50.614285714285714, "ram_util_percent": 89.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5311493922024964, "cur_kl_coeff": 7.703719777548943e-35, "cur_lr": 1e-07, "total_loss": 2.1963167496025564, "policy_loss": -0.00021001433487981557, "vf_loss": 10.0, "vf_explained_var": -6.198883056640625e-06, "kl": 4.099430515247527e-06, "entropy": 3.034732420742512, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "env_runners": {"episode_reward_max": 545.1416837774602, "episode_reward_min": 400.91492163026544, "episode_reward_mean": 473.58566806972806, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 400.91492163026544}, "policy_reward_max": {"tplp_policy": 545.1416837774602}, "policy_reward_mean": {"tplp_policy": 473.58566806972806}, "custom_metrics": {"mean_episode_reward_mean": 473.58566806972806, "mean_episode_reward_min": 400.91492163026544, "mean_episode_reward_max": 545.1416837774602}, "hist_stats": {"episode_reward": [453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.6298795721318, 400.91492163026544, 461.68572932665126, 467.40824652900403, 464.3179609918741, 485.9852449690845, 503.5381317636129, 531.1718328235174, 508.5814657764061, 417.66860449300185, 479.32599776703097, 468.273541402952, 486.66929947863497, 491.298037688656, 483.4034915983345, 465.75710262768973, 508.7831814752201, 462.5870761745466, 443.6076677475213, 479.5258158794639, 482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4910137939715347, "mean_inference_ms": 4.441011967532032, "mean_action_processing_ms": 0.8215502897839064, "mean_env_wait_ms": 4.255171733923215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010292768478393555, "StateBufferConnector_ms": 0.03666090965270996, "ViewRequirementAgentConnector_ms": 0.4678459167480469}, "num_episodes": 22, "episode_return_max": 545.1416837774602, "episode_return_min": 400.91492163026544, "episode_return_mean": 473.58566806972806, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.21564124340946, "num_env_steps_trained_throughput_per_sec": 217.21564124340946, "timesteps_total": 114688, "num_env_steps_sampled_lifetime": 114688, "num_agent_steps_sampled_lifetime": 114688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 4127.422, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4127.322, "sample_time_ms": 1725.108, "learn_time_ms": 2336.027, "learn_throughput": 438.351, "synch_weights_time_ms": 65.979}, "counters": {"num_env_steps_sampled": 114688, "num_env_steps_trained": 114688, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "training_iteration": 112, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-42", "timestamp": 1744125942, "time_this_iter_s": 4.7240517139434814, "time_total_s": 539.5898427963257, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 539.5898427963257, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 57.566666666666656, "ram_util_percent": 89.31666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4321869134902956, "cur_kl_coeff": 3.8518598887744714e-35, "cur_lr": 1e-07, "total_loss": 2.193647017329931, "policy_loss": -0.00012520981836132704, "vf_loss": 9.99041681289673, "vf_explained_var": -8.721649646759033e-06, "kl": 1.9927715854350937e-06, "entropy": 3.038319706916809, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "env_runners": {"episode_reward_max": 545.1416837774602, "episode_reward_min": 418.01523556467095, "episode_reward_mean": 473.4055048125688, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.01523556467095}, "policy_reward_max": {"tplp_policy": 545.1416837774602}, "policy_reward_mean": {"tplp_policy": 473.4055048125688}, "custom_metrics": {"mean_episode_reward_mean": 473.4055048125688, "mean_episode_reward_min": 418.01523556467095, "mean_episode_reward_max": 545.1416837774602}, "hist_stats": {"episode_reward": [482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [482.2167416519624, 514.6033417729078, 483.63269973806115, 474.59658889607056, 521.288203459022, 477.0517369877124, 473.0876047111173, 461.494612644126, 424.97962181078447, 442.38208869910255, 493.7148364579251, 463.898570798063, 475.1602127163401, 526.3173499802518, 469.43117286346035, 477.5484809850148, 471.0907533975582, 491.4252034917202, 454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4913352346937117, "mean_inference_ms": 4.445359535240665, "mean_action_processing_ms": 0.8218033099056634, "mean_env_wait_ms": 4.257961948551625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010573148727416992, "StateBufferConnector_ms": 0.03513836860656738, "ViewRequirementAgentConnector_ms": 0.5006146430969238}, "num_episodes": 20, "episode_return_max": 545.1416837774602, "episode_return_min": 418.01523556467095, "episode_return_mean": 473.4055048125688, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712, "num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 194.18074951989067, "num_env_steps_trained_throughput_per_sec": 194.18074951989067, "timesteps_total": 115712, "num_env_steps_sampled_lifetime": 115712, "num_agent_steps_sampled_lifetime": 115712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 115712, "timers": {"training_iteration_time_ms": 4269.365, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4269.264, "sample_time_ms": 1774.519, "learn_time_ms": 2427.349, "learn_throughput": 421.859, "synch_weights_time_ms": 67.089}, "counters": {"num_env_steps_sampled": 115712, "num_env_steps_trained": 115712, "num_agent_steps_sampled": 115712, "num_agent_steps_trained": 115712}, "done": false, "training_iteration": 113, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-48", "timestamp": 1744125948, "time_this_iter_s": 5.284579515457153, "time_total_s": 544.8744223117828, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB471A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 544.8744223117828, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 57.4875, "ram_util_percent": 89.4125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1196085169911383, "cur_kl_coeff": 1.9259299443872357e-35, "cur_lr": 1e-07, "total_loss": 2.1959109000861643, "policy_loss": -6.225155084393919e-05, "vf_loss": 10.0, "vf_explained_var": -9.482353925704956e-06, "kl": 1.2152869524273414e-06, "entropy": 3.04026847332716, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "env_runners": {"episode_reward_max": 545.1416837774602, "episode_reward_min": 418.01523556467095, "episode_reward_mean": 472.28105846505986, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.01523556467095}, "policy_reward_max": {"tplp_policy": 545.1416837774602}, "policy_reward_mean": {"tplp_policy": 472.28105846505986}, "custom_metrics": {"mean_episode_reward_mean": 472.28105846505986, "mean_episode_reward_min": 418.01523556467095, "mean_episode_reward_max": 545.1416837774602}, "hist_stats": {"episode_reward": [454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [454.1158235014253, 476.4398720563029, 460.5540362178136, 451.1347900028541, 480.14864528376773, 461.5077190021532, 495.13812448836126, 476.53393313987885, 441.363923032991, 471.4487804639256, 494.863388223776, 446.47023435108065, 457.1397742771589, 500.53199199808887, 480.9652602312104, 442.06940557988594, 454.6257113617135, 495.6000227328495, 444.6206368519502, 484.9312952646055, 462.3103292683987, 438.9090381094036, 517.2692927574892, 463.9933466042388, 468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.491808449305707, "mean_inference_ms": 4.446628132974534, "mean_action_processing_ms": 0.8217001857668548, "mean_env_wait_ms": 4.259089797712784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008629798889160156, "StateBufferConnector_ms": 0.029125213623046875, "ViewRequirementAgentConnector_ms": 0.5145201683044434}, "num_episodes": 18, "episode_return_max": 545.1416837774602, "episode_return_min": 418.01523556467095, "episode_return_mean": 472.28105846505986, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736, "num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 222.065167807575, "num_env_steps_trained_throughput_per_sec": 222.065167807575, "timesteps_total": 116736, "num_env_steps_sampled_lifetime": 116736, "num_agent_steps_sampled_lifetime": 116736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 116736, "timers": {"training_iteration_time_ms": 4380.161, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4380.061, "sample_time_ms": 1813.595, "learn_time_ms": 2498.948, "learn_throughput": 409.772, "synch_weights_time_ms": 67.318}, "counters": {"num_env_steps_sampled": 116736, "num_env_steps_trained": 116736, "num_agent_steps_sampled": 116736, "num_agent_steps_trained": 116736}, "done": false, "training_iteration": 114, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-53", "timestamp": 1744125953, "time_this_iter_s": 4.624392032623291, "time_total_s": 549.4988143444061, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 549.4988143444061, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 55.03333333333334, "ram_util_percent": 89.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2908631984144447, "cur_kl_coeff": 9.629649721936178e-36, "cur_lr": 1e-07, "total_loss": 2.1921847462654114, "policy_loss": -5.967261240584776e-05, "vf_loss": 9.985558009147644, "vf_explained_var": -1.1462345719337464e-05, "kl": 7.719219164703528e-07, "entropy": 3.041450871527195, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "env_runners": {"episode_reward_max": 545.1416837774602, "episode_reward_min": 418.01523556467095, "episode_reward_mean": 473.7132305679606, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.01523556467095}, "policy_reward_max": {"tplp_policy": 545.1416837774602}, "policy_reward_mean": {"tplp_policy": 473.7132305679606}, "custom_metrics": {"mean_episode_reward_mean": 473.7132305679606, "mean_episode_reward_min": 418.01523556467095, "mean_episode_reward_max": 545.1416837774602}, "hist_stats": {"episode_reward": [468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.6979842948138, 439.93923830517167, 448.81354187169234, 444.5639928057327, 494.1982519701357, 500.10160874622585, 463.4503959809291, 486.9702446156472, 478.03886732639717, 463.00742396642283, 439.446568626593, 456.4421408543794, 452.80307373820517, 454.63590036901724, 489.1626342936044, 477.77481628593773, 447.9004276808253, 498.64116031826853, 480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.492002984755905, "mean_inference_ms": 4.44740985108651, "mean_action_processing_ms": 0.8215578398674894, "mean_env_wait_ms": 4.260321428186362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018194198608398438, "StateBufferConnector_ms": 0.03447866439819336, "ViewRequirementAgentConnector_ms": 0.5101017951965332}, "num_episodes": 24, "episode_return_max": 545.1416837774602, "episode_return_min": 418.01523556467095, "episode_return_mean": 473.7132305679606, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760, "num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.16648722537911, "num_env_steps_trained_throughput_per_sec": 204.16648722537911, "timesteps_total": 117760, "num_env_steps_sampled_lifetime": 117760, "num_agent_steps_sampled_lifetime": 117760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 117760, "timers": {"training_iteration_time_ms": 4526.736, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4526.635, "sample_time_ms": 1883.982, "learn_time_ms": 2574.783, "learn_throughput": 397.703, "synch_weights_time_ms": 67.671}, "counters": {"num_env_steps_sampled": 117760, "num_env_steps_trained": 117760, "num_agent_steps_sampled": 117760, "num_agent_steps_trained": 117760}, "done": false, "training_iteration": 115, "trial_id": "3bf18_00000", "date": "2025-04-08_23-25-58", "timestamp": 1744125958, "time_this_iter_s": 5.0261476039886475, "time_total_s": 554.5249619483948, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB453A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 554.5249619483948, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 55.114285714285714, "ram_util_percent": 89.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1294254660606384, "cur_kl_coeff": 4.814824860968089e-36, "cur_lr": 1e-07, "total_loss": 2.1933975480496883, "policy_loss": -0.00011450857855379581, "vf_loss": 9.99130448102951, "vf_explained_var": -1.0092556476593017e-05, "kl": 2.066138345260815e-06, "entropy": 3.043140558898449, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "env_runners": {"episode_reward_max": 545.1416837774602, "episode_reward_min": 418.01523556467095, "episode_reward_mean": 475.3567726911667, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.01523556467095}, "policy_reward_max": {"tplp_policy": 545.1416837774602}, "policy_reward_mean": {"tplp_policy": 475.3567726911667}, "custom_metrics": {"mean_episode_reward_mean": 475.3567726911667, "mean_episode_reward_min": 418.01523556467095, "mean_episode_reward_max": 545.1416837774602}, "hist_stats": {"episode_reward": [480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [480.4650014482917, 545.1416837774602, 496.3539509062823, 474.5164481512247, 467.0919851247114, 489.88097987146386, 481.3359022565102, 458.99865308335416, 470.32569788597834, 418.01523556467095, 500.04010209318494, 506.4606512970277, 469.30482812789216, 506.1382996975741, 464.5202932838075, 461.7307737201528, 499.1355741822424, 460.2177424635276, 493.00208582693756, 470.56422058238934, 454.6344213270217, 478.5378334534849, 450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4917187716063558, "mean_inference_ms": 4.446266452482611, "mean_action_processing_ms": 0.8215320007099433, "mean_env_wait_ms": 4.26027541184821, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018373966217041016, "StateBufferConnector_ms": 0.012949466705322266, "ViewRequirementAgentConnector_ms": 0.4923396110534668}, "num_episodes": 18, "episode_return_max": 545.1416837774602, "episode_return_min": 418.01523556467095, "episode_return_mean": 475.3567726911667, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784, "num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 231.32027664499995, "num_env_steps_trained_throughput_per_sec": 231.32027664499995, "timesteps_total": 118784, "num_env_steps_sampled_lifetime": 118784, "num_agent_steps_sampled_lifetime": 118784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 118784, "timers": {"training_iteration_time_ms": 4603.723, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4603.623, "sample_time_ms": 1933.929, "learn_time_ms": 2601.607, "learn_throughput": 393.603, "synch_weights_time_ms": 67.656}, "counters": {"num_env_steps_sampled": 118784, "num_env_steps_trained": 118784, "num_agent_steps_sampled": 118784, "num_agent_steps_trained": 118784}, "done": false, "training_iteration": 116, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-02", "timestamp": 1744125962, "time_this_iter_s": 4.436513900756836, "time_total_s": 558.9614758491516, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46520>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 558.9614758491516, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 49.96666666666667, "ram_util_percent": 89.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4689676754176615, "cur_kl_coeff": 2.4074124304840446e-36, "cur_lr": 1e-07, "total_loss": 2.1952445097267628, "policy_loss": -0.00014162471634335816, "vf_loss": 10.0, "vf_explained_var": -8.428096771240235e-06, "kl": 3.001493988240289e-06, "entropy": 3.0461384877562523, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "env_runners": {"episode_reward_max": 536.664074367497, "episode_reward_min": 423.3686061092284, "episode_reward_mean": 474.447007050033, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.3686061092284}, "policy_reward_max": {"tplp_policy": 536.664074367497}, "policy_reward_mean": {"tplp_policy": 474.447007050033}, "custom_metrics": {"mean_episode_reward_mean": 474.447007050033, "mean_episode_reward_min": 423.3686061092284, "mean_episode_reward_max": 536.664074367497}, "hist_stats": {"episode_reward": [450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.40912380058114, 456.007611612859, 437.4730116334955, 478.7964673982136, 536.664074367497, 463.2954068322441, 474.058327390542, 464.940508517269, 466.41422014230875, 476.80305427968705, 482.8365672572744, 464.29600425772406, 451.4592058011255, 468.00740895298446, 437.36474811913774, 502.7236560163896, 509.81867894696165, 491.57657389286504, 497.10436682093086, 453.5661300602373, 495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4915722380847543, "mean_inference_ms": 4.445480529949986, "mean_action_processing_ms": 0.821298971945641, "mean_env_wait_ms": 4.261158565745713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019892215728759766, "StateBufferConnector_ms": 0.015275716781616211, "ViewRequirementAgentConnector_ms": 0.507232666015625}, "num_episodes": 22, "episode_return_max": 536.664074367497, "episode_return_min": 423.3686061092284, "episode_return_mean": 474.447007050033, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808, "num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 203.04507989660175, "num_env_steps_trained_throughput_per_sec": 203.04507989660175, "timesteps_total": 119808, "num_env_steps_sampled_lifetime": 119808, "num_agent_steps_sampled_lifetime": 119808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 119808, "timers": {"training_iteration_time_ms": 4754.699, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4754.598, "sample_time_ms": 1991.274, "learn_time_ms": 2694.16, "learn_throughput": 380.081, "synch_weights_time_ms": 68.732}, "counters": {"num_env_steps_sampled": 119808, "num_env_steps_trained": 119808, "num_agent_steps_sampled": 119808, "num_agent_steps_trained": 119808}, "done": false, "training_iteration": 117, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-07", "timestamp": 1744125967, "time_this_iter_s": 5.071794509887695, "time_total_s": 564.0332703590393, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47E20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 564.0332703590393, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 55.92857142857144, "ram_util_percent": 89.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.463004602864385, "cur_kl_coeff": 1.2037062152420223e-36, "cur_lr": 1e-07, "total_loss": 2.1948202632367613, "policy_loss": -0.00023985584266483784, "vf_loss": 10.0, "vf_explained_var": -7.84657895565033e-06, "kl": 3.2450683201901143e-06, "entropy": 3.0493987664580344, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "env_runners": {"episode_reward_max": 535.5691583183567, "episode_reward_min": 423.3686061092284, "episode_reward_mean": 475.22179116558596, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.3686061092284}, "policy_reward_max": {"tplp_policy": 535.5691583183567}, "policy_reward_mean": {"tplp_policy": 475.22179116558596}, "custom_metrics": {"mean_episode_reward_mean": 475.22179116558596, "mean_episode_reward_min": 423.3686061092284, "mean_episode_reward_max": 535.5691583183567}, "hist_stats": {"episode_reward": [495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [495.34416091857804, 465.9581766653789, 465.85648203084673, 441.0865889363297, 501.6991015730142, 423.3686061092284, 490.84748389633967, 479.00655897986474, 470.5426988496201, 478.6931967225862, 482.66600674113204, 473.59527055176835, 507.5663639268241, 463.3637980149769, 440.2237059974337, 480.9864895152226, 479.161621263265, 485.4399678451869, 502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4916401164584436, "mean_inference_ms": 4.445851534514625, "mean_action_processing_ms": 0.821285311209034, "mean_env_wait_ms": 4.262902135643478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02632737159729004, "StateBufferConnector_ms": 0.015375614166259766, "ViewRequirementAgentConnector_ms": 0.5328395366668701}, "num_episodes": 20, "episode_return_max": 535.5691583183567, "episode_return_min": 423.3686061092284, "episode_return_mean": 475.22179116558596, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832, "num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 192.1815345832522, "num_env_steps_trained_throughput_per_sec": 192.1815345832522, "timesteps_total": 120832, "num_env_steps_sampled_lifetime": 120832, "num_agent_steps_sampled_lifetime": 120832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 120832, "timers": {"training_iteration_time_ms": 4916.015, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4915.915, "sample_time_ms": 2086.464, "learn_time_ms": 2761.373, "learn_throughput": 370.83, "synch_weights_time_ms": 67.646}, "counters": {"num_env_steps_sampled": 120832, "num_env_steps_trained": 120832, "num_agent_steps_sampled": 120832, "num_agent_steps_trained": 120832}, "done": false, "training_iteration": 118, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-13", "timestamp": 1744125973, "time_this_iter_s": 5.351915597915649, "time_total_s": 569.385185956955, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 569.385185956955, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 54.48571428571428, "ram_util_percent": 89.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2298433411866427, "cur_kl_coeff": 6.0185310762101115e-37, "cur_lr": 1e-07, "total_loss": 2.1947196565568445, "policy_loss": -3.905728808604181e-05, "vf_loss": 10.0, "vf_explained_var": -7.1480870246887205e-06, "kl": 1.9922666690597167e-06, "entropy": 3.0524128690361976, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "env_runners": {"episode_reward_max": 535.5691583183567, "episode_reward_min": 425.12083639921207, "episode_reward_mean": 474.0208623756795, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.12083639921207}, "policy_reward_max": {"tplp_policy": 535.5691583183567}, "policy_reward_mean": {"tplp_policy": 474.0208623756795}, "custom_metrics": {"mean_episode_reward_mean": 474.0208623756795, "mean_episode_reward_min": 425.12083639921207, "mean_episode_reward_max": 535.5691583183567}, "hist_stats": {"episode_reward": [502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [502.2745966259589, 514.6044326266161, 501.701074303851, 425.12083639921207, 456.5573825871099, 464.105412184641, 441.57762577029655, 450.23641204697725, 505.30486972184093, 450.9431611160965, 505.28614268407796, 512.7665937067823, 500.13018136938354, 444.6350537318113, 440.2912855254534, 507.48467632167973, 491.4677859216247, 469.95625847876056, 482.08453724610507, 436.6721440241968, 472.21966551445894, 455.88086807600325, 494.75441583580425, 492.0380536104901, 499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4922640610377333, "mean_inference_ms": 4.447171119983021, "mean_action_processing_ms": 0.8215052756369805, "mean_env_wait_ms": 4.264951768896361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0291903018951416, "StateBufferConnector_ms": 0.01876091957092285, "ViewRequirementAgentConnector_ms": 0.5205409526824951}, "num_episodes": 18, "episode_return_max": 535.5691583183567, "episode_return_min": 425.12083639921207, "episode_return_mean": 474.0208623756795, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856, "num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.16710836659414, "num_env_steps_trained_throughput_per_sec": 204.16710836659414, "timesteps_total": 121856, "num_env_steps_sampled_lifetime": 121856, "num_agent_steps_sampled_lifetime": 121856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 121856, "timers": {"training_iteration_time_ms": 4939.37, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4939.37, "sample_time_ms": 2086.716, "learn_time_ms": 2784.127, "learn_throughput": 367.799, "synch_weights_time_ms": 68.096}, "counters": {"num_env_steps_sampled": 121856, "num_env_steps_trained": 121856, "num_agent_steps_sampled": 121856, "num_agent_steps_trained": 121856}, "done": false, "training_iteration": 119, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-18", "timestamp": 1744125978, "time_this_iter_s": 5.032467603683472, "time_total_s": 574.4176535606384, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 574.4176535606384, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.5, "ram_util_percent": 89.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2388669304549693, "cur_kl_coeff": 3.0092655381050558e-37, "cur_lr": 1e-07, "total_loss": 2.1929076232016085, "policy_loss": -2.4831376504153013e-05, "vf_loss": 9.993912941217422, "vf_explained_var": -8.128955960273742e-06, "kl": 1.94037897980337e-06, "entropy": 3.0554576709866526, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "env_runners": {"episode_reward_max": 535.5691583183567, "episode_reward_min": 426.7035227553151, "episode_reward_mean": 472.0402749470805, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.7035227553151}, "policy_reward_max": {"tplp_policy": 535.5691583183567}, "policy_reward_mean": {"tplp_policy": 472.0402749470805}, "custom_metrics": {"mean_episode_reward_mean": 472.0402749470805, "mean_episode_reward_min": 426.7035227553151, "mean_episode_reward_max": 535.5691583183567}, "hist_stats": {"episode_reward": [499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.9401517287149, 477.0690274341645, 481.6262904589602, 480.66959221848515, 450.994374078309, 464.1755082718321, 466.6173946720313, 473.38603984059677, 474.25041766106216, 451.511080093484, 487.7827558268309, 486.82225623536135, 445.16966518716913, 487.4256343899574, 473.2136912619188, 481.49613556545006, 507.6211915292476, 433.50186417260346, 450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4931180873064356, "mean_inference_ms": 4.4493629073004515, "mean_action_processing_ms": 0.8218573000287414, "mean_env_wait_ms": 4.267357977460554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02585887908935547, "StateBufferConnector_ms": 0.011467695236206055, "ViewRequirementAgentConnector_ms": 0.5309813022613525}, "num_episodes": 24, "episode_return_max": 535.5691583183567, "episode_return_min": 426.7035227553151, "episode_return_mean": 472.0402749470805, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880, "num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 221.17758810775442, "num_env_steps_trained_throughput_per_sec": 221.17758810775442, "timesteps_total": 122880, "num_env_steps_sampled_lifetime": 122880, "num_agent_steps_sampled_lifetime": 122880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 122880, "timers": {"training_iteration_time_ms": 4898.653, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4898.653, "sample_time_ms": 2083.568, "learn_time_ms": 2777.268, "learn_throughput": 368.708, "synch_weights_time_ms": 37.386}, "counters": {"num_env_steps_sampled": 122880, "num_env_steps_trained": 122880, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "done": false, "training_iteration": 120, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-23", "timestamp": 1744125983, "time_this_iter_s": 4.639068841934204, "time_total_s": 579.0567224025726, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB453A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 579.0567224025726, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 58.933333333333344, "ram_util_percent": 89.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.417970331758261, "cur_kl_coeff": 1.5046327690525279e-37, "cur_lr": 1e-07, "total_loss": 2.189295217394829, "policy_loss": -8.045792928896844e-05, "vf_loss": 9.98090010881424, "vf_explained_var": -1.911483705043793e-05, "kl": 2.3210230968295775e-06, "entropy": 3.058493633568287, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "env_runners": {"episode_reward_max": 604.0439497177176, "episode_reward_min": 426.7035227553151, "episode_reward_mean": 473.25567483765843, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.7035227553151}, "policy_reward_max": {"tplp_policy": 604.0439497177176}, "policy_reward_mean": {"tplp_policy": 473.25567483765843}, "custom_metrics": {"mean_episode_reward_mean": 473.25567483765843, "mean_episode_reward_min": 426.7035227553151, "mean_episode_reward_max": 604.0439497177176}, "hist_stats": {"episode_reward": [450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.8612285795169, 476.6130579104925, 475.82335806737694, 484.63849286216237, 438.49321617740986, 500.1400384383254, 458.51571882457773, 464.1462589855356, 451.8964974133474, 464.74034885895, 487.0081947800832, 535.5691583183567, 468.3122946002565, 486.8940047599854, 480.54037014005957, 475.27736433666945, 476.8361279987099, 496.08464328985906, 446.9054604677321, 495.0169095005597, 488.03784705483133, 478.06397490245854, 498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4944415483240896, "mean_inference_ms": 4.452933311628901, "mean_action_processing_ms": 0.8221696448232113, "mean_env_wait_ms": 4.270313630181411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025151491165161133, "StateBufferConnector_ms": 0.02160811424255371, "ViewRequirementAgentConnector_ms": 0.545767068862915}, "num_episodes": 18, "episode_return_max": 604.0439497177176, "episode_return_min": 426.7035227553151, "episode_return_mean": 473.25567483765843, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904, "num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 199.42590421531068, "num_env_steps_trained_throughput_per_sec": 199.42590421531068, "timesteps_total": 123904, "num_env_steps_sampled_lifetime": 123904, "num_agent_steps_sampled_lifetime": 123904, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 123904, "timers": {"training_iteration_time_ms": 4919.27, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4919.27, "sample_time_ms": 2079.329, "learn_time_ms": 2802.546, "learn_throughput": 365.382, "synch_weights_time_ms": 37.063}, "counters": {"num_env_steps_sampled": 123904, "num_env_steps_trained": 123904, "num_agent_steps_sampled": 123904, "num_agent_steps_trained": 123904}, "done": false, "training_iteration": 121, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-28", "timestamp": 1744125988, "time_this_iter_s": 5.148648262023926, "time_total_s": 584.2053706645966, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46F20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 584.2053706645966, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 55.637499999999996, "ram_util_percent": 89.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3193381940945983, "cur_kl_coeff": 7.523163845262639e-38, "cur_lr": 1e-07, "total_loss": 2.1930972792208197, "policy_loss": -2.931062481366098e-05, "vf_loss": 9.99701343178749, "vf_explained_var": -1.2558698654174804e-05, "kl": 1.4236183388624534e-06, "entropy": 3.061267727613449, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "env_runners": {"episode_reward_max": 604.0439497177176, "episode_reward_min": 426.7035227553151, "episode_reward_mean": 474.22489263671895, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.7035227553151}, "policy_reward_max": {"tplp_policy": 604.0439497177176}, "policy_reward_mean": {"tplp_policy": 474.22489263671895}, "custom_metrics": {"mean_episode_reward_mean": 474.22489263671895, "mean_episode_reward_min": 426.7035227553151, "mean_episode_reward_max": 604.0439497177176}, "hist_stats": {"episode_reward": [498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [498.9131314761611, 504.6233890364451, 470.5330634809077, 529.8314273890753, 449.4307916738086, 463.3437766266872, 466.1324261579537, 451.49659376443543, 496.27065412474246, 476.32554713632334, 442.75132157917426, 453.2624714540772, 495.7445591354783, 473.63972052198955, 443.8935233066884, 503.11979173444087, 481.1863913209466, 474.49315577899944, 462.59753292695297, 487.25814856273996, 433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4962719288699182, "mean_inference_ms": 4.457749021438003, "mean_action_processing_ms": 0.8229128071485227, "mean_env_wait_ms": 4.274311795626182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022123098373413086, "StateBufferConnector_ms": 0.02140069007873535, "ViewRequirementAgentConnector_ms": 0.5617997646331787}, "num_episodes": 22, "episode_return_max": 604.0439497177176, "episode_return_min": 426.7035227553151, "episode_return_mean": 474.22489263671895, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928, "num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 192.79420433315792, "num_env_steps_trained_throughput_per_sec": 192.79420433315792, "timesteps_total": 124928, "num_env_steps_sampled_lifetime": 124928, "num_agent_steps_sampled_lifetime": 124928, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 124928, "timers": {"training_iteration_time_ms": 4978.985, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4978.985, "sample_time_ms": 2112.984, "learn_time_ms": 2828.16, "learn_throughput": 362.073, "synch_weights_time_ms": 37.509}, "counters": {"num_env_steps_sampled": 124928, "num_env_steps_trained": 124928, "num_agent_steps_sampled": 124928, "num_agent_steps_trained": 124928}, "done": false, "training_iteration": 122, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-33", "timestamp": 1744125993, "time_this_iter_s": 5.321158170700073, "time_total_s": 589.5265288352966, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 589.5265288352966, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 58.8, "ram_util_percent": 89.35714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.356203964725137, "cur_kl_coeff": 3.7615819226313197e-38, "cur_lr": 1e-07, "total_loss": 2.191439238935709, "policy_loss": -6.649350689258426e-05, "vf_loss": 9.991025561094284, "vf_explained_var": -1.4374405145645141e-05, "kl": 4.6383433400937204e-07, "entropy": 3.0625065505504607, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "env_runners": {"episode_reward_max": 604.0439497177176, "episode_reward_min": 426.7035227553151, "episode_reward_mean": 475.2510934558443, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.7035227553151}, "policy_reward_max": {"tplp_policy": 604.0439497177176}, "policy_reward_mean": {"tplp_policy": 475.2510934558443}, "custom_metrics": {"mean_episode_reward_mean": 475.2510934558443, "mean_episode_reward_min": 426.7035227553151, "mean_episode_reward_max": 604.0439497177176}, "hist_stats": {"episode_reward": [433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [433.20640596708137, 440.15274463903654, 480.26858246688835, 481.29137989340813, 434.3196567561805, 519.9045959010773, 467.23538111171325, 481.6705353558822, 471.4362446535352, 458.05817171467874, 464.5201272671233, 470.3880751688347, 438.81545530579285, 467.1607180405332, 464.858314738353, 482.1713290771427, 464.218172031045, 478.6871251485851, 470.535578345748, 472.75054678565556, 466.45235094601736, 465.1296648387689, 442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.497847802155442, "mean_inference_ms": 4.461129189653368, "mean_action_processing_ms": 0.823561067327172, "mean_env_wait_ms": 4.277087812605794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014198064804077148, "StateBufferConnector_ms": 0.02727031707763672, "ViewRequirementAgentConnector_ms": 0.5432367324829102}, "num_episodes": 20, "episode_return_max": 604.0439497177176, "episode_return_min": 426.7035227553151, "episode_return_mean": 475.2510934558443, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952, "num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 200.27415133473596, "num_env_steps_trained_throughput_per_sec": 200.27415133473596, "timesteps_total": 125952, "num_env_steps_sampled_lifetime": 125952, "num_agent_steps_sampled_lifetime": 125952, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 125952, "timers": {"training_iteration_time_ms": 4962.94, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4962.94, "sample_time_ms": 2117.391, "learn_time_ms": 2808.149, "learn_throughput": 364.653, "synch_weights_time_ms": 37.169}, "counters": {"num_env_steps_sampled": 125952, "num_env_steps_trained": 125952, "num_agent_steps_sampled": 125952, "num_agent_steps_trained": 125952}, "done": false, "training_iteration": 123, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-39", "timestamp": 1744125999, "time_this_iter_s": 5.120529890060425, "time_total_s": 594.647058725357, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB460C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 594.647058725357, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 65.01666666666667, "ram_util_percent": 89.53333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.99124882761389, "cur_kl_coeff": 1.8807909613156599e-38, "cur_lr": 1e-07, "total_loss": 2.193706864863634, "policy_loss": -3.2747426303103566e-05, "vf_loss": 10.0, "vf_explained_var": -7.860362529754639e-06, "kl": 3.7878031627081035e-07, "entropy": 3.0626036927103995, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "env_runners": {"episode_reward_max": 604.0439497177176, "episode_reward_min": 426.56972797021393, "episode_reward_mean": 475.92406164942383, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.56972797021393}, "policy_reward_max": {"tplp_policy": 604.0439497177176}, "policy_reward_mean": {"tplp_policy": 475.92406164942383}, "custom_metrics": {"mean_episode_reward_mean": 475.92406164942383, "mean_episode_reward_min": 426.56972797021393, "mean_episode_reward_max": 604.0439497177176}, "hist_stats": {"episode_reward": [442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [442.3206437650216, 461.5571451230046, 453.8045345314304, 455.8622621109684, 467.8611379609295, 486.6382028413757, 433.45182778918644, 478.29527307425843, 492.66705488556414, 469.4488998785882, 494.78567334335696, 479.0822043476296, 478.65991559875914, 426.7035227553151, 486.8587646211535, 457.5435149171508, 483.4554321713554, 453.2652747584537, 436.40426306729717, 505.8182196306163, 462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4997681476565667, "mean_inference_ms": 4.4627989221063515, "mean_action_processing_ms": 0.8237548680141177, "mean_env_wait_ms": 4.278586082025909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010580778121948242, "StateBufferConnector_ms": 0.02595376968383789, "ViewRequirementAgentConnector_ms": 0.5441775321960449}, "num_episodes": 22, "episode_return_max": 604.0439497177176, "episode_return_min": 426.56972797021393, "episode_return_mean": 475.92406164942383, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976, "num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 223.35350529864073, "num_env_steps_trained_throughput_per_sec": 223.35350529864073, "timesteps_total": 126976, "num_env_steps_sampled_lifetime": 126976, "num_agent_steps_sampled_lifetime": 126976, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 126976, "timers": {"training_iteration_time_ms": 4960.281, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4960.281, "sample_time_ms": 2143.875, "learn_time_ms": 2778.791, "learn_throughput": 368.506, "synch_weights_time_ms": 37.382}, "counters": {"num_env_steps_sampled": 126976, "num_env_steps_trained": 126976, "num_agent_steps_sampled": 126976, "num_agent_steps_trained": 126976}, "done": false, "training_iteration": 124, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-43", "timestamp": 1744126003, "time_this_iter_s": 4.597519159317017, "time_total_s": 599.2445778846741, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 599.2445778846741, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 50.91428571428571, "ram_util_percent": 89.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2953639328479767, "cur_kl_coeff": 9.403954806578299e-39, "cur_lr": 1e-07, "total_loss": 2.193591582030058, "policy_loss": -9.009990026243031e-05, "vf_loss": 10.0, "vf_explained_var": -1.2001395225524902e-05, "kl": 7.951226136615474e-07, "entropy": 3.063183219730854, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 604.0439497177176, "episode_reward_min": 426.56972797021393, "episode_reward_mean": 479.04592330833117, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.56972797021393}, "policy_reward_max": {"tplp_policy": 604.0439497177176}, "policy_reward_mean": {"tplp_policy": 479.04592330833117}, "custom_metrics": {"mean_episode_reward_mean": 479.04592330833117, "mean_episode_reward_min": 426.56972797021393, "mean_episode_reward_max": 604.0439497177176}, "hist_stats": {"episode_reward": [462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.5963975138512, 522.0111065405259, 495.99775267399133, 470.28127471238895, 522.1571658905779, 479.4456546292941, 449.1821120965935, 475.09492104699365, 469.5381913032917, 476.67778088958033, 445.51490729215374, 461.9847004142996, 461.40693992083925, 435.9834331974748, 470.6742891464871, 604.0439497177176, 470.69747742818805, 440.2393521813225, 476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5008278282357668, "mean_inference_ms": 4.466893498659667, "mean_action_processing_ms": 0.8243052896281481, "mean_env_wait_ms": 4.283086154043531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010815143585205078, "StateBufferConnector_ms": 0.025346755981445312, "ViewRequirementAgentConnector_ms": 0.5299413204193115}, "num_episodes": 20, "episode_return_max": 604.0439497177176, "episode_return_min": 426.56972797021393, "episode_return_mean": 479.04592330833117, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 205.14399479489123, "num_env_steps_trained_throughput_per_sec": 205.14399479489123, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 4957.891, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4957.891, "sample_time_ms": 2154.105, "learn_time_ms": 2765.564, "learn_throughput": 370.268, "synch_weights_time_ms": 37.889}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 125, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-48", "timestamp": 1744126008, "time_this_iter_s": 5.004286050796509, "time_total_s": 604.2488639354706, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 604.2488639354706, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 56.8, "ram_util_percent": 89.34285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2688177056610583, "cur_kl_coeff": 4.7019774032891496e-39, "cur_lr": 1e-07, "total_loss": 2.18758837133646, "policy_loss": -0.000132235191995278, "vf_loss": 9.976767128705978, "vf_explained_var": -1.4400109648704529e-05, "kl": 2.196200758375344e-06, "entropy": 3.0647116601467133, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "env_runners": {"episode_reward_max": 552.2685491302459, "episode_reward_min": 426.56972797021393, "episode_reward_mean": 479.8209609568917, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 426.56972797021393}, "policy_reward_max": {"tplp_policy": 552.2685491302459}, "policy_reward_mean": {"tplp_policy": 479.8209609568917}, "custom_metrics": {"mean_episode_reward_mean": 479.8209609568917, "mean_episode_reward_min": 426.56972797021393, "mean_episode_reward_max": 552.2685491302459}, "hist_stats": {"episode_reward": [476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [476.6718413180407, 497.3280370827931, 488.30051201853394, 476.805940330671, 462.5196318677168, 513.2012272096445, 479.10192930183274, 490.8935584802399, 507.51433145320937, 462.8753324052528, 504.76074757886545, 537.6036297536454, 490.77303337174754, 508.9988460912933, 475.99173099859985, 471.1070236559775, 472.13104432461165, 440.0851705020623, 467.7788859071798, 441.9570629118728, 485.3577435309256, 538.4050050200052, 480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.501730903210195, "mean_inference_ms": 4.4684887323795826, "mean_action_processing_ms": 0.824584485761543, "mean_env_wait_ms": 4.285410472107281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009168386459350586, "StateBufferConnector_ms": 0.01722574234008789, "ViewRequirementAgentConnector_ms": 0.6024158000946045}, "num_episodes": 18, "episode_return_max": 552.2685491302459, "episode_return_min": 426.56972797021393, "episode_return_mean": 479.8209609568917, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024, "num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 214.12121446888136, "num_env_steps_trained_throughput_per_sec": 214.12121446888136, "timesteps_total": 129024, "num_env_steps_sampled_lifetime": 129024, "num_agent_steps_sampled_lifetime": 129024, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 129024, "timers": {"training_iteration_time_ms": 4993.448, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4993.448, "sample_time_ms": 2184.721, "learn_time_ms": 2769.18, "learn_throughput": 369.785, "synch_weights_time_ms": 39.346}, "counters": {"num_env_steps_sampled": 129024, "num_env_steps_trained": 129024, "num_agent_steps_sampled": 129024, "num_agent_steps_trained": 129024}, "done": false, "training_iteration": 126, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-53", "timestamp": 1744126013, "time_this_iter_s": 4.799077033996582, "time_total_s": 609.0479409694672, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15B20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 609.0479409694672, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 51.18333333333333, "ram_util_percent": 89.38333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.966629013046622, "cur_kl_coeff": 2.3509887016445748e-39, "cur_lr": 1e-07, "total_loss": 2.193245220184326, "policy_loss": -5.167296621948481e-05, "vf_loss": 10.0, "vf_explained_var": -1.1168420314788818e-05, "kl": 1.1118665359521884e-06, "entropy": 3.067031154036522, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "env_runners": {"episode_reward_max": 552.2685491302459, "episode_reward_min": 415.3271789205876, "episode_reward_mean": 476.40854641062566, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.3271789205876}, "policy_reward_max": {"tplp_policy": 552.2685491302459}, "policy_reward_mean": {"tplp_policy": 476.40854641062566}, "custom_metrics": {"mean_episode_reward_mean": 476.40854641062566, "mean_episode_reward_min": 415.3271789205876, "mean_episode_reward_max": 552.2685491302459}, "hist_stats": {"episode_reward": [480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [480.6648570741359, 457.62938466373146, 472.8746951731648, 468.87200989331643, 465.8971707074624, 541.9333934851179, 479.05050499024696, 456.1093261898561, 491.7622970560719, 482.40328345947523, 484.0055615286678, 473.04351281411607, 461.8801189081605, 474.2303256311015, 481.0293700013954, 457.9640947807686, 520.8613927754755, 453.4934514173695, 478.40499618733537, 442.01606745060883, 467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5029529474758292, "mean_inference_ms": 4.470127221110499, "mean_action_processing_ms": 0.8247922631619802, "mean_env_wait_ms": 4.287460869927178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014629125595092773, "StateBufferConnector_ms": 0.01780223846435547, "ViewRequirementAgentConnector_ms": 0.5713460445404053}, "num_episodes": 22, "episode_return_max": 552.2685491302459, "episode_return_min": 415.3271789205876, "episode_return_mean": 476.40854641062566, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048, "num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 198.3044355014645, "num_env_steps_trained_throughput_per_sec": 198.3044355014645, "timesteps_total": 130048, "num_env_steps_sampled_lifetime": 130048, "num_agent_steps_sampled_lifetime": 130048, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 130048, "timers": {"training_iteration_time_ms": 5005.504, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5005.504, "sample_time_ms": 2196.52, "learn_time_ms": 2770.137, "learn_throughput": 369.657, "synch_weights_time_ms": 38.646}, "counters": {"num_env_steps_sampled": 130048, "num_env_steps_trained": 130048, "num_agent_steps_sampled": 130048, "num_agent_steps_trained": 130048}, "done": false, "training_iteration": 127, "trial_id": "3bf18_00000", "date": "2025-04-08_23-26-59", "timestamp": 1744126019, "time_this_iter_s": 5.178713083267212, "time_total_s": 614.2266540527344, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 614.2266540527344, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 56.300000000000004, "ram_util_percent": 89.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.062445008382201, "cur_kl_coeff": 1.1754943508222874e-39, "cur_lr": 1e-07, "total_loss": 2.187246027588844, "policy_loss": -3.5331700928509236e-06, "vf_loss": 9.976436078548431, "vf_explained_var": -1.192912459373474e-05, "kl": 9.206683352469547e-07, "entropy": 3.068594437837601, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "env_runners": {"episode_reward_max": 552.2685491302459, "episode_reward_min": 415.3271789205876, "episode_reward_mean": 477.74477077341305, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.3271789205876}, "policy_reward_max": {"tplp_policy": 552.2685491302459}, "policy_reward_mean": {"tplp_policy": 477.74477077341305}, "custom_metrics": {"mean_episode_reward_mean": 477.74477077341305, "mean_episode_reward_min": 415.3271789205876, "mean_episode_reward_max": 552.2685491302459}, "hist_stats": {"episode_reward": [467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.01604140414656, 490.61583233234785, 504.39773169991525, 442.24135744750123, 463.98990778740034, 442.50014464859277, 445.819183841445, 462.15008787582315, 458.9284277112327, 455.70194194992064, 426.56972797021393, 504.04684479744094, 466.724515501583, 521.8995028116548, 478.42697103323275, 453.733414003126, 493.71503068937363, 490.4368005812624, 461.7824866715703, 489.4109611153075, 504.66267004447207, 493.2609722860512, 462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5039342142938819, "mean_inference_ms": 4.471974587291774, "mean_action_processing_ms": 0.8250180921176604, "mean_env_wait_ms": 4.2900194859451055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020101547241210938, "StateBufferConnector_ms": 0.011396169662475586, "ViewRequirementAgentConnector_ms": 0.5997440814971924}, "num_episodes": 20, "episode_return_max": 552.2685491302459, "episode_return_min": 415.3271789205876, "episode_return_mean": 477.74477077341305, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072, "num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 202.7933423784417, "num_env_steps_trained_throughput_per_sec": 202.7933423784417, "timesteps_total": 131072, "num_env_steps_sampled_lifetime": 131072, "num_agent_steps_sampled_lifetime": 131072, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 131072, "timers": {"training_iteration_time_ms": 4977.622, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4977.622, "sample_time_ms": 2202.165, "learn_time_ms": 2737.986, "learn_throughput": 373.998, "synch_weights_time_ms": 37.271}, "counters": {"num_env_steps_sampled": 131072, "num_env_steps_trained": 131072, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "done": false, "training_iteration": 128, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-04", "timestamp": 1744126024, "time_this_iter_s": 5.065563917160034, "time_total_s": 619.2922179698944, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC168E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 619.2922179698944, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 60.46666666666667, "ram_util_percent": 89.11666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4187546852976083, "cur_kl_coeff": 5.877471754111437e-40, "cur_lr": 1e-07, "total_loss": 2.1896958857774735, "policy_loss": -7.615381618961692e-05, "vf_loss": 9.987452352046967, "vf_explained_var": -1.2759491801261902e-05, "kl": 2.2472352479804837e-06, "entropy": 3.0709102645516397, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "env_runners": {"episode_reward_max": 552.2685491302459, "episode_reward_min": 415.3271789205876, "episode_reward_mean": 476.5176829899058, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.3271789205876}, "policy_reward_max": {"tplp_policy": 552.2685491302459}, "policy_reward_mean": {"tplp_policy": 476.5176829899058}, "custom_metrics": {"mean_episode_reward_mean": 476.5176829899058, "mean_episode_reward_min": 415.3271789205876, "mean_episode_reward_max": 552.2685491302459}, "hist_stats": {"episode_reward": [462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.75558909701834, 494.6920068064884, 486.58136242701437, 470.65874489717424, 490.2872863301158, 476.56918757069565, 491.41595717672675, 453.9879285350416, 486.3599117039542, 514.1184261386092, 488.25261186148407, 499.46955996225523, 475.91704519342596, 475.88196637769573, 478.3786867073784, 458.50200957596974, 466.9410122163168, 487.97699815427995, 503.1303228348082, 488.96424086547296, 528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5045404602594024, "mean_inference_ms": 4.473144293068608, "mean_action_processing_ms": 0.8251958426225053, "mean_env_wait_ms": 4.291753497306379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020441293716430664, "StateBufferConnector_ms": 0.010038375854492188, "ViewRequirementAgentConnector_ms": 0.5714380741119385}, "num_episodes": 22, "episode_return_max": 552.2685491302459, "episode_return_min": 415.3271789205876, "episode_return_mean": 476.5176829899058, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096, "num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 211.38291625205935, "num_env_steps_trained_throughput_per_sec": 211.38291625205935, "timesteps_total": 132096, "num_env_steps_sampled_lifetime": 132096, "num_agent_steps_sampled_lifetime": 132096, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 132096, "timers": {"training_iteration_time_ms": 4960.501, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4960.501, "sample_time_ms": 2172.899, "learn_time_ms": 2750.805, "learn_throughput": 372.255, "synch_weights_time_ms": 36.596}, "counters": {"num_env_steps_sampled": 132096, "num_env_steps_trained": 132096, "num_agent_steps_sampled": 132096, "num_agent_steps_trained": 132096}, "done": false, "training_iteration": 129, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-09", "timestamp": 1744126029, "time_this_iter_s": 4.8588151931762695, "time_total_s": 624.1510331630707, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F1A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 624.1510331630707, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 55.11428571428572, "ram_util_percent": 88.94285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3693650707602503, "cur_kl_coeff": 2.9387358770557185e-40, "cur_lr": 1e-07, "total_loss": 2.187827291339636, "policy_loss": -5.372909363359213e-05, "vf_loss": 9.980818998813628, "vf_explained_var": -1.611150801181793e-05, "kl": 1.0859850206657028e-06, "entropy": 3.073237493634224, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "env_runners": {"episode_reward_max": 552.2685491302459, "episode_reward_min": 415.3271789205876, "episode_reward_mean": 476.01464857174005, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.3271789205876}, "policy_reward_max": {"tplp_policy": 552.2685491302459}, "policy_reward_mean": {"tplp_policy": 476.01464857174005}, "custom_metrics": {"mean_episode_reward_mean": 476.01464857174005, "mean_episode_reward_min": 415.3271789205876, "mean_episode_reward_max": 552.2685491302459}, "hist_stats": {"episode_reward": [528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [528.2688186012534, 465.7568625244765, 484.52448998922216, 482.0889560485289, 552.2685491302459, 519.7151686829642, 452.81735773776234, 484.84169844496154, 452.2446008088908, 460.69744854346294, 480.5919226607024, 463.1140186009139, 481.9490215126038, 474.2061656475544, 446.82440182682797, 469.0271269909567, 433.029947373929, 462.66208101388565, 444.6387028733937, 463.0207501615589, 474.7689994980339, 440.752445112322, 460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5046572090310852, "mean_inference_ms": 4.474293448402417, "mean_action_processing_ms": 0.8255514000025524, "mean_env_wait_ms": 4.2935618916367435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020969629287719727, "StateBufferConnector_ms": 0.010646343231201172, "ViewRequirementAgentConnector_ms": 0.5505168437957764}, "num_episodes": 20, "episode_return_max": 552.2685491302459, "episode_return_min": 415.3271789205876, "episode_return_mean": 476.01464857174005, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120, "num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.9212325698472, "num_env_steps_trained_throughput_per_sec": 217.9212325698472, "timesteps_total": 133120, "num_env_steps_sampled_lifetime": 133120, "num_agent_steps_sampled_lifetime": 133120, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 133120, "timers": {"training_iteration_time_ms": 4967.42, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4967.42, "sample_time_ms": 2176.925, "learn_time_ms": 2754.09, "learn_throughput": 371.811, "synch_weights_time_ms": 36.204}, "counters": {"num_env_steps_sampled": 133120, "num_env_steps_trained": 133120, "num_agent_steps_sampled": 133120, "num_agent_steps_trained": 133120}, "done": false, "training_iteration": 130, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-14", "timestamp": 1744126034, "time_this_iter_s": 4.706951141357422, "time_total_s": 628.8579843044281, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16DE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 628.8579843044281, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 53.25714285714285, "ram_util_percent": 88.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4766520723700522, "cur_kl_coeff": 1.4693679385278593e-40, "cur_lr": 1e-07, "total_loss": 2.186597920209169, "policy_loss": -0.00020103307324461638, "vf_loss": 9.976948469877243, "vf_explained_var": -4.499778151512146e-06, "kl": 2.1580673319962496e-06, "entropy": 3.0743816301226614, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "env_runners": {"episode_reward_max": 535.7289145069365, "episode_reward_min": 415.3271789205876, "episode_reward_mean": 475.47999840288895, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 415.3271789205876}, "policy_reward_max": {"tplp_policy": 535.7289145069365}, "policy_reward_mean": {"tplp_policy": 475.47999840288895}, "custom_metrics": {"mean_episode_reward_mean": 475.47999840288895, "mean_episode_reward_min": 415.3271789205876, "mean_episode_reward_max": 535.7289145069365}, "hist_stats": {"episode_reward": [460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [460.2005242917591, 479.83511547347683, 526.5681208607004, 516.5893271737245, 468.9123386204262, 415.3271789205876, 497.09230378217444, 474.2007645446945, 465.1804072588564, 448.54754603766094, 457.48191028509285, 483.44399937062474, 459.42751850636364, 523.5798523650896, 455.6283359506386, 498.0326410131186, 521.6204930965583, 487.6770585532443, 474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5050601258168081, "mean_inference_ms": 4.473686842746121, "mean_action_processing_ms": 0.8256942047206814, "mean_env_wait_ms": 4.293958355455196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02315378189086914, "StateBufferConnector_ms": 0.013751029968261719, "ViewRequirementAgentConnector_ms": 0.47578907012939453}, "num_episodes": 22, "episode_return_max": 535.7289145069365, "episode_return_min": 415.3271789205876, "episode_return_mean": 475.47999840288895, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144, "num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 197.56257427052395, "num_env_steps_trained_throughput_per_sec": 197.56257427052395, "timesteps_total": 134144, "num_env_steps_sampled_lifetime": 134144, "num_agent_steps_sampled_lifetime": 134144, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 134144, "timers": {"training_iteration_time_ms": 4972.262, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4972.262, "sample_time_ms": 2149.872, "learn_time_ms": 2785.778, "learn_throughput": 367.581, "synch_weights_time_ms": 36.412}, "counters": {"num_env_steps_sampled": 134144, "num_env_steps_trained": 134144, "num_agent_steps_sampled": 134144, "num_agent_steps_trained": 134144}, "done": false, "training_iteration": 131, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-19", "timestamp": 1744126039, "time_this_iter_s": 5.199871778488159, "time_total_s": 634.0578560829163, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46A20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 634.0578560829163, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 61.07142857142856, "ram_util_percent": 88.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.12764250934124, "cur_kl_coeff": 7.346839692639296e-41, "cur_lr": 1e-07, "total_loss": 2.185288383811712, "policy_loss": -0.00013304200838319956, "vf_loss": 9.971804898977279, "vf_explained_var": -8.374825119972229e-06, "kl": 1.3755028037465421e-06, "entropy": 3.075297977030277, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "env_runners": {"episode_reward_max": 535.7289145069365, "episode_reward_min": 422.2639079822726, "episode_reward_mean": 473.3029572514739, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 422.2639079822726}, "policy_reward_max": {"tplp_policy": 535.7289145069365}, "policy_reward_mean": {"tplp_policy": 473.3029572514739}, "custom_metrics": {"mean_episode_reward_mean": 473.3029572514739, "mean_episode_reward_min": 422.2639079822726, "mean_episode_reward_max": 535.7289145069365}, "hist_stats": {"episode_reward": [474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [474.2942460150093, 453.4367176844524, 461.23472752698353, 516.5494651441716, 434.19466465310046, 521.2750641348351, 490.0347677156279, 535.7289145069365, 494.1344448259552, 490.11499504223667, 525.6343203752602, 427.1721479086661, 471.96858446067114, 473.75244616884333, 457.93059018142105, 481.5863516594341, 477.36075877146243, 462.047492041452, 436.65580307455946, 447.6918814190202, 456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5043074141249104, "mean_inference_ms": 4.47554352366511, "mean_action_processing_ms": 0.8261728708546973, "mean_env_wait_ms": 4.296070413858168, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016979455947875977, "StateBufferConnector_ms": 0.011545896530151367, "ViewRequirementAgentConnector_ms": 0.5371718406677246}, "num_episodes": 18, "episode_return_max": 535.7289145069365, "episode_return_min": 422.2639079822726, "episode_return_mean": 473.3029572514739, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168, "num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 208.73092362217344, "num_env_steps_trained_throughput_per_sec": 208.73092362217344, "timesteps_total": 135168, "num_env_steps_sampled_lifetime": 135168, "num_agent_steps_sampled_lifetime": 135168, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 135168, "timers": {"training_iteration_time_ms": 4931.71, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4931.71, "sample_time_ms": 2151.927, "learn_time_ms": 2743.478, "learn_throughput": 373.249, "synch_weights_time_ms": 36.104}, "counters": {"num_env_steps_sampled": 135168, "num_env_steps_trained": 135168, "num_agent_steps_sampled": 135168, "num_agent_steps_trained": 135168}, "done": false, "training_iteration": 132, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-24", "timestamp": 1744126044, "time_this_iter_s": 4.924350261688232, "time_total_s": 638.9822063446045, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16D40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 638.9822063446045, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 52.67142857142857, "ram_util_percent": 88.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.11680139452219, "cur_kl_coeff": 3.673419846319648e-41, "cur_lr": 1e-07, "total_loss": 2.18771111741662, "policy_loss": 1.559210941195488e-05, "vf_loss": 9.981417697668075, "vf_explained_var": -5.039200186729431e-06, "kl": 6.110081799792777e-07, "entropy": 3.0765888929367065, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "env_runners": {"episode_reward_max": 529.6895584865914, "episode_reward_min": 422.2639079822726, "episode_reward_mean": 471.29191099843297, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 422.2639079822726}, "policy_reward_max": {"tplp_policy": 529.6895584865914}, "policy_reward_mean": {"tplp_policy": 471.29191099843297}, "custom_metrics": {"mean_episode_reward_mean": 471.29191099843297, "mean_episode_reward_min": 422.2639079822726, "mean_episode_reward_max": 529.6895584865914}, "hist_stats": {"episode_reward": [456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [456.2265432365732, 479.6708144538622, 471.8274022376957, 458.34763652070245, 484.21702989552875, 521.5966439816634, 482.5945812698079, 521.0825159497605, 465.02608832155573, 480.5940231195846, 434.7972403152925, 459.5606921038684, 462.49658882667677, 477.5428630833266, 492.62719403940537, 450.95627534706244, 450.8796525362987, 446.021074229128, 451.4840400415675, 463.4251918499427, 422.2639079822726, 487.1399315752167, 446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5041787401017144, "mean_inference_ms": 4.476115018627868, "mean_action_processing_ms": 0.8265608315721952, "mean_env_wait_ms": 4.297472968085263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017484664916992188, "StateBufferConnector_ms": 0.01198577880859375, "ViewRequirementAgentConnector_ms": 0.5202646255493164}, "num_episodes": 20, "episode_return_max": 529.6895584865914, "episode_return_min": 422.2639079822726, "episode_return_mean": 471.29191099843297, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192, "num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 203.2379143855068, "num_env_steps_trained_throughput_per_sec": 203.2379143855068, "timesteps_total": 136192, "num_env_steps_sampled_lifetime": 136192, "num_agent_steps_sampled_lifetime": 136192, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 136192, "timers": {"training_iteration_time_ms": 4924.254, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4924.254, "sample_time_ms": 2151.878, "learn_time_ms": 2735.927, "learn_throughput": 374.279, "synch_weights_time_ms": 36.105}, "counters": {"num_env_steps_sampled": 136192, "num_env_steps_trained": 136192, "num_agent_steps_sampled": 136192, "num_agent_steps_trained": 136192}, "done": false, "training_iteration": 133, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-29", "timestamp": 1744126049, "time_this_iter_s": 5.0606677532196045, "time_total_s": 644.0428740978241, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 644.0428740978241, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 53.34285714285714, "ram_util_percent": 88.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.302651545032859, "cur_kl_coeff": 1.836709923159824e-41, "cur_lr": 1e-07, "total_loss": 2.1898249089717865, "policy_loss": -4.137002397328615e-05, "vf_loss": 9.990485394001007, "vf_explained_var": -1.341886818408966e-05, "kl": 5.467941818326772e-07, "entropy": 3.077550619840622, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "env_runners": {"episode_reward_max": 540.1884772391993, "episode_reward_min": 423.8982766566305, "episode_reward_mean": 474.83182264756107, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.8982766566305}, "policy_reward_max": {"tplp_policy": 540.1884772391993}, "policy_reward_mean": {"tplp_policy": 474.83182264756107}, "custom_metrics": {"mean_episode_reward_mean": 474.83182264756107, "mean_episode_reward_min": 423.8982766566305, "mean_episode_reward_max": 540.1884772391993}, "hist_stats": {"episode_reward": [446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [446.761458523064, 461.42869616929215, 469.16481900492573, 467.31408983067644, 529.6895584865914, 522.5236810491527, 501.083658270692, 465.275756328501, 454.0935031694535, 478.3133527011866, 490.10357426433984, 486.44898085251583, 477.2959855246466, 489.0079996807751, 479.12407912616, 515.455159619392, 436.14629829646316, 521.9029221600377, 486.86785321394103, 450.48253148532393, 459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5047239185252956, "mean_inference_ms": 4.478558233331385, "mean_action_processing_ms": 0.8272250681335863, "mean_env_wait_ms": 4.300402703280779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027424097061157227, "StateBufferConnector_ms": 0.01828742027282715, "ViewRequirementAgentConnector_ms": 0.5634627342224121}, "num_episodes": 22, "episode_return_max": 540.1884772391993, "episode_return_min": 423.8982766566305, "episode_return_mean": 474.83182264756107, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216, "num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 209.5460795337591, "num_env_steps_trained_throughput_per_sec": 209.5460795337591, "timesteps_total": 137216, "num_env_steps_sampled_lifetime": 137216, "num_agent_steps_sampled_lifetime": 137216, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 137216, "timers": {"training_iteration_time_ms": 4954.463, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4954.463, "sample_time_ms": 2166.186, "learn_time_ms": 2751.638, "learn_throughput": 372.142, "synch_weights_time_ms": 36.176}, "counters": {"num_env_steps_sampled": 137216, "num_env_steps_trained": 137216, "num_agent_steps_sampled": 137216, "num_agent_steps_trained": 137216}, "done": false, "training_iteration": 134, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-34", "timestamp": 1744126054, "time_this_iter_s": 4.899793863296509, "time_total_s": 648.9426679611206, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC168E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 648.9426679611206, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 61.03333333333333, "ram_util_percent": 88.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2354527171701193, "cur_kl_coeff": 9.18354961579912e-42, "cur_lr": 1e-07, "total_loss": 2.180078874528408, "policy_loss": -7.647370221093297e-05, "vf_loss": 9.952188336849213, "vf_explained_var": -8.268281817436218e-06, "kl": 1.1948338920361735e-06, "entropy": 3.0789172634482385, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "env_runners": {"episode_reward_max": 540.1884772391993, "episode_reward_min": 416.2313484926857, "episode_reward_mean": 472.89223989658336, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.2313484926857}, "policy_reward_max": {"tplp_policy": 540.1884772391993}, "policy_reward_mean": {"tplp_policy": 472.89223989658336}, "custom_metrics": {"mean_episode_reward_mean": 472.89223989658336, "mean_episode_reward_min": 416.2313484926857, "mean_episode_reward_max": 540.1884772391993}, "hist_stats": {"episode_reward": [459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.41763280423305, 499.20432536251565, 477.86914402752245, 477.04441597811586, 468.4663027823623, 427.19960532787843, 476.44289782151236, 450.15295888361646, 496.4953550444993, 453.91416204569396, 469.68881960079386, 463.22764160279354, 480.63055290571475, 482.2690945957231, 474.66527500773697, 500.6786709377105, 462.91592662026625, 467.04181826625904, 484.4618771330091, 455.2076554521157, 465.8158528499051, 476.0737393718649, 447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5054555359045871, "mean_inference_ms": 4.481101430664699, "mean_action_processing_ms": 0.827746364045498, "mean_env_wait_ms": 4.303011988734095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026453733444213867, "StateBufferConnector_ms": 0.015140295028686523, "ViewRequirementAgentConnector_ms": 0.5535640716552734}, "num_episodes": 20, "episode_return_max": 540.1884772391993, "episode_return_min": 416.2313484926857, "episode_return_mean": 472.89223989658336, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240, "num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.94366516216036, "num_env_steps_trained_throughput_per_sec": 204.94366516216036, "timesteps_total": 138240, "num_env_steps_sampled_lifetime": 138240, "num_agent_steps_sampled_lifetime": 138240, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 138240, "timers": {"training_iteration_time_ms": 4954.951, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4954.951, "sample_time_ms": 2173.466, "learn_time_ms": 2744.969, "learn_throughput": 373.046, "synch_weights_time_ms": 36.054}, "counters": {"num_env_steps_sampled": 138240, "num_env_steps_trained": 138240, "num_agent_steps_sampled": 138240, "num_agent_steps_trained": 138240}, "done": false, "training_iteration": 135, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-39", "timestamp": 1744126059, "time_this_iter_s": 5.011228322982788, "time_total_s": 653.9538962841034, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 653.9538962841034, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 54.62857142857142, "ram_util_percent": 88.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.249974610470235, "cur_kl_coeff": 4.59177480789956e-42, "cur_lr": 1e-07, "total_loss": 2.1884438365697862, "policy_loss": -1.2935756240040064e-05, "vf_loss": 9.986233896017074, "vf_explained_var": -6.935372948646546e-06, "kl": 1.6138949786359546e-06, "entropy": 3.081016945838928, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "env_runners": {"episode_reward_max": 540.1884772391993, "episode_reward_min": 416.2313484926857, "episode_reward_mean": 472.8299017636642, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.2313484926857}, "policy_reward_max": {"tplp_policy": 540.1884772391993}, "policy_reward_mean": {"tplp_policy": 472.8299017636642}, "custom_metrics": {"mean_episode_reward_mean": 472.8299017636642, "mean_episode_reward_min": 416.2313484926857, "mean_episode_reward_max": 540.1884772391993}, "hist_stats": {"episode_reward": [447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [447.9514232116188, 488.8859162613463, 453.9568370108808, 497.4178934196835, 479.5510748959936, 427.38351819164393, 462.29065749362366, 495.0297551928044, 509.071212703294, 468.8453834985098, 423.8982766566305, 442.2683883875618, 436.2429737388007, 504.4611495287365, 456.1289426126863, 486.36832593770987, 458.9103345442722, 466.951116363778, 494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5063465181150655, "mean_inference_ms": 4.484083324974536, "mean_action_processing_ms": 0.8286290777579797, "mean_env_wait_ms": 4.306111587595623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034294843673706055, "StateBufferConnector_ms": 0.01113438606262207, "ViewRequirementAgentConnector_ms": 0.5127067565917969}, "num_episodes": 22, "episode_return_max": 540.1884772391993, "episode_return_min": 416.2313484926857, "episode_return_mean": 472.8299017636642, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264, "num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.77903720506538, "num_env_steps_trained_throughput_per_sec": 210.77903720506538, "timesteps_total": 139264, "num_env_steps_sampled_lifetime": 139264, "num_agent_steps_sampled_lifetime": 139264, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 139264, "timers": {"training_iteration_time_ms": 4962.534, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4962.534, "sample_time_ms": 2176.886, "learn_time_ms": 2750.504, "learn_throughput": 372.295, "synch_weights_time_ms": 34.68}, "counters": {"num_env_steps_sampled": 139264, "num_env_steps_trained": 139264, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "done": false, "training_iteration": 136, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-44", "timestamp": 1744126064, "time_this_iter_s": 4.869403123855591, "time_total_s": 658.823299407959, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC179C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 658.823299407959, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 54.25714285714286, "ram_util_percent": 89.14285714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.163509749248624, "cur_kl_coeff": 2.29588740394978e-42, "cur_lr": 1e-07, "total_loss": 2.1914252787828445, "policy_loss": -6.830932688899339e-05, "vf_loss": 9.999386781454087, "vf_explained_var": -1.2234225869178772e-05, "kl": 1.6123491392211474e-06, "entropy": 3.0835308119654656, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "env_runners": {"episode_reward_max": 548.4256633104911, "episode_reward_min": 398.7031726701569, "episode_reward_mean": 476.20544244247486, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 398.7031726701569}, "policy_reward_max": {"tplp_policy": 548.4256633104911}, "policy_reward_mean": {"tplp_policy": 476.20544244247486}, "custom_metrics": {"mean_episode_reward_mean": 476.20544244247486, "mean_episode_reward_min": 398.7031726701569, "mean_episode_reward_max": 548.4256633104911}, "hist_stats": {"episode_reward": [494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [494.44463699337996, 460.1369844625819, 479.459760744421, 496.59850039920985, 475.4578943302705, 482.4023138488068, 476.1747378110865, 492.2035467216213, 445.44062806765714, 440.27685341161344, 464.80290558891966, 430.71882085211433, 491.574046255094, 491.37460360408045, 446.21573720779185, 465.50936719917894, 428.5579149458678, 444.48305465425574, 482.70436316419836, 511.7559130882801, 452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5073580217966216, "mean_inference_ms": 4.486744833475629, "mean_action_processing_ms": 0.8294360375875997, "mean_env_wait_ms": 4.308607544094413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03756451606750488, "StateBufferConnector_ms": 0.017148256301879883, "ViewRequirementAgentConnector_ms": 0.5567009449005127}, "num_episodes": 18, "episode_return_max": 548.4256633104911, "episode_return_min": 398.7031726701569, "episode_return_mean": 476.20544244247486, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288, "num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 185.71684723641715, "num_env_steps_trained_throughput_per_sec": 185.71684723641715, "timesteps_total": 140288, "num_env_steps_sampled_lifetime": 140288, "num_agent_steps_sampled_lifetime": 140288, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 140288, "timers": {"training_iteration_time_ms": 4997.533, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4997.533, "sample_time_ms": 2175.845, "learn_time_ms": 2784.672, "learn_throughput": 367.727, "synch_weights_time_ms": 36.553}, "counters": {"num_env_steps_sampled": 140288, "num_env_steps_trained": 140288, "num_agent_steps_sampled": 140288, "num_agent_steps_trained": 140288}, "done": false, "training_iteration": 137, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-50", "timestamp": 1744126070, "time_this_iter_s": 5.5260703563690186, "time_total_s": 664.349369764328, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47A60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 664.349369764328, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 55.574999999999996, "ram_util_percent": 89.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.437008955329657, "cur_kl_coeff": 1.14794370197489e-42, "cur_lr": 1e-07, "total_loss": 2.1890143126249315, "policy_loss": -4.8611051170155406e-05, "vf_loss": 9.9904039144516, "vf_explained_var": -1.3016164302825928e-05, "kl": 1.3900445415826468e-06, "entropy": 3.0853805735707285, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "env_runners": {"episode_reward_max": 548.4256633104911, "episode_reward_min": 398.7031726701569, "episode_reward_mean": 475.9345165961811, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 398.7031726701569}, "policy_reward_max": {"tplp_policy": 548.4256633104911}, "policy_reward_mean": {"tplp_policy": 475.9345165961811}, "custom_metrics": {"mean_episode_reward_mean": 475.9345165961811, "mean_episode_reward_min": 398.7031726701569, "mean_episode_reward_max": 548.4256633104911}, "hist_stats": {"episode_reward": [452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [452.5876677896449, 515.6742667939562, 460.3931349667596, 475.71482062352663, 482.9663911607604, 473.2706651822303, 479.4170876564094, 474.0130833944876, 454.81282847140915, 482.14605376366757, 459.5002017044256, 484.0215589286322, 496.6214891918443, 540.1884772391993, 490.23479531307385, 486.46944217620523, 463.01846329227936, 511.7656526806347, 499.2157654603595, 497.87697378761806, 469.40443232910906, 455.3147866408045, 466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.508330487828229, "mean_inference_ms": 4.489695815143472, "mean_action_processing_ms": 0.8303936931865477, "mean_env_wait_ms": 4.311028673491379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04237675666809082, "StateBufferConnector_ms": 0.017657756805419922, "ViewRequirementAgentConnector_ms": 0.5657415390014648}, "num_episodes": 20, "episode_return_max": 548.4256633104911, "episode_return_min": 398.7031726701569, "episode_return_mean": 475.9345165961811, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312, "num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 208.01204047756246, "num_env_steps_trained_throughput_per_sec": 208.01204047756246, "timesteps_total": 141312, "num_env_steps_sampled_lifetime": 141312, "num_agent_steps_sampled_lifetime": 141312, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 141312, "timers": {"training_iteration_time_ms": 4984.865, "restore_workers_time_ms": 0.132, "training_step_time_ms": 4984.733, "sample_time_ms": 2154.301, "learn_time_ms": 2792.565, "learn_throughput": 366.688, "synch_weights_time_ms": 37.404}, "counters": {"num_env_steps_sampled": 141312, "num_env_steps_trained": 141312, "num_agent_steps_sampled": 141312, "num_agent_steps_trained": 141312}, "done": false, "training_iteration": 138, "trial_id": "3bf18_00000", "date": "2025-04-08_23-27-55", "timestamp": 1744126075, "time_this_iter_s": 4.938782215118408, "time_total_s": 669.2881519794464, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 669.2881519794464, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 57.23333333333333, "ram_util_percent": 89.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.53890511803329, "cur_kl_coeff": 5.73971850987445e-43, "cur_lr": 1e-07, "total_loss": 2.19135727211833, "policy_loss": -5.321417120285332e-06, "vf_loss": 10.0, "vf_explained_var": -1.6198307275772094e-05, "kl": 3.2388212125589175e-07, "entropy": 3.0863739967346193, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "env_runners": {"episode_reward_max": 562.2176790906898, "episode_reward_min": 398.7031726701569, "episode_reward_mean": 476.61463790169694, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 398.7031726701569}, "policy_reward_max": {"tplp_policy": 562.2176790906898}, "policy_reward_mean": {"tplp_policy": 476.61463790169694}, "custom_metrics": {"mean_episode_reward_mean": 476.61463790169694, "mean_episode_reward_min": 398.7031726701569, "mean_episode_reward_max": 562.2176790906898}, "hist_stats": {"episode_reward": [466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.4334231667507, 501.648507077959, 458.02996053089885, 489.59775277346205, 491.8712708997736, 462.2552487489538, 456.0636196926686, 438.76454435502046, 416.2313484926857, 469.19582748047674, 476.5028966490061, 479.0022743075947, 480.69746298205547, 504.7811734903093, 508.88121296577725, 461.34712762803457, 467.08610142674826, 481.4167110212712, 495.33271287547336, 448.5154052289111, 484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5091564031307232, "mean_inference_ms": 4.491425739487626, "mean_action_processing_ms": 0.8313217432010626, "mean_env_wait_ms": 4.312390895734153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033090829849243164, "StateBufferConnector_ms": 0.013303041458129883, "ViewRequirementAgentConnector_ms": 0.5260469913482666}, "num_episodes": 22, "episode_return_max": 562.2176790906898, "episode_return_min": 398.7031726701569, "episode_return_mean": 476.61463790169694, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336, "num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.07541574094603, "num_env_steps_trained_throughput_per_sec": 210.07541574094603, "timesteps_total": 142336, "num_env_steps_sampled_lifetime": 142336, "num_agent_steps_sampled_lifetime": 142336, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 142336, "timers": {"training_iteration_time_ms": 4987.88, "restore_workers_time_ms": 0.132, "training_step_time_ms": 4987.748, "sample_time_ms": 2164.16, "learn_time_ms": 2785.382, "learn_throughput": 367.634, "synch_weights_time_ms": 37.743}, "counters": {"num_env_steps_sampled": 142336, "num_env_steps_trained": 142336, "num_agent_steps_sampled": 142336, "num_agent_steps_trained": 142336}, "done": false, "training_iteration": 139, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-00", "timestamp": 1744126080, "time_this_iter_s": 4.888893365859985, "time_total_s": 674.1770453453064, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 674.1770453453064, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 56.9, "ram_util_percent": 89.25714285714285}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1557627487927675, "cur_kl_coeff": 2.869859254937225e-43, "cur_lr": 1e-07, "total_loss": 2.188804566860199, "policy_loss": -7.79642490670085e-05, "vf_loss": 9.99040378332138, "vf_explained_var": -9.524822235107423e-06, "kl": 9.810378581498468e-07, "entropy": 3.087184067070484, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "env_runners": {"episode_reward_max": 562.2176790906898, "episode_reward_min": 398.7031726701569, "episode_reward_mean": 476.15284122452556, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 398.7031726701569}, "policy_reward_max": {"tplp_policy": 562.2176790906898}, "policy_reward_mean": {"tplp_policy": 476.15284122452556}, "custom_metrics": {"mean_episode_reward_mean": 476.15284122452556, "mean_episode_reward_min": 398.7031726701569, "mean_episode_reward_max": 562.2176790906898}, "hist_stats": {"episode_reward": [484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [484.5104557923481, 448.0687714641959, 505.77234741081145, 436.1828974161954, 468.6762370539405, 472.5058173292037, 499.98199363062776, 496.455621857834, 458.6732958574656, 442.00917812575443, 454.68591259354776, 484.339660617644, 482.2835374226033, 487.4460285557775, 480.65393375979545, 481.78630981681556, 449.19505132502525, 498.83282638864625, 453.2386336528282, 433.5032829544972, 514.3627991829844, 449.87004975533716, 531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5096013610769097, "mean_inference_ms": 4.492174099410267, "mean_action_processing_ms": 0.8320839154143033, "mean_env_wait_ms": 4.313345232548727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030574321746826172, "StateBufferConnector_ms": 0.016504526138305664, "ViewRequirementAgentConnector_ms": 0.529827356338501}, "num_episodes": 20, "episode_return_max": 562.2176790906898, "episode_return_min": 398.7031726701569, "episode_return_mean": 476.15284122452556, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360, "num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 227.76002151725496, "num_env_steps_trained_throughput_per_sec": 227.76002151725496, "timesteps_total": 143360, "num_env_steps_sampled_lifetime": 143360, "num_agent_steps_sampled_lifetime": 143360, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 143360, "timers": {"training_iteration_time_ms": 4967.581, "restore_workers_time_ms": 0.132, "training_step_time_ms": 4967.45, "sample_time_ms": 2152.467, "learn_time_ms": 2776.283, "learn_throughput": 368.838, "synch_weights_time_ms": 38.237}, "counters": {"num_env_steps_sampled": 143360, "num_env_steps_trained": 143360, "num_agent_steps_sampled": 143360, "num_agent_steps_trained": 143360}, "done": false, "training_iteration": 140, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-05", "timestamp": 1744126085, "time_this_iter_s": 4.5063605308532715, "time_total_s": 678.6834058761597, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC171A0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 678.6834058761597, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 50.57142857142856, "ram_util_percent": 89.47142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.543874146044254, "cur_kl_coeff": 1.4349296274686126e-43, "cur_lr": 1e-07, "total_loss": 2.1851976685225964, "policy_loss": -0.0001092043734388426, "vf_loss": 9.976637399196624, "vf_explained_var": -1.5048682689666748e-05, "kl": 1.6964326999158174e-06, "entropy": 3.0885246247053146, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "env_runners": {"episode_reward_max": 562.2176790906898, "episode_reward_min": 398.7031726701569, "episode_reward_mean": 478.18606224977725, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 398.7031726701569}, "policy_reward_max": {"tplp_policy": 562.2176790906898}, "policy_reward_mean": {"tplp_policy": 478.18606224977725}, "custom_metrics": {"mean_episode_reward_mean": 478.18606224977725, "mean_episode_reward_min": 398.7031726701569, "mean_episode_reward_max": 562.2176790906898}, "hist_stats": {"episode_reward": [531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [531.8439916583413, 476.0438409196713, 472.20312913634154, 517.7754744880137, 548.4256633104911, 398.7031726701569, 475.2408144121823, 455.17743870711007, 478.50823007594727, 466.1902978666848, 468.270815731921, 456.85973508751596, 491.090758071173, 522.4424387167704, 488.5638695190892, 531.5947282209029, 477.7666815464231, 459.65890645121215, 455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.510169139677619, "mean_inference_ms": 4.492637495680091, "mean_action_processing_ms": 0.8325332663618894, "mean_env_wait_ms": 4.314890979919242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023917436599731445, "StateBufferConnector_ms": 0.015382528305053711, "ViewRequirementAgentConnector_ms": 0.5085608959197998}, "num_episodes": 22, "episode_return_max": 562.2176790906898, "episode_return_min": 398.7031726701569, "episode_return_mean": 478.18606224977725, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384, "num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 216.2077781126493, "num_env_steps_trained_throughput_per_sec": 216.2077781126493, "timesteps_total": 144384, "num_env_steps_sampled_lifetime": 144384, "num_agent_steps_sampled_lifetime": 144384, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 144384, "timers": {"training_iteration_time_ms": 4922.883, "restore_workers_time_ms": 0.132, "training_step_time_ms": 4922.751, "sample_time_ms": 2164.96, "learn_time_ms": 2718.667, "learn_throughput": 376.655, "synch_weights_time_ms": 38.661}, "counters": {"num_env_steps_sampled": 144384, "num_env_steps_trained": 144384, "num_agent_steps_sampled": 144384, "num_agent_steps_trained": 144384}, "done": false, "training_iteration": 141, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-09", "timestamp": 1744126089, "time_this_iter_s": 4.757419109344482, "time_total_s": 683.4408249855042, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 683.4408249855042, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 53.383333333333326, "ram_util_percent": 89.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.434384798631072, "cur_kl_coeff": 7.174648137343063e-44, "cur_lr": 1e-07, "total_loss": 2.190889623016119, "policy_loss": -5.064751603640616e-05, "vf_loss": 10.0, "vf_explained_var": -1.1272355914115906e-05, "kl": 1.1898372248353438e-06, "entropy": 3.090597151219845, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "env_runners": {"episode_reward_max": 562.2176790906898, "episode_reward_min": 422.1460382554387, "episode_reward_mean": 475.64586404521606, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 422.1460382554387}, "policy_reward_max": {"tplp_policy": 562.2176790906898}, "policy_reward_mean": {"tplp_policy": 475.64586404521606}, "custom_metrics": {"mean_episode_reward_mean": 475.64586404521606, "mean_episode_reward_min": 422.1460382554387, "mean_episode_reward_max": 562.2176790906898}, "hist_stats": {"episode_reward": [455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [455.7291819310549, 474.0505896746121, 445.9299047373616, 425.65765794750286, 447.95696120450606, 501.0051055537199, 456.2466814496206, 472.69360952901746, 460.07660620811487, 475.5980524532245, 465.2446555138287, 490.84510444706575, 481.4677626884036, 462.95235037924084, 497.43608704894956, 470.01201454073436, 471.86147451946147, 481.01061089698584, 476.0015153570357, 480.73796353846313, 507.8046247242378, 505.11790804610433, 471.1624982051401, 562.2176790906898, 507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.510534305752857, "mean_inference_ms": 4.492908608924857, "mean_action_processing_ms": 0.832837161873424, "mean_env_wait_ms": 4.316671368775459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016548871994018555, "StateBufferConnector_ms": 0.016770601272583008, "ViewRequirementAgentConnector_ms": 0.48317885398864746}, "num_episodes": 18, "episode_return_max": 562.2176790906898, "episode_return_min": 422.1460382554387, "episode_return_mean": 475.64586404521606, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408, "num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 221.62116970428443, "num_env_steps_trained_throughput_per_sec": 221.62116970428443, "timesteps_total": 145408, "num_env_steps_sampled_lifetime": 145408, "num_agent_steps_sampled_lifetime": 145408, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 145408, "timers": {"training_iteration_time_ms": 4894.349, "restore_workers_time_ms": 0.132, "training_step_time_ms": 4894.217, "sample_time_ms": 2160.94, "learn_time_ms": 2695.307, "learn_throughput": 379.92, "synch_weights_time_ms": 37.379}, "counters": {"num_env_steps_sampled": 145408, "num_env_steps_trained": 145408, "num_agent_steps_sampled": 145408, "num_agent_steps_trained": 145408}, "done": false, "training_iteration": 142, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-14", "timestamp": 1744126094, "time_this_iter_s": 4.632095098495483, "time_total_s": 688.0729200839996, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 688.0729200839996, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 53.08333333333334, "ram_util_percent": 89.36666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2794575366191565, "cur_kl_coeff": 3.5873240686715314e-44, "cur_lr": 1e-07, "total_loss": 2.1905852913856507, "policy_loss": -2.2964098025113345e-05, "vf_loss": 9.999504214525222, "vf_explained_var": -1.2878701090812683e-05, "kl": 1.6404762335664457e-06, "entropy": 3.0926777705550195, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "env_runners": {"episode_reward_max": 562.672165202259, "episode_reward_min": 422.1460382554387, "episode_reward_mean": 474.8064676221639, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 422.1460382554387}, "policy_reward_max": {"tplp_policy": 562.672165202259}, "policy_reward_mean": {"tplp_policy": 474.8064676221639}, "custom_metrics": {"mean_episode_reward_mean": 474.8064676221639, "mean_episode_reward_min": 422.1460382554387, "mean_episode_reward_max": 562.672165202259}, "hist_stats": {"episode_reward": [507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [507.98104721989915, 489.4217857637012, 511.5813826427202, 513.3192695943592, 466.6318945046359, 466.76220263851155, 488.4841618005153, 454.8286214086565, 443.10633234953264, 497.1431243156499, 498.9059623833613, 473.7126003468833, 481.5407729167162, 479.50232564664634, 425.6967073972158, 470.9797892079607, 453.58893940643424, 472.69410449566294, 469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5109690350845595, "mean_inference_ms": 4.490818533829686, "mean_action_processing_ms": 0.8329770272292285, "mean_env_wait_ms": 4.317705368572252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014038562774658203, "StateBufferConnector_ms": 0.013597488403320312, "ViewRequirementAgentConnector_ms": 0.4599142074584961}, "num_episodes": 24, "episode_return_max": 562.672165202259, "episode_return_min": 422.1460382554387, "episode_return_mean": 474.8064676221639, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432, "num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 230.47969903790764, "num_env_steps_trained_throughput_per_sec": 230.47969903790764, "timesteps_total": 146432, "num_env_steps_sampled_lifetime": 146432, "num_agent_steps_sampled_lifetime": 146432, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 146432, "timers": {"training_iteration_time_ms": 4834.797, "restore_workers_time_ms": 0.232, "training_step_time_ms": 4834.564, "sample_time_ms": 2131.971, "learn_time_ms": 2665.549, "learn_throughput": 384.161, "synch_weights_time_ms": 36.595}, "counters": {"num_env_steps_sampled": 146432, "num_env_steps_trained": 146432, "num_agent_steps_sampled": 146432, "num_agent_steps_trained": 146432}, "done": false, "training_iteration": 143, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-19", "timestamp": 1744126099, "time_this_iter_s": 4.456524848937988, "time_total_s": 692.5294449329376, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 692.5294449329376, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 53.349999999999994, "ram_util_percent": 89.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4673074804246427, "cur_kl_coeff": 1.7936620343357657e-44, "cur_lr": 1e-07, "total_loss": 2.1884081296622755, "policy_loss": -7.884588558226824e-05, "vf_loss": 9.992040228843688, "vf_explained_var": -1.0765716433525086e-05, "kl": 1.5269927779115734e-06, "entropy": 3.0952307507395744, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "env_runners": {"episode_reward_max": 562.672165202259, "episode_reward_min": 417.26628489767734, "episode_reward_mean": 472.8260707781799, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.26628489767734}, "policy_reward_max": {"tplp_policy": 562.672165202259}, "policy_reward_mean": {"tplp_policy": 472.8260707781799}, "custom_metrics": {"mean_episode_reward_mean": 472.8260707781799, "mean_episode_reward_min": 417.26628489767734, "mean_episode_reward_max": 562.672165202259}, "hist_stats": {"episode_reward": [469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [469.7764746005044, 496.4348789890688, 494.7392393230132, 459.104999479103, 470.597149064969, 497.9301945541399, 502.0304536410733, 450.810141724834, 439.38388169650597, 464.49845926079956, 509.51924122716036, 442.7426364728894, 450.80218746316575, 471.2427918772883, 472.4901747625529, 457.20230028049133, 487.49395959595023, 444.39270616107643, 473.56833213480036, 442.9151244907797, 506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5107800530729782, "mean_inference_ms": 4.4924737883596535, "mean_action_processing_ms": 0.8337819651128187, "mean_env_wait_ms": 4.3198119988985235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016521692276000977, "StateBufferConnector_ms": 0.018672704696655273, "ViewRequirementAgentConnector_ms": 0.5090951919555664}, "num_episodes": 18, "episode_return_max": 562.672165202259, "episode_return_min": 417.26628489767734, "episode_return_mean": 472.8260707781799, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456, "num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 205.3272817974664, "num_env_steps_trained_throughput_per_sec": 205.3272817974664, "timesteps_total": 147456, "num_env_steps_sampled_lifetime": 147456, "num_agent_steps_sampled_lifetime": 147456, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 147456, "timers": {"training_iteration_time_ms": 4844.837, "restore_workers_time_ms": 0.232, "training_step_time_ms": 4844.605, "sample_time_ms": 2111.837, "learn_time_ms": 2695.441, "learn_throughput": 379.901, "synch_weights_time_ms": 36.999}, "counters": {"num_env_steps_sampled": 147456, "num_env_steps_trained": 147456, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "done": false, "training_iteration": 144, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-24", "timestamp": 1744126104, "time_this_iter_s": 4.999967336654663, "time_total_s": 697.5294122695923, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 697.5294122695923, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 54.60000000000001, "ram_util_percent": 89.1857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.103016737475991, "cur_kl_coeff": 8.968310171678829e-45, "cur_lr": 1e-07, "total_loss": 2.184003023803234, "policy_loss": -5.421728710643947e-05, "vf_loss": 9.975181913375854, "vf_explained_var": -2.071112394332886e-05, "kl": 1.9004287593826775e-06, "entropy": 3.09738242328167, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "env_runners": {"episode_reward_max": 583.8018731186215, "episode_reward_min": 417.26628489767734, "episode_reward_mean": 476.12337887131815, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.26628489767734}, "policy_reward_max": {"tplp_policy": 583.8018731186215}, "policy_reward_mean": {"tplp_policy": 476.12337887131815}, "custom_metrics": {"mean_episode_reward_mean": 476.12337887131815, "mean_episode_reward_min": 417.26628489767734, "mean_episode_reward_max": 583.8018731186215}, "hist_stats": {"episode_reward": [506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.8620467700086, 469.4111397998531, 486.4482279792551, 505.8438711126147, 482.95670287382404, 477.0365223217068, 439.2716080021995, 486.186875885657, 495.18213303333266, 424.7707434696, 508.07390783828015, 490.59960042115915, 527.5210872421593, 489.79231299375385, 453.3039390260925, 468.70762663815884, 489.2240466045869, 474.10501457238206, 477.2850644499541, 517.2908168288956, 509.86857823722323, 455.66967209393687, 478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5112683866636303, "mean_inference_ms": 4.493352559893756, "mean_action_processing_ms": 0.8342948428236417, "mean_env_wait_ms": 4.32144859919933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016521692276000977, "StateBufferConnector_ms": 0.015471220016479492, "ViewRequirementAgentConnector_ms": 0.5356979370117188}, "num_episodes": 20, "episode_return_max": 583.8018731186215, "episode_return_min": 417.26628489767734, "episode_return_mean": 476.12337887131815, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480, "num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.98413357760194, "num_env_steps_trained_throughput_per_sec": 210.98413357760194, "timesteps_total": 148480, "num_env_steps_sampled_lifetime": 148480, "num_agent_steps_sampled_lifetime": 148480, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 148480, "timers": {"training_iteration_time_ms": 4830.533, "restore_workers_time_ms": 0.232, "training_step_time_ms": 4830.3, "sample_time_ms": 2117.328, "learn_time_ms": 2676.265, "learn_throughput": 382.623, "synch_weights_time_ms": 36.478}, "counters": {"num_env_steps_sampled": 148480, "num_env_steps_trained": 148480, "num_agent_steps_sampled": 148480, "num_agent_steps_trained": 148480}, "done": false, "training_iteration": 145, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-29", "timestamp": 1744126109, "time_this_iter_s": 4.865735292434692, "time_total_s": 702.395147562027, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 702.395147562027, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 56.38571428571429, "ram_util_percent": 89.20000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.701982641592622, "cur_kl_coeff": 4.484155085839414e-45, "cur_lr": 1e-07, "total_loss": 2.1875946812331675, "policy_loss": 3.979054745286703e-05, "vf_loss": 9.990075641870499, "vf_explained_var": -1.0121986269950866e-05, "kl": 6.226836494205301e-07, "entropy": 3.0996401786804197, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "env_runners": {"episode_reward_max": 583.8018731186215, "episode_reward_min": 417.26628489767734, "episode_reward_mean": 473.97974265046963, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.26628489767734}, "policy_reward_max": {"tplp_policy": 583.8018731186215}, "policy_reward_mean": {"tplp_policy": 473.97974265046963}, "custom_metrics": {"mean_episode_reward_mean": 473.97974265046963, "mean_episode_reward_min": 417.26628489767734, "mean_episode_reward_max": 583.8018731186215}, "hist_stats": {"episode_reward": [478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [478.65517895935335, 422.1460382554387, 449.86408988040114, 476.9138841431693, 435.97852589532107, 472.1036795494424, 459.2485465517346, 494.9887439986862, 466.93766851945384, 490.87594056299645, 489.31249763359966, 480.18804342635576, 449.0510839736742, 485.04180120775527, 439.7032036907202, 505.79298955457045, 441.99474210857045, 440.34285262835607, 490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5117061226801183, "mean_inference_ms": 4.493420788535124, "mean_action_processing_ms": 0.8347373201670473, "mean_env_wait_ms": 4.322315713168392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01206207275390625, "StateBufferConnector_ms": 0.011564016342163086, "ViewRequirementAgentConnector_ms": 0.5567035675048828}, "num_episodes": 22, "episode_return_max": 583.8018731186215, "episode_return_min": 417.26628489767734, "episode_return_mean": 473.97974265046963, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504, "num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 219.15670185787107, "num_env_steps_trained_throughput_per_sec": 219.15670185787107, "timesteps_total": 149504, "num_env_steps_sampled_lifetime": 149504, "num_agent_steps_sampled_lifetime": 149504, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 149504, "timers": {"training_iteration_time_ms": 4811.961, "restore_workers_time_ms": 0.232, "training_step_time_ms": 4811.729, "sample_time_ms": 2097.314, "learn_time_ms": 2677.249, "learn_throughput": 382.482, "synch_weights_time_ms": 37.038}, "counters": {"num_env_steps_sampled": 149504, "num_env_steps_trained": 149504, "num_agent_steps_sampled": 149504, "num_agent_steps_trained": 149504}, "done": false, "training_iteration": 146, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-34", "timestamp": 1744126114, "time_this_iter_s": 4.687120199203491, "time_total_s": 707.0822677612305, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14D60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 707.0822677612305, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 54.050000000000004, "ram_util_percent": 88.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.273306168243289, "cur_kl_coeff": 2.242077542919707e-45, "cur_lr": 1e-07, "total_loss": 2.1898997128009796, "policy_loss": -4.520808579400182e-05, "vf_loss": 10.0, "vf_explained_var": -1.0893866419792176e-05, "kl": 4.6374040998387043e-07, "entropy": 3.100550775229931, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "env_runners": {"episode_reward_max": 583.8018731186215, "episode_reward_min": 417.26628489767734, "episode_reward_mean": 476.04524607317745, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 417.26628489767734}, "policy_reward_max": {"tplp_policy": 583.8018731186215}, "policy_reward_mean": {"tplp_policy": 476.04524607317745}, "custom_metrics": {"mean_episode_reward_mean": 476.04524607317745, "mean_episode_reward_min": 417.26628489767734, "mean_episode_reward_max": 583.8018731186215}, "hist_stats": {"episode_reward": [490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [490.26234796542235, 440.437760800651, 480.0493779936525, 459.281229691806, 480.77169123728333, 521.1564434765517, 503.49899827957086, 472.9522208771302, 562.672165202259, 433.8756167168426, 463.5741561787581, 480.74827401522697, 489.5442868557948, 482.2402975327271, 463.78835175864504, 471.82405354915244, 456.86519203504645, 475.0282916440594, 461.2774660488231, 479.65078383864284, 458.3975968079959, 444.64276013688533, 417.26628489767734, 443.3519332528799, 457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5118444394850783, "mean_inference_ms": 4.493107683205, "mean_action_processing_ms": 0.8348539402396422, "mean_env_wait_ms": 4.322311864818844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010807037353515625, "StateBufferConnector_ms": 0.010352849960327148, "ViewRequirementAgentConnector_ms": 0.5741713047027588}, "num_episodes": 18, "episode_return_max": 583.8018731186215, "episode_return_min": 417.26628489767734, "episode_return_mean": 476.04524607317745, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528, "num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.09165766739943, "num_env_steps_trained_throughput_per_sec": 204.09165766739943, "timesteps_total": 150528, "num_env_steps_sampled_lifetime": 150528, "num_agent_steps_sampled_lifetime": 150528, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 150528, "timers": {"training_iteration_time_ms": 4762.32, "restore_workers_time_ms": 0.232, "training_step_time_ms": 4762.087, "sample_time_ms": 2084.488, "learn_time_ms": 2642.022, "learn_throughput": 387.582, "synch_weights_time_ms": 35.449}, "counters": {"num_env_steps_sampled": 150528, "num_env_steps_trained": 150528, "num_agent_steps_sampled": 150528, "num_agent_steps_trained": 150528}, "done": false, "training_iteration": 147, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-39", "timestamp": 1744126119, "time_this_iter_s": 5.037829875946045, "time_total_s": 712.1200976371765, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 712.1200976371765, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 52.85714285714285, "ram_util_percent": 88.88571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.250517636537552, "cur_kl_coeff": 1.1210387714598536e-45, "cur_lr": 1e-07, "total_loss": 2.1898281916975977, "policy_loss": -0.00013622404658235608, "vf_loss": 10.0, "vf_explained_var": -1.0859966278076171e-05, "kl": 8.930931894579608e-07, "entropy": 3.100355875492096, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "env_runners": {"episode_reward_max": 583.8018731186215, "episode_reward_min": 425.89692755990893, "episode_reward_mean": 477.00136225553183, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.89692755990893}, "policy_reward_max": {"tplp_policy": 583.8018731186215}, "policy_reward_mean": {"tplp_policy": 477.00136225553183}, "custom_metrics": {"mean_episode_reward_mean": 477.00136225553183, "mean_episode_reward_min": 425.89692755990893, "mean_episode_reward_max": 583.8018731186215}, "hist_stats": {"episode_reward": [457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [457.83187891916316, 478.08902044123886, 461.6714515993667, 492.78339777246333, 457.51342083719334, 482.4123786224619, 441.75530341765636, 466.7139050959561, 455.6483415552216, 493.7250631214659, 503.43920462007225, 484.14185848349206, 459.76898517268796, 468.146807876903, 466.5485934790168, 467.033510475743, 453.72678682706686, 452.71582684322425, 561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5126164383668106, "mean_inference_ms": 4.494944652677889, "mean_action_processing_ms": 0.8353408268193797, "mean_env_wait_ms": 4.32352632702108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016452789306640625, "StateBufferConnector_ms": 0.014476299285888672, "ViewRequirementAgentConnector_ms": 0.5650315284729004}, "num_episodes": 24, "episode_return_max": 583.8018731186215, "episode_return_min": 425.89692755990893, "episode_return_mean": 477.00136225553183, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552, "num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 190.77089555735841, "num_env_steps_trained_throughput_per_sec": 190.77089555735841, "timesteps_total": 151552, "num_env_steps_sampled_lifetime": 151552, "num_agent_steps_sampled_lifetime": 151552, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 151552, "timers": {"training_iteration_time_ms": 4806.81, "restore_workers_time_ms": 0.1, "training_step_time_ms": 4806.709, "sample_time_ms": 2112.39, "learn_time_ms": 2658.661, "learn_throughput": 385.156, "synch_weights_time_ms": 35.531}, "counters": {"num_env_steps_sampled": 151552, "num_env_steps_trained": 151552, "num_agent_steps_sampled": 151552, "num_agent_steps_trained": 151552}, "done": false, "training_iteration": 148, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-44", "timestamp": 1744126124, "time_this_iter_s": 5.382146596908569, "time_total_s": 717.5022442340851, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17740>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 717.5022442340851, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 57.1125, "ram_util_percent": 88.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3245330221951006, "cur_kl_coeff": 5.605193857299268e-46, "cur_lr": 1e-07, "total_loss": 2.1874108999967574, "policy_loss": -9.115104912780226e-05, "vf_loss": 9.990399330854416, "vf_explained_var": -1.584663987159729e-05, "kl": 1.1076608440629964e-06, "entropy": 3.1009777024388314, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "env_runners": {"episode_reward_max": 583.8018731186215, "episode_reward_min": 425.0264437482834, "episode_reward_mean": 477.58904839160874, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 425.0264437482834}, "policy_reward_max": {"tplp_policy": 583.8018731186215}, "policy_reward_mean": {"tplp_policy": 477.58904839160874}, "custom_metrics": {"mean_episode_reward_mean": 477.58904839160874, "mean_episode_reward_min": 425.0264437482834, "mean_episode_reward_max": 583.8018731186215}, "hist_stats": {"episode_reward": [561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [561.0369306655581, 460.5981257641821, 480.6163859132549, 484.3958617356227, 461.15219980197213, 500.10269295620805, 477.50496282592445, 460.9796020849367, 505.313925532521, 468.1317973347929, 508.1655242576004, 583.8018731186215, 487.18794221360037, 486.109240624464, 498.34167512991405, 454.4295815164097, 484.15885995485667, 458.93634101326535, 487.2692846612971, 483.22593771098866, 497.5857724857517, 494.8567090455512, 492.4113078722659, 504.90430697610446, 468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5131314739576607, "mean_inference_ms": 4.496776490194127, "mean_action_processing_ms": 0.8357603029051164, "mean_env_wait_ms": 4.324786843963071, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013576745986938477, "StateBufferConnector_ms": 0.011785268783569336, "ViewRequirementAgentConnector_ms": 0.5854141712188721}, "num_episodes": 18, "episode_return_max": 583.8018731186215, "episode_return_min": 425.0264437482834, "episode_return_mean": 477.58904839160874, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576, "num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 191.0034126499388, "num_env_steps_trained_throughput_per_sec": 191.0034126499388, "timesteps_total": 152576, "num_env_steps_sampled_lifetime": 152576, "num_agent_steps_sampled_lifetime": 152576, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 152576, "timers": {"training_iteration_time_ms": 4855.482, "restore_workers_time_ms": 0.1, "training_step_time_ms": 4855.382, "sample_time_ms": 2147.81, "learn_time_ms": 2671.585, "learn_throughput": 383.293, "synch_weights_time_ms": 35.859}, "counters": {"num_env_steps_sampled": 152576, "num_env_steps_trained": 152576, "num_agent_steps_sampled": 152576, "num_agent_steps_trained": 152576}, "done": false, "training_iteration": 149, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-50", "timestamp": 1744126130, "time_this_iter_s": 5.375464677810669, "time_total_s": 722.8777089118958, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16E80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 722.8777089118958, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 59.27142857142858, "ram_util_percent": 88.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.445923638343811, "cur_kl_coeff": 2.802596928649634e-46, "cur_lr": 1e-07, "total_loss": 2.188890730589628, "policy_loss": -6.66613457724452e-05, "vf_loss": 9.99672927260399, "vf_explained_var": -1.589730381965637e-05, "kl": 1.097418062065425e-06, "entropy": 3.1022490739822386, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "env_runners": {"episode_reward_max": 574.3913337837495, "episode_reward_min": 418.6733510823933, "episode_reward_mean": 476.5367565676916, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.6733510823933}, "policy_reward_max": {"tplp_policy": 574.3913337837495}, "policy_reward_mean": {"tplp_policy": 476.5367565676916}, "custom_metrics": {"mean_episode_reward_mean": 476.5367565676916, "mean_episode_reward_min": 418.6733510823933, "mean_episode_reward_max": 574.3913337837495}, "hist_stats": {"episode_reward": [468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.6809560026436, 443.7520684876555, 462.16644224382577, 468.5949895351219, 459.02068756485363, 497.77459155031715, 480.49958688519615, 454.127532215558, 461.1997871746365, 453.38851252374025, 475.94456998410544, 508.919198831495, 450.4084918314367, 443.96099780162876, 496.4174071512041, 435.9387775743936, 459.28505885871516, 488.61208531997613, 547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514035101058783, "mean_inference_ms": 4.498278686521182, "mean_action_processing_ms": 0.836459574607064, "mean_env_wait_ms": 4.325765075260424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014850854873657227, "StateBufferConnector_ms": 0.01911020278930664, "ViewRequirementAgentConnector_ms": 0.5503036975860596}, "num_episodes": 24, "episode_return_max": 574.3913337837495, "episode_return_min": 418.6733510823933, "episode_return_mean": 476.5367565676916, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600, "num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 201.31902680844573, "num_env_steps_trained_throughput_per_sec": 201.31902680844573, "timesteps_total": 153600, "num_env_steps_sampled_lifetime": 153600, "num_agent_steps_sampled_lifetime": 153600, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 153600, "timers": {"training_iteration_time_ms": 4914.531, "restore_workers_time_ms": 0.1, "training_step_time_ms": 4914.431, "sample_time_ms": 2178.18, "learn_time_ms": 2699.985, "learn_throughput": 379.261, "synch_weights_time_ms": 36.038}, "counters": {"num_env_steps_sampled": 153600, "num_env_steps_trained": 153600, "num_agent_steps_sampled": 153600, "num_agent_steps_trained": 153600}, "done": false, "training_iteration": 150, "trial_id": "3bf18_00000", "date": "2025-04-08_23-28-55", "timestamp": 1744126135, "time_this_iter_s": 5.099426507949829, "time_total_s": 727.9771354198456, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17D80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 727.9771354198456, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 58.31428571428571, "ram_util_percent": 88.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0689896132797, "cur_kl_coeff": 1.401298464324817e-46, "cur_lr": 1e-07, "total_loss": 2.1825096532702446, "policy_loss": -2.8243096312507988e-05, "vf_loss": 9.971501034498214, "vf_explained_var": -2.327673137187958e-05, "kl": 6.116411057632831e-07, "entropy": 3.1033737286925316, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "env_runners": {"episode_reward_max": 576.3694436912963, "episode_reward_min": 418.6733510823933, "episode_reward_mean": 479.7283562265319, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 418.6733510823933}, "policy_reward_max": {"tplp_policy": 576.3694436912963}, "policy_reward_mean": {"tplp_policy": 479.7283562265319}, "custom_metrics": {"mean_episode_reward_mean": 479.7283562265319, "mean_episode_reward_min": 418.6733510823933, "mean_episode_reward_max": 576.3694436912963}, "hist_stats": {"episode_reward": [547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [547.4160755949913, 471.5970574464687, 450.15117869992304, 460.9970983748753, 425.89692755990893, 484.95762784629034, 471.6663723428402, 489.93120962118047, 475.7207462103654, 452.84150652490945, 519.5393180907813, 484.4442859643039, 455.8349510453471, 496.1226401752799, 468.07896365543405, 482.5967494788032, 468.07310876435696, 498.01351809908533, 462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5139982281696986, "mean_inference_ms": 4.50333817450488, "mean_action_processing_ms": 0.8375049934432158, "mean_env_wait_ms": 4.328200171400986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0183255672454834, "StateBufferConnector_ms": 0.020711183547973633, "ViewRequirementAgentConnector_ms": 0.566185474395752}, "num_episodes": 18, "episode_return_max": 576.3694436912963, "episode_return_min": 418.6733510823933, "episode_return_mean": 479.7283562265319, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624, "num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 212.8368979036174, "num_env_steps_trained_throughput_per_sec": 212.8368979036174, "timesteps_total": 154624, "num_env_steps_sampled_lifetime": 154624, "num_agent_steps_sampled_lifetime": 154624, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 154624, "timers": {"training_iteration_time_ms": 4922.033, "restore_workers_time_ms": 0.1, "training_step_time_ms": 4921.932, "sample_time_ms": 2178.697, "learn_time_ms": 2707.268, "learn_throughput": 378.241, "synch_weights_time_ms": 35.739}, "counters": {"num_env_steps_sampled": 154624, "num_env_steps_trained": 154624, "num_agent_steps_sampled": 154624, "num_agent_steps_trained": 154624}, "done": false, "training_iteration": 151, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-00", "timestamp": 1744126140, "time_this_iter_s": 4.827998161315918, "time_total_s": 732.8051335811615, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16480>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 732.8051335811615, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 54.25714285714287, "ram_util_percent": 88.78571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4696063965559008, "cur_kl_coeff": 7.006492321624085e-47, "cur_lr": 1e-07, "total_loss": 2.1893784910440446, "policy_loss": -0.00010118649224750697, "vf_loss": 10.0, "vf_explained_var": -1.0319799184799194e-05, "kl": 1.7860555881599183e-06, "entropy": 3.1052030682563783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "env_runners": {"episode_reward_max": 576.3694436912963, "episode_reward_min": 395.6174264506221, "episode_reward_mean": 476.9237004461613, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.6174264506221}, "policy_reward_max": {"tplp_policy": 576.3694436912963}, "policy_reward_mean": {"tplp_policy": 476.9237004461613}, "custom_metrics": {"mean_episode_reward_mean": 476.9237004461613, "mean_episode_reward_min": 395.6174264506221, "mean_episode_reward_max": 576.3694436912963}, "hist_stats": {"episode_reward": [462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.0376078566087, 509.3483915309986, 442.57629654086355, 503.6944071684384, 441.26179647350057, 487.31394322345045, 481.5467686762431, 474.55288079043487, 485.6841341819371, 465.6181957960448, 477.4202635780497, 473.2449914506833, 451.29040299687017, 526.8295554294193, 434.9644197604541, 485.1888507247764, 498.48222949202284, 450.1165227565687, 470.1621273356739, 486.22925486537446, 497.43521563912475, 457.684315897945, 466.7597232195675, 493.92914446037514, 517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5143477176945521, "mean_inference_ms": 4.505474330950966, "mean_action_processing_ms": 0.8381701287024792, "mean_env_wait_ms": 4.329430066161258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0208892822265625, "StateBufferConnector_ms": 0.018939733505249023, "ViewRequirementAgentConnector_ms": 0.5308990478515625}, "num_episodes": 18, "episode_return_max": 576.3694436912963, "episode_return_min": 395.6174264506221, "episode_return_mean": 476.9237004461613, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648, "num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.1471817482627, "num_env_steps_trained_throughput_per_sec": 210.1471817482627, "timesteps_total": 155648, "num_env_steps_sampled_lifetime": 155648, "num_agent_steps_sampled_lifetime": 155648, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 155648, "timers": {"training_iteration_time_ms": 4947.26, "restore_workers_time_ms": 0.1, "training_step_time_ms": 4947.16, "sample_time_ms": 2130.224, "learn_time_ms": 2780.779, "learn_throughput": 368.242, "synch_weights_time_ms": 36.057}, "counters": {"num_env_steps_sampled": 155648, "num_env_steps_trained": 155648, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "done": false, "training_iteration": 152, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-05", "timestamp": 1744126145, "time_this_iter_s": 4.892906665802002, "time_total_s": 737.6980402469635, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16840>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 737.6980402469635, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 54.357142857142854, "ram_util_percent": 89.02857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1674899399280547, "cur_kl_coeff": 3.5032461608120424e-47, "cur_lr": 1e-07, "total_loss": 2.1892314575612546, "policy_loss": -4.023909568786621e-05, "vf_loss": 10.0, "vf_explained_var": -1.368597149848938e-05, "kl": 1.4333457670545612e-06, "entropy": 3.1072829216718674, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "env_runners": {"episode_reward_max": 576.3694436912963, "episode_reward_min": 395.6174264506221, "episode_reward_mean": 476.1697327429317, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.6174264506221}, "policy_reward_max": {"tplp_policy": 576.3694436912963}, "policy_reward_mean": {"tplp_policy": 476.1697327429317}, "custom_metrics": {"mean_episode_reward_mean": 476.1697327429317, "mean_episode_reward_min": 395.6174264506221, "mean_episode_reward_max": 576.3694436912963}, "hist_stats": {"episode_reward": [517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [517.1458717946055, 425.0264437482834, 488.88498170105487, 462.1867493637643, 465.6023011431062, 470.37042935425313, 472.03738451806583, 497.14314911706003, 475.8346287232599, 507.5697895310233, 454.4683485920299, 436.81080004751647, 451.0629170302597, 520.0227657236672, 455.57061565076987, 442.00830504941734, 537.8575370544069, 462.45460669296244, 490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5142202516541483, "mean_inference_ms": 4.506166903434584, "mean_action_processing_ms": 0.8386798381453017, "mean_env_wait_ms": 4.32981314678587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014754772186279297, "StateBufferConnector_ms": 0.014671802520751953, "ViewRequirementAgentConnector_ms": 0.5190463066101074}, "num_episodes": 24, "episode_return_max": 576.3694436912963, "episode_return_min": 395.6174264506221, "episode_return_mean": 476.1697327429317, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672, "num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 214.19148834944028, "num_env_steps_trained_throughput_per_sec": 214.19148834944028, "timesteps_total": 156672, "num_env_steps_sampled_lifetime": 156672, "num_agent_steps_sampled_lifetime": 156672, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 156672, "timers": {"training_iteration_time_ms": 4981.046, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4981.046, "sample_time_ms": 2123.996, "learn_time_ms": 2818.532, "learn_throughput": 363.31, "synch_weights_time_ms": 38.419}, "counters": {"num_env_steps_sampled": 156672, "num_env_steps_trained": 156672, "num_agent_steps_sampled": 156672, "num_agent_steps_trained": 156672}, "done": false, "training_iteration": 153, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-10", "timestamp": 1744126150, "time_this_iter_s": 4.797680377960205, "time_total_s": 742.4957206249237, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16C00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 742.4957206249237, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 56.51428571428572, "ram_util_percent": 88.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1301269069314004, "cur_kl_coeff": 1.7516230804060212e-47, "cur_lr": 1e-07, "total_loss": 2.187701741605997, "policy_loss": 5.492125637829304e-07, "vf_loss": 9.994509840011597, "vf_explained_var": -1.615360379219055e-05, "kl": 7.352114574921131e-07, "entropy": 3.109262616932392, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "env_runners": {"episode_reward_max": 576.3694436912963, "episode_reward_min": 395.6174264506221, "episode_reward_mean": 476.2192183300221, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.6174264506221}, "policy_reward_max": {"tplp_policy": 576.3694436912963}, "policy_reward_mean": {"tplp_policy": 476.2192183300221}, "custom_metrics": {"mean_episode_reward_mean": 476.2192183300221, "mean_episode_reward_min": 395.6174264506221, "mean_episode_reward_max": 576.3694436912963}, "hist_stats": {"episode_reward": [490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [490.0896306870025, 492.74887596600945, 467.74544957413264, 445.4309753011552, 479.6555145666845, 488.8170910751534, 574.3913337837495, 462.5676410629727, 501.6819285759207, 474.53539549371095, 454.8499951876491, 492.28558105687426, 474.254765665161, 485.83578475926726, 460.2121425309961, 418.6733510823933, 490.96760613747483, 476.54034870171785, 462.0901574558627, 568.354568309447, 523.501634735527, 490.445743347719, 449.7964272753787, 441.48985154885577, 527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5143146210503733, "mean_inference_ms": 4.5069416396800905, "mean_action_processing_ms": 0.8389690482838528, "mean_env_wait_ms": 4.330510176834024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013456583023071289, "StateBufferConnector_ms": 0.017497539520263672, "ViewRequirementAgentConnector_ms": 0.5082354545593262}, "num_episodes": 18, "episode_return_max": 576.3694436912963, "episode_return_min": 395.6174264506221, "episode_return_mean": 476.2192183300221, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696, "num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.0291816681116, "num_env_steps_trained_throughput_per_sec": 204.0291816681116, "timesteps_total": 157696, "num_env_steps_sampled_lifetime": 157696, "num_agent_steps_sampled_lifetime": 157696, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 157696, "timers": {"training_iteration_time_ms": 4984.219, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4984.219, "sample_time_ms": 2153.039, "learn_time_ms": 2793.177, "learn_throughput": 366.608, "synch_weights_time_ms": 37.803}, "counters": {"num_env_steps_sampled": 157696, "num_env_steps_trained": 157696, "num_agent_steps_sampled": 157696, "num_agent_steps_trained": 157696}, "done": false, "training_iteration": 154, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-15", "timestamp": 1744126155, "time_this_iter_s": 5.032189846038818, "time_total_s": 747.5279104709625, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 747.5279104709625, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 59.666666666666664, "ram_util_percent": 88.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3387039337307214, "cur_kl_coeff": 8.758115402030106e-48, "cur_lr": 1e-07, "total_loss": 2.182075637578964, "policy_loss": -7.55595276132226e-05, "vf_loss": 9.97309318780899, "vf_explained_var": -5.980953574180603e-06, "kl": 1.918461527861126e-06, "entropy": 3.1112211272120476, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "env_runners": {"episode_reward_max": 576.3694436912963, "episode_reward_min": 395.6174264506221, "episode_reward_mean": 474.14480029950295, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.6174264506221}, "policy_reward_max": {"tplp_policy": 576.3694436912963}, "policy_reward_mean": {"tplp_policy": 474.14480029950295}, "custom_metrics": {"mean_episode_reward_mean": 474.14480029950295, "mean_episode_reward_min": 395.6174264506221, "mean_episode_reward_max": 576.3694436912963}, "hist_stats": {"episode_reward": [527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [527.0667292867396, 452.6833793347601, 522.464754998863, 483.04202808773465, 476.85977062321064, 510.2299199594638, 480.6770967101052, 576.3694436912963, 477.24623793677966, 450.77827270919084, 478.04113640586525, 477.49433710135247, 493.5330852411135, 502.692022332801, 427.489405315937, 499.8978088610888, 453.68526730926493, 458.96136216858883, 498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5143229658402537, "mean_inference_ms": 4.50662131047629, "mean_action_processing_ms": 0.8390404625673463, "mean_env_wait_ms": 4.330462529712791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015530109405517578, "StateBufferConnector_ms": 0.01598215103149414, "ViewRequirementAgentConnector_ms": 0.4531562328338623}, "num_episodes": 24, "episode_return_max": 576.3694436912963, "episode_return_min": 395.6174264506221, "episode_return_mean": 474.14480029950295, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720, "num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.64291335443082, "num_env_steps_trained_throughput_per_sec": 210.64291335443082, "timesteps_total": 158720, "num_env_steps_sampled_lifetime": 158720, "num_agent_steps_sampled_lifetime": 158720, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 158720, "timers": {"training_iteration_time_ms": 4985.006, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4985.006, "sample_time_ms": 2121.023, "learn_time_ms": 2825.879, "learn_throughput": 362.365, "synch_weights_time_ms": 37.903}, "counters": {"num_env_steps_sampled": 158720, "num_env_steps_trained": 158720, "num_agent_steps_sampled": 158720, "num_agent_steps_trained": 158720}, "done": false, "training_iteration": 155, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-20", "timestamp": 1744126160, "time_this_iter_s": 4.875538110733032, "time_total_s": 752.4034485816956, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 752.4034485816956, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 56.98571428571429, "ram_util_percent": 88.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.06447330750525, "cur_kl_coeff": 4.379057701015053e-48, "cur_lr": 1e-07, "total_loss": 2.183846189081669, "policy_loss": -5.560925928875804e-05, "vf_loss": 9.980878967046738, "vf_explained_var": -1.3340264558792114e-05, "kl": 1.176592948048949e-06, "entropy": 3.1131794661283494, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "env_runners": {"episode_reward_max": 547.4428632785862, "episode_reward_min": 395.6174264506221, "episode_reward_mean": 471.1304294627849, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 395.6174264506221}, "policy_reward_max": {"tplp_policy": 547.4428632785862}, "policy_reward_mean": {"tplp_policy": 471.1304294627849}, "custom_metrics": {"mean_episode_reward_mean": 471.1304294627849, "mean_episode_reward_min": 395.6174264506221, "mean_episode_reward_max": 547.4428632785862}, "hist_stats": {"episode_reward": [498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [498.7069374174222, 453.4961798450531, 421.1718466627193, 459.18072596287493, 484.41557928218566, 395.6174264506221, 476.53495927348627, 511.90883101841655, 452.59596620955847, 487.84125038163654, 433.7759404077775, 485.7345247451359, 470.0637284548956, 447.2703202254088, 476.94586796277906, 455.50704368026675, 454.6241617240018, 466.1450495062977, 506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5141966468142616, "mean_inference_ms": 4.505909417168175, "mean_action_processing_ms": 0.8390127312342183, "mean_env_wait_ms": 4.330107647322161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013836860656738281, "StateBufferConnector_ms": 0.014886856079101562, "ViewRequirementAgentConnector_ms": 0.45122194290161133}, "num_episodes": 18, "episode_return_max": 547.4428632785862, "episode_return_min": 395.6174264506221, "episode_return_mean": 471.1304294627849, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744, "num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 215.40894865238482, "num_env_steps_trained_throughput_per_sec": 215.40894865238482, "timesteps_total": 159744, "num_env_steps_sampled_lifetime": 159744, "num_agent_steps_sampled_lifetime": 159744, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 159744, "timers": {"training_iteration_time_ms": 4993.135, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4993.135, "sample_time_ms": 2112.579, "learn_time_ms": 2842.359, "learn_throughput": 360.264, "synch_weights_time_ms": 37.699}, "counters": {"num_env_steps_sampled": 159744, "num_env_steps_trained": 159744, "num_agent_steps_sampled": 159744, "num_agent_steps_trained": 159744}, "done": false, "training_iteration": 156, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-25", "timestamp": 1744126165, "time_this_iter_s": 4.764732360839844, "time_total_s": 757.1681809425354, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 757.1681809425354, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 50.94285714285716, "ram_util_percent": 88.6857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1734120324254036, "cur_kl_coeff": 2.1895288505075265e-48, "cur_lr": 1e-07, "total_loss": 2.188507115840912, "policy_loss": -2.6231713127344848e-05, "vf_loss": 10.0, "vf_explained_var": -1.9260868430137635e-05, "kl": 1.2350321824339262e-06, "entropy": 3.1146664306521417, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "env_runners": {"episode_reward_max": 552.5713576095509, "episode_reward_min": 414.5387548843521, "episode_reward_mean": 475.36549324042693, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 414.5387548843521}, "policy_reward_max": {"tplp_policy": 552.5713576095509}, "policy_reward_mean": {"tplp_policy": 475.36549324042693}, "custom_metrics": {"mean_episode_reward_mean": 475.36549324042693, "mean_episode_reward_min": 414.5387548843521, "mean_episode_reward_max": 552.5713576095509}, "hist_stats": {"episode_reward": [506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.6898098497284, 496.8490076420051, 455.91546992333497, 484.15480934690845, 462.40662551515004, 478.3125931985529, 509.942769769679, 476.2654234537678, 443.15314046252774, 466.32121641405536, 446.6041389494471, 460.14624210217494, 488.346482729226, 465.43374916965985, 462.81615391888624, 453.27358144819516, 476.43627405008544, 494.9481851651076, 471.0401438128603, 511.60399101879847, 461.10234523071694, 455.44330512128096, 438.53025443463525, 474.32009468083186, 485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5141700624484795, "mean_inference_ms": 4.50615926450274, "mean_action_processing_ms": 0.8391691172988964, "mean_env_wait_ms": 4.330064573623334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014038562774658203, "StateBufferConnector_ms": 0.015375614166259766, "ViewRequirementAgentConnector_ms": 0.4605381488800049}, "num_episodes": 18, "episode_return_max": 552.5713576095509, "episode_return_min": 414.5387548843521, "episode_return_mean": 475.36549324042693, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768, "num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 212.48948470833383, "num_env_steps_trained_throughput_per_sec": 212.48948470833383, "timesteps_total": 160768, "num_env_steps_sampled_lifetime": 160768, "num_agent_steps_sampled_lifetime": 160768, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 160768, "timers": {"training_iteration_time_ms": 4973.306, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4973.306, "sample_time_ms": 2115.095, "learn_time_ms": 2820.225, "learn_throughput": 363.092, "synch_weights_time_ms": 37.487}, "counters": {"num_env_steps_sampled": 160768, "num_env_steps_trained": 160768, "num_agent_steps_sampled": 160768, "num_agent_steps_trained": 160768}, "done": false, "training_iteration": 157, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-30", "timestamp": 1744126170, "time_this_iter_s": 4.832036733627319, "time_total_s": 762.0002176761627, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 762.0002176761627, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 55.949999999999996, "ram_util_percent": 88.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2581147480756045, "cur_kl_coeff": 1.0947644252537632e-48, "cur_lr": 1e-07, "total_loss": 2.1883055306971073, "policy_loss": -9.663516830187291e-05, "vf_loss": 10.0, "vf_explained_var": -1.9509345293045044e-05, "kl": 1.2699725979281596e-06, "entropy": 3.115978290140629, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "env_runners": {"episode_reward_max": 552.5713576095509, "episode_reward_min": 413.62588570555755, "episode_reward_mean": 477.74158215147327, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.62588570555755}, "policy_reward_max": {"tplp_policy": 552.5713576095509}, "policy_reward_mean": {"tplp_policy": 477.74158215147327}, "custom_metrics": {"mean_episode_reward_mean": 477.74158215147327, "mean_episode_reward_min": 413.62588570555755, "mean_episode_reward_max": 552.5713576095509}, "hist_stats": {"episode_reward": [485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [485.1201275254399, 507.26486724849303, 479.6315447505021, 488.01137820429983, 437.48195564914, 492.63059283771867, 475.7828164172806, 495.0362166139741, 505.59536093783254, 422.89570208281174, 472.3414220463295, 477.27678767513, 480.00818250127617, 495.8003738807144, 466.27012429392, 453.00838176421877, 523.2490218113517, 466.67814500773966, 462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.515036624540889, "mean_inference_ms": 4.5083423564553256, "mean_action_processing_ms": 0.839600858024586, "mean_env_wait_ms": 4.331248733654869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015845537185668945, "StateBufferConnector_ms": 0.016310691833496094, "ViewRequirementAgentConnector_ms": 0.6020748615264893}, "num_episodes": 24, "episode_return_max": 552.5713576095509, "episode_return_min": 413.62588570555755, "episode_return_mean": 477.74158215147327, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792, "num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 196.0526829295013, "num_env_steps_trained_throughput_per_sec": 196.0526829295013, "timesteps_total": 161792, "num_env_steps_sampled_lifetime": 161792, "num_agent_steps_sampled_lifetime": 161792, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 161792, "timers": {"training_iteration_time_ms": 4958.845, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4958.845, "sample_time_ms": 2127.354, "learn_time_ms": 2793.784, "learn_throughput": 366.528, "synch_weights_time_ms": 37.099}, "counters": {"num_env_steps_sampled": 161792, "num_env_steps_trained": 161792, "num_agent_steps_sampled": 161792, "num_agent_steps_trained": 161792}, "done": false, "training_iteration": 158, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-35", "timestamp": 1744126175, "time_this_iter_s": 5.23364782333374, "time_total_s": 767.2338654994965, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 767.2338654994965, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 52.785714285714285, "ram_util_percent": 88.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.319377427920699, "cur_kl_coeff": 5.473822126268816e-49, "cur_lr": 1e-07, "total_loss": 2.188240699470043, "policy_loss": -6.847793119959533e-05, "vf_loss": 10.0, "vf_explained_var": -1.4300644397735596e-05, "kl": 7.655849781670887e-07, "entropy": 3.116908197104931, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "env_runners": {"episode_reward_max": 552.5713576095509, "episode_reward_min": 413.62588570555755, "episode_reward_mean": 479.6476815284144, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.62588570555755}, "policy_reward_max": {"tplp_policy": 552.5713576095509}, "policy_reward_mean": {"tplp_policy": 479.6476815284144}, "custom_metrics": {"mean_episode_reward_mean": 479.6476815284144, "mean_episode_reward_min": 413.62588570555755, "mean_episode_reward_max": 552.5713576095509}, "hist_stats": {"episode_reward": [462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [462.86187107922626, 451.987987886548, 474.58391388423917, 547.4428632785862, 475.1282938571329, 454.52084563333693, 470.1568183178098, 464.9489327960746, 455.29837097442424, 481.970675720885, 490.20893237367267, 497.02061185326585, 479.8913724236218, 467.5109871943464, 464.08009213820037, 493.67929237645023, 451.69606718973614, 448.36700512655585, 493.7545806460181, 479.1807051382479, 450.76384923708287, 414.5387548843521, 486.4871963391798, 470.88418606014613, 459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5154308648303314, "mean_inference_ms": 4.509117579477282, "mean_action_processing_ms": 0.8398082521732774, "mean_env_wait_ms": 4.33157379937941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019992828369140625, "StateBufferConnector_ms": 0.02205634117126465, "ViewRequirementAgentConnector_ms": 0.5985310077667236}, "num_episodes": 18, "episode_return_max": 552.5713576095509, "episode_return_min": 413.62588570555755, "episode_return_mean": 479.6476815284144, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816, "num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 194.71744972692653, "num_env_steps_trained_throughput_per_sec": 194.71744972692653, "timesteps_total": 162816, "num_env_steps_sampled_lifetime": 162816, "num_agent_steps_sampled_lifetime": 162816, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 162816, "timers": {"training_iteration_time_ms": 4948.619, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4948.619, "sample_time_ms": 2111.872, "learn_time_ms": 2799.139, "learn_throughput": 365.827, "synch_weights_time_ms": 36.999}, "counters": {"num_env_steps_sampled": 162816, "num_env_steps_trained": 162816, "num_agent_steps_sampled": 162816, "num_agent_steps_trained": 162816}, "done": false, "training_iteration": 159, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-41", "timestamp": 1744126181, "time_this_iter_s": 5.273285627365112, "time_total_s": 772.5071511268616, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 772.5071511268616, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 54.285714285714285, "ram_util_percent": 88.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6470407590270044, "cur_kl_coeff": 2.736911063134408e-49, "cur_lr": 1e-07, "total_loss": 2.1868503533303736, "policy_loss": -0.0001359900983516127, "vf_loss": 9.995351278781891, "vf_explained_var": -1.775510609149933e-05, "kl": 2.5966693845552724e-06, "entropy": 3.1185149893164636, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "env_runners": {"episode_reward_max": 552.5713576095509, "episode_reward_min": 413.62588570555755, "episode_reward_mean": 478.97857058502007, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.62588570555755}, "policy_reward_max": {"tplp_policy": 552.5713576095509}, "policy_reward_mean": {"tplp_policy": 478.97857058502007}, "custom_metrics": {"mean_episode_reward_mean": 478.97857058502007, "mean_episode_reward_min": 413.62588570555755, "mean_episode_reward_max": 552.5713576095509}, "hist_stats": {"episode_reward": [459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.9634598576947, 434.69782244440523, 485.3501269157077, 458.44475058608253, 451.83134021422273, 469.2294157937289, 503.5887995156411, 464.8126178836197, 460.8715782123128, 461.97254292997656, 468.272967529288, 493.66616509807824, 490.52433321901157, 461.7291472777315, 479.83022545609924, 445.6182990694214, 481.91238964824146, 503.9868600852061, 458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.516627335157591, "mean_inference_ms": 4.511577305860267, "mean_action_processing_ms": 0.840278659795817, "mean_env_wait_ms": 4.333366265470241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339029312133789, "StateBufferConnector_ms": 0.01729273796081543, "ViewRequirementAgentConnector_ms": 0.6433432102203369}, "num_episodes": 24, "episode_return_max": 552.5713576095509, "episode_return_min": 413.62588570555755, "episode_return_mean": 478.97857058502007, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840, "num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 199.30361052724584, "num_env_steps_trained_throughput_per_sec": 199.30361052724584, "timesteps_total": 163840, "num_env_steps_sampled_lifetime": 163840, "num_agent_steps_sampled_lifetime": 163840, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 163840, "timers": {"training_iteration_time_ms": 4953.763, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4953.763, "sample_time_ms": 2131.17, "learn_time_ms": 2785.136, "learn_throughput": 367.666, "synch_weights_time_ms": 36.948}, "counters": {"num_env_steps_sampled": 163840, "num_env_steps_trained": 163840, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "done": false, "training_iteration": 160, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-46", "timestamp": 1744126186, "time_this_iter_s": 5.151047468185425, "time_total_s": 777.658198595047, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 777.658198595047, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 58.4, "ram_util_percent": 88.64285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.479074040800333, "cur_kl_coeff": 1.368455531567204e-49, "cur_lr": 1e-07, "total_loss": 2.187708258628845, "policy_loss": -9.038031566888094e-05, "vf_loss": 10.0, "vf_explained_var": -1.12876296043396e-05, "kl": 2.779560599996955e-06, "entropy": 3.1220134824514387, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "env_runners": {"episode_reward_max": 579.3076701557637, "episode_reward_min": 413.62588570555755, "episode_reward_mean": 481.06663191235043, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.62588570555755}, "policy_reward_max": {"tplp_policy": 579.3076701557637}, "policy_reward_mean": {"tplp_policy": 481.06663191235043}, "custom_metrics": {"mean_episode_reward_mean": 481.06663191235043, "mean_episode_reward_min": 413.62588570555755, "mean_episode_reward_max": 579.3076701557637}, "hist_stats": {"episode_reward": [458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.20702803790897, 479.14811397138646, 526.2018595272883, 495.8875221178034, 461.2457774000866, 498.8843351873306, 478.16669452259356, 513.4289227647794, 448.85982311724786, 477.56038128010556, 505.0039945542806, 500.43484341607865, 552.5713576095509, 458.62465787023206, 456.94141367502795, 457.97674218959423, 413.62588570555755, 449.1601546112829, 465.7151209303748, 487.08603150713054, 551.7391708879125, 486.1155408216853, 525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.517604734476279, "mean_inference_ms": 4.5130566840245905, "mean_action_processing_ms": 0.8405744940330421, "mean_env_wait_ms": 4.334802678323435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300882339477539, "StateBufferConnector_ms": 0.019711971282958984, "ViewRequirementAgentConnector_ms": 0.6871049404144287}, "num_episodes": 18, "episode_return_max": 579.3076701557637, "episode_return_min": 413.62588570555755, "episode_return_mean": 481.06663191235043, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864, "num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 202.04745945142403, "num_env_steps_trained_throughput_per_sec": 202.04745945142403, "timesteps_total": 164864, "num_env_steps_sampled_lifetime": 164864, "num_agent_steps_sampled_lifetime": 164864, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 164864, "timers": {"training_iteration_time_ms": 4979.455, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4979.455, "sample_time_ms": 2104.883, "learn_time_ms": 2836.973, "learn_throughput": 360.948, "synch_weights_time_ms": 37.09}, "counters": {"num_env_steps_sampled": 164864, "num_env_steps_trained": 164864, "num_agent_steps_sampled": 164864, "num_agent_steps_trained": 164864}, "done": false, "training_iteration": 161, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-51", "timestamp": 1744126191, "time_this_iter_s": 5.0810866355896, "time_total_s": 782.7392852306366, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 782.7392852306366, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 49.95714285714286, "ram_util_percent": 88.62857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2041903283447026, "cur_kl_coeff": 6.84227765783602e-50, "cur_lr": 1e-07, "total_loss": 2.186427564918995, "policy_loss": -3.484214539639652e-05, "vf_loss": 9.99550964832306, "vf_explained_var": -1.222379505634308e-05, "kl": 7.84947799646607e-07, "entropy": 3.1241499930620193, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "env_runners": {"episode_reward_max": 579.3076701557637, "episode_reward_min": 427.65458849456064, "episode_reward_mean": 479.4993763697584, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.65458849456064}, "policy_reward_max": {"tplp_policy": 579.3076701557637}, "policy_reward_mean": {"tplp_policy": 479.4993763697584}, "custom_metrics": {"mean_episode_reward_mean": 479.4993763697584, "mean_episode_reward_min": 427.65458849456064, "mean_episode_reward_max": 579.3076701557637}, "hist_stats": {"episode_reward": [525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [525.6818233197537, 470.58484437776474, 494.11917036447824, 478.62710367995027, 514.310835605339, 487.7095553043411, 461.8204383470899, 531.4329796227426, 473.44928256115776, 466.9342286245068, 457.95283609936763, 501.1772446236213, 480.6989391155612, 508.09504065922215, 430.3319909928182, 497.37429942504156, 491.6904047838475, 452.23177654170985, 488.34591000230387, 501.36346283344164, 459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5190247620037929, "mean_inference_ms": 4.512181653356736, "mean_action_processing_ms": 0.8405926416456296, "mean_env_wait_ms": 4.335011850137832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02532482147216797, "StateBufferConnector_ms": 0.01945185661315918, "ViewRequirementAgentConnector_ms": 0.682584285736084}, "num_episodes": 22, "episode_return_max": 579.3076701557637, "episode_return_min": 427.65458849456064, "episode_return_mean": 479.4993763697584, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888, "num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 222.903073117228, "num_env_steps_trained_throughput_per_sec": 222.903073117228, "timesteps_total": 165888, "num_env_steps_sampled_lifetime": 165888, "num_agent_steps_sampled_lifetime": 165888, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 165888, "timers": {"training_iteration_time_ms": 4951.57, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4951.519, "sample_time_ms": 2124.291, "learn_time_ms": 2789.763, "learn_throughput": 367.056, "synch_weights_time_ms": 36.957}, "counters": {"num_env_steps_sampled": 165888, "num_env_steps_trained": 165888, "num_agent_steps_sampled": 165888, "num_agent_steps_trained": 165888}, "done": false, "training_iteration": 162, "trial_id": "3bf18_00000", "date": "2025-04-08_23-29-56", "timestamp": 1744126196, "time_this_iter_s": 4.61318039894104, "time_total_s": 787.3524656295776, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC160C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 787.3524656295776, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 51.628571428571426, "ram_util_percent": 88.6857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7246580444276334, "cur_kl_coeff": 3.42113882891801e-50, "cur_lr": 1e-07, "total_loss": 2.1800307489931585, "policy_loss": -0.00022877592709846795, "vf_loss": 9.971269851922989, "vf_explained_var": -2.0376965403556822e-05, "kl": 2.977733042847097e-06, "entropy": 3.125579337775707, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "env_runners": {"episode_reward_max": 579.9298283103046, "episode_reward_min": 427.65458849456064, "episode_reward_mean": 479.9234434007594, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.65458849456064}, "policy_reward_max": {"tplp_policy": 579.9298283103046}, "policy_reward_mean": {"tplp_policy": 479.9234434007594}, "custom_metrics": {"mean_episode_reward_mean": 479.9234434007594, "mean_episode_reward_min": 427.65458849456064, "mean_episode_reward_max": 579.9298283103046}, "hist_stats": {"episode_reward": [459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.8725475808171, 458.327943558631, 505.18190903259875, 458.4755305272392, 455.21966796688326, 509.03354819396634, 518.4328906857123, 495.1432511089082, 512.7683721128788, 475.1724249556105, 496.2097259525492, 513.9134825486311, 470.42934814408625, 514.9932508861098, 463.65728084285547, 518.1523920090592, 442.27423561339606, 460.3758921418099, 509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5189139524735922, "mean_inference_ms": 4.5140180861637065, "mean_action_processing_ms": 0.8407704056714245, "mean_env_wait_ms": 4.336116157577394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029626131057739258, "StateBufferConnector_ms": 0.020893096923828125, "ViewRequirementAgentConnector_ms": 0.5453753471374512}, "num_episodes": 20, "episode_return_max": 579.9298283103046, "episode_return_min": 427.65458849456064, "episode_return_mean": 479.9234434007594, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912, "num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 217.94072789103876, "num_env_steps_trained_throughput_per_sec": 217.94072789103876, "timesteps_total": 166912, "num_env_steps_sampled_lifetime": 166912, "num_agent_steps_sampled_lifetime": 166912, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 166912, "timers": {"training_iteration_time_ms": 4943.345, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4943.295, "sample_time_ms": 2142.293, "learn_time_ms": 2764.781, "learn_throughput": 370.373, "synch_weights_time_ms": 35.712}, "counters": {"num_env_steps_sampled": 166912, "num_env_steps_trained": 166912, "num_agent_steps_sampled": 166912, "num_agent_steps_trained": 166912}, "done": false, "training_iteration": 163, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-01", "timestamp": 1744126201, "time_this_iter_s": 4.717594623565674, "time_total_s": 792.0700602531433, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 792.0700602531433, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 56.91666666666668, "ram_util_percent": 88.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.465249612927437, "cur_kl_coeff": 1.710569414459005e-50, "cur_lr": 1e-07, "total_loss": 2.1828725896775723, "policy_loss": -2.0447134738788007e-05, "vf_loss": 9.982696908712388, "vf_explained_var": -2.1404027938842775e-05, "kl": 1.0882320572669358e-06, "entropy": 3.127811972796917, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "env_runners": {"episode_reward_max": 579.9298283103046, "episode_reward_min": 427.65458849456064, "episode_reward_mean": 480.4268089906433, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.65458849456064}, "policy_reward_max": {"tplp_policy": 579.9298283103046}, "policy_reward_mean": {"tplp_policy": 480.4268089906433}, "custom_metrics": {"mean_episode_reward_mean": 480.4268089906433, "mean_episode_reward_min": 427.65458849456064, "mean_episode_reward_max": 579.9298283103046}, "hist_stats": {"episode_reward": [509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.8739979070538, 470.5198726439502, 490.4131023638614, 462.93309107028875, 501.73822672233337, 457.85921963186223, 454.7206817287627, 486.47574570238623, 438.6393786644722, 427.65458849456064, 487.57685520572574, 490.34593776498826, 492.8691285944162, 449.85460777019193, 506.79997709658903, 458.8106483253384, 468.2568287266247, 467.57502108450217, 454.2051538322366, 449.0568913990623, 435.94943816920176, 495.27459141608847, 459.6068367968214, 499.7265685425396, 471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5188777106978384, "mean_inference_ms": 4.513781754601468, "mean_action_processing_ms": 0.8407609339395798, "mean_env_wait_ms": 4.336106921775723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024389266967773438, "StateBufferConnector_ms": 0.017019987106323242, "ViewRequirementAgentConnector_ms": 0.5068213939666748}, "num_episodes": 18, "episode_return_max": 579.9298283103046, "episode_return_min": 427.65458849456064, "episode_return_mean": 480.4268089906433, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936, "num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 230.2378461366921, "num_env_steps_trained_throughput_per_sec": 230.2378461366921, "timesteps_total": 167936, "num_env_steps_sampled_lifetime": 167936, "num_agent_steps_sampled_lifetime": 167936, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 167936, "timers": {"training_iteration_time_ms": 4886.214, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4886.163, "sample_time_ms": 2100.467, "learn_time_ms": 2749.655, "learn_throughput": 372.41, "synch_weights_time_ms": 35.632}, "counters": {"num_env_steps_sampled": 167936, "num_env_steps_trained": 167936, "num_agent_steps_sampled": 167936, "num_agent_steps_trained": 167936}, "done": false, "training_iteration": 164, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-05", "timestamp": 1744126205, "time_this_iter_s": 4.460809230804443, "time_total_s": 796.5308694839478, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BB0F2E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 796.5308694839478, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 52.3, "ram_util_percent": 89.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1840937880799176, "cur_kl_coeff": 8.552847072295025e-51, "cur_lr": 1e-07, "total_loss": 2.187011558562517, "policy_loss": -5.3168891463428734e-05, "vf_loss": 10.0, "vf_explained_var": -1.3917312026023865e-05, "kl": 1.0525155346163828e-06, "entropy": 3.1293527632951736, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "env_runners": {"episode_reward_max": 579.9298283103046, "episode_reward_min": 437.05139039976376, "episode_reward_mean": 482.88727784413425, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.05139039976376}, "policy_reward_max": {"tplp_policy": 579.9298283103046}, "policy_reward_mean": {"tplp_policy": 482.88727784413425}, "custom_metrics": {"mean_episode_reward_mean": 482.88727784413425, "mean_episode_reward_min": 437.05139039976376, "mean_episode_reward_max": 579.9298283103046}, "hist_stats": {"episode_reward": [471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [471.9065429356705, 579.3076701557637, 469.103698616187, 501.8949274489198, 489.1842796566085, 458.0477129343143, 489.7025330521144, 457.6225993622403, 440.5890319337586, 464.6927896367927, 468.00661925834174, 485.73391339527205, 494.272149469173, 456.6174955174643, 484.5190051782098, 514.5746005793111, 439.56009277828537, 493.5406019969722, 447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5184161561832434, "mean_inference_ms": 4.512882126453281, "mean_action_processing_ms": 0.8407079177993481, "mean_env_wait_ms": 4.335489144876542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017731428146362305, "StateBufferConnector_ms": 0.021523237228393555, "ViewRequirementAgentConnector_ms": 0.4649159908294678}, "num_episodes": 24, "episode_return_max": 579.9298283103046, "episode_return_min": 437.05139039976376, "episode_return_mean": 482.88727784413425, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960, "num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 199.0616775636964, "num_env_steps_trained_throughput_per_sec": 199.0616775636964, "timesteps_total": 168960, "num_env_steps_sampled_lifetime": 168960, "num_agent_steps_sampled_lifetime": 168960, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 168960, "timers": {"training_iteration_time_ms": 4914.496, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4914.446, "sample_time_ms": 2128.841, "learn_time_ms": 2749.329, "learn_throughput": 372.455, "synch_weights_time_ms": 35.867}, "counters": {"num_env_steps_sampled": 168960, "num_env_steps_trained": 168960, "num_agent_steps_sampled": 168960, "num_agent_steps_trained": 168960}, "done": false, "training_iteration": 165, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-11", "timestamp": 1744126211, "time_this_iter_s": 5.155843257904053, "time_total_s": 801.6867127418518, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC160C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 801.6867127418518, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 56.642857142857146, "ram_util_percent": 88.95714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2673282012343408, "cur_kl_coeff": 4.2764235361475127e-51, "cur_lr": 1e-07, "total_loss": 2.1822428554296494, "policy_loss": -0.0001157229533419013, "vf_loss": 9.98167353272438, "vf_explained_var": -1.9433721899986266e-05, "kl": 1.2640360703308761e-06, "entropy": 3.13059813529253, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "env_runners": {"episode_reward_max": 579.9298283103046, "episode_reward_min": 437.05139039976376, "episode_reward_mean": 481.60324051941353, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.05139039976376}, "policy_reward_max": {"tplp_policy": 579.9298283103046}, "policy_reward_mean": {"tplp_policy": 481.60324051941353}, "custom_metrics": {"mean_episode_reward_mean": 481.60324051941353, "mean_episode_reward_min": 437.05139039976376, "mean_episode_reward_max": 579.9298283103046}, "hist_stats": {"episode_reward": [447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [447.8566231503967, 451.30457918701086, 475.3037091620426, 482.5750954521983, 475.41467190984616, 466.19231628211526, 507.2199436599569, 456.63486904458966, 475.9918507931704, 494.6128689953897, 494.20596447559524, 449.2846839855372, 473.9998374458805, 439.98163778740343, 490.0429271338591, 486.2529854212099, 489.23378385004116, 508.1917746587603, 494.39431395858395, 474.0646863172006, 501.985225572567, 485.99366456528685, 579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5180934326191635, "mean_inference_ms": 4.513175895337557, "mean_action_processing_ms": 0.8407809425638897, "mean_env_wait_ms": 4.335529260435391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016114473342895508, "StateBufferConnector_ms": 0.020592689514160156, "ViewRequirementAgentConnector_ms": 0.4237048625946045}, "num_episodes": 18, "episode_return_max": 579.9298283103046, "episode_return_min": 437.05139039976376, "episode_return_mean": 481.60324051941353, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984, "num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 198.03887438180968, "num_env_steps_trained_throughput_per_sec": 198.03887438180968, "timesteps_total": 169984, "num_env_steps_sampled_lifetime": 169984, "num_agent_steps_sampled_lifetime": 169984, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 169984, "timers": {"training_iteration_time_ms": 4956.192, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4956.141, "sample_time_ms": 2180.459, "learn_time_ms": 2738.552, "learn_throughput": 373.92, "synch_weights_time_ms": 36.389}, "counters": {"num_env_steps_sampled": 169984, "num_env_steps_trained": 169984, "num_agent_steps_sampled": 169984, "num_agent_steps_trained": 169984}, "done": false, "training_iteration": 166, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-16", "timestamp": 1744126216, "time_this_iter_s": 5.201573848724365, "time_total_s": 806.8882865905762, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB47EC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 806.8882865905762, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 57.13333333333333, "ram_util_percent": 88.83333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.204675430804491, "cur_kl_coeff": 2.1382117680737563e-51, "cur_lr": 1e-07, "total_loss": 2.177290964871645, "policy_loss": 3.059562877751887e-05, "vf_loss": 9.961856335401535, "vf_explained_var": -1.108311116695404e-05, "kl": 6.617820158649757e-07, "entropy": 3.132037165760994, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "env_runners": {"episode_reward_max": 579.9298283103046, "episode_reward_min": 432.06735266416786, "episode_reward_mean": 482.19149011001036, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.06735266416786}, "policy_reward_max": {"tplp_policy": 579.9298283103046}, "policy_reward_mean": {"tplp_policy": 482.19149011001036}, "custom_metrics": {"mean_episode_reward_mean": 482.19149011001036, "mean_episode_reward_min": 432.06735266416786, "mean_episode_reward_max": 579.9298283103046}, "hist_stats": {"episode_reward": [579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [579.9298283103046, 488.2331465317052, 487.51713603184487, 569.9926491122947, 492.22777614159554, 475.5094115498854, 478.98695367084866, 486.3931437032112, 462.98328525602096, 467.742267692898, 449.30308226036345, 481.7827015393815, 471.3419570508791, 490.4899051017145, 488.4913380298433, 456.2052866535946, 465.42870747625466, 475.8014037336605, 453.48542822626786, 481.9922966147791, 509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.517802007078521, "mean_inference_ms": 4.513906941426982, "mean_action_processing_ms": 0.8408682860224875, "mean_env_wait_ms": 4.336014101801322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012518167495727539, "StateBufferConnector_ms": 0.018874406814575195, "ViewRequirementAgentConnector_ms": 0.4315145015716553}, "num_episodes": 22, "episode_return_max": 579.9298283103046, "episode_return_min": 432.06735266416786, "episode_return_mean": 482.19149011001036, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008, "num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 209.6236124958685, "num_env_steps_trained_throughput_per_sec": 209.6236124958685, "timesteps_total": 171008, "num_env_steps_sampled_lifetime": 171008, "num_agent_steps_sampled_lifetime": 171008, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 171008, "timers": {"training_iteration_time_ms": 4962.78, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4962.73, "sample_time_ms": 2178.711, "learn_time_ms": 2746.238, "learn_throughput": 372.874, "synch_weights_time_ms": 37.04}, "counters": {"num_env_steps_sampled": 171008, "num_env_steps_trained": 171008, "num_agent_steps_sampled": 171008, "num_agent_steps_trained": 171008}, "done": false, "training_iteration": 167, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-21", "timestamp": 1744126221, "time_this_iter_s": 4.9140143394470215, "time_total_s": 811.8023009300232, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 811.8023009300232, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 51.91428571428571, "ram_util_percent": 88.77142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5988031812012196, "cur_kl_coeff": 1.0691058840368782e-51, "cur_lr": 1e-07, "total_loss": 2.1839568331837653, "policy_loss": -0.0002079472818877548, "vf_loss": 9.990388524532317, "vf_explained_var": -2.087913453578949e-05, "kl": 2.947928437702085e-06, "entropy": 3.134323312342167, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "env_runners": {"episode_reward_max": 581.2122673936332, "episode_reward_min": 432.06735266416786, "episode_reward_mean": 482.4151820158672, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.06735266416786}, "policy_reward_max": {"tplp_policy": 581.2122673936332}, "policy_reward_mean": {"tplp_policy": 482.4151820158672}, "custom_metrics": {"mean_episode_reward_mean": 482.4151820158672, "mean_episode_reward_min": 432.06735266416786, "mean_episode_reward_max": 581.2122673936332}, "hist_stats": {"episode_reward": [509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.65440836470606, 528.9239290102707, 496.44849638699634, 497.7344184089262, 489.68282248334447, 502.03991585446863, 457.66307316171407, 459.7025046110373, 481.28059304950557, 456.61462500906924, 497.9729046688606, 489.75753708864266, 456.5265668793368, 516.734447104965, 482.73856923020065, 519.0177166970396, 462.2212517104756, 471.2317108940707, 468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5176747139407405, "mean_inference_ms": 4.514590120581423, "mean_action_processing_ms": 0.8409523241328941, "mean_env_wait_ms": 4.336804800893045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013185977935791016, "StateBufferConnector_ms": 0.021456480026245117, "ViewRequirementAgentConnector_ms": 0.5697646141052246}, "num_episodes": 20, "episode_return_max": 581.2122673936332, "episode_return_min": 432.06735266416786, "episode_return_mean": 482.4151820158672, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032, "num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 204.6864594658391, "num_env_steps_trained_throughput_per_sec": 204.6864594658391, "timesteps_total": 172032, "num_env_steps_sampled_lifetime": 172032, "num_agent_steps_sampled_lifetime": 172032, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 4940.749, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4940.698, "sample_time_ms": 2127.266, "learn_time_ms": 2775.565, "learn_throughput": 368.934, "synch_weights_time_ms": 37.236}, "counters": {"num_env_steps_sampled": 172032, "num_env_steps_trained": 172032, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "done": false, "training_iteration": 168, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-26", "timestamp": 1744126226, "time_this_iter_s": 5.017357349395752, "time_total_s": 816.819658279419, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16200>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.819658279419, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 54.48571428571429, "ram_util_percent": 88.8142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.469545701891184, "cur_kl_coeff": 5.345529420184391e-52, "cur_lr": 1e-07, "total_loss": 2.1861465789377688, "policy_loss": -0.00010499124764464795, "vf_loss": 10.0, "vf_explained_var": -1.806207001209259e-05, "kl": 2.8589495030040268e-06, "entropy": 3.1374842271208765, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "env_runners": {"episode_reward_max": 581.2122673936332, "episode_reward_min": 432.06735266416786, "episode_reward_mean": 481.4307345662861, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.06735266416786}, "policy_reward_max": {"tplp_policy": 581.2122673936332}, "policy_reward_mean": {"tplp_policy": 481.4307345662861}, "custom_metrics": {"mean_episode_reward_mean": 481.4307345662861, "mean_episode_reward_min": 432.06735266416786, "mean_episode_reward_max": 581.2122673936332}, "hist_stats": {"episode_reward": [468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.40440941084694, 493.46683651149584, 464.7456265084509, 494.1778785745395, 478.6225850063614, 476.4584521792222, 511.4637409245707, 494.2779184590378, 480.6770949304923, 473.0537626039468, 558.7597080050133, 459.1368147155765, 452.2161766272625, 502.83242433873664, 491.82286091167384, 483.72044334571143, 505.1252667432645, 457.9794928581735, 470.0020265116283, 481.32565503173345, 494.00974780090337, 437.05139039976376, 504.21501230287413, 467.72442572021333, 509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.517804199900211, "mean_inference_ms": 4.5155228105378065, "mean_action_processing_ms": 0.8411232117565683, "mean_env_wait_ms": 4.337992714431247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013052225112915039, "StateBufferConnector_ms": 0.025150775909423828, "ViewRequirementAgentConnector_ms": 0.627471923828125}, "num_episodes": 18, "episode_return_max": 581.2122673936332, "episode_return_min": 432.06735266416786, "episode_return_mean": 481.4307345662861, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056, "num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 200.05512601729038, "num_env_steps_trained_throughput_per_sec": 200.05512601729038, "timesteps_total": 173056, "num_env_steps_sampled_lifetime": 173056, "num_agent_steps_sampled_lifetime": 173056, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 173056, "timers": {"training_iteration_time_ms": 4926.718, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4926.667, "sample_time_ms": 2140.167, "learn_time_ms": 2748.849, "learn_throughput": 372.52, "synch_weights_time_ms": 37.02}, "counters": {"num_env_steps_sampled": 173056, "num_env_steps_trained": 173056, "num_agent_steps_sampled": 173056, "num_agent_steps_trained": 173056}, "done": false, "training_iteration": 169, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-31", "timestamp": 1744126231, "time_this_iter_s": 5.133659839630127, "time_total_s": 821.9533181190491, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 821.9533181190491, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 51.75, "ram_util_percent": 88.81666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.976793549954891, "cur_kl_coeff": 2.6727647100921954e-52, "cur_lr": 1e-07, "total_loss": 2.1835020504891873, "policy_loss": -0.00023832903243601323, "vf_loss": 9.991031408309937, "vf_explained_var": -2.128779888153076e-05, "kl": 2.9458505569124326e-06, "entropy": 3.14017473757267, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "env_runners": {"episode_reward_max": 581.2122673936332, "episode_reward_min": 432.06735266416786, "episode_reward_mean": 480.58306058561635, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 432.06735266416786}, "policy_reward_max": {"tplp_policy": 581.2122673936332}, "policy_reward_mean": {"tplp_policy": 480.58306058561635}, "custom_metrics": {"mean_episode_reward_mean": 480.58306058561635, "mean_episode_reward_min": 432.06735266416786, "mean_episode_reward_max": 581.2122673936332}, "hist_stats": {"episode_reward": [509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [509.5232971711843, 467.1222724023805, 467.76738132485275, 486.54128489132114, 462.20404688636603, 492.9553124861241, 463.35770806189146, 476.54710073599887, 488.269762785588, 502.6213384349952, 461.04512290494563, 464.90361330201443, 473.27488651199724, 463.2186149926052, 437.36971100078176, 441.81163951719736, 503.52891619092344, 445.6587128584882, 432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5186317920428594, "mean_inference_ms": 4.518764228184279, "mean_action_processing_ms": 0.8415205952602796, "mean_env_wait_ms": 4.340965393093011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015555858612060547, "StateBufferConnector_ms": 0.0211641788482666, "ViewRequirementAgentConnector_ms": 0.6562905311584473}, "num_episodes": 24, "episode_return_max": 581.2122673936332, "episode_return_min": 432.06735266416786, "episode_return_mean": 480.58306058561635, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080, "num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 138.71974735049724, "num_env_steps_trained_throughput_per_sec": 138.71974735049724, "timesteps_total": 174080, "num_env_steps_sampled_lifetime": 174080, "num_agent_steps_sampled_lifetime": 174080, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 174080, "timers": {"training_iteration_time_ms": 5151.108, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5151.057, "sample_time_ms": 2200.449, "learn_time_ms": 2913.113, "learn_throughput": 351.514, "synch_weights_time_ms": 36.864}, "counters": {"num_env_steps_sampled": 174080, "num_env_steps_trained": 174080, "num_agent_steps_sampled": 174080, "num_agent_steps_trained": 174080}, "done": false, "training_iteration": 170, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-39", "timestamp": 1744126239, "time_this_iter_s": 7.400986909866333, "time_total_s": 829.3543050289154, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060BA50F40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 829.3543050289154, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 75.0, "ram_util_percent": 89.39}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6476721011102198, "cur_kl_coeff": 1.3363823550460977e-52, "cur_lr": 1e-07, "total_loss": 2.1821822106838225, "policy_loss": -0.00014038008521310985, "vf_loss": 9.986207675933837, "vf_explained_var": -1.5961751341819763e-05, "kl": 1.9645026644532494e-06, "entropy": 3.142293117940426, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "env_runners": {"episode_reward_max": 581.2122673936332, "episode_reward_min": 427.4060549573038, "episode_reward_mean": 480.0833003385788, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.4060549573038}, "policy_reward_max": {"tplp_policy": 581.2122673936332}, "policy_reward_mean": {"tplp_policy": 480.0833003385788}, "custom_metrics": {"mean_episode_reward_mean": 480.0833003385788, "mean_episode_reward_min": 427.4060549573038, "mean_episode_reward_max": 581.2122673936332}, "hist_stats": {"episode_reward": [432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [432.06735266416786, 456.240727047552, 565.9410226280824, 481.0163154894, 470.1259630922196, 489.4640349836809, 472.5130094997379, 494.44357695483325, 452.3708497873353, 489.08005815962576, 508.9588971980798, 497.14223819960233, 479.1023648464355, 477.9763249486507, 482.013543219825, 470.5395627420869, 476.93565605807777, 483.2041941976914, 480.51130781563853, 470.728343286181, 519.2462603632077, 487.9278685237494, 465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5195770958132178, "mean_inference_ms": 4.521936287188089, "mean_action_processing_ms": 0.841948313267195, "mean_env_wait_ms": 4.344147916415994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015963077545166016, "StateBufferConnector_ms": 0.022573471069335938, "ViewRequirementAgentConnector_ms": 0.6825673580169678}, "num_episodes": 18, "episode_return_max": 581.2122673936332, "episode_return_min": 427.4060549573038, "episode_return_mean": 480.0833003385788, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104, "num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 200.47102863518236, "num_env_steps_trained_throughput_per_sec": 200.47102863518236, "timesteps_total": 175104, "num_env_steps_sampled_lifetime": 175104, "num_agent_steps_sampled_lifetime": 175104, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 175104, "timers": {"training_iteration_time_ms": 5155.093, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5155.042, "sample_time_ms": 2258.476, "learn_time_ms": 2858.605, "learn_throughput": 358.217, "synch_weights_time_ms": 37.33}, "counters": {"num_env_steps_sampled": 175104, "num_env_steps_trained": 175104, "num_agent_steps_sampled": 175104, "num_agent_steps_trained": 175104}, "done": false, "training_iteration": 171, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-44", "timestamp": 1744126244, "time_this_iter_s": 5.119741439819336, "time_total_s": 834.4740464687347, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8AE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 834.4740464687347, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 62.542857142857144, "ram_util_percent": 90.57142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3743842002004385, "cur_kl_coeff": 6.681911775230489e-53, "cur_lr": 1e-07, "total_loss": 2.1855532310903074, "policy_loss": -2.689209650270641e-05, "vf_loss": 10.0, "vf_explained_var": -1.4984235167503358e-05, "kl": 1.3012826619807073e-06, "entropy": 3.1441986948251723, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "env_runners": {"episode_reward_max": 581.2122673936332, "episode_reward_min": 424.05851208738784, "episode_reward_mean": 478.0278327157487, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.05851208738784}, "policy_reward_max": {"tplp_policy": 581.2122673936332}, "policy_reward_mean": {"tplp_policy": 478.0278327157487}, "custom_metrics": {"mean_episode_reward_mean": 478.0278327157487, "mean_episode_reward_min": 424.05851208738784, "mean_episode_reward_max": 581.2122673936332}, "hist_stats": {"episode_reward": [465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.92867340236813, 542.5678950194084, 483.0758532145331, 482.1318322790767, 486.5620324089198, 497.1712617962753, 581.2122673936332, 463.6340426479322, 471.0974192623546, 499.50452344082385, 445.1370655528354, 481.30630945413765, 461.12368020207407, 475.4390074766822, 458.98297033125624, 496.2877340251423, 469.8352120782045, 458.0349864004199, 433.95665046066966, 483.8818626174649, 475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5208468575790552, "mean_inference_ms": 4.526030081481877, "mean_action_processing_ms": 0.8425684149122402, "mean_env_wait_ms": 4.34811893649279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01665639877319336, "StateBufferConnector_ms": 0.02356100082397461, "ViewRequirementAgentConnector_ms": 0.618873119354248}, "num_episodes": 22, "episode_return_max": 581.2122673936332, "episode_return_min": 424.05851208738784, "episode_return_mean": 478.0278327157487, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128, "num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 208.1089202412977, "num_env_steps_trained_throughput_per_sec": 208.1089202412977, "timesteps_total": 176128, "num_env_steps_sampled_lifetime": 176128, "num_agent_steps_sampled_lifetime": 176128, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 176128, "timers": {"training_iteration_time_ms": 5187.75, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5187.75, "sample_time_ms": 2277.188, "learn_time_ms": 2871.826, "learn_throughput": 356.568, "synch_weights_time_ms": 37.903}, "counters": {"num_env_steps_sampled": 176128, "num_env_steps_trained": 176128, "num_agent_steps_sampled": 176128, "num_agent_steps_trained": 176128}, "done": false, "training_iteration": 172, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-49", "timestamp": 1744126249, "time_this_iter_s": 4.934561252593994, "time_total_s": 839.4086077213287, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 839.4086077213287, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 53.39999999999999, "ram_util_percent": 90.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2146259918808937, "cur_kl_coeff": 3.3409558876152443e-53, "cur_lr": 1e-07, "total_loss": 2.180860137194395, "policy_loss": -6.993792485445737e-05, "vf_loss": 9.982352554798126, "vf_explained_var": -1.9491463899612426e-05, "kl": 1.8754382645980173e-06, "entropy": 3.1465806022286413, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "env_runners": {"episode_reward_max": 550.4290713189348, "episode_reward_min": 424.05851208738784, "episode_reward_mean": 477.77187583599175, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.05851208738784}, "policy_reward_max": {"tplp_policy": 550.4290713189348}, "policy_reward_mean": {"tplp_policy": 477.77187583599175}, "custom_metrics": {"mean_episode_reward_mean": 477.77187583599175, "mean_episode_reward_min": 424.05851208738784, "mean_episode_reward_max": 550.4290713189348}, "hist_stats": {"episode_reward": [475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.22678536801794, 481.26934421639476, 452.4493847190909, 462.4362741393252, 524.7703988633301, 520.44171178268, 473.41105216884023, 487.1665150156886, 482.4474255968675, 538.2993584135273, 479.5491152695559, 447.376138494084, 507.25311719901396, 453.7896139646743, 491.8479363633506, 481.9280610029559, 501.3014711829309, 446.47394384260707, 476.4532657002521, 550.4290713189348, 466.95062262040904, 479.3308597685918, 465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5218809159656084, "mean_inference_ms": 4.529626106085523, "mean_action_processing_ms": 0.843190359305237, "mean_env_wait_ms": 4.351716714992723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01317453384399414, "StateBufferConnector_ms": 0.01865100860595703, "ViewRequirementAgentConnector_ms": 0.5320277214050293}, "num_episodes": 20, "episode_return_max": 550.4290713189348, "episode_return_min": 424.05851208738784, "episode_return_mean": 477.77187583599175, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152, "num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 226.7443901321357, "num_env_steps_trained_throughput_per_sec": 226.7443901321357, "timesteps_total": 177152, "num_env_steps_sampled_lifetime": 177152, "num_agent_steps_sampled_lifetime": 177152, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 177152, "timers": {"training_iteration_time_ms": 5169.508, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5169.508, "sample_time_ms": 2282.859, "learn_time_ms": 2848.729, "learn_throughput": 359.459, "synch_weights_time_ms": 37.087}, "counters": {"num_env_steps_sampled": 177152, "num_env_steps_trained": 177152, "num_agent_steps_sampled": 177152, "num_agent_steps_trained": 177152}, "done": false, "training_iteration": 173, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-54", "timestamp": 1744126254, "time_this_iter_s": 4.532527446746826, "time_total_s": 843.9411351680756, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC94E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 843.9411351680756, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 55.166666666666664, "ram_util_percent": 90.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.647002400457859, "cur_kl_coeff": 1.6704779438076221e-53, "cur_lr": 1e-07, "total_loss": 2.182424346357584, "policy_loss": -9.444509050808847e-05, "vf_loss": 9.98975071310997, "vf_explained_var": -1.2547150254249572e-05, "kl": 2.2785449282872185e-06, "entropy": 3.149188905954361, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "env_runners": {"episode_reward_max": 543.8575400984663, "episode_reward_min": 416.72240343518087, "episode_reward_mean": 476.3651541410289, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.72240343518087}, "policy_reward_max": {"tplp_policy": 543.8575400984663}, "policy_reward_mean": {"tplp_policy": 476.3651541410289}, "custom_metrics": {"mean_episode_reward_mean": 476.3651541410289, "mean_episode_reward_min": 416.72240343518087, "mean_episode_reward_max": 543.8575400984663}, "hist_stats": {"episode_reward": [465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.71230675396293, 507.4086196594888, 479.8798451169463, 439.54263208342263, 473.30937117120067, 435.2539309310924, 509.4391792028157, 473.3469339927437, 486.9759128650156, 489.0099022990759, 446.54143697762163, 467.51775928391595, 477.3528027685854, 450.94193472266033, 479.34960207420227, 508.9231809991683, 481.98689300221656, 523.0708740166466, 473.2771393403453, 444.52117495007695, 487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5231306044955608, "mean_inference_ms": 4.531332863873436, "mean_action_processing_ms": 0.8437426627811934, "mean_env_wait_ms": 4.3539640921052785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031842708587646484, "StateBufferConnector_ms": 0.023618221282958984, "ViewRequirementAgentConnector_ms": 0.5022807121276855}, "num_episodes": 22, "episode_return_max": 543.8575400984663, "episode_return_min": 416.72240343518087, "episode_return_mean": 476.3651541410289, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176, "num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 203.50441034610085, "num_env_steps_trained_throughput_per_sec": 203.50441034610085, "timesteps_total": 178176, "num_env_steps_sampled_lifetime": 178176, "num_agent_steps_sampled_lifetime": 178176, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 178176, "timers": {"training_iteration_time_ms": 5227.934, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5227.934, "sample_time_ms": 2315.533, "learn_time_ms": 2873.047, "learn_throughput": 356.416, "synch_weights_time_ms": 38.52}, "counters": {"num_env_steps_sampled": 178176, "num_env_steps_trained": 178176, "num_agent_steps_sampled": 178176, "num_agent_steps_trained": 178176}, "done": false, "training_iteration": 174, "trial_id": "3bf18_00000", "date": "2025-04-08_23-30-59", "timestamp": 1744126259, "time_this_iter_s": 5.066291332244873, "time_total_s": 849.0074265003204, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 849.0074265003204, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 54.41428571428571, "ram_util_percent": 90.37142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1663277499377727, "cur_kl_coeff": 8.352389719038111e-54, "cur_lr": 1e-07, "total_loss": 2.1829115368425844, "policy_loss": -2.830824232660234e-05, "vf_loss": 9.992578679323197, "vf_explained_var": -1.2353807687759399e-05, "kl": 1.5719721563833834e-06, "entropy": 3.152048236131668, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "env_runners": {"episode_reward_max": 543.8575400984663, "episode_reward_min": 416.72240343518087, "episode_reward_mean": 477.31164796205877, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.72240343518087}, "policy_reward_max": {"tplp_policy": 543.8575400984663}, "policy_reward_mean": {"tplp_policy": 477.31164796205877}, "custom_metrics": {"mean_episode_reward_mean": 477.31164796205877, "mean_episode_reward_min": 416.72240343518087, "mean_episode_reward_max": 543.8575400984663}, "hist_stats": {"episode_reward": [487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.79154194675715, 469.8440022326209, 462.44266391418876, 491.1020517767627, 427.4060549573038, 479.2807599692778, 469.43328677989575, 460.4930140816213, 475.88445364937036, 478.83441232954397, 471.2633041948051, 488.0605130307738, 469.6027495280107, 482.3067389048037, 430.73055035476045, 495.4702858149856, 439.21729001236423, 425.8607548630052, 463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5234438861952508, "mean_inference_ms": 4.535508631415268, "mean_action_processing_ms": 0.8445455117869705, "mean_env_wait_ms": 4.357637178940141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03148603439331055, "StateBufferConnector_ms": 0.024313926696777344, "ViewRequirementAgentConnector_ms": 0.5083646774291992}, "num_episodes": 20, "episode_return_max": 543.8575400984663, "episode_return_min": 416.72240343518087, "episode_return_mean": 477.31164796205877, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200, "num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 202.02576212623597, "num_env_steps_trained_throughput_per_sec": 202.02576212623597, "timesteps_total": 179200, "num_env_steps_sampled_lifetime": 179200, "num_agent_steps_sampled_lifetime": 179200, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 179200, "timers": {"training_iteration_time_ms": 5220.386, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5220.386, "sample_time_ms": 2343.088, "learn_time_ms": 2838.318, "learn_throughput": 360.777, "synch_weights_time_ms": 38.147}, "counters": {"num_env_steps_sampled": 179200, "num_env_steps_trained": 179200, "num_agent_steps_sampled": 179200, "num_agent_steps_trained": 179200}, "done": false, "training_iteration": 175, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-04", "timestamp": 1744126264, "time_this_iter_s": 5.082691192626953, "time_total_s": 854.0901176929474, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8CC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 854.0901176929474, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 58.56666666666667, "ram_util_percent": 90.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.285561577230692, "cur_kl_coeff": 4.1761948595190553e-54, "cur_lr": 1e-07, "total_loss": 2.1845651030540467, "policy_loss": -2.3244536714628337e-05, "vf_loss": 10.0, "vf_explained_var": -1.981519162654877e-05, "kl": 9.308056187151692e-07, "entropy": 3.1541166454553604, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "env_runners": {"episode_reward_max": 543.8575400984663, "episode_reward_min": 416.72240343518087, "episode_reward_mean": 479.8645589318067, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.72240343518087}, "policy_reward_max": {"tplp_policy": 543.8575400984663}, "policy_reward_mean": {"tplp_policy": 479.8645589318067}, "custom_metrics": {"mean_episode_reward_mean": 479.8645589318067, "mean_episode_reward_min": 416.72240343518087, "mean_episode_reward_max": 543.8575400984663}, "hist_stats": {"episode_reward": [463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.2844505531963, 444.88763877337, 498.452039537185, 503.811584952169, 424.05851208738784, 527.1626287915967, 458.0669764688186, 460.01283957094813, 495.94178389372183, 442.82862989131945, 493.9722604932492, 459.1234664112692, 538.686429416848, 450.511220891713, 491.7330217398706, 485.9617831682207, 478.3021761564457, 474.225812504004, 496.35142391023254, 479.54998533592214, 479.91793940343706, 498.6772111419786, 445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5236364230810022, "mean_inference_ms": 4.536000919228589, "mean_action_processing_ms": 0.8448517240698642, "mean_env_wait_ms": 4.358641695601111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0333256721496582, "StateBufferConnector_ms": 0.027384281158447266, "ViewRequirementAgentConnector_ms": 0.4902024269104004}, "num_episodes": 18, "episode_return_max": 543.8575400984663, "episode_return_min": 416.72240343518087, "episode_return_mean": 479.8645589318067, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224, "num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 229.55247967736915, "num_env_steps_trained_throughput_per_sec": 229.55247967736915, "timesteps_total": 180224, "num_env_steps_sampled_lifetime": 180224, "num_agent_steps_sampled_lifetime": 180224, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 180224, "timers": {"training_iteration_time_ms": 5149.401, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5149.401, "sample_time_ms": 2285.269, "learn_time_ms": 2825.642, "learn_throughput": 362.396, "synch_weights_time_ms": 38.288}, "counters": {"num_env_steps_sampled": 180224, "num_env_steps_trained": 180224, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "done": false, "training_iteration": 176, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-09", "timestamp": 1744126269, "time_this_iter_s": 4.475306987762451, "time_total_s": 858.5654246807098, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC15940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 858.5654246807098, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 49.72857142857142, "ram_util_percent": 90.65714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.357523650676012, "cur_kl_coeff": 2.0880974297595277e-54, "cur_lr": 1e-07, "total_loss": 2.181323927640915, "policy_loss": -7.641796255484224e-05, "vf_loss": 9.987983465194702, "vf_explained_var": -1.5566125512123108e-05, "kl": 1.822028110541607e-06, "entropy": 3.1559551805257797, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "env_runners": {"episode_reward_max": 543.8575400984663, "episode_reward_min": 416.72240343518087, "episode_reward_mean": 480.1920842797853, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.72240343518087}, "policy_reward_max": {"tplp_policy": 543.8575400984663}, "policy_reward_mean": {"tplp_policy": 480.1920842797853}, "custom_metrics": {"mean_episode_reward_mean": 480.1920842797853, "mean_episode_reward_min": 416.72240343518087, "mean_episode_reward_max": 543.8575400984663}, "hist_stats": {"episode_reward": [445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [445.070743789189, 451.2333145475459, 543.8575400984663, 445.04449709137083, 470.3626285199694, 454.89009514636143, 483.0952301801292, 476.2642918966059, 479.3495985027672, 493.1341336614393, 500.8958395393692, 490.06430909546094, 460.3297345864702, 472.9674559750163, 496.59957770465803, 462.7125096981814, 493.5856675638326, 513.2232733462613, 465.37348770861576, 452.688842890765, 477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5239266550953459, "mean_inference_ms": 4.53704667321371, "mean_action_processing_ms": 0.8452858344543701, "mean_env_wait_ms": 4.360770729301685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040764570236206055, "StateBufferConnector_ms": 0.026375532150268555, "ViewRequirementAgentConnector_ms": 0.5118973255157471}, "num_episodes": 22, "episode_return_max": 543.8575400984663, "episode_return_min": 416.72240343518087, "episode_return_mean": 480.1920842797853, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248, "num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 207.9504137857407, "num_env_steps_trained_throughput_per_sec": 207.9504137857407, "timesteps_total": 181248, "num_env_steps_sampled_lifetime": 181248, "num_agent_steps_sampled_lifetime": 181248, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 181248, "timers": {"training_iteration_time_ms": 5153.332, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5153.332, "sample_time_ms": 2312.001, "learn_time_ms": 2803.47, "learn_throughput": 365.262, "synch_weights_time_ms": 37.659}, "counters": {"num_env_steps_sampled": 181248, "num_env_steps_trained": 181248, "num_agent_steps_sampled": 181248, "num_agent_steps_trained": 181248}, "done": false, "training_iteration": 177, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-14", "timestamp": 1744126274, "time_this_iter_s": 4.943052530288696, "time_total_s": 863.5084772109985, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 863.5084772109985, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 56.06666666666667, "ram_util_percent": 90.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3737101446837188, "cur_kl_coeff": 1.0440487148797638e-54, "cur_lr": 1e-07, "total_loss": 2.1842511244118215, "policy_loss": 3.1875207787379624e-05, "vf_loss": 10.0, "vf_explained_var": -1.6001984477043152e-05, "kl": 5.961598192286143e-07, "entropy": 3.1578075513243675, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "env_runners": {"episode_reward_max": 529.6046204745626, "episode_reward_min": 416.72240343518087, "episode_reward_mean": 479.60836946518634, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 416.72240343518087}, "policy_reward_max": {"tplp_policy": 529.6046204745626}, "policy_reward_mean": {"tplp_policy": 479.60836946518634}, "custom_metrics": {"mean_episode_reward_mean": 479.60836946518634, "mean_episode_reward_min": 416.72240343518087, "mean_episode_reward_max": 529.6046204745626}, "hist_stats": {"episode_reward": [477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [477.3570462941777, 516.7835546612439, 511.47601302627504, 496.01278999175514, 518.7536932505249, 506.1884586340983, 474.221098640336, 446.69658607483206, 449.722402652612, 416.72240343518087, 447.1997370379733, 492.65027454653045, 430.1771820924586, 520.9633814553658, 480.6701964445967, 456.20368952198646, 475.5319981774027, 514.838855227375, 476.69017425960783, 513.0074314911162, 421.7136717309979, 474.3769322889044, 463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.524318534428793, "mean_inference_ms": 4.538190314543709, "mean_action_processing_ms": 0.8456412390076224, "mean_env_wait_ms": 4.362342204175712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04857945442199707, "StateBufferConnector_ms": 0.029794692993164062, "ViewRequirementAgentConnector_ms": 0.5429213047027588}, "num_episodes": 20, "episode_return_max": 529.6046204745626, "episode_return_min": 416.72240343518087, "episode_return_mean": 479.60836946518634, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272, "num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 186.02063939613646, "num_env_steps_trained_throughput_per_sec": 186.02063939613646, "timesteps_total": 182272, "num_env_steps_sampled_lifetime": 182272, "num_agent_steps_sampled_lifetime": 182272, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 182272, "timers": {"training_iteration_time_ms": 5203.531, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5203.531, "sample_time_ms": 2311.636, "learn_time_ms": 2853.88, "learn_throughput": 358.81, "synch_weights_time_ms": 37.813}, "counters": {"num_env_steps_sampled": 182272, "num_env_steps_trained": 182272, "num_agent_steps_sampled": 182272, "num_agent_steps_trained": 182272}, "done": false, "training_iteration": 178, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-20", "timestamp": 1744126280, "time_this_iter_s": 5.519736051559448, "time_total_s": 869.028213262558, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 869.028213262558, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 64.3, "ram_util_percent": 89.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6960989467799665, "cur_kl_coeff": 5.220243574398819e-55, "cur_lr": 1e-07, "total_loss": 2.17916569635272, "policy_loss": -8.099765400402248e-05, "vf_loss": 9.980767649412154, "vf_explained_var": -1.7870962619781493e-05, "kl": 1.5649087037369891e-06, "entropy": 3.1594520658254623, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "env_runners": {"episode_reward_max": 529.6046204745626, "episode_reward_min": 424.7739660773208, "episode_reward_mean": 479.3656960260325, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.7739660773208}, "policy_reward_max": {"tplp_policy": 529.6046204745626}, "policy_reward_mean": {"tplp_policy": 479.3656960260325}, "custom_metrics": {"mean_episode_reward_mean": 479.3656960260325, "mean_episode_reward_min": 424.7739660773208, "mean_episode_reward_max": 529.6046204745626}, "hist_stats": {"episode_reward": [463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.53775798788706, 518.2178753225093, 463.7832568805077, 474.7190584709673, 516.3896003350902, 447.83653920629104, 492.9651724813198, 487.54811877822254, 486.16240239457227, 474.8226146510711, 498.52964021249943, 506.6303397631593, 504.641873652664, 482.7715183755739, 427.01795220265774, 483.0709381463318, 493.04903307542736, 490.226518357544, 458.55321657743775, 453.1714926692093, 497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5248384943496278, "mean_inference_ms": 4.5391420480200395, "mean_action_processing_ms": 0.8460603432370165, "mean_env_wait_ms": 4.364195149848724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03707313537597656, "StateBufferConnector_ms": 0.019353628158569336, "ViewRequirementAgentConnector_ms": 0.5725998878479004}, "num_episodes": 22, "episode_return_max": 529.6046204745626, "episode_return_min": 424.7739660773208, "episode_return_mean": 479.3656960260325, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296, "num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 201.36431319923352, "num_env_steps_trained_throughput_per_sec": 201.36431319923352, "timesteps_total": 183296, "num_env_steps_sampled_lifetime": 183296, "num_agent_steps_sampled_lifetime": 183296, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 183296, "timers": {"training_iteration_time_ms": 5200.203, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5200.203, "sample_time_ms": 2305.27, "learn_time_ms": 2857.607, "learn_throughput": 358.342, "synch_weights_time_ms": 37.124}, "counters": {"num_env_steps_sampled": 183296, "num_env_steps_trained": 183296, "num_agent_steps_sampled": 183296, "num_agent_steps_trained": 183296}, "done": false, "training_iteration": 179, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-25", "timestamp": 1744126285, "time_this_iter_s": 5.098912954330444, "time_total_s": 874.1271262168884, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 874.1271262168884, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 60.25714285714285, "ram_util_percent": 88.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5909861985594036, "cur_kl_coeff": 2.6101217871994096e-55, "cur_lr": 1e-07, "total_loss": 2.18362892344594, "policy_loss": -0.00012829990009777248, "vf_loss": 10.0, "vf_explained_var": -9.600445628166198e-06, "kl": 2.9999731022467556e-06, "entropy": 3.16242772936821, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "env_runners": {"episode_reward_max": 538.0049432588376, "episode_reward_min": 424.7739660773208, "episode_reward_mean": 477.5076160327585, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.7739660773208}, "policy_reward_max": {"tplp_policy": 538.0049432588376}, "policy_reward_mean": {"tplp_policy": 477.5076160327585}, "custom_metrics": {"mean_episode_reward_mean": 477.5076160327585, "mean_episode_reward_min": 424.7739660773208, "mean_episode_reward_max": 538.0049432588376}, "hist_stats": {"episode_reward": [497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.99270175135376, 465.33397695824254, 468.1669915900767, 505.0890696508814, 484.2340825037412, 443.6421951483293, 480.30101115221265, 472.44854743271077, 503.71814325140485, 439.6075377816393, 488.8069317496623, 467.4092791803596, 500.3065029776792, 529.6046204745626, 518.7929601884443, 483.13626427769515, 465.9622157633341, 476.47617252819657, 466.70144097645584, 526.6570973712478, 473.35037747334337, 481.5699233641083, 464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5250502830392805, "mean_inference_ms": 4.539127733623947, "mean_action_processing_ms": 0.8463369279560305, "mean_env_wait_ms": 4.364758282212593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03595614433288574, "StateBufferConnector_ms": 0.015100717544555664, "ViewRequirementAgentConnector_ms": 0.5706210136413574}, "num_episodes": 20, "episode_return_max": 538.0049432588376, "episode_return_min": 424.7739660773208, "episode_return_mean": 477.5076160327585, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320, "num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 227.28509229167986, "num_env_steps_trained_throughput_per_sec": 227.28509229167986, "timesteps_total": 184320, "num_env_steps_sampled_lifetime": 184320, "num_agent_steps_sampled_lifetime": 184320, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 184320, "timers": {"training_iteration_time_ms": 4912.56, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4912.56, "sample_time_ms": 2185.125, "learn_time_ms": 2689.781, "learn_throughput": 380.7, "synch_weights_time_ms": 37.452}, "counters": {"num_env_steps_sampled": 184320, "num_env_steps_trained": 184320, "num_agent_steps_sampled": 184320, "num_agent_steps_trained": 184320}, "done": false, "training_iteration": 180, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-30", "timestamp": 1744126290, "time_this_iter_s": 4.522728204727173, "time_total_s": 878.6498544216156, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 878.6498544216156, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 51.91428571428571, "ram_util_percent": 88.55714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2500876199454067, "cur_kl_coeff": 1.3050608935997048e-55, "cur_lr": 1e-07, "total_loss": 2.1795723982155324, "policy_loss": -8.234681445173919e-05, "vf_loss": 9.984687006473541, "vf_explained_var": -8.586421608924866e-06, "kl": 1.7500650740132073e-06, "entropy": 3.1651700019836424, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "env_runners": {"episode_reward_max": 538.0049432588376, "episode_reward_min": 424.7739660773208, "episode_reward_mean": 475.75730369205814, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.7739660773208}, "policy_reward_max": {"tplp_policy": 538.0049432588376}, "policy_reward_mean": {"tplp_policy": 475.75730369205814}, "custom_metrics": {"mean_episode_reward_mean": 475.75730369205814, "mean_episode_reward_min": 424.7739660773208, "mean_episode_reward_max": 538.0049432588376}, "hist_stats": {"episode_reward": [464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.4171859212211, 483.5829212904508, 455.920413766945, 476.5504399268387, 517.2823975285697, 480.3652716788931, 527.962522033379, 463.53247411604616, 479.6075568970893, 477.7137852270201, 424.7739660773208, 501.61354000469026, 491.75719210265686, 501.87100996797506, 476.706690543883, 463.8977553311129, 502.0902629925424, 468.8294335133936, 475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.525451000194777, "mean_inference_ms": 4.536610515785239, "mean_action_processing_ms": 0.8463085534862124, "mean_env_wait_ms": 4.364025832683142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027057886123657227, "StateBufferConnector_ms": 0.01305842399597168, "ViewRequirementAgentConnector_ms": 0.5993010997772217}, "num_episodes": 22, "episode_return_max": 538.0049432588376, "episode_return_min": 424.7739660773208, "episode_return_mean": 475.75730369205814, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344, "num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 242.68165416691247, "num_env_steps_trained_throughput_per_sec": 242.68165416691247, "timesteps_total": 185344, "num_env_steps_sampled_lifetime": 185344, "num_agent_steps_sampled_lifetime": 185344, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 185344, "timers": {"training_iteration_time_ms": 4823.715, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4823.715, "sample_time_ms": 2133.366, "learn_time_ms": 2653.16, "learn_throughput": 385.955, "synch_weights_time_ms": 36.871}, "counters": {"num_env_steps_sampled": 185344, "num_env_steps_trained": 185344, "num_agent_steps_sampled": 185344, "num_agent_steps_trained": 185344}, "done": false, "training_iteration": 181, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-34", "timestamp": 1744126294, "time_this_iter_s": 4.2312164306640625, "time_total_s": 882.8810708522797, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 882.8810708522797, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 54.720000000000006, "ram_util_percent": 88.61999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4087592042982577, "cur_kl_coeff": 6.525304467998524e-56, "cur_lr": 1e-07, "total_loss": 2.1819331012666225, "policy_loss": 4.947494016960263e-06, "vf_loss": 9.994831544160842, "vf_explained_var": -1.149885356426239e-05, "kl": 1.929865141114817e-06, "entropy": 3.167797328531742, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "env_runners": {"episode_reward_max": 538.0049432588376, "episode_reward_min": 431.6484769693289, "episode_reward_mean": 474.511936202427, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.6484769693289}, "policy_reward_max": {"tplp_policy": 538.0049432588376}, "policy_reward_mean": {"tplp_policy": 474.511936202427}, "custom_metrics": {"mean_episode_reward_mean": 474.511936202427, "mean_episode_reward_min": 431.6484769693289, "mean_episode_reward_max": 538.0049432588376}, "hist_stats": {"episode_reward": [475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.54631670809016, 471.944319729592, 463.5228349567727, 485.971100826296, 487.36742129002823, 459.9839860651417, 508.8153511281908, 437.1351978838478, 496.14815685254905, 438.77966671111517, 479.8445404644497, 493.167290714941, 471.89166339910486, 460.7382431012931, 484.80872618512683, 469.0528255826066, 467.44096149655144, 469.29299048093657, 517.3578738797182, 480.88522145201307, 478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.524398148060474, "mean_inference_ms": 4.53649078669133, "mean_action_processing_ms": 0.8462693882744187, "mean_env_wait_ms": 4.3636171188931705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022729873657226562, "StateBufferConnector_ms": 0.013063192367553711, "ViewRequirementAgentConnector_ms": 0.5490758419036865}, "num_episodes": 18, "episode_return_max": 538.0049432588376, "episode_return_min": 431.6484769693289, "episode_return_mean": 474.511936202427, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368, "num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 299.64341088191765, "num_env_steps_trained_throughput_per_sec": 299.64341088191765, "timesteps_total": 186368, "num_env_steps_sampled_lifetime": 186368, "num_agent_steps_sampled_lifetime": 186368, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 186368, "timers": {"training_iteration_time_ms": 4673.404, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4673.404, "sample_time_ms": 2063.334, "learn_time_ms": 2573.823, "learn_throughput": 397.852, "synch_weights_time_ms": 36.131}, "counters": {"num_env_steps_sampled": 186368, "num_env_steps_trained": 186368, "num_agent_steps_sampled": 186368, "num_agent_steps_trained": 186368}, "done": false, "training_iteration": 182, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-38", "timestamp": 1744126298, "time_this_iter_s": 3.4269068241119385, "time_total_s": 886.3079776763916, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC91C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 886.3079776763916, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 47.160000000000004, "ram_util_percent": 88.62}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3616930209100246, "cur_kl_coeff": 3.262652233999262e-56, "cur_lr": 1e-07, "total_loss": 2.1828271366655825, "policy_loss": -8.582935552112759e-05, "vf_loss": 10.0, "vf_explained_var": -1.3017281889915467e-05, "kl": 2.1332600061541028e-06, "entropy": 3.1708703503012656, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "env_runners": {"episode_reward_max": 538.0049432588376, "episode_reward_min": 431.6484769693289, "episode_reward_mean": 473.77766513945784, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 431.6484769693289}, "policy_reward_max": {"tplp_policy": 538.0049432588376}, "policy_reward_mean": {"tplp_policy": 473.77766513945784}, "custom_metrics": {"mean_episode_reward_mean": 473.77766513945784, "mean_episode_reward_min": 431.6484769693289, "mean_episode_reward_max": 538.0049432588376}, "hist_stats": {"episode_reward": [478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [478.60447488219415, 456.02313688617784, 473.07391741441603, 493.20664503162294, 441.8692127899951, 462.1143750790135, 481.20502157664595, 466.41287201540115, 520.1871606553016, 497.91650088812264, 464.08735555798467, 493.1905148770263, 525.9544353042702, 480.5460463760104, 454.91984999987756, 468.9663500141313, 439.84728581942954, 454.9433208150712, 444.3337648208805, 498.0448908846529, 472.06749105591155, 457.4794887539039, 435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.523365987597023, "mean_inference_ms": 4.53264597593799, "mean_action_processing_ms": 0.8456884846590769, "mean_env_wait_ms": 4.36091457194894, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016000032424926758, "StateBufferConnector_ms": 0.009085893630981445, "ViewRequirementAgentConnector_ms": 0.47649598121643066}, "num_episodes": 20, "episode_return_max": 538.0049432588376, "episode_return_min": 431.6484769693289, "episode_return_mean": 473.77766513945784, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392, "num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 264.23645793222045, "num_env_steps_trained_throughput_per_sec": 264.23645793222045, "timesteps_total": 187392, "num_env_steps_sampled_lifetime": 187392, "num_agent_steps_sampled_lifetime": 187392, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 187392, "timers": {"training_iteration_time_ms": 4609.326, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4609.326, "sample_time_ms": 2002.291, "learn_time_ms": 2570.775, "learn_throughput": 398.323, "synch_weights_time_ms": 36.145}, "counters": {"num_env_steps_sampled": 187392, "num_env_steps_trained": 187392, "num_agent_steps_sampled": 187392, "num_agent_steps_trained": 187392}, "done": false, "training_iteration": 183, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-42", "timestamp": 1744126302, "time_this_iter_s": 3.884925365447998, "time_total_s": 890.1929030418396, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB44360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 890.1929030418396, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 46.48, "ram_util_percent": 88.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.167897905409336, "cur_kl_coeff": 1.631326116999631e-56, "cur_lr": 1e-07, "total_loss": 2.1825335256755354, "policy_loss": -6.111307302489877e-05, "vf_loss": 9.999820160865784, "vf_explained_var": -1.8580630421638488e-05, "kl": 2.099481825057481e-06, "entropy": 3.1736039221286774, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "env_runners": {"episode_reward_max": 584.7289127738371, "episode_reward_min": 424.6528229523969, "episode_reward_mean": 474.52753333333334, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.6528229523969}, "policy_reward_max": {"tplp_policy": 584.7289127738371}, "policy_reward_mean": {"tplp_policy": 474.52753333333334}, "custom_metrics": {"mean_episode_reward_mean": 474.52753333333334, "mean_episode_reward_min": 424.6528229523969, "mean_episode_reward_max": 584.7289127738371}, "hist_stats": {"episode_reward": [435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [435.0819829659419, 475.84305883360463, 490.73679946288865, 472.7567141548541, 460.7422251636379, 444.4413038380732, 481.6196093289635, 484.63980875261734, 452.1205053707938, 478.22230032455093, 474.7597634023438, 472.0157015655704, 435.0340660964542, 485.15210584225736, 538.0049432588376, 482.9558229458521, 467.45354255708065, 476.7096865394167, 467.4456703183874, 456.8168933612346, 463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.521463269403944, "mean_inference_ms": 4.52642198644855, "mean_action_processing_ms": 0.8445460025089497, "mean_env_wait_ms": 4.356037357851764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00956416130065918, "StateBufferConnector_ms": 0.009732723236083984, "ViewRequirementAgentConnector_ms": 0.4294095039367676}, "num_episodes": 22, "episode_return_max": 584.7289127738371, "episode_return_min": 424.6528229523969, "episode_return_mean": 474.52753333333334, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416, "num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 291.37833081210573, "num_env_steps_trained_throughput_per_sec": 291.37833081210573, "timesteps_total": 188416, "num_env_steps_sampled_lifetime": 188416, "num_agent_steps_sampled_lifetime": 188416, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 188416, "timers": {"training_iteration_time_ms": 4457.576, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4457.576, "sample_time_ms": 1911.409, "learn_time_ms": 2511.598, "learn_throughput": 407.709, "synch_weights_time_ms": 34.453}, "counters": {"num_env_steps_sampled": 188416, "num_env_steps_trained": 188416, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "done": false, "training_iteration": 184, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-45", "timestamp": 1744126305, "time_this_iter_s": 3.52541184425354, "time_total_s": 893.7183148860931, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCA160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 893.7183148860931, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 40.550000000000004, "ram_util_percent": 88.60000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3949445109814405, "cur_kl_coeff": 8.156630584998155e-57, "cur_lr": 1e-07, "total_loss": 2.1822185344994067, "policy_loss": -6.158768082968891e-05, "vf_loss": 10.0, "vf_explained_var": -1.1683255434036254e-05, "kl": 3.1293470477145036e-06, "entropy": 3.177198661863804, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "env_runners": {"episode_reward_max": 584.7289127738371, "episode_reward_min": 419.79337258873886, "episode_reward_mean": 474.42336978142566, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.79337258873886}, "policy_reward_max": {"tplp_policy": 584.7289127738371}, "policy_reward_mean": {"tplp_policy": 474.42336978142566}, "custom_metrics": {"mean_episode_reward_mean": 474.42336978142566, "mean_episode_reward_min": 419.79337258873886, "mean_episode_reward_max": 584.7289127738371}, "hist_stats": {"episode_reward": [463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.2346208896465, 466.82772900302007, 482.63254517798345, 504.8880313667942, 463.390620641439, 488.5033683375519, 493.80672496562715, 431.6484769693289, 500.5685164902686, 526.1894716260567, 437.6352161751018, 468.0445687251843, 532.2202040647238, 476.0654502869381, 457.6948894514326, 464.0132860486924, 489.9684778651561, 456.4327286599485, 450.092961242796, 486.1563578083317, 457.7694964328137, 493.2867035290345, 447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.519211682600764, "mean_inference_ms": 4.519538778887722, "mean_action_processing_ms": 0.8432446974382768, "mean_env_wait_ms": 4.349990525441605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008533239364624023, "StateBufferConnector_ms": 0.009732723236083984, "ViewRequirementAgentConnector_ms": 0.377685546875}, "num_episodes": 20, "episode_return_max": 584.7289127738371, "episode_return_min": 419.79337258873886, "episode_return_mean": 474.42336978142566, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440, "num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 310.4250858337319, "num_env_steps_trained_throughput_per_sec": 310.4250858337319, "timesteps_total": 189440, "num_env_steps_sampled_lifetime": 189440, "num_agent_steps_sampled_lifetime": 189440, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 189440, "timers": {"training_iteration_time_ms": 4280.58, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4280.58, "sample_time_ms": 1789.673, "learn_time_ms": 2456.832, "learn_throughput": 416.797, "synch_weights_time_ms": 33.96}, "counters": {"num_env_steps_sampled": 189440, "num_env_steps_trained": 189440, "num_agent_steps_sampled": 189440, "num_agent_steps_trained": 189440}, "done": false, "training_iteration": 185, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-49", "timestamp": 1744126309, "time_this_iter_s": 3.3095459938049316, "time_total_s": 897.0278608798981, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCA020>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 897.0278608798981, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 46.85, "ram_util_percent": 88.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.193637317419052, "cur_kl_coeff": 4.0783152924990775e-57, "cur_lr": 1e-07, "total_loss": 2.181060644984245, "policy_loss": -7.82839604653418e-05, "vf_loss": 9.996431124210357, "vf_explained_var": -2.5467947125434875e-05, "kl": 1.2181962101287525e-06, "entropy": 3.1796884506940843, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "env_runners": {"episode_reward_max": 594.8528132160908, "episode_reward_min": 419.79337258873886, "episode_reward_mean": 476.4909596326157, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.79337258873886}, "policy_reward_max": {"tplp_policy": 594.8528132160908}, "policy_reward_mean": {"tplp_policy": 476.4909596326157}, "custom_metrics": {"mean_episode_reward_mean": 476.4909596326157, "mean_episode_reward_min": 419.79337258873886, "mean_episode_reward_max": 594.8528132160908}, "hist_stats": {"episode_reward": [447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [447.8510772640594, 457.50973227160057, 449.732127789746, 463.7992466605478, 471.0780926221804, 513.7715193232698, 455.7056189802459, 472.20967550247605, 467.5743402621564, 477.2347298192085, 472.9971907962813, 519.6648809331464, 467.0893824498763, 459.14286646221854, 488.34733471560696, 499.17405414243507, 484.88958239859267, 465.90310368023086, 477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.516552103557743, "mean_inference_ms": 4.511146501270854, "mean_action_processing_ms": 0.8417268626857518, "mean_env_wait_ms": 4.342378678996224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009894609451293945, "StateBufferConnector_ms": 0.00768589973449707, "ViewRequirementAgentConnector_ms": 0.3527836799621582}, "num_episodes": 22, "episode_return_max": 594.8528132160908, "episode_return_min": 419.79337258873886, "episode_return_mean": 476.4909596326157, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464, "num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 289.90976049558947, "num_env_steps_trained_throughput_per_sec": 289.90976049558947, "timesteps_total": 190464, "num_env_steps_sampled_lifetime": 190464, "num_agent_steps_sampled_lifetime": 190464, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 190464, "timers": {"training_iteration_time_ms": 4187.708, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4187.708, "sample_time_ms": 1745.079, "learn_time_ms": 2410.029, "learn_throughput": 424.891, "synch_weights_time_ms": 32.484}, "counters": {"num_env_steps_sampled": 190464, "num_env_steps_trained": 190464, "num_agent_steps_sampled": 190464, "num_agent_steps_trained": 190464}, "done": false, "training_iteration": 186, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-52", "timestamp": 1744126312, "time_this_iter_s": 3.541555881500244, "time_total_s": 900.5694167613983, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC160C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 900.5694167613983, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 47.239999999999995, "ram_util_percent": 88.66}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0735994964838027, "cur_kl_coeff": 2.0391576462495387e-57, "cur_lr": 1e-07, "total_loss": 2.176492966711521, "policy_loss": -7.291138172149658e-06, "vf_loss": 9.978867495059967, "vf_explained_var": -1.6649067401885986e-05, "kl": 1.90824613204299e-06, "entropy": 3.1821660101413727, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "env_runners": {"episode_reward_max": 594.8528132160908, "episode_reward_min": 419.79337258873886, "episode_reward_mean": 477.0595854225212, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.79337258873886}, "policy_reward_max": {"tplp_policy": 594.8528132160908}, "policy_reward_mean": {"tplp_policy": 477.0595854225212}, "custom_metrics": {"mean_episode_reward_mean": 477.0595854225212, "mean_episode_reward_min": 419.79337258873886, "mean_episode_reward_max": 594.8528132160908}, "hist_stats": {"episode_reward": [477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [477.75128482042476, 463.9550068238247, 489.97126683214566, 485.13017474071546, 458.673155308916, 509.1153997204, 461.4174224894952, 469.99357847607035, 442.8086727341869, 459.0010119585258, 448.2457403656247, 480.00720859362474, 478.84269082648655, 480.2364146706362, 499.2620342710124, 446.8953584885203, 472.12285022240997, 472.04562518961257, 461.7241231081528, 584.7289127738371, 457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514424370654954, "mean_inference_ms": 4.504226880454294, "mean_action_processing_ms": 0.8405018519834668, "mean_env_wait_ms": 4.336160462530003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009424209594726562, "StateBufferConnector_ms": 0.007676839828491211, "ViewRequirementAgentConnector_ms": 0.34705162048339844}, "num_episodes": 18, "episode_return_max": 594.8528132160908, "episode_return_min": 419.79337258873886, "episode_return_mean": 477.0595854225212, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488, "num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 289.61898501630105, "num_env_steps_trained_throughput_per_sec": 289.61898501630105, "timesteps_total": 191488, "num_env_steps_sampled_lifetime": 191488, "num_agent_steps_sampled_lifetime": 191488, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 191488, "timers": {"training_iteration_time_ms": 4048.851, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4048.851, "sample_time_ms": 1655.252, "learn_time_ms": 2361.75, "learn_throughput": 433.577, "synch_weights_time_ms": 31.733}, "counters": {"num_env_steps_sampled": 191488, "num_env_steps_trained": 191488, "num_agent_steps_sampled": 191488, "num_agent_steps_trained": 191488}, "done": false, "training_iteration": 187, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-56", "timestamp": 1744126316, "time_this_iter_s": 3.5465078353881836, "time_total_s": 904.1159245967865, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 904.1159245967865, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 41.916666666666664, "ram_util_percent": 88.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6244134712964295, "cur_kl_coeff": 1.0195788231247694e-57, "cur_lr": 1e-07, "total_loss": 2.178983396291733, "policy_loss": -0.0001155113335698843, "vf_loss": 9.990379512310028, "vf_explained_var": -3.21216881275177e-05, "kl": 2.6582384641926636e-06, "entropy": 3.18495959341526, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "env_runners": {"episode_reward_max": 594.8528132160908, "episode_reward_min": 419.79337258873886, "episode_reward_mean": 481.3164772323821, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.79337258873886}, "policy_reward_max": {"tplp_policy": 594.8528132160908}, "policy_reward_mean": {"tplp_policy": 481.3164772323821}, "custom_metrics": {"mean_episode_reward_mean": 481.3164772323821, "mean_episode_reward_min": 419.79337258873886, "mean_episode_reward_max": 594.8528132160908}, "hist_stats": {"episode_reward": [457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [457.36484658232433, 463.15043048368483, 460.7424536879167, 498.49232385846875, 498.53549609893764, 438.442402290742, 494.5516536769304, 508.7032218073178, 479.37708101369657, 471.8570461625844, 460.7447962603247, 485.631769584765, 450.0993237234698, 468.27890525075037, 455.0849545776694, 424.6528229523969, 474.81546268339264, 513.9078853944694, 485.0027515755316, 464.09226733823715, 494.79805958029726, 466.51498670382887, 458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5119535010472334, "mean_inference_ms": 4.496485045508727, "mean_action_processing_ms": 0.8391495221223011, "mean_env_wait_ms": 4.329162924827931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010626554489135742, "StateBufferConnector_ms": 0.009109973907470703, "ViewRequirementAgentConnector_ms": 0.3380870819091797}, "num_episodes": 20, "episode_return_max": 594.8528132160908, "episode_return_min": 419.79337258873886, "episode_return_mean": 481.3164772323821, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512, "num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 305.017891157709, "num_env_steps_trained_throughput_per_sec": 305.017891157709, "timesteps_total": 192512, "num_env_steps_sampled_lifetime": 192512, "num_agent_steps_sampled_lifetime": 192512, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 192512, "timers": {"training_iteration_time_ms": 3834.092, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3834.092, "sample_time_ms": 1583.085, "learn_time_ms": 2220.388, "learn_throughput": 461.181, "synch_weights_time_ms": 30.505}, "counters": {"num_env_steps_sampled": 192512, "num_env_steps_trained": 192512, "num_agent_steps_sampled": 192512, "num_agent_steps_trained": 192512}, "done": false, "training_iteration": 188, "trial_id": "3bf18_00000", "date": "2025-04-08_23-31-59", "timestamp": 1744126319, "time_this_iter_s": 3.3668127059936523, "time_total_s": 907.4827373027802, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9E40>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 907.4827373027802, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 53.199999999999996, "ram_util_percent": 88.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.498502179980278, "cur_kl_coeff": 5.097894115623847e-58, "cur_lr": 1e-07, "total_loss": 2.178411716222763, "policy_loss": -7.847436936572194e-05, "vf_loss": 9.989235401153564, "vf_explained_var": -2.7688592672348024e-05, "kl": 2.67800601082141e-06, "entropy": 3.1881864249706267, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "env_runners": {"episode_reward_max": 594.8528132160908, "episode_reward_min": 419.79337258873886, "episode_reward_mean": 483.03908677660837, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.79337258873886}, "policy_reward_max": {"tplp_policy": 594.8528132160908}, "policy_reward_mean": {"tplp_policy": 483.03908677660837}, "custom_metrics": {"mean_episode_reward_mean": 483.03908677660837, "mean_episode_reward_min": 419.79337258873886, "mean_episode_reward_max": 594.8528132160908}, "hist_stats": {"episode_reward": [458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [458.0037614038142, 474.203572083336, 438.35269063168903, 456.8221519461427, 492.28919011263434, 473.24489433180605, 462.07514882921146, 453.3508716363162, 456.6959578064253, 469.1321913588182, 436.13937268776965, 536.9125491803254, 477.7130611601958, 419.79337258873886, 520.1256508141039, 477.4934493022163, 478.8465449410171, 479.6286717939021, 467.01046455268283, 537.4703934435503, 438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.509474015864931, "mean_inference_ms": 4.488636720911046, "mean_action_processing_ms": 0.8377691877025901, "mean_env_wait_ms": 4.322270026593769, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010345935821533203, "StateBufferConnector_ms": 0.01019430160522461, "ViewRequirementAgentConnector_ms": 0.35263657569885254}, "num_episodes": 22, "episode_return_max": 594.8528132160908, "episode_return_min": 419.79337258873886, "episode_return_mean": 483.03908677660837, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536, "num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 247.22481817613007, "num_env_steps_trained_throughput_per_sec": 247.22481817613007, "timesteps_total": 193536, "num_env_steps_sampled_lifetime": 193536, "num_agent_steps_sampled_lifetime": 193536, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 193536, "timers": {"training_iteration_time_ms": 3739.759, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3739.759, "sample_time_ms": 1522.459, "learn_time_ms": 2186.661, "learn_throughput": 468.294, "synch_weights_time_ms": 30.524}, "counters": {"num_env_steps_sampled": 193536, "num_env_steps_trained": 193536, "num_agent_steps_sampled": 193536, "num_agent_steps_trained": 193536}, "done": false, "training_iteration": 189, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-03", "timestamp": 1744126323, "time_this_iter_s": 4.151473045349121, "time_total_s": 911.6342103481293, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC160C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 911.6342103481293, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 48.18333333333334, "ram_util_percent": 88.86666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2140991874039173, "cur_kl_coeff": 2.5489470578119234e-58, "cur_lr": 1e-07, "total_loss": 2.1783286407589912, "policy_loss": -9.370617917738854e-05, "vf_loss": 9.990378522872925, "vf_explained_var": -1.985207200050354e-05, "kl": 2.963629096885967e-06, "entropy": 3.1917226195335386, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "env_runners": {"episode_reward_max": 594.8528132160908, "episode_reward_min": 437.8622446691059, "episode_reward_mean": 483.84014539891444, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 437.8622446691059}, "policy_reward_max": {"tplp_policy": 594.8528132160908}, "policy_reward_mean": {"tplp_policy": 483.84014539891444}, "custom_metrics": {"mean_episode_reward_mean": 483.84014539891444, "mean_episode_reward_min": 437.8622446691059, "mean_episode_reward_max": 594.8528132160908}, "hist_stats": {"episode_reward": [438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [438.6212154659014, 504.67444765857255, 489.8462779788752, 511.119714358163, 465.36883394004593, 437.87305228169714, 490.01597717537555, 473.42716286849463, 507.1663035441482, 594.8528132160908, 454.8784004774481, 446.45254654953766, 450.6169459674338, 507.823565115247, 466.88654722966965, 467.0702834246478, 493.6363176260479, 567.3209052236017, 475.6606338238227, 450.03662895581255, 476.31319314618344, 477.17270694094384, 447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5074026550294823, "mean_inference_ms": 4.482244229349607, "mean_action_processing_ms": 0.8365599304388402, "mean_env_wait_ms": 4.3164494744474515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010560274124145508, "StateBufferConnector_ms": 0.01019430160522461, "ViewRequirementAgentConnector_ms": 0.3831140995025635}, "num_episodes": 20, "episode_return_max": 594.8528132160908, "episode_return_min": 437.8622446691059, "episode_return_mean": 483.84014539891444, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560, "num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 280.8405701388154, "num_env_steps_trained_throughput_per_sec": 280.8405701388154, "timesteps_total": 194560, "num_env_steps_sampled_lifetime": 194560, "num_agent_steps_sampled_lifetime": 194560, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 194560, "timers": {"training_iteration_time_ms": 3653.843, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3653.843, "sample_time_ms": 1482.057, "learn_time_ms": 2141.92, "learn_throughput": 478.076, "synch_weights_time_ms": 29.751}, "counters": {"num_env_steps_sampled": 194560, "num_env_steps_trained": 194560, "num_agent_steps_sampled": 194560, "num_agent_steps_trained": 194560}, "done": false, "training_iteration": 190, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-07", "timestamp": 1744126327, "time_this_iter_s": 3.655775308609009, "time_total_s": 915.2899856567383, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 915.2899856567383, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 45.519999999999996, "ram_util_percent": 88.96}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5035552967339756, "cur_kl_coeff": 1.2744735289059617e-58, "cur_lr": 1e-07, "total_loss": 2.177596017718315, "policy_loss": 1.688662450760603e-06, "vf_loss": 9.9882181763649, "vf_explained_var": -1.4819949865341186e-05, "kl": 1.606621471594849e-06, "entropy": 3.1946021512150766, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "env_runners": {"episode_reward_max": 593.9001390952169, "episode_reward_min": 428.2881605595881, "episode_reward_mean": 482.24682210716674, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2881605595881}, "policy_reward_max": {"tplp_policy": 593.9001390952169}, "policy_reward_mean": {"tplp_policy": 482.24682210716674}, "custom_metrics": {"mean_episode_reward_mean": 482.24682210716674, "mean_episode_reward_min": 428.2881605595881, "mean_episode_reward_max": 593.9001390952169}, "hist_stats": {"episode_reward": [447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [447.53713689708803, 455.93686109288836, 483.70961403141604, 503.24808542803817, 482.7552202835228, 471.0935588671004, 451.9613130299485, 472.56386304491247, 494.1481294499814, 483.00623442263407, 476.6647024672988, 513.95780560795, 500.6519290465247, 498.58091331045506, 463.3736233284399, 437.8622446691059, 540.3631963023417, 450.0113039213611, 544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5052519959097237, "mean_inference_ms": 4.475442681699688, "mean_action_processing_ms": 0.8352268162242544, "mean_env_wait_ms": 4.310141173100556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012699365615844727, "StateBufferConnector_ms": 0.01099395751953125, "ViewRequirementAgentConnector_ms": 0.37740135192871094}, "num_episodes": 22, "episode_return_max": 593.9001390952169, "episode_return_min": 428.2881605595881, "episode_return_mean": 482.24682210716674, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584, "num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 277.4464484549345, "num_env_steps_trained_throughput_per_sec": 277.4464484549345, "timesteps_total": 195584, "num_env_steps_sampled_lifetime": 195584, "num_agent_steps_sampled_lifetime": 195584, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 195584, "timers": {"training_iteration_time_ms": 3600.972, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3600.972, "sample_time_ms": 1430.154, "learn_time_ms": 2141.057, "learn_throughput": 478.268, "synch_weights_time_ms": 29.761}, "counters": {"num_env_steps_sampled": 195584, "num_env_steps_trained": 195584, "num_agent_steps_sampled": 195584, "num_agent_steps_trained": 195584}, "done": false, "training_iteration": 191, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-11", "timestamp": 1744126331, "time_this_iter_s": 3.7019131183624268, "time_total_s": 918.9918987751007, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 918.9918987751007, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 45.9, "ram_util_percent": 88.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1647373072803022, "cur_kl_coeff": 6.372367644529809e-59, "cur_lr": 1e-07, "total_loss": 2.178457647562027, "policy_loss": 3.483961336314678e-07, "vf_loss": 9.992609810829162, "vf_explained_var": -2.8188899159431456e-05, "kl": 1.2858625410172575e-06, "entropy": 3.1969514563679695, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "env_runners": {"episode_reward_max": 605.9266709522005, "episode_reward_min": 428.2881605595881, "episode_reward_mean": 484.7500501183606, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 428.2881605595881}, "policy_reward_max": {"tplp_policy": 605.9266709522005}, "policy_reward_mean": {"tplp_policy": 484.7500501183606}, "custom_metrics": {"mean_episode_reward_mean": 484.7500501183606, "mean_episode_reward_min": 428.2881605595881, "mean_episode_reward_max": 605.9266709522005}, "hist_stats": {"episode_reward": [544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [544.3533622368526, 463.0062057272127, 506.9140857624504, 441.86468073609944, 483.90835045050966, 449.0264124154063, 469.88524909103984, 483.4191723037757, 557.2778192238923, 511.12017456894455, 537.0209410237272, 586.1986384069722, 458.3634448252665, 483.7453501814659, 463.83750475944044, 501.52716551698944, 503.88779708368236, 531.8862588632838, 470.99320263071763, 593.9001390952169, 483.6381096745368, 482.76558809868396, 499.3255706419385, 454.9730235828985, 465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5034983050845812, "mean_inference_ms": 4.47008127919944, "mean_action_processing_ms": 0.834114401225294, "mean_env_wait_ms": 4.305265953700417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012729883193969727, "StateBufferConnector_ms": 0.011044502258300781, "ViewRequirementAgentConnector_ms": 0.39510512351989746}, "num_episodes": 18, "episode_return_max": 605.9266709522005, "episode_return_min": 428.2881605595881, "episode_return_mean": 484.7500501183606, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608, "num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 277.5292033701025, "num_env_steps_trained_throughput_per_sec": 277.5292033701025, "timesteps_total": 196608, "num_env_steps_sampled_lifetime": 196608, "num_agent_steps_sampled_lifetime": 196608, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 196608, "timers": {"training_iteration_time_ms": 3628.202, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3628.202, "sample_time_ms": 1434.011, "learn_time_ms": 2164.057, "learn_throughput": 473.185, "synch_weights_time_ms": 30.134}, "counters": {"num_env_steps_sampled": 196608, "num_env_steps_trained": 196608, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "done": false, "training_iteration": 192, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-15", "timestamp": 1744126335, "time_this_iter_s": 3.698777675628662, "time_total_s": 922.6906764507294, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9D00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 922.6906764507294, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 46.78333333333333, "ram_util_percent": 88.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1569727811962367, "cur_kl_coeff": 3.1861838222649043e-59, "cur_lr": 1e-07, "total_loss": 2.177675339579582, "policy_loss": -4.0551042184233664e-05, "vf_loss": 9.990377140045165, "vf_explained_var": -6.739422678947448e-06, "kl": 8.945613573452249e-07, "entropy": 3.1987838789820673, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "env_runners": {"episode_reward_max": 605.9266709522005, "episode_reward_min": 423.5056219776419, "episode_reward_mean": 478.8086892686281, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.5056219776419}, "policy_reward_max": {"tplp_policy": 605.9266709522005}, "policy_reward_mean": {"tplp_policy": 478.8086892686281}, "custom_metrics": {"mean_episode_reward_mean": 478.8086892686281, "mean_episode_reward_min": 423.5056219776419, "mean_episode_reward_max": 605.9266709522005}, "hist_stats": {"episode_reward": [465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [465.0967585962045, 452.9140700478714, 476.44237893253194, 476.3665044596372, 499.5110515428207, 448.0486153104874, 557.0056674367987, 471.49576981261635, 459.7935521892761, 486.89779836574235, 471.0678926548925, 474.3629611144193, 466.1706331352625, 468.3668393373224, 472.80344800905715, 455.16232104142983, 463.40189390004826, 462.52949932855364, 467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.501711605574219, "mean_inference_ms": 4.461586925049412, "mean_action_processing_ms": 0.8325182375097516, "mean_env_wait_ms": 4.298096518439945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013263225555419922, "StateBufferConnector_ms": 0.009505987167358398, "ViewRequirementAgentConnector_ms": 0.4038703441619873}, "num_episodes": 24, "episode_return_max": 605.9266709522005, "episode_return_min": 423.5056219776419, "episode_return_mean": 478.8086892686281, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632, "num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 282.30672020653833, "num_env_steps_trained_throughput_per_sec": 282.30672020653833, "timesteps_total": 197632, "num_env_steps_sampled_lifetime": 197632, "num_agent_steps_sampled_lifetime": 197632, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 197632, "timers": {"training_iteration_time_ms": 3603.397, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3603.397, "sample_time_ms": 1435.073, "learn_time_ms": 2138.153, "learn_throughput": 478.918, "synch_weights_time_ms": 30.171}, "counters": {"num_env_steps_sampled": 197632, "num_env_steps_trained": 197632, "num_agent_steps_sampled": 197632, "num_agent_steps_trained": 197632}, "done": false, "training_iteration": 193, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-19", "timestamp": 1744126339, "time_this_iter_s": 3.6383862495422363, "time_total_s": 926.3290627002716, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC82C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 926.3290627002716, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 47.64, "ram_util_percent": 88.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.986951895058155, "cur_kl_coeff": 1.5930919111324521e-59, "cur_lr": 1e-07, "total_loss": 2.1777981489896776, "policy_loss": -4.242511931806803e-06, "vf_loss": 9.991308516263961, "vf_explained_var": -1.529678702354431e-05, "kl": 8.812514780826008e-07, "entropy": 3.2002472668886184, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "env_runners": {"episode_reward_max": 605.9266709522005, "episode_reward_min": 423.5056219776419, "episode_reward_mean": 479.69143015234755, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.5056219776419}, "policy_reward_max": {"tplp_policy": 605.9266709522005}, "policy_reward_mean": {"tplp_policy": 479.69143015234755}, "custom_metrics": {"mean_episode_reward_mean": 479.69143015234755, "mean_episode_reward_min": 423.5056219776419, "mean_episode_reward_max": 605.9266709522005}, "hist_stats": {"episode_reward": [467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.9593141052839, 471.8661588748249, 536.9967994369556, 504.5416662882481, 481.85847375900914, 466.86546573324324, 474.1893663790545, 490.64898168779297, 446.13892461289566, 461.7630255194021, 448.11816421617687, 489.423007452859, 472.03878178094413, 482.4777746537809, 500.6449399452482, 493.2258815612921, 449.63315712063337, 481.0885464790564, 455.51970495223895, 475.4966115434558, 469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4994827364655947, "mean_inference_ms": 4.457754941335684, "mean_action_processing_ms": 0.8314763773832625, "mean_env_wait_ms": 4.29400638950529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014323711395263672, "StateBufferConnector_ms": 0.007752418518066406, "ViewRequirementAgentConnector_ms": 0.41060709953308105}, "num_episodes": 18, "episode_return_max": 605.9266709522005, "episode_return_min": 423.5056219776419, "episode_return_mean": 479.69143015234755, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656, "num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 271.4959792688011, "num_env_steps_trained_throughput_per_sec": 271.4959792688011, "timesteps_total": 198656, "num_env_steps_sampled_lifetime": 198656, "num_agent_steps_sampled_lifetime": 198656, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 198656, "timers": {"training_iteration_time_ms": 3629.133, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3629.133, "sample_time_ms": 1437.578, "learn_time_ms": 2160.882, "learn_throughput": 473.881, "synch_weights_time_ms": 30.673}, "counters": {"num_env_steps_sampled": 198656, "num_env_steps_trained": 198656, "num_agent_steps_sampled": 198656, "num_agent_steps_trained": 198656}, "done": false, "training_iteration": 194, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-22", "timestamp": 1744126342, "time_this_iter_s": 3.7811660766601562, "time_total_s": 930.1102287769318, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 930.1102287769318, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 46.400000000000006, "ram_util_percent": 88.58}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8490375626832245, "cur_kl_coeff": 7.965459555662261e-60, "cur_lr": 1e-07, "total_loss": 2.174878703802824, "policy_loss": -0.00018276639748364686, "vf_loss": 9.980946189165115, "vf_explained_var": -2.553574740886688e-05, "kl": 2.4427759425460494e-06, "entropy": 3.2017506539821623, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "env_runners": {"episode_reward_max": 605.9266709522005, "episode_reward_min": 423.5056219776419, "episode_reward_mean": 478.5221057259275, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.5056219776419}, "policy_reward_max": {"tplp_policy": 605.9266709522005}, "policy_reward_mean": {"tplp_policy": 478.5221057259275}, "custom_metrics": {"mean_episode_reward_mean": 478.5221057259275, "mean_episode_reward_min": 423.5056219776419, "mean_episode_reward_max": 605.9266709522005}, "hist_stats": {"episode_reward": [469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [469.53106327708804, 510.1206754048952, 504.68166950534135, 477.4907041821546, 489.21974391977636, 473.87320316178, 473.900596952647, 477.0563979381297, 514.0967618431116, 500.52386051025525, 448.0581621011069, 461.5283803592688, 474.35442144298855, 445.57933019537916, 461.14987204301906, 463.96580849360805, 484.269071354903, 428.2881605595881, 488.97257164076865, 509.82537241148475, 454.35050851468367, 503.5520059510056, 506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4974385639942855, "mean_inference_ms": 4.451246934662726, "mean_action_processing_ms": 0.8301388271720769, "mean_env_wait_ms": 4.288309262915347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01262521743774414, "StateBufferConnector_ms": 0.009947061538696289, "ViewRequirementAgentConnector_ms": 0.4088785648345947}, "num_episodes": 20, "episode_return_max": 605.9266709522005, "episode_return_min": 423.5056219776419, "episode_return_mean": 478.5221057259275, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680, "num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 288.93522998275796, "num_env_steps_trained_throughput_per_sec": 288.93522998275796, "timesteps_total": 199680, "num_env_steps_sampled_lifetime": 199680, "num_agent_steps_sampled_lifetime": 199680, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 199680, "timers": {"training_iteration_time_ms": 3653.668, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3653.668, "sample_time_ms": 1454.883, "learn_time_ms": 2167.629, "learn_throughput": 472.406, "synch_weights_time_ms": 31.156}, "counters": {"num_env_steps_sampled": 199680, "num_env_steps_trained": 199680, "num_agent_steps_sampled": 199680, "num_agent_steps_trained": 199680}, "done": false, "training_iteration": 195, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-26", "timestamp": 1744126346, "time_this_iter_s": 3.5554513931274414, "time_total_s": 933.6656801700592, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCACA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 933.6656801700592, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 46.42, "ram_util_percent": 88.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3986007519066335, "cur_kl_coeff": 3.9827297778311304e-60, "cur_lr": 1e-07, "total_loss": 2.177050203830004, "policy_loss": -2.803819952532649e-05, "vf_loss": 9.989619982242584, "vf_explained_var": -3.0215829610824585e-05, "kl": 1.336156057307747e-06, "entropy": 3.2032677099108695, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "env_runners": {"episode_reward_max": 605.9266709522005, "episode_reward_min": 423.5056219776419, "episode_reward_mean": 479.5198999171974, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.5056219776419}, "policy_reward_max": {"tplp_policy": 605.9266709522005}, "policy_reward_mean": {"tplp_policy": 479.5198999171974}, "custom_metrics": {"mean_episode_reward_mean": 479.5198999171974, "mean_episode_reward_min": 423.5056219776419, "mean_episode_reward_max": 605.9266709522005}, "hist_stats": {"episode_reward": [506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.1193890623747, 473.16304680252773, 503.3116822265787, 499.36529386641456, 471.2089786414947, 471.6952025564946, 486.70505779087085, 505.05811410854545, 481.56982670090514, 485.3282030887125, 477.33290737001045, 478.73488102215396, 485.2122068707379, 532.9401490331062, 605.9266709522005, 456.1744117615811, 497.342545678986, 482.21102441091625, 534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.495221215273996, "mean_inference_ms": 4.443955482506237, "mean_action_processing_ms": 0.8287672969430518, "mean_env_wait_ms": 4.282245855026728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01858234405517578, "StateBufferConnector_ms": 0.010320186614990234, "ViewRequirementAgentConnector_ms": 0.4106414318084717}, "num_episodes": 22, "episode_return_max": 605.9266709522005, "episode_return_min": 423.5056219776419, "episode_return_mean": 479.5198999171974, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704, "num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 284.93623821461244, "num_env_steps_trained_throughput_per_sec": 284.93623821461244, "timesteps_total": 200704, "num_env_steps_sampled_lifetime": 200704, "num_agent_steps_sampled_lifetime": 200704, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 200704, "timers": {"training_iteration_time_ms": 3659.833, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3659.833, "sample_time_ms": 1458.625, "learn_time_ms": 2169.895, "learn_throughput": 471.912, "synch_weights_time_ms": 31.312}, "counters": {"num_env_steps_sampled": 200704, "num_env_steps_trained": 200704, "num_agent_steps_sampled": 200704, "num_agent_steps_trained": 200704}, "done": false, "training_iteration": 196, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-30", "timestamp": 1744126350, "time_this_iter_s": 3.605747699737549, "time_total_s": 937.2714278697968, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC82C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 937.2714278697968, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 44.660000000000004, "ram_util_percent": 88.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7221203725785017, "cur_kl_coeff": 1.9913648889155652e-60, "cur_lr": 1e-07, "total_loss": 2.1723563984036445, "policy_loss": -3.1843100441619757e-05, "vf_loss": 9.971868419647217, "vf_explained_var": -1.389533281326294e-05, "kl": 1.3677502633147042e-06, "entropy": 3.2057885065674783, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "env_runners": {"episode_reward_max": 548.9065678418492, "episode_reward_min": 423.5056219776419, "episode_reward_mean": 475.2066026374416, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.5056219776419}, "policy_reward_max": {"tplp_policy": 548.9065678418492}, "policy_reward_mean": {"tplp_policy": 475.2066026374416}, "custom_metrics": {"mean_episode_reward_mean": 475.2066026374416, "mean_episode_reward_min": 423.5056219776419, "mean_episode_reward_max": 548.9065678418492}, "hist_stats": {"episode_reward": [534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [534.2140284008278, 465.6907934379682, 423.5056219776419, 433.2027968312471, 480.08458927210046, 501.17751119956415, 480.74638467639187, 459.9745640705069, 484.32461747843826, 424.9210998644509, 437.0191362747075, 471.3295831344608, 475.4187753853062, 471.0894704156855, 526.584842199754, 472.1820467229073, 455.4124095119676, 453.6613183131122, 486.96720749269065, 425.52808762717524, 515.0495568571234, 511.06415069381785, 471.8971381418891, 497.1405790980334, 491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4933152872941216, "mean_inference_ms": 4.437824898730681, "mean_action_processing_ms": 0.8276800965597277, "mean_env_wait_ms": 4.277043951508402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01895618438720703, "StateBufferConnector_ms": 0.00973367691040039, "ViewRequirementAgentConnector_ms": 0.3936653137207031}, "num_episodes": 18, "episode_return_max": 548.9065678418492, "episode_return_min": 423.5056219776419, "episode_return_mean": 475.2066026374416, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728, "num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 278.80221088266467, "num_env_steps_trained_throughput_per_sec": 278.80221088266467, "timesteps_total": 201728, "num_env_steps_sampled_lifetime": 201728, "num_agent_steps_sampled_lifetime": 201728, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 201728, "timers": {"training_iteration_time_ms": 3673.55, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3673.55, "sample_time_ms": 1449.217, "learn_time_ms": 2193.458, "learn_throughput": 466.843, "synch_weights_time_ms": 30.875}, "counters": {"num_env_steps_sampled": 201728, "num_env_steps_trained": 201728, "num_agent_steps_sampled": 201728, "num_agent_steps_trained": 201728}, "done": false, "training_iteration": 197, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-34", "timestamp": 1744126354, "time_this_iter_s": 3.684002161026001, "time_total_s": 940.9554300308228, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCA5C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 940.9554300308228, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 49.38, "ram_util_percent": 88.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.330836647748947, "cur_kl_coeff": 9.956824444577826e-61, "cur_lr": 1e-07, "total_loss": 2.1743875883519648, "policy_loss": -3.9701600326225164e-05, "vf_loss": 9.98085942864418, "vf_explained_var": -2.0137801766395568e-05, "kl": 2.0054543593550633e-06, "entropy": 3.207875570654869, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "env_runners": {"episode_reward_max": 597.5275048253526, "episode_reward_min": 433.0576387326497, "episode_reward_mean": 477.6062358432579, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.0576387326497}, "policy_reward_max": {"tplp_policy": 597.5275048253526}, "policy_reward_mean": {"tplp_policy": 477.6062358432579}, "custom_metrics": {"mean_episode_reward_mean": 477.6062358432579, "mean_episode_reward_min": 433.0576387326497, "mean_episode_reward_max": 597.5275048253526}, "hist_stats": {"episode_reward": [491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.213194577507, 486.7578801971724, 467.1917112810918, 470.95924899621656, 453.13683765009216, 459.8233872658022, 529.9209108197076, 455.49048707414954, 457.49302801257164, 479.15888140068813, 457.9608496356286, 456.49165384719856, 516.1858432286134, 450.1767941774609, 505.4813429685467, 509.2319752145575, 436.3132550840999, 497.8239993168273, 481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4907011264725925, "mean_inference_ms": 4.429227612882553, "mean_action_processing_ms": 0.8262764515317212, "mean_env_wait_ms": 4.269816291373649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017047405242919922, "StateBufferConnector_ms": 0.009215354919433594, "ViewRequirementAgentConnector_ms": 0.38768863677978516}, "num_episodes": 24, "episode_return_max": 597.5275048253526, "episode_return_min": 433.0576387326497, "episode_return_mean": 477.6062358432579, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752, "num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 285.0406221485351, "num_env_steps_trained_throughput_per_sec": 285.0406221485351, "timesteps_total": 202752, "num_env_steps_sampled_lifetime": 202752, "num_agent_steps_sampled_lifetime": 202752, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 202752, "timers": {"training_iteration_time_ms": 3697.23, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3697.079, "sample_time_ms": 1448.971, "learn_time_ms": 2216.791, "learn_throughput": 461.929, "synch_weights_time_ms": 31.317}, "counters": {"num_env_steps_sampled": 202752, "num_env_steps_trained": 202752, "num_agent_steps_sampled": 202752, "num_agent_steps_trained": 202752}, "done": false, "training_iteration": 198, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-37", "timestamp": 1744126357, "time_this_iter_s": 3.604065418243408, "time_total_s": 944.5594954490662, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCACA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 944.5594954490662, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 44.699999999999996, "ram_util_percent": 88.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.348888400569558, "cur_kl_coeff": 4.978412222288913e-61, "cur_lr": 1e-07, "total_loss": 2.1777716390788555, "policy_loss": -6.069301743991673e-05, "vf_loss": 9.99543639421463, "vf_explained_var": -2.3430585861206056e-05, "kl": 1.3155358301375485e-06, "entropy": 3.210267627239227, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "env_runners": {"episode_reward_max": 597.5275048253526, "episode_reward_min": 433.0576387326497, "episode_reward_mean": 478.9847618825744, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.0576387326497}, "policy_reward_max": {"tplp_policy": 597.5275048253526}, "policy_reward_mean": {"tplp_policy": 478.9847618825744}, "custom_metrics": {"mean_episode_reward_mean": 478.9847618825744, "mean_episode_reward_min": 433.0576387326497, "mean_episode_reward_max": 597.5275048253526}, "hist_stats": {"episode_reward": [481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [481.38832813615164, 451.87005029790487, 467.3118057509408, 548.9065678418492, 482.19754159149505, 464.9577496954724, 486.8661202161949, 456.5133234990293, 526.8067990540873, 484.84848900587923, 443.2832257553263, 466.44246127813926, 494.162361678129, 434.3211245848611, 436.211545919961, 436.2066370218529, 463.72124555384784, 473.40967217833276, 488.24611151405315, 479.66052705235603, 461.1232602700448, 538.8299449079134, 456.5384713281497, 478.20640283175, 502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4888335892893994, "mean_inference_ms": 4.42334317011695, "mean_action_processing_ms": 0.825261448756927, "mean_env_wait_ms": 4.264899061159586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016890525817871094, "StateBufferConnector_ms": 0.01125478744506836, "ViewRequirementAgentConnector_ms": 0.3704957962036133}, "num_episodes": 18, "episode_return_max": 597.5275048253526, "episode_return_min": 433.0576387326497, "episode_return_mean": 478.9847618825744, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776, "num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 278.33589870906894, "num_env_steps_trained_throughput_per_sec": 278.33589870906894, "timesteps_total": 203776, "num_env_steps_sampled_lifetime": 203776, "num_agent_steps_sampled_lifetime": 203776, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 203776, "timers": {"training_iteration_time_ms": 3651.033, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3650.782, "sample_time_ms": 1450.089, "learn_time_ms": 2169.235, "learn_throughput": 472.056, "synch_weights_time_ms": 31.458}, "counters": {"num_env_steps_sampled": 203776, "num_env_steps_trained": 203776, "num_agent_steps_sampled": 203776, "num_agent_steps_trained": 203776}, "done": false, "training_iteration": 199, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-41", "timestamp": 1744126361, "time_this_iter_s": 3.6927740573883057, "time_total_s": 948.2522695064545, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC96C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 948.2522695064545, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 45.93333333333334, "ram_util_percent": 88.86666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.551365289837122, "cur_kl_coeff": 2.4892061111444565e-61, "cur_lr": 1e-07, "total_loss": 2.1751180939376353, "policy_loss": -0.0001463577733375132, "vf_loss": 9.985722255706786, "vf_explained_var": -2.843700349330902e-05, "kl": 1.8724852683726922e-06, "entropy": 3.2116611167788505, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "env_runners": {"episode_reward_max": 597.5275048253526, "episode_reward_min": 433.0576387326497, "episode_reward_mean": 481.0609205365548, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.0576387326497}, "policy_reward_max": {"tplp_policy": 597.5275048253526}, "policy_reward_mean": {"tplp_policy": 481.0609205365548}, "custom_metrics": {"mean_episode_reward_mean": 481.0609205365548, "mean_episode_reward_min": 433.0576387326497, "mean_episode_reward_max": 597.5275048253526}, "hist_stats": {"episode_reward": [502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [502.16036129681333, 509.22332457925256, 461.8394546886436, 464.9275193319307, 508.2072737617826, 452.8165557453464, 486.0324727559069, 501.9436087544074, 485.94685782085696, 465.7185031729956, 445.4119205198556, 541.2102162793387, 493.3506799387496, 461.47352767945006, 457.289297230601, 474.01146942976277, 464.011414023592, 449.41858794783224, 468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4867447937173017, "mean_inference_ms": 4.4138700784929075, "mean_action_processing_ms": 0.8237243809885086, "mean_env_wait_ms": 4.257571333626774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018405675888061523, "StateBufferConnector_ms": 0.01187896728515625, "ViewRequirementAgentConnector_ms": 0.35335803031921387}, "num_episodes": 24, "episode_return_max": 597.5275048253526, "episode_return_min": 433.0576387326497, "episode_return_mean": 481.0609205365548, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800, "num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 286.84692295727206, "num_env_steps_trained_throughput_per_sec": 286.84692295727206, "timesteps_total": 204800, "num_env_steps_sampled_lifetime": 204800, "num_agent_steps_sampled_lifetime": 204800, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 204800, "timers": {"training_iteration_time_ms": 3643.398, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3643.045, "sample_time_ms": 1432.996, "learn_time_ms": 2178.699, "learn_throughput": 470.005, "synch_weights_time_ms": 31.35}, "counters": {"num_env_steps_sampled": 204800, "num_env_steps_trained": 204800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "done": false, "training_iteration": 200, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-45", "timestamp": 1744126365, "time_this_iter_s": 3.5804853439331055, "time_total_s": 951.8327548503876, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 951.8327548503876, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 43.14, "ram_util_percent": 89.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4126358211040495, "cur_kl_coeff": 1.2446030555722282e-61, "cur_lr": 1e-07, "total_loss": 2.178655172884464, "policy_loss": -3.4718768438324334e-05, "vf_loss": 10.0, "vf_explained_var": -2.8368458151817323e-05, "kl": 8.655292379255997e-07, "entropy": 3.21310108602047, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "env_runners": {"episode_reward_max": 597.5275048253526, "episode_reward_min": 430.0269600781491, "episode_reward_mean": 479.011649470605, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.0269600781491}, "policy_reward_max": {"tplp_policy": 597.5275048253526}, "policy_reward_mean": {"tplp_policy": 479.011649470605}, "custom_metrics": {"mean_episode_reward_mean": 479.011649470605, "mean_episode_reward_min": 430.0269600781491, "mean_episode_reward_max": 597.5275048253526}, "hist_stats": {"episode_reward": [468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.7077964163871, 498.36366532303805, 460.24892747053883, 508.9072207622654, 501.7246644836316, 454.4915939875593, 525.8500080347627, 451.30584958752945, 513.3006653626874, 449.8980196331533, 433.31799456908436, 433.41678780955783, 474.1014259370069, 468.40053442704215, 443.86382118997625, 468.7408870034023, 440.69575229027686, 508.59718964833365, 499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4844393242195444, "mean_inference_ms": 4.409614200705268, "mean_action_processing_ms": 0.822847755691038, "mean_env_wait_ms": 4.2535876934877095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01298379898071289, "StateBufferConnector_ms": 0.013377666473388672, "ViewRequirementAgentConnector_ms": 0.3590576648712158}, "num_episodes": 18, "episode_return_max": 597.5275048253526, "episode_return_min": 430.0269600781491, "episode_return_mean": 479.011649470605, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824, "num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 293.3161846888469, "num_env_steps_trained_throughput_per_sec": 293.3161846888469, "timesteps_total": 205824, "num_env_steps_sampled_lifetime": 205824, "num_agent_steps_sampled_lifetime": 205824, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 205824, "timers": {"training_iteration_time_ms": 3623.429, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3623.076, "sample_time_ms": 1432.491, "learn_time_ms": 2159.783, "learn_throughput": 474.122, "synch_weights_time_ms": 30.803}, "counters": {"num_env_steps_sampled": 205824, "num_env_steps_trained": 205824, "num_agent_steps_sampled": 205824, "num_agent_steps_trained": 205824}, "done": false, "training_iteration": 201, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-48", "timestamp": 1744126368, "time_this_iter_s": 3.5046465396881104, "time_total_s": 955.3374013900757, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC96C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 955.3374013900757, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 42.959999999999994, "ram_util_percent": 89.25999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.299361689761281, "cur_kl_coeff": 6.223015277861141e-62, "cur_lr": 1e-07, "total_loss": 2.1736973196268083, "policy_loss": -7.838825695216656e-08, "vf_loss": 9.980857521295547, "vf_explained_var": -1.9703805446624755e-05, "kl": 1.364268806147706e-06, "entropy": 3.215169659256935, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "env_runners": {"episode_reward_max": 597.5275048253526, "episode_reward_min": 430.0269600781491, "episode_reward_mean": 482.6872232060035, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.0269600781491}, "policy_reward_max": {"tplp_policy": 597.5275048253526}, "policy_reward_mean": {"tplp_policy": 482.6872232060035}, "custom_metrics": {"mean_episode_reward_mean": 482.6872232060035, "mean_episode_reward_min": 430.0269600781491, "mean_episode_reward_max": 597.5275048253526}, "hist_stats": {"episode_reward": [499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [499.16063308279223, 476.1636062474034, 466.8321449073905, 498.11099696533444, 491.8416105044499, 597.5275048253526, 481.4257038267186, 457.467332468564, 480.0122134623564, 476.07339966819626, 433.0576387326497, 488.36259613094694, 474.7332292515669, 504.4462410146575, 472.66234073200843, 479.61403676339864, 477.78246051478465, 435.9266937189355, 493.43993346872713, 495.2827632411447, 482.3775605703366, 486.55604762307104, 463.0015115630717, 551.7443659363939, 487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4826530905867208, "mean_inference_ms": 4.4043633826842274, "mean_action_processing_ms": 0.8218331528774019, "mean_env_wait_ms": 4.249154781145471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014409065246582031, "StateBufferConnector_ms": 0.012920618057250977, "ViewRequirementAgentConnector_ms": 0.3677787780761719}, "num_episodes": 18, "episode_return_max": 597.5275048253526, "episode_return_min": 430.0269600781491, "episode_return_mean": 482.6872232060035, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848, "num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 277.58577617678037, "num_env_steps_trained_throughput_per_sec": 277.58577617678037, "timesteps_total": 206848, "num_env_steps_sampled_lifetime": 206848, "num_agent_steps_sampled_lifetime": 206848, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 206848, "timers": {"training_iteration_time_ms": 3623.354, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3623.001, "sample_time_ms": 1443.615, "learn_time_ms": 2147.863, "learn_throughput": 476.753, "synch_weights_time_ms": 31.523}, "counters": {"num_env_steps_sampled": 206848, "num_env_steps_trained": 206848, "num_agent_steps_sampled": 206848, "num_agent_steps_trained": 206848}, "done": false, "training_iteration": 202, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-52", "timestamp": 1744126372, "time_this_iter_s": 3.705476999282837, "time_total_s": 959.0428783893585, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CB46AC0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 959.0428783893585, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 46.4, "ram_util_percent": 89.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5097240010276436, "cur_kl_coeff": 3.1115076389305706e-62, "cur_lr": 1e-07, "total_loss": 2.1700127705931664, "policy_loss": -0.0001574504072777927, "vf_loss": 9.967261880636215, "vf_explained_var": -2.3388117551803588e-05, "kl": 1.6133643346585847e-06, "entropy": 3.216452307999134, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "env_runners": {"episode_reward_max": 553.5133563869562, "episode_reward_min": 430.0269600781491, "episode_reward_mean": 480.03672266503656, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.0269600781491}, "policy_reward_max": {"tplp_policy": 553.5133563869562}, "policy_reward_mean": {"tplp_policy": 480.03672266503656}, "custom_metrics": {"mean_episode_reward_mean": 480.03672266503656, "mean_episode_reward_min": 430.0269600781491, "mean_episode_reward_max": 553.5133563869562}, "hist_stats": {"episode_reward": [487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.83128835230076, 482.25645994751767, 441.8182131316556, 460.01715156328316, 458.92096053928907, 437.3915681978956, 546.201072295684, 510.6978563428623, 469.5206441529231, 495.3992279389917, 467.6634816551605, 527.3571496803602, 459.9244758600673, 489.14492765038165, 458.03514703411605, 511.73838283762893, 457.4909901178011, 470.7363338696057, 468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4805914229818427, "mean_inference_ms": 4.398016583805526, "mean_action_processing_ms": 0.8205006330819455, "mean_env_wait_ms": 4.244105448094842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017586469650268555, "StateBufferConnector_ms": 0.012371063232421875, "ViewRequirementAgentConnector_ms": 0.402907133102417}, "num_episodes": 24, "episode_return_max": 553.5133563869562, "episode_return_min": 430.0269600781491, "episode_return_mean": 480.03672266503656, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872, "num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 248.72140853251224, "num_env_steps_trained_throughput_per_sec": 248.72140853251224, "timesteps_total": 207872, "num_env_steps_sampled_lifetime": 207872, "num_agent_steps_sampled_lifetime": 207872, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 207872, "timers": {"training_iteration_time_ms": 3672.334, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3671.981, "sample_time_ms": 1458.581, "learn_time_ms": 2182.374, "learn_throughput": 469.214, "synch_weights_time_ms": 31.026}, "counters": {"num_env_steps_sampled": 207872, "num_env_steps_trained": 207872, "num_agent_steps_sampled": 207872, "num_agent_steps_trained": 207872}, "done": false, "training_iteration": 203, "trial_id": "3bf18_00000", "date": "2025-04-08_23-32-56", "timestamp": 1744126376, "time_this_iter_s": 4.127004384994507, "time_total_s": 963.169882774353, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 963.169882774353, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 55.58, "ram_util_percent": 89.34}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6768055826425554, "cur_kl_coeff": 1.5557538194652853e-62, "cur_lr": 1e-07, "total_loss": 2.1757415421307087, "policy_loss": -0.00013182196416892112, "vf_loss": 9.990923094749451, "vf_explained_var": -1.5829876065254212e-05, "kl": 3.154590493137377e-06, "entropy": 3.218573960661888, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "env_runners": {"episode_reward_max": 553.5133563869562, "episode_reward_min": 430.0269600781491, "episode_reward_mean": 478.86623417300535, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.0269600781491}, "policy_reward_max": {"tplp_policy": 553.5133563869562}, "policy_reward_mean": {"tplp_policy": 478.86623417300535}, "custom_metrics": {"mean_episode_reward_mean": 478.86623417300535, "mean_episode_reward_min": 430.0269600781491, "mean_episode_reward_max": 553.5133563869562}, "hist_stats": {"episode_reward": [468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.8793845809868, 457.77049296863765, 471.8136076108134, 494.00430346737824, 504.4767558595155, 477.1521345165399, 481.3583747055543, 442.48794980962407, 491.07616036546773, 542.756106713522, 462.14048851276635, 451.3984264928926, 477.20414835399964, 502.1527936190808, 474.1928649943776, 496.6875282631714, 469.4642798145116, 553.5133563869562, 467.7382985878102, 463.58064257458904, 541.3812261385426, 490.1889840376232, 445.75908821320377, 440.35198994575114, 430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4789249466611227, "mean_inference_ms": 4.392947461188663, "mean_action_processing_ms": 0.819507495430313, "mean_env_wait_ms": 4.239936363707673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015467166900634766, "StateBufferConnector_ms": 0.010142803192138672, "ViewRequirementAgentConnector_ms": 0.4246103763580322}, "num_episodes": 18, "episode_return_max": 553.5133563869562, "episode_return_min": 430.0269600781491, "episode_return_mean": 478.86623417300535, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896, "num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 295.75849451375865, "num_env_steps_trained_throughput_per_sec": 295.75849451375865, "timesteps_total": 208896, "num_env_steps_sampled_lifetime": 208896, "num_agent_steps_sampled_lifetime": 208896, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 208896, "timers": {"training_iteration_time_ms": 3641.393, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3641.04, "sample_time_ms": 1458.639, "learn_time_ms": 2151.559, "learn_throughput": 475.934, "synch_weights_time_ms": 30.711}, "counters": {"num_env_steps_sampled": 208896, "num_env_steps_trained": 208896, "num_agent_steps_sampled": 208896, "num_agent_steps_trained": 208896}, "done": false, "training_iteration": 204, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-00", "timestamp": 1744126380, "time_this_iter_s": 3.472543954849243, "time_total_s": 966.6424267292023, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 966.6424267292023, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 43.040000000000006, "ram_util_percent": 89.28}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5717765796929597, "cur_kl_coeff": 7.778769097326426e-63, "cur_lr": 1e-07, "total_loss": 2.172997537255287, "policy_loss": -6.918848375789822e-05, "vf_loss": 9.980738413333892, "vf_explained_var": -1.299157738685608e-05, "kl": 1.4592528643220248e-06, "entropy": 3.2211787045001983, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "env_runners": {"episode_reward_max": 553.0605351955494, "episode_reward_min": 430.0269600781491, "episode_reward_mean": 478.9224454551446, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.0269600781491}, "policy_reward_max": {"tplp_policy": 553.0605351955494}, "policy_reward_mean": {"tplp_policy": 478.9224454551446}, "custom_metrics": {"mean_episode_reward_mean": 478.9224454551446, "mean_episode_reward_min": 430.0269600781491, "mean_episode_reward_max": 553.0605351955494}, "hist_stats": {"episode_reward": [430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [430.0269600781491, 459.0323710662536, 455.62042760246374, 504.30479381237484, 479.9873922732116, 487.3922060781636, 463.666384223264, 456.61368406448594, 453.02762886742295, 475.41961261076267, 487.0075368374732, 478.80177068061374, 482.9240564235404, 474.65061479853927, 457.48922649746055, 487.9901942889944, 493.92956128952807, 460.51496996639133, 463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4767298595658684, "mean_inference_ms": 4.386227135046497, "mean_action_processing_ms": 0.8182150776484317, "mean_env_wait_ms": 4.234199576268869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017487287521362305, "StateBufferConnector_ms": 0.013087272644042969, "ViewRequirementAgentConnector_ms": 0.41730380058288574}, "num_episodes": 24, "episode_return_max": 553.0605351955494, "episode_return_min": 430.0269600781491, "episode_return_mean": 478.9224454551446, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920, "num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 290.0551322354196, "num_env_steps_trained_throughput_per_sec": 290.0551322354196, "timesteps_total": 209920, "num_env_steps_sampled_lifetime": 209920, "num_agent_steps_sampled_lifetime": 209920, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 209920, "timers": {"training_iteration_time_ms": 3640.024, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3639.671, "sample_time_ms": 1447.994, "learn_time_ms": 2161.167, "learn_throughput": 473.818, "synch_weights_time_ms": 30.379}, "counters": {"num_env_steps_sampled": 209920, "num_env_steps_trained": 209920, "num_agent_steps_sampled": 209920, "num_agent_steps_trained": 209920}, "done": false, "training_iteration": 205, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-04", "timestamp": 1744126384, "time_this_iter_s": 3.541954755783081, "time_total_s": 970.1843814849854, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 970.1843814849854, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 48.64, "ram_util_percent": 89.42}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2905517004430296, "cur_kl_coeff": 3.889384548663213e-63, "cur_lr": 1e-07, "total_loss": 2.173648151010275, "policy_loss": -5.382715025916696e-05, "vf_loss": 9.983884567022324, "vf_explained_var": -1.5265494585037232e-05, "kl": 1.293540167957019e-06, "entropy": 3.222691720724106, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "env_runners": {"episode_reward_max": 553.0605351955494, "episode_reward_min": 420.74664988434677, "episode_reward_mean": 481.6796960922649, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.74664988434677}, "policy_reward_max": {"tplp_policy": 553.0605351955494}, "policy_reward_mean": {"tplp_policy": 481.6796960922649}, "custom_metrics": {"mean_episode_reward_mean": 481.6796960922649, "mean_episode_reward_min": 420.74664988434677, "mean_episode_reward_max": 553.0605351955494}, "hist_stats": {"episode_reward": [463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [463.4363020403096, 534.1822559656177, 488.89217438811784, 503.4710452564379, 499.619017822503, 450.77149850098766, 517.0636037788747, 489.7637221374686, 526.1159235638702, 475.0348572087853, 510.56615117214693, 495.15010786817237, 440.43007981319306, 496.3299446896713, 536.4796145054486, 489.73934750855966, 481.7413216185378, 465.0910705392724, 442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4749942058590002, "mean_inference_ms": 4.380942855927239, "mean_action_processing_ms": 0.8171996650439352, "mean_env_wait_ms": 4.229711622499641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01886463165283203, "StateBufferConnector_ms": 0.019903898239135742, "ViewRequirementAgentConnector_ms": 0.4106898307800293}, "num_episodes": 18, "episode_return_max": 553.0605351955494, "episode_return_min": 420.74664988434677, "episode_return_mean": 481.6796960922649, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944, "num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 309.9951047105757, "num_env_steps_trained_throughput_per_sec": 309.9951047105757, "timesteps_total": 210944, "num_env_steps_sampled_lifetime": 210944, "num_agent_steps_sampled_lifetime": 210944, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 210944, "timers": {"training_iteration_time_ms": 3610.974, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3610.621, "sample_time_ms": 1434.637, "learn_time_ms": 2146.107, "learn_throughput": 477.143, "synch_weights_time_ms": 29.746}, "counters": {"num_env_steps_sampled": 210944, "num_env_steps_trained": 210944, "num_agent_steps_sampled": 210944, "num_agent_steps_trained": 210944}, "done": false, "training_iteration": 206, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-07", "timestamp": 1744126387, "time_this_iter_s": 3.3123843669891357, "time_total_s": 973.4967658519745, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8540>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 973.4967658519745, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 43.28, "ram_util_percent": 89.47999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5029772229492666, "cur_kl_coeff": 1.9446922743316066e-63, "cur_lr": 1e-07, "total_loss": 2.17031564861536, "policy_loss": -4.682517610490322e-05, "vf_loss": 9.971221613883973, "vf_explained_var": -3.277808427810669e-05, "kl": 1.6247164980498496e-06, "entropy": 3.224429166316986, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "env_runners": {"episode_reward_max": 553.0605351955494, "episode_reward_min": 420.74664988434677, "episode_reward_mean": 481.0446482639972, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.74664988434677}, "policy_reward_max": {"tplp_policy": 553.0605351955494}, "policy_reward_mean": {"tplp_policy": 481.0446482639972}, "custom_metrics": {"mean_episode_reward_mean": 481.0446482639972, "mean_episode_reward_min": 420.74664988434677, "mean_episode_reward_max": 553.0605351955494}, "hist_stats": {"episode_reward": [442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [442.3902429258018, 477.85506736486326, 459.0502638507291, 479.483375431147, 474.3632411359444, 512.1218427154497, 471.880439324756, 536.9955446623952, 458.4209346510648, 448.63256694435523, 478.24627862881226, 449.2188403743909, 452.8839264052347, 538.3991769614827, 479.91210445247617, 497.930888825461, 475.76151655232565, 483.4270840226391, 467.71913347786233, 455.09088115737393, 475.84924526134733, 436.0875238398305, 464.52827073226507, 480.91689829747827, 450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4731253903962565, "mean_inference_ms": 4.375034842960691, "mean_action_processing_ms": 0.8161392175263227, "mean_env_wait_ms": 4.224737913506833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017966270446777344, "StateBufferConnector_ms": 0.021037817001342773, "ViewRequirementAgentConnector_ms": 0.38605499267578125}, "num_episodes": 18, "episode_return_max": 553.0605351955494, "episode_return_min": 420.74664988434677, "episode_return_mean": 481.0446482639972, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968, "num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 313.10740992735197, "num_env_steps_trained_throughput_per_sec": 313.10740992735197, "timesteps_total": 211968, "num_env_steps_sampled_lifetime": 211968, "num_agent_steps_sampled_lifetime": 211968, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 211968, "timers": {"training_iteration_time_ms": 3570.732, "restore_workers_time_ms": 0.102, "training_step_time_ms": 3570.379, "sample_time_ms": 1426.599, "learn_time_ms": 2113.331, "learn_throughput": 484.543, "synch_weights_time_ms": 30.317}, "counters": {"num_env_steps_sampled": 211968, "num_env_steps_trained": 211968, "num_agent_steps_sampled": 211968, "num_agent_steps_trained": 211968}, "done": false, "training_iteration": 207, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-10", "timestamp": 1744126390, "time_this_iter_s": 3.2788782119750977, "time_total_s": 976.7756440639496, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 976.7756440639496, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 42.86, "ram_util_percent": 89.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4527902685105802, "cur_kl_coeff": 9.723461371658033e-64, "cur_lr": 1e-07, "total_loss": 2.17151048630476, "policy_loss": -0.00011001374223269522, "vf_loss": 9.977335721254349, "vf_explained_var": -1.5004724264144898e-05, "kl": 2.400894839033052e-06, "entropy": 3.2271343529224397, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "env_runners": {"episode_reward_max": 558.4453709572364, "episode_reward_min": 420.74664988434677, "episode_reward_mean": 482.55866656789146, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.74664988434677}, "policy_reward_max": {"tplp_policy": 558.4453709572364}, "policy_reward_mean": {"tplp_policy": 482.55866656789146}, "custom_metrics": {"mean_episode_reward_mean": 482.55866656789146, "mean_episode_reward_min": 420.74664988434677, "mean_episode_reward_max": 558.4453709572364}, "hist_stats": {"episode_reward": [450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [450.53978108162664, 474.3042084341719, 462.44518805548745, 481.5318807161412, 435.8895843185787, 482.42321351677106, 476.8289370104868, 482.90134282003197, 439.84114664347777, 464.8900188745346, 521.6988431646473, 451.92779397129885, 497.70811396055865, 469.2464364180497, 477.0717518741938, 500.403072074614, 436.5321480817983, 466.56424798881653, 468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.470435247968602, "mean_inference_ms": 4.366811137268586, "mean_action_processing_ms": 0.8146765425071325, "mean_env_wait_ms": 4.217542466273903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01595783233642578, "StateBufferConnector_ms": 0.021632671356201172, "ViewRequirementAgentConnector_ms": 0.34287500381469727}, "num_episodes": 24, "episode_return_max": 558.4453709572364, "episode_return_min": 420.74664988434677, "episode_return_mean": 482.55866656789146, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992, "num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 286.43551107120027, "num_env_steps_trained_throughput_per_sec": 286.43551107120027, "timesteps_total": 212992, "num_env_steps_sampled_lifetime": 212992, "num_agent_steps_sampled_lifetime": 212992, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 212992, "timers": {"training_iteration_time_ms": 3568.832, "restore_workers_time_ms": 0.203, "training_step_time_ms": 3568.529, "sample_time_ms": 1430.033, "learn_time_ms": 2108.398, "learn_throughput": 485.677, "synch_weights_time_ms": 29.967}, "counters": {"num_env_steps_sampled": 212992, "num_env_steps_trained": 212992, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "done": false, "training_iteration": 208, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-14", "timestamp": 1744126394, "time_this_iter_s": 3.584043025970459, "time_total_s": 980.35968708992, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8C20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 980.35968708992, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 47.519999999999996, "ram_util_percent": 89.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.101350264623761, "cur_kl_coeff": 4.8617306858290166e-64, "cur_lr": 1e-07, "total_loss": 2.1699703872203826, "policy_loss": -4.809384699910879e-05, "vf_loss": 9.971954095363618, "vf_explained_var": -2.6027485728263854e-05, "kl": 1.7639051102857905e-06, "entropy": 3.2297002598643303, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "env_runners": {"episode_reward_max": 558.4453709572364, "episode_reward_min": 420.74664988434677, "episode_reward_mean": 485.3084807294557, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.74664988434677}, "policy_reward_max": {"tplp_policy": 558.4453709572364}, "policy_reward_mean": {"tplp_policy": 485.3084807294557}, "custom_metrics": {"mean_episode_reward_mean": 485.3084807294557, "mean_episode_reward_min": 420.74664988434677, "mean_episode_reward_max": 558.4453709572364}, "hist_stats": {"episode_reward": [468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [468.5946265610438, 477.58284913261747, 455.69830307019583, 511.74474429455313, 467.69757673431985, 477.02050330002396, 510.03483868873786, 485.63289374271125, 529.9963150909006, 458.8208268381556, 463.57081892834674, 469.12451992637153, 489.7518660642124, 470.48089673198314, 460.2821601546678, 495.39278038104555, 485.5436118014099, 553.0605351955494, 501.8236265423783, 472.2953072926729, 456.77024128493315, 509.13427691979797, 534.171081735436, 498.2331250582254, 489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4684959718571124, "mean_inference_ms": 4.360875022184632, "mean_action_processing_ms": 0.8135733868791958, "mean_env_wait_ms": 4.212341345820403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02147698402404785, "StateBufferConnector_ms": 0.0271456241607666, "ViewRequirementAgentConnector_ms": 0.3163566589355469}, "num_episodes": 18, "episode_return_max": 558.4453709572364, "episode_return_min": 420.74664988434677, "episode_return_mean": 485.3084807294557, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016, "num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 290.7985949479876, "num_env_steps_trained_throughput_per_sec": 290.7985949479876, "timesteps_total": 214016, "num_env_steps_sampled_lifetime": 214016, "num_agent_steps_sampled_lifetime": 214016, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 214016, "timers": {"training_iteration_time_ms": 3552.965, "restore_workers_time_ms": 0.203, "training_step_time_ms": 3552.762, "sample_time_ms": 1413.646, "learn_time_ms": 2109.604, "learn_throughput": 485.399, "synch_weights_time_ms": 29.38}, "counters": {"num_env_steps_sampled": 214016, "num_env_steps_trained": 214016, "num_agent_steps_sampled": 214016, "num_agent_steps_trained": 214016}, "done": false, "training_iteration": 209, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-18", "timestamp": 1744126398, "time_this_iter_s": 3.5302083492279053, "time_total_s": 983.889895439148, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCB600>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 983.889895439148, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 46.92, "ram_util_percent": 89.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.414682021737099, "cur_kl_coeff": 2.4308653429145083e-64, "cur_lr": 1e-07, "total_loss": 2.174432947486639, "policy_loss": -4.961728118360043e-05, "vf_loss": 9.990366125106812, "vf_explained_var": -2.0275264978408815e-05, "kl": 8.036534907496229e-07, "entropy": 3.2310897529125215, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "env_runners": {"episode_reward_max": 558.4453709572364, "episode_reward_min": 420.74664988434677, "episode_reward_mean": 485.2780840425623, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.74664988434677}, "policy_reward_max": {"tplp_policy": 558.4453709572364}, "policy_reward_mean": {"tplp_policy": 485.2780840425623}, "custom_metrics": {"mean_episode_reward_mean": 485.2780840425623, "mean_episode_reward_min": 420.74664988434677, "mean_episode_reward_max": 558.4453709572364}, "hist_stats": {"episode_reward": [489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [489.39354742621833, 500.3866108275959, 494.8633419929396, 467.5686156533023, 488.883097745857, 493.996689775606, 472.3194385534483, 482.39565456887584, 461.242439646149, 488.3789050879291, 507.3229884484621, 455.26099705526383, 508.65824433973665, 496.184575145929, 420.74664988434677, 504.1184522257992, 543.5797414362189, 461.2323785529409, 487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4659748510135204, "mean_inference_ms": 4.353216405066433, "mean_action_processing_ms": 0.8121243117176249, "mean_env_wait_ms": 4.205730650711967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017242431640625, "StateBufferConnector_ms": 0.02208399772644043, "ViewRequirementAgentConnector_ms": 0.3095521926879883}, "num_episodes": 24, "episode_return_max": 558.4453709572364, "episode_return_min": 420.74664988434677, "episode_return_mean": 485.2780840425623, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040, "num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 278.25249983754986, "num_env_steps_trained_throughput_per_sec": 278.25249983754986, "timesteps_total": 215040, "num_env_steps_sampled_lifetime": 215040, "num_agent_steps_sampled_lifetime": 215040, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 215040, "timers": {"training_iteration_time_ms": 3563.991, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3563.891, "sample_time_ms": 1423.546, "learn_time_ms": 2110.975, "learn_throughput": 485.084, "synch_weights_time_ms": 29.239}, "counters": {"num_env_steps_sampled": 215040, "num_env_steps_trained": 215040, "num_agent_steps_sampled": 215040, "num_agent_steps_trained": 215040}, "done": false, "training_iteration": 210, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-21", "timestamp": 1744126401, "time_this_iter_s": 3.6892943382263184, "time_total_s": 987.5791897773743, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 987.5791897773743, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 46.8, "ram_util_percent": 89.17999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6000287536531688, "cur_kl_coeff": 1.2154326714572541e-64, "cur_lr": 1e-07, "total_loss": 2.1766001783311366, "policy_loss": -0.00011834563338197768, "vf_loss": 10.0, "vf_explained_var": -2.623945474624634e-05, "kl": 2.4669420121803396e-06, "entropy": 3.232814735174179, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "env_runners": {"episode_reward_max": 558.4453709572364, "episode_reward_min": 433.50302716924585, "episode_reward_mean": 483.6781837617855, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 433.50302716924585}, "policy_reward_max": {"tplp_policy": 558.4453709572364}, "policy_reward_mean": {"tplp_policy": 483.6781837617855}, "custom_metrics": {"mean_episode_reward_mean": 483.6781837617855, "mean_episode_reward_min": 433.50302716924585, "mean_episode_reward_max": 558.4453709572364}, "hist_stats": {"episode_reward": [487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.1900592160623, 470.37717146988575, 510.47062973003983, 521.7628457376064, 493.74571370707804, 516.3865823609567, 507.43407890465437, 485.0569404722895, 498.5617654219831, 448.5730623288596, 470.8312991869228, 498.7789750740479, 474.66144205816863, 475.741986668048, 487.0193873072948, 448.96919591814645, 558.4453709572364, 494.53692597918814, 438.50526402024946, 471.52704306175525, 475.99020765587625, 489.4700117990602, 449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4642578409680302, "mean_inference_ms": 4.347963407845202, "mean_action_processing_ms": 0.8110954950402659, "mean_env_wait_ms": 4.201250751304096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0182039737701416, "StateBufferConnector_ms": 0.013711214065551758, "ViewRequirementAgentConnector_ms": 0.30604982376098633}, "num_episodes": 18, "episode_return_max": 558.4453709572364, "episode_return_min": 433.50302716924585, "episode_return_mean": 483.6781837617855, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064, "num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 271.5150818768024, "num_env_steps_trained_throughput_per_sec": 271.5150818768024, "timesteps_total": 216064, "num_env_steps_sampled_lifetime": 216064, "num_agent_steps_sampled_lifetime": 216064, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 216064, "timers": {"training_iteration_time_ms": 3592.023, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3591.922, "sample_time_ms": 1428.605, "learn_time_ms": 2133.625, "learn_throughput": 479.934, "synch_weights_time_ms": 29.56}, "counters": {"num_env_steps_sampled": 216064, "num_env_steps_trained": 216064, "num_agent_steps_sampled": 216064, "num_agent_steps_trained": 216064}, "done": false, "training_iteration": 211, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-25", "timestamp": 1744126405, "time_this_iter_s": 4.0815110206604, "time_total_s": 991.6607007980347, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 991.6607007980347, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 43.166666666666664, "ram_util_percent": 89.21666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1020700693130494, "cur_kl_coeff": 6.077163357286271e-65, "cur_lr": 1e-07, "total_loss": 2.176513260602951, "policy_loss": 3.258100477978587e-05, "vf_loss": 10.0, "vf_explained_var": -1.072324812412262e-05, "kl": 9.072916519831109e-07, "entropy": 3.235193261504173, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "env_runners": {"episode_reward_max": 561.3668098863568, "episode_reward_min": 427.3853982512845, "episode_reward_mean": 481.8571837954171, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.3853982512845}, "policy_reward_max": {"tplp_policy": 561.3668098863568}, "policy_reward_mean": {"tplp_policy": 481.8571837954171}, "custom_metrics": {"mean_episode_reward_mean": 481.8571837954171, "mean_episode_reward_min": 427.3853982512845, "mean_episode_reward_max": 561.3668098863568}, "hist_stats": {"episode_reward": [449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [449.9789984672034, 483.812683811218, 509.75498000592165, 486.0258048463608, 489.3180608812297, 528.9750312109151, 454.4476366738108, 479.5175236995213, 463.970490665223, 492.08667471076154, 451.47049349707083, 435.1877217324768, 463.48997152555523, 484.0682078617522, 462.85653552390863, 479.1839714970089, 520.2251064197236, 485.7224018818724, 506.51110177875654, 454.44697499538717, 472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4628127836606124, "mean_inference_ms": 4.340910501827569, "mean_action_processing_ms": 0.8098029595299807, "mean_env_wait_ms": 4.195661771583293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018817663192749023, "StateBufferConnector_ms": 0.011038780212402344, "ViewRequirementAgentConnector_ms": 0.32096266746520996}, "num_episodes": 22, "episode_return_max": 561.3668098863568, "episode_return_min": 427.3853982512845, "episode_return_mean": 481.8571837954171, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088, "num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 270.1078965685785, "num_env_steps_trained_throughput_per_sec": 270.1078965685785, "timesteps_total": 217088, "num_env_steps_sampled_lifetime": 217088, "num_agent_steps_sampled_lifetime": 217088, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 217088, "timers": {"training_iteration_time_ms": 3602.236, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3602.135, "sample_time_ms": 1425.817, "learn_time_ms": 2148.109, "learn_throughput": 476.698, "synch_weights_time_ms": 28.078}, "counters": {"num_env_steps_sampled": 217088, "num_env_steps_trained": 217088, "num_agent_steps_sampled": 217088, "num_agent_steps_trained": 217088}, "done": false, "training_iteration": 212, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-29", "timestamp": 1744126409, "time_this_iter_s": 3.7996904850006104, "time_total_s": 995.4603912830353, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCBB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 995.4603912830353, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 46.54, "ram_util_percent": 89.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.107516710087657, "cur_kl_coeff": 3.0385816786431353e-65, "cur_lr": 1e-07, "total_loss": 2.1720789305865766, "policy_loss": -1.2274098116904497e-05, "vf_loss": 9.98311843276024, "vf_explained_var": -2.0120665431022645e-05, "kl": 9.41537391341285e-07, "entropy": 3.236883872747421, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "env_runners": {"episode_reward_max": 561.3668098863568, "episode_reward_min": 427.3853982512845, "episode_reward_mean": 482.66885674352665, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.3853982512845}, "policy_reward_max": {"tplp_policy": 561.3668098863568}, "policy_reward_mean": {"tplp_policy": 482.66885674352665}, "custom_metrics": {"mean_episode_reward_mean": 482.66885674352665, "mean_episode_reward_min": 427.3853982512845, "mean_episode_reward_max": 561.3668098863568}, "hist_stats": {"episode_reward": [472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [472.09577591832357, 469.7182682541041, 522.2786020989246, 445.56504226766856, 481.5139157780095, 470.5207768632476, 492.79276943824823, 530.9255975753538, 473.58492088419047, 549.4752663545498, 443.0351770065468, 438.9462553106646, 505.04473958329294, 480.85330747648044, 499.9595692861674, 510.46106429179866, 462.50315847302295, 532.480297653534, 471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4606215573038435, "mean_inference_ms": 4.337250324362511, "mean_action_processing_ms": 0.8089479981809157, "mean_env_wait_ms": 4.192071707907969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01735091209411621, "StateBufferConnector_ms": 0.00803065299987793, "ViewRequirementAgentConnector_ms": 0.3339114189147949}, "num_episodes": 20, "episode_return_max": 561.3668098863568, "episode_return_min": 427.3853982512845, "episode_return_mean": 482.66885674352665, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112, "num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 277.55337941422283, "num_env_steps_trained_throughput_per_sec": 277.55337941422283, "timesteps_total": 218112, "num_env_steps_sampled_lifetime": 218112, "num_agent_steps_sampled_lifetime": 218112, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 218112, "timers": {"training_iteration_time_ms": 3559.468, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3559.367, "sample_time_ms": 1410.212, "learn_time_ms": 2120.308, "learn_throughput": 482.949, "synch_weights_time_ms": 28.617}, "counters": {"num_env_steps_sampled": 218112, "num_env_steps_trained": 218112, "num_agent_steps_sampled": 218112, "num_agent_steps_trained": 218112}, "done": false, "training_iteration": 213, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-33", "timestamp": 1744126413, "time_this_iter_s": 3.702341079711914, "time_total_s": 999.1627323627472, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 999.1627323627472, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 45.14, "ram_util_percent": 89.24}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9606079887598753, "cur_kl_coeff": 1.5192908393215677e-65, "cur_lr": 1e-07, "total_loss": 2.1760392285883428, "policy_loss": -2.3765000514686106e-05, "vf_loss": 10.0, "vf_explained_var": -2.078600227832794e-05, "kl": 2.1575335469758984e-06, "entropy": 3.2393699795007707, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "env_runners": {"episode_reward_max": 561.3668098863568, "episode_reward_min": 427.3853982512845, "episode_reward_mean": 480.1524903307337, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.3853982512845}, "policy_reward_max": {"tplp_policy": 561.3668098863568}, "policy_reward_mean": {"tplp_policy": 480.1524903307337}, "custom_metrics": {"mean_episode_reward_mean": 480.1524903307337, "mean_episode_reward_min": 427.3853982512845, "mean_episode_reward_max": 561.3668098863568}, "hist_stats": {"episode_reward": [471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [471.6083317020412, 458.21181452542174, 502.1952095646244, 508.68191261620655, 467.6568293319668, 518.380551046397, 475.9368394222518, 520.8908174385758, 468.66828887659136, 489.32182862615207, 490.8953078445678, 466.6426465543216, 480.5960510191448, 519.4772403663779, 533.6827953016657, 482.95671813091946, 473.5632612507491, 466.22298473902816, 466.0698881269429, 452.12876147259243, 511.3189565370799, 479.32816616076553, 471.21856068305584, 446.9130435793488, 466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4592116849124401, "mean_inference_ms": 4.3331986588449745, "mean_action_processing_ms": 0.8081569209552256, "mean_env_wait_ms": 4.188571642333659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01385354995727539, "StateBufferConnector_ms": 0.007523536682128906, "ViewRequirementAgentConnector_ms": 0.3326566219329834}, "num_episodes": 18, "episode_return_max": 561.3668098863568, "episode_return_min": 427.3853982512845, "episode_return_mean": 480.1524903307337, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136, "num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 263.3379573255598, "num_env_steps_trained_throughput_per_sec": 263.3379573255598, "timesteps_total": 219136, "num_env_steps_sampled_lifetime": 219136, "num_agent_steps_sampled_lifetime": 219136, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 219136, "timers": {"training_iteration_time_ms": 3602.094, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3601.993, "sample_time_ms": 1436.187, "learn_time_ms": 2137.277, "learn_throughput": 479.114, "synch_weights_time_ms": 28.33}, "counters": {"num_env_steps_sampled": 219136, "num_env_steps_trained": 219136, "num_agent_steps_sampled": 219136, "num_agent_steps_trained": 219136}, "done": false, "training_iteration": 214, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-37", "timestamp": 1744126417, "time_this_iter_s": 3.899843215942383, "time_total_s": 1003.0625755786896, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1003.0625755786896, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 48.849999999999994, "ram_util_percent": 89.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.655542866885662, "cur_kl_coeff": 7.596454196607838e-66, "cur_lr": 1e-07, "total_loss": 2.173348817974329, "policy_loss": -2.755282330326736e-05, "vf_loss": 9.990313905477525, "vf_explained_var": -1.7487257719039916e-05, "kl": 1.2993183426068811e-06, "entropy": 3.242021012306213, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "env_runners": {"episode_reward_max": 561.3668098863568, "episode_reward_min": 427.3853982512845, "episode_reward_mean": 479.5824275861453, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 427.3853982512845}, "policy_reward_max": {"tplp_policy": 561.3668098863568}, "policy_reward_mean": {"tplp_policy": 479.5824275861453}, "custom_metrics": {"mean_episode_reward_mean": 479.5824275861453, "mean_episode_reward_min": 427.3853982512845, "mean_episode_reward_max": 561.3668098863568}, "hist_stats": {"episode_reward": [466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [466.0989793917803, 477.8728955099231, 455.26266274513046, 464.6061141325099, 466.7990250106786, 503.38710980312743, 433.50302716924585, 496.44152900359643, 541.5213833933074, 484.17063718166133, 454.15077739391256, 438.08921749244524, 491.5563714176472, 457.2682121036641, 501.99733079227906, 525.6854634856353, 508.5047953124982, 473.1966310995863, 491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4573682760305586, "mean_inference_ms": 4.327743358527624, "mean_action_processing_ms": 0.807049643724301, "mean_env_wait_ms": 4.183943788493477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010820627212524414, "StateBufferConnector_ms": 0.01002359390258789, "ViewRequirementAgentConnector_ms": 0.3204526901245117}, "num_episodes": 24, "episode_return_max": 561.3668098863568, "episode_return_min": 427.3853982512845, "episode_return_mean": 479.5824275861453, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160, "num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 285.2373818024071, "num_env_steps_trained_throughput_per_sec": 285.2373818024071, "timesteps_total": 220160, "num_env_steps_sampled_lifetime": 220160, "num_agent_steps_sampled_lifetime": 220160, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 220160, "timers": {"training_iteration_time_ms": 3608.056, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3607.956, "sample_time_ms": 1445.745, "learn_time_ms": 2133.857, "learn_throughput": 479.882, "synch_weights_time_ms": 28.155}, "counters": {"num_env_steps_sampled": 220160, "num_env_steps_trained": 220160, "num_agent_steps_sampled": 220160, "num_agent_steps_trained": 220160}, "done": false, "training_iteration": 215, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-41", "timestamp": 1744126421, "time_this_iter_s": 3.5990726947784424, "time_total_s": 1006.661648273468, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCBB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1006.661648273468, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 46.620000000000005, "ram_util_percent": 89.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5604584153741596, "cur_kl_coeff": 3.798227098303919e-66, "cur_lr": 1e-07, "total_loss": 2.1754609875380995, "policy_loss": -6.76809751894325e-05, "vf_loss": 10.0, "vf_explained_var": -1.653917133808136e-05, "kl": 2.7057517240983153e-06, "entropy": 3.2447132393717766, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "env_runners": {"episode_reward_max": 561.3668098863568, "episode_reward_min": 424.643366594456, "episode_reward_mean": 477.6349625078927, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 424.643366594456}, "policy_reward_max": {"tplp_policy": 561.3668098863568}, "policy_reward_mean": {"tplp_policy": 477.6349625078927}, "custom_metrics": {"mean_episode_reward_mean": 477.6349625078927, "mean_episode_reward_min": 424.643366594456, "mean_episode_reward_max": 561.3668098863568}, "hist_stats": {"episode_reward": [491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [491.6670666132559, 497.8441867631255, 467.44016074252545, 492.75454647020916, 457.58725712842556, 456.7706190825316, 465.3477176877651, 474.13684949102895, 461.91809160792644, 478.1025081066902, 427.3853982512845, 527.8228054670145, 471.6670579059551, 561.3668098863568, 454.4636934823694, 501.22851480191395, 457.6214080950641, 452.5089241032711, 488.9733005312353, 473.6276197685362, 488.2952772098639, 462.88378740132816, 485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4559833498227357, "mean_inference_ms": 4.3238318693862885, "mean_action_processing_ms": 0.8061783204609969, "mean_env_wait_ms": 4.180381811682639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007821083068847656, "StateBufferConnector_ms": 0.010511636734008789, "ViewRequirementAgentConnector_ms": 0.32119083404541016}, "num_episodes": 18, "episode_return_max": 561.3668098863568, "episode_return_min": 424.643366594456, "episode_return_mean": 477.6349625078927, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184, "num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 278.93181717961613, "num_env_steps_trained_throughput_per_sec": 278.93181717961613, "timesteps_total": 221184, "num_env_steps_sampled_lifetime": 221184, "num_agent_steps_sampled_lifetime": 221184, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 221184, "timers": {"training_iteration_time_ms": 3644.843, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3644.737, "sample_time_ms": 1465.751, "learn_time_ms": 2149.485, "learn_throughput": 476.393, "synch_weights_time_ms": 29.251}, "counters": {"num_env_steps_sampled": 221184, "num_env_steps_trained": 221184, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "done": false, "training_iteration": 216, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-45", "timestamp": 1744126425, "time_this_iter_s": 3.680272102355957, "time_total_s": 1010.341920375824, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC8220>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1010.341920375824, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 47.7, "ram_util_percent": 89.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3583614472299814, "cur_kl_coeff": 1.8991135491519596e-66, "cur_lr": 1e-07, "total_loss": 2.1740322075784206, "policy_loss": -6.71956455335021e-05, "vf_loss": 9.9951207280159, "vf_explained_var": -1.8119439482688902e-05, "kl": 9.881477438966612e-07, "entropy": 3.2468076959252357, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "env_runners": {"episode_reward_max": 529.3122129285065, "episode_reward_min": 423.9127274014497, "episode_reward_mean": 477.2271900151323, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.9127274014497}, "policy_reward_max": {"tplp_policy": 529.3122129285065}, "policy_reward_mean": {"tplp_policy": 477.2271900151323}, "custom_metrics": {"mean_episode_reward_mean": 477.2271900151323, "mean_episode_reward_min": 423.9127274014497, "mean_episode_reward_max": 529.3122129285065}, "hist_stats": {"episode_reward": [485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [485.0056290744951, 513.7086672808822, 487.61017948259365, 520.0666336378346, 493.9743564039696, 503.6503276760152, 466.85106529241915, 520.2975165605717, 442.72732035787743, 458.49137212963853, 445.61865449394713, 504.73518069229027, 509.6655290069005, 428.953560964555, 507.5435781090772, 474.1871255341215, 465.35185773737305, 482.6000474508657, 493.265094711023, 499.98743016752206, 487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4542283631112096, "mean_inference_ms": 4.3188147061369735, "mean_action_processing_ms": 0.8050927900331467, "mean_env_wait_ms": 4.175755793838069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01109933853149414, "StateBufferConnector_ms": 0.013504505157470703, "ViewRequirementAgentConnector_ms": 0.32313108444213867}, "num_episodes": 22, "episode_return_max": 529.3122129285065, "episode_return_min": 423.9127274014497, "episode_return_mean": 477.2271900151323, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208, "num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 294.1949044095597, "num_env_steps_trained_throughput_per_sec": 294.1949044095597, "timesteps_total": 222208, "num_env_steps_sampled_lifetime": 222208, "num_agent_steps_sampled_lifetime": 222208, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 222208, "timers": {"training_iteration_time_ms": 3665.868, "restore_workers_time_ms": 0.101, "training_step_time_ms": 3665.761, "sample_time_ms": 1478.059, "learn_time_ms": 2158.027, "learn_throughput": 474.507, "synch_weights_time_ms": 29.321}, "counters": {"num_env_steps_sampled": 222208, "num_env_steps_trained": 222208, "num_agent_steps_sampled": 222208, "num_agent_steps_trained": 222208}, "done": false, "training_iteration": 217, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-48", "timestamp": 1744126428, "time_this_iter_s": 3.490374803543091, "time_total_s": 1013.8322951793671, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9300>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1013.8322951793671, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 45.64, "ram_util_percent": 89.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7166569475084543, "cur_kl_coeff": 9.495567745759798e-67, "cur_lr": 1e-07, "total_loss": 2.170986843109131, "policy_loss": -0.00011673355475068092, "vf_loss": 9.983992493152618, "vf_explained_var": -1.6319379210472106e-05, "kl": 3.1641834902673695e-06, "entropy": 3.248945100605488, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "env_runners": {"episode_reward_max": 529.3122129285065, "episode_reward_min": 423.9127274014497, "episode_reward_mean": 476.25560231028487, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 423.9127274014497}, "policy_reward_max": {"tplp_policy": 529.3122129285065}, "policy_reward_mean": {"tplp_policy": 476.25560231028487}, "custom_metrics": {"mean_episode_reward_mean": 476.25560231028487, "mean_episode_reward_min": 423.9127274014497, "mean_episode_reward_max": 529.3122129285065}, "hist_stats": {"episode_reward": [487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [487.15111094464027, 496.70591269908806, 453.45871725913065, 441.00884668455603, 498.3437579508598, 473.7987004213646, 438.91812746068445, 469.6680733195494, 472.3958993872691, 487.0403258235186, 459.9433489542177, 476.9111406432692, 465.2536988886971, 468.1420584365602, 483.53772243500407, 464.58789704789257, 483.79374884679186, 475.2909727208212, 459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4526524894387096, "mean_inference_ms": 4.314208927769474, "mean_action_processing_ms": 0.8041234168038552, "mean_env_wait_ms": 4.171574478667356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01266932487487793, "StateBufferConnector_ms": 0.012998342514038086, "ViewRequirementAgentConnector_ms": 0.3121914863586426}, "num_episodes": 20, "episode_return_max": 529.3122129285065, "episode_return_min": 423.9127274014497, "episode_return_mean": 476.25560231028487, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232, "num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 290.0946672224099, "num_env_steps_trained_throughput_per_sec": 290.0946672224099, "timesteps_total": 223232, "num_env_steps_sampled_lifetime": 223232, "num_agent_steps_sampled_lifetime": 223232, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 223232, "timers": {"training_iteration_time_ms": 3661.358, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3661.353, "sample_time_ms": 1481.536, "learn_time_ms": 2150.002, "learn_throughput": 476.279, "synch_weights_time_ms": 29.461}, "counters": {"num_env_steps_sampled": 223232, "num_env_steps_trained": 223232, "num_agent_steps_sampled": 223232, "num_agent_steps_trained": 223232}, "done": false, "training_iteration": 218, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-52", "timestamp": 1744126432, "time_this_iter_s": 3.53844952583313, "time_total_s": 1017.3707447052002, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1017.3707447052002, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 45.96, "ram_util_percent": 89.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.165660291165113, "cur_kl_coeff": 4.747783872879899e-67, "cur_lr": 1e-07, "total_loss": 2.17272582128644, "policy_loss": -0.0002782679395750165, "vf_loss": 9.993303447961807, "vf_explained_var": -2.4634599685668946e-05, "kl": 6.076401114896157e-06, "entropy": 3.253217655420303, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "env_runners": {"episode_reward_max": 529.3122129285065, "episode_reward_min": 413.6994045570409, "episode_reward_mean": 475.97155846632484, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.6994045570409}, "policy_reward_max": {"tplp_policy": 529.3122129285065}, "policy_reward_mean": {"tplp_policy": 475.97155846632484}, "custom_metrics": {"mean_episode_reward_mean": 475.97155846632484, "mean_episode_reward_min": 413.6994045570409, "mean_episode_reward_max": 529.3122129285065}, "hist_stats": {"episode_reward": [459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [459.57017852796565, 499.7450203326348, 471.72452006709284, 485.6878993378866, 445.73823795269203, 459.4439081073373, 517.9549078157338, 521.5756014674556, 451.8182624569483, 442.83821583907456, 463.9651636721693, 497.08221059292407, 498.4503582709786, 480.10477822319297, 490.59838014784873, 453.4064923993266, 511.86476717891264, 491.02720726786083, 526.9255884443317, 502.5592663126843, 450.75244918836034, 483.6423952869248, 424.643366594456, 464.72661677048353, 434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.45117422665583, "mean_inference_ms": 4.309624378163947, "mean_action_processing_ms": 0.8031922548290332, "mean_env_wait_ms": 4.167450565019598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013662576675415039, "StateBufferConnector_ms": 0.01140451431274414, "ViewRequirementAgentConnector_ms": 0.3366546630859375}, "num_episodes": 18, "episode_return_max": 529.3122129285065, "episode_return_min": 413.6994045570409, "episode_return_mean": 475.97155846632484, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256, "num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 263.5410377324916, "num_env_steps_trained_throughput_per_sec": 263.5410377324916, "timesteps_total": 224256, "num_env_steps_sampled_lifetime": 224256, "num_agent_steps_sampled_lifetime": 224256, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 224256, "timers": {"training_iteration_time_ms": 3697.779, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3697.773, "sample_time_ms": 1478.201, "learn_time_ms": 2189.651, "learn_throughput": 467.654, "synch_weights_time_ms": 29.568}, "counters": {"num_env_steps_sampled": 224256, "num_env_steps_trained": 224256, "num_agent_steps_sampled": 224256, "num_agent_steps_trained": 224256}, "done": false, "training_iteration": 219, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-56", "timestamp": 1744126436, "time_this_iter_s": 3.898085355758667, "time_total_s": 1021.2688300609589, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCAB60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1021.2688300609589, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 44.88333333333333, "ram_util_percent": 89.23333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7694365657866, "cur_kl_coeff": 2.3738919364399495e-67, "cur_lr": 1e-07, "total_loss": 2.1718726798892023, "policy_loss": -5.526188760995865e-05, "vf_loss": 9.990361332893372, "vf_explained_var": -2.0476430654525758e-05, "kl": 1.3158872836663283e-06, "entropy": 3.2566237673163414, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "env_runners": {"episode_reward_max": 541.553855681785, "episode_reward_min": 413.6994045570409, "episode_reward_mean": 476.6431492125678, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.6994045570409}, "policy_reward_max": {"tplp_policy": 541.553855681785}, "policy_reward_mean": {"tplp_policy": 476.6431492125678}, "custom_metrics": {"mean_episode_reward_mean": 476.6431492125678, "mean_episode_reward_min": 413.6994045570409, "mean_episode_reward_max": 541.553855681785}, "hist_stats": {"episode_reward": [434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [434.85993016401716, 471.0364462476794, 435.88168718299085, 474.0698253682504, 442.2737654843384, 448.9742446468616, 475.42062689190595, 485.5187492817012, 505.9214743720102, 503.93819485793597, 482.94376981014665, 458.9309707704157, 499.05617628146007, 483.7852346505337, 447.21988630534827, 506.16468893282973, 434.1453368768047, 493.5644082677142, 464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4490564299370872, "mean_inference_ms": 4.303273678592327, "mean_action_processing_ms": 0.8019395977234806, "mean_env_wait_ms": 4.161879443132104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014511585235595703, "StateBufferConnector_ms": 0.009639501571655273, "ViewRequirementAgentConnector_ms": 0.3324239253997803}, "num_episodes": 24, "episode_return_max": 541.553855681785, "episode_return_min": 413.6994045570409, "episode_return_mean": 476.6431492125678, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280, "num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 295.1981781838019, "num_env_steps_trained_throughput_per_sec": 295.1981781838019, "timesteps_total": 225280, "num_env_steps_sampled_lifetime": 225280, "num_agent_steps_sampled_lifetime": 225280, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 225280, "timers": {"training_iteration_time_ms": 3676.653, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3676.648, "sample_time_ms": 1467.605, "learn_time_ms": 2178.248, "learn_throughput": 470.103, "synch_weights_time_ms": 30.317}, "counters": {"num_env_steps_sampled": 225280, "num_env_steps_trained": 225280, "num_agent_steps_sampled": 225280, "num_agent_steps_trained": 225280}, "done": false, "training_iteration": 220, "trial_id": "3bf18_00000", "date": "2025-04-08_23-33-59", "timestamp": 1744126439, "time_this_iter_s": 3.481920003890991, "time_total_s": 1024.7507500648499, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1024.7507500648499, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 44.059999999999995, "ram_util_percent": 89.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1659549966454508, "cur_kl_coeff": 1.1869459682199747e-67, "cur_lr": 1e-07, "total_loss": 2.172780904918909, "policy_loss": -9.19449725188315e-05, "vf_loss": 9.994648647308349, "vf_explained_var": -2.8290227055549623e-05, "kl": 1.5585806238962997e-06, "entropy": 3.257893179357052, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35280.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "env_runners": {"episode_reward_max": 587.2016488242348, "episode_reward_min": 413.6994045570409, "episode_reward_mean": 479.5762872661872, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.6994045570409}, "policy_reward_max": {"tplp_policy": 587.2016488242348}, "policy_reward_mean": {"tplp_policy": 479.5762872661872}, "custom_metrics": {"mean_episode_reward_mean": 479.5762872661872, "mean_episode_reward_min": 413.6994045570409, "mean_episode_reward_max": 587.2016488242348}, "hist_stats": {"episode_reward": [464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.79656886788285, 454.9730154405665, 493.93388962495516, 480.26804104389817, 474.96847520256574, 501.39318638383764, 460.8036414272701, 486.41279698234865, 461.95271042831257, 439.37818448140183, 423.9127274014497, 493.93269557958484, 524.0559216124808, 529.3122129285065, 455.16313021415885, 500.3631045690621, 447.0415315346079, 460.22224062052754, 508.4614754182909, 481.58105641540595, 482.95513168712586, 464.3864171504662, 490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4475508346744226, "mean_inference_ms": 4.298747887975667, "mean_action_processing_ms": 0.8011595928711164, "mean_env_wait_ms": 4.157999247795309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015020370483398438, "StateBufferConnector_ms": 0.012647867202758789, "ViewRequirementAgentConnector_ms": 0.35243916511535645}, "num_episodes": 18, "episode_return_max": 587.2016488242348, "episode_return_min": 413.6994045570409, "episode_return_mean": 479.5762872661872, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304, "num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 274.7000946715195, "num_env_steps_trained_throughput_per_sec": 274.7000946715195, "timesteps_total": 226304, "num_env_steps_sampled_lifetime": 226304, "num_agent_steps_sampled_lifetime": 226304, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 226304, "timers": {"training_iteration_time_ms": 3672.281, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3672.275, "sample_time_ms": 1479.686, "learn_time_ms": 2162.002, "learn_throughput": 473.635, "synch_weights_time_ms": 30.009}, "counters": {"num_env_steps_sampled": 226304, "num_env_steps_trained": 226304, "num_agent_steps_sampled": 226304, "num_agent_steps_trained": 226304}, "done": false, "training_iteration": 221, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-03", "timestamp": 1744126443, "time_this_iter_s": 3.736013889312744, "time_total_s": 1028.4867639541626, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCAB60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1028.4867639541626, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 52.02, "ram_util_percent": 89.56000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.207041407749057, "cur_kl_coeff": 5.934729841099874e-68, "cur_lr": 1e-07, "total_loss": 2.173984724283218, "policy_loss": -4.507368430495262e-06, "vf_loss": 9.99987244606018, "vf_explained_var": -2.6993826031684877e-05, "kl": 1.4915794760206324e-06, "entropy": 3.2597886681556703, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35440.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "env_runners": {"episode_reward_max": 587.2016488242348, "episode_reward_min": 413.6994045570409, "episode_reward_mean": 480.2936284001358, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.6994045570409}, "policy_reward_max": {"tplp_policy": 587.2016488242348}, "policy_reward_mean": {"tplp_policy": 480.2936284001358}, "custom_metrics": {"mean_episode_reward_mean": 480.2936284001358, "mean_episode_reward_min": 413.6994045570409, "mean_episode_reward_max": 587.2016488242348}, "hist_stats": {"episode_reward": [490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [490.08616407023544, 476.5069808589155, 510.29610451402533, 479.38642154582124, 496.8060556704046, 492.4289356442473, 511.2888838038645, 455.66473621932903, 468.5635955706522, 488.2710996430312, 475.0549078125434, 489.90725302058905, 467.0615107483314, 433.6643338767575, 461.8195808191568, 473.94937601134836, 502.5760338422764, 486.4588337701098, 441.4147249389821, 475.38594383536406, 476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4461046480661253, "mean_inference_ms": 4.294050150268479, "mean_action_processing_ms": 0.800323857994872, "mean_env_wait_ms": 4.15386716295619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010509967803955078, "StateBufferConnector_ms": 0.01516270637512207, "ViewRequirementAgentConnector_ms": 0.3918900489807129}, "num_episodes": 22, "episode_return_max": 587.2016488242348, "episode_return_min": 413.6994045570409, "episode_return_mean": 480.2936284001358, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328, "num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 229.26464558511933, "num_env_steps_trained_throughput_per_sec": 229.26464558511933, "timesteps_total": 227328, "num_env_steps_sampled_lifetime": 227328, "num_agent_steps_sampled_lifetime": 227328, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 227328, "timers": {"training_iteration_time_ms": 3739.818, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3739.812, "sample_time_ms": 1500.763, "learn_time_ms": 2208.455, "learn_throughput": 463.673, "synch_weights_time_ms": 30.017}, "counters": {"num_env_steps_sampled": 227328, "num_env_steps_trained": 227328, "num_agent_steps_sampled": 227328, "num_agent_steps_trained": 227328}, "done": false, "training_iteration": 222, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-08", "timestamp": 1744126448, "time_this_iter_s": 4.476015567779541, "time_total_s": 1032.9627795219421, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCB560>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1032.9627795219421, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 50.99999999999999, "ram_util_percent": 89.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3304779775440694, "cur_kl_coeff": 2.967364920549937e-68, "cur_lr": 1e-07, "total_loss": 2.1738831900060176, "policy_loss": 3.0140508897602558e-05, "vf_loss": 10.0, "vf_explained_var": -2.5061145424842835e-05, "kl": 7.401357464686953e-08, "entropy": 3.26146931797266, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35600.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "env_runners": {"episode_reward_max": 587.2016488242348, "episode_reward_min": 413.6994045570409, "episode_reward_mean": 480.5473500955205, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 413.6994045570409}, "policy_reward_max": {"tplp_policy": 587.2016488242348}, "policy_reward_mean": {"tplp_policy": 480.5473500955205}, "custom_metrics": {"mean_episode_reward_mean": 480.5473500955205, "mean_episode_reward_min": 413.6994045570409, "mean_episode_reward_max": 587.2016488242348}, "hist_stats": {"episode_reward": [476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [476.43320228312405, 511.36126718547985, 513.4754203448354, 476.32190926209717, 413.6994045570409, 494.2058449619939, 435.50138192583165, 461.58348494723435, 457.255310147304, 463.1546883153919, 464.25419134112525, 449.82777914952294, 486.757398463084, 525.2809246093989, 474.93662755114985, 446.69617170895515, 538.7101443609062, 496.9602849026929, 446.8539026970405, 467.1893078185082, 467.8176840689038, 466.3125545647426, 473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4448548112112223, "mean_inference_ms": 4.2899752748103, "mean_action_processing_ms": 0.7995731674700525, "mean_env_wait_ms": 4.150343412943689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02358841896057129, "StateBufferConnector_ms": 0.01667189598083496, "ViewRequirementAgentConnector_ms": 0.40522217750549316}, "num_episodes": 20, "episode_return_max": 587.2016488242348, "episode_return_min": 413.6994045570409, "episode_return_mean": 480.5473500955205, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352, "num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 284.24457052336874, "num_env_steps_trained_throughput_per_sec": 284.24457052336874, "timesteps_total": 228352, "num_env_steps_sampled_lifetime": 228352, "num_agent_steps_sampled_lifetime": 228352, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 228352, "timers": {"training_iteration_time_ms": 3731.133, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3731.128, "sample_time_ms": 1511.02, "learn_time_ms": 2189.97, "learn_throughput": 467.586, "synch_weights_time_ms": 29.56}, "counters": {"num_env_steps_sampled": 228352, "num_env_steps_trained": 228352, "num_agent_steps_sampled": 228352, "num_agent_steps_trained": 228352}, "done": false, "training_iteration": 223, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-12", "timestamp": 1744126452, "time_this_iter_s": 3.611933946609497, "time_total_s": 1036.5747134685516, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC17B00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1036.5747134685516, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 49.82, "ram_util_percent": 90.03999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3332028150558473, "cur_kl_coeff": 1.4836824602749684e-68, "cur_lr": 1e-07, "total_loss": 2.16903885230422, "policy_loss": -1.8031476065516473e-05, "vf_loss": 9.980983889102935, "vf_explained_var": -1.2721866369247437e-05, "kl": 3.1124136793680977e-07, "entropy": 3.2618909001350405, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35760.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "env_runners": {"episode_reward_max": 587.2016488242348, "episode_reward_min": 420.1630131612798, "episode_reward_mean": 482.6649576171604, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.1630131612798}, "policy_reward_max": {"tplp_policy": 587.2016488242348}, "policy_reward_mean": {"tplp_policy": 482.6649576171604}, "custom_metrics": {"mean_episode_reward_mean": 482.6649576171604, "mean_episode_reward_min": 420.1630131612798, "mean_episode_reward_max": 587.2016488242348}, "hist_stats": {"episode_reward": [473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [473.63654407477594, 541.553855681785, 471.06811807705986, 480.6167219906109, 479.83058805492, 455.2808902698096, 489.58217547161155, 469.0729144236661, 455.042709940832, 470.70920370402524, 425.7783512778469, 492.4718981679239, 527.3822350601329, 527.8101784858262, 456.10899148630176, 448.4723022956683, 508.6877952458461, 506.055514758141, 487.04198904925124, 498.97038343215576, 483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4439235408720466, "mean_inference_ms": 4.28445717988153, "mean_action_processing_ms": 0.7986436034280292, "mean_env_wait_ms": 4.145673986127281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022587299346923828, "StateBufferConnector_ms": 0.015159845352172852, "ViewRequirementAgentConnector_ms": 0.3999624252319336}, "num_episodes": 22, "episode_return_max": 587.2016488242348, "episode_return_min": 420.1630131612798, "episode_return_mean": 482.6649576171604, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376, "num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 297.81753873668373, "num_env_steps_trained_throughput_per_sec": 297.81753873668373, "timesteps_total": 229376, "num_env_steps_sampled_lifetime": 229376, "num_agent_steps_sampled_lifetime": 229376, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 229376, "timers": {"training_iteration_time_ms": 3686.114, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3686.108, "sample_time_ms": 1483.899, "learn_time_ms": 2172.182, "learn_throughput": 471.415, "synch_weights_time_ms": 29.549}, "counters": {"num_env_steps_sampled": 229376, "num_env_steps_trained": 229376, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "done": false, "training_iteration": 224, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-15", "timestamp": 1744126455, "time_this_iter_s": 3.4470229148864746, "time_total_s": 1040.021736383438, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCBA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1040.021736383438, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 45.279999999999994, "ram_util_percent": 89.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.652323008701205, "cur_kl_coeff": 7.418412301374842e-69, "cur_lr": 1e-07, "total_loss": 2.170557814091444, "policy_loss": -0.00015551255200989543, "vf_loss": 9.987883311510085, "vf_explained_var": -2.4316832423210144e-05, "kl": 1.6179338586025382e-06, "entropy": 3.2625750958919526, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35920.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "env_runners": {"episode_reward_max": 599.1576899967895, "episode_reward_min": 420.1630131612798, "episode_reward_mean": 481.18873965740494, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.1630131612798}, "policy_reward_max": {"tplp_policy": 599.1576899967895}, "policy_reward_mean": {"tplp_policy": 481.18873965740494}, "custom_metrics": {"mean_episode_reward_mean": 481.18873965740494, "mean_episode_reward_min": 420.1630131612798, "mean_episode_reward_max": 599.1576899967895}, "hist_stats": {"episode_reward": [483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [483.3913060551431, 474.6692719679862, 491.6858823528902, 493.12355589828957, 514.1458308405595, 480.074084672554, 462.5860209494167, 519.3273022556078, 434.02033624695866, 507.65348897773566, 468.05637050612313, 498.9156669983108, 427.60827456287313, 495.97332239104617, 587.2016488242348, 452.5744857737448, 483.0873158679554, 538.1891886834937, 423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4423217805761215, "mean_inference_ms": 4.281836074890424, "mean_action_processing_ms": 0.7980326288538981, "mean_env_wait_ms": 4.143085751478331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0210723876953125, "StateBufferConnector_ms": 0.016663551330566406, "ViewRequirementAgentConnector_ms": 0.3903946876525879}, "num_episodes": 20, "episode_return_max": 599.1576899967895, "episode_return_min": 420.1630131612798, "episode_return_mean": 481.18873965740494, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400, "num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 300.6351111024937, "num_env_steps_trained_throughput_per_sec": 300.6351111024937, "timesteps_total": 230400, "num_env_steps_sampled_lifetime": 230400, "num_agent_steps_sampled_lifetime": 230400, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 230400, "timers": {"training_iteration_time_ms": 3667.727, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3667.721, "sample_time_ms": 1480.433, "learn_time_ms": 2157.314, "learn_throughput": 474.664, "synch_weights_time_ms": 29.496}, "counters": {"num_env_steps_sampled": 230400, "num_env_steps_trained": 230400, "num_agent_steps_sampled": 230400, "num_agent_steps_trained": 230400}, "done": false, "training_iteration": 225, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-19", "timestamp": 1744126459, "time_this_iter_s": 3.414839267730713, "time_total_s": 1043.4365756511688, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC16660>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1043.4365756511688, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 49.275, "ram_util_percent": 89.92500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4005117818713186, "cur_kl_coeff": 3.709206150687421e-69, "cur_lr": 1e-07, "total_loss": 2.1712460704147816, "policy_loss": -5.853748880326748e-05, "vf_loss": 9.990796184539795, "vf_explained_var": -1.3203173875808715e-05, "kl": 1.1766841626736913e-06, "entropy": 3.2639443963766097, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36080.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "env_runners": {"episode_reward_max": 599.1576899967895, "episode_reward_min": 420.1630131612798, "episode_reward_mean": 478.4748966878102, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 420.1630131612798}, "policy_reward_max": {"tplp_policy": 599.1576899967895}, "policy_reward_mean": {"tplp_policy": 478.4748966878102}, "custom_metrics": {"mean_episode_reward_mean": 478.4748966878102, "mean_episode_reward_min": 420.1630131612798, "mean_episode_reward_max": 599.1576899967895}, "hist_stats": {"episode_reward": [423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [423.80526560042364, 447.104854102388, 487.47065745381246, 498.46575853467925, 476.4951708091448, 519.4901464222021, 481.97716815249765, 474.3951699870908, 473.9061070685534, 462.2703206673186, 468.9400729317891, 476.1570584731293, 472.2123045073021, 449.8060969301912, 496.84504846045775, 458.6387303694642, 474.32075360631967, 527.5054036011188, 459.71543451824624, 511.2042416619803, 464.8582606019774, 546.0270797806867, 464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4412444849154817, "mean_inference_ms": 4.278164054180547, "mean_action_processing_ms": 0.7972702244237087, "mean_env_wait_ms": 4.140007585153835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022286415100097656, "StateBufferConnector_ms": 0.016535043716430664, "ViewRequirementAgentConnector_ms": 0.3714151382446289}, "num_episodes": 18, "episode_return_max": 599.1576899967895, "episode_return_min": 420.1630131612798, "episode_return_mean": 478.4748966878102, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424, "num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 277.59517731745103, "num_env_steps_trained_throughput_per_sec": 277.59517731745103, "timesteps_total": 231424, "num_env_steps_sampled_lifetime": 231424, "num_agent_steps_sampled_lifetime": 231424, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 231424, "timers": {"training_iteration_time_ms": 3669.495, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3669.495, "sample_time_ms": 1486.548, "learn_time_ms": 2153.247, "learn_throughput": 475.561, "synch_weights_time_ms": 29.169}, "counters": {"num_env_steps_sampled": 231424, "num_env_steps_trained": 231424, "num_agent_steps_sampled": 231424, "num_agent_steps_trained": 231424}, "done": false, "training_iteration": 226, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-22", "timestamp": 1744126462, "time_this_iter_s": 3.697542428970337, "time_total_s": 1047.1341180801392, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCBB00>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1047.1341180801392, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 45.51666666666666, "ram_util_percent": 89.91666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.400582167133689, "cur_kl_coeff": 1.8546030753437105e-69, "cur_lr": 1e-07, "total_loss": 2.1710654735565185, "policy_loss": -3.877148265019059e-06, "vf_loss": 9.990358132123948, "vf_explained_var": -2.8526410460472107e-05, "kl": 9.772771469629404e-07, "entropy": 3.2652017191052436, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36240.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "env_runners": {"episode_reward_max": 599.1576899967895, "episode_reward_min": 419.61814136377603, "episode_reward_mean": 477.7968164890967, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.61814136377603}, "policy_reward_max": {"tplp_policy": 599.1576899967895}, "policy_reward_mean": {"tplp_policy": 477.7968164890967}, "custom_metrics": {"mean_episode_reward_mean": 477.7968164890967, "mean_episode_reward_min": 419.61814136377603, "mean_episode_reward_max": 599.1576899967895}, "hist_stats": {"episode_reward": [464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [464.375941338404, 486.25517362900524, 522.4255556162666, 467.74037377371644, 420.1630131612798, 458.7233390524344, 467.1460107004183, 438.75816379617, 484.35804814270745, 458.79520186019147, 481.66379256087583, 481.92030605792365, 466.8978626405575, 487.63828819960906, 555.9683056935861, 477.2506336788104, 495.74026134535063, 475.25803412448437, 523.852906976208, 500.4007438930346, 504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.439565074579874, "mean_inference_ms": 4.2729090955326425, "mean_action_processing_ms": 0.7962224794740489, "mean_env_wait_ms": 4.135664719692826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020824909210205078, "StateBufferConnector_ms": 0.012371301651000977, "ViewRequirementAgentConnector_ms": 0.33004260063171387}, "num_episodes": 22, "episode_return_max": 599.1576899967895, "episode_return_min": 419.61814136377603, "episode_return_mean": 477.7968164890967, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448, "num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 285.94836352402916, "num_env_steps_trained_throughput_per_sec": 285.94836352402916, "timesteps_total": 232448, "num_env_steps_sampled_lifetime": 232448, "num_agent_steps_sampled_lifetime": 232448, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 232448, "timers": {"training_iteration_time_ms": 3679.533, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3679.533, "sample_time_ms": 1480.942, "learn_time_ms": 2168.969, "learn_throughput": 472.114, "synch_weights_time_ms": 29.194}, "counters": {"num_env_steps_sampled": 232448, "num_env_steps_trained": 232448, "num_agent_steps_sampled": 232448, "num_agent_steps_trained": 232448}, "done": false, "training_iteration": 227, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-26", "timestamp": 1744126466, "time_this_iter_s": 3.588599681854248, "time_total_s": 1050.7227177619934, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1050.7227177619934, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 45.54, "ram_util_percent": 89.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3487283524125813, "cur_kl_coeff": 9.273015376718553e-70, "cur_lr": 1e-07, "total_loss": 2.1714554533362387, "policy_loss": 3.758258535526693e-05, "vf_loss": 9.992487525939941, "vf_explained_var": -2.7995184063911437e-05, "kl": 8.112094414466919e-07, "entropy": 3.2670401483774185, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36400.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "env_runners": {"episode_reward_max": 599.1576899967895, "episode_reward_min": 419.61814136377603, "episode_reward_mean": 475.8211388388445, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.61814136377603}, "policy_reward_max": {"tplp_policy": 599.1576899967895}, "policy_reward_mean": {"tplp_policy": 475.8211388388445}, "custom_metrics": {"mean_episode_reward_mean": 475.8211388388445, "mean_episode_reward_min": 419.61814136377603, "mean_episode_reward_max": 599.1576899967895}, "hist_stats": {"episode_reward": [504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [504.98918009733296, 520.5140540932936, 483.890145679701, 455.4461720617924, 482.64912189840766, 464.54704319690586, 481.97721741780987, 454.86199682083424, 481.0738424352709, 434.4841902905455, 509.5790808307148, 497.4732015928839, 432.5760321217073, 496.05948546412486, 476.1559595567932, 428.1145758532978, 501.04651630528423, 501.1762763502636, 537.5923551836253, 477.88953921052916, 464.7586220091617, 475.0332909106047, 443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4379223203385496, "mean_inference_ms": 4.267652514846843, "mean_action_processing_ms": 0.7951743759707582, "mean_env_wait_ms": 4.1315244201386365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007472991943359375, "StateBufferConnector_ms": 0.012875080108642578, "ViewRequirementAgentConnector_ms": 0.3365657329559326}, "num_episodes": 20, "episode_return_max": 599.1576899967895, "episode_return_min": 419.61814136377603, "episode_return_mean": 475.8211388388445, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472, "num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 303.7728375788887, "num_env_steps_trained_throughput_per_sec": 303.7728375788887, "timesteps_total": 233472, "num_env_steps_sampled_lifetime": 233472, "num_agent_steps_sampled_lifetime": 233472, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 233472, "timers": {"training_iteration_time_ms": 3663.639, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3663.639, "sample_time_ms": 1471.892, "learn_time_ms": 2161.653, "learn_throughput": 473.711, "synch_weights_time_ms": 29.667}, "counters": {"num_env_steps_sampled": 233472, "num_env_steps_trained": 233472, "num_agent_steps_sampled": 233472, "num_agent_steps_trained": 233472}, "done": false, "training_iteration": 228, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-30", "timestamp": 1744126470, "time_this_iter_s": 3.384467840194702, "time_total_s": 1054.107185602188, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CC14360>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1054.107185602188, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 46.475, "ram_util_percent": 89.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6296202346682547, "cur_kl_coeff": 4.6365076883592763e-70, "cur_lr": 1e-07, "total_loss": 2.1665204100310804, "policy_loss": -2.1736929193139075e-05, "vf_loss": 9.973652189970016, "vf_explained_var": -1.9570812582969666e-05, "kl": 1.0801356245870863e-06, "entropy": 3.2687088564038276, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36560.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "env_runners": {"episode_reward_max": 599.1576899967895, "episode_reward_min": 419.61814136377603, "episode_reward_mean": 478.3316967287182, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.61814136377603}, "policy_reward_max": {"tplp_policy": 599.1576899967895}, "policy_reward_mean": {"tplp_policy": 478.3316967287182}, "custom_metrics": {"mean_episode_reward_mean": 478.3316967287182, "mean_episode_reward_min": 419.61814136377603, "mean_episode_reward_max": 599.1576899967895}, "hist_stats": {"episode_reward": [443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [443.59917822829226, 478.7009716576331, 484.4240577069547, 454.50181767598065, 450.6101071490047, 473.2668554736725, 448.8663617344687, 486.81971942594, 444.12771131115073, 433.67252550837907, 469.4299937955816, 492.4431003199443, 502.02619076463856, 534.2235874403855, 437.7181497534059, 480.7791959384406, 599.1576899967895, 463.3924381722194, 474.9507556726765, 476.80671301275675, 520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4363428851742865, "mean_inference_ms": 4.2625950882448285, "mean_action_processing_ms": 0.7941239115564401, "mean_env_wait_ms": 4.1275136298689645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012015104293823242, "StateBufferConnector_ms": 0.009736299514770508, "ViewRequirementAgentConnector_ms": 0.36498236656188965}, "num_episodes": 22, "episode_return_max": 599.1576899967895, "episode_return_min": 419.61814136377603, "episode_return_mean": 478.3316967287182, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496, "num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 220.71866111605968, "num_env_steps_trained_throughput_per_sec": 220.71866111605968, "timesteps_total": 234496, "num_env_steps_sampled_lifetime": 234496, "num_agent_steps_sampled_lifetime": 234496, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 234496, "timers": {"training_iteration_time_ms": 3739.023, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3739.023, "sample_time_ms": 1497.138, "learn_time_ms": 2211.272, "learn_throughput": 463.082, "synch_weights_time_ms": 30.187}, "counters": {"num_env_steps_sampled": 234496, "num_env_steps_trained": 234496, "num_agent_steps_sampled": 234496, "num_agent_steps_trained": 234496}, "done": false, "training_iteration": 229, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-34", "timestamp": 1744126474, "time_this_iter_s": 4.653158664703369, "time_total_s": 1058.7603442668915, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9760>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1058.7603442668915, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 59.442857142857136, "ram_util_percent": 90.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2486298263072966, "cur_kl_coeff": 2.3182538441796382e-70, "cur_lr": 1e-07, "total_loss": 2.1698765583336352, "policy_loss": -2.965448657050729e-05, "vf_loss": 9.987816613912582, "vf_explained_var": -2.439059317111969e-05, "kl": 1.3260631342715268e-06, "entropy": 3.270479379594326, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36720.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "env_runners": {"episode_reward_max": 575.1927173972871, "episode_reward_min": 419.61814136377603, "episode_reward_mean": 479.85597942995366, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.61814136377603}, "policy_reward_max": {"tplp_policy": 575.1927173972871}, "policy_reward_mean": {"tplp_policy": 479.85597942995366}, "custom_metrics": {"mean_episode_reward_mean": 479.85597942995366, "mean_episode_reward_min": 419.61814136377603, "mean_episode_reward_max": 575.1927173972871}, "hist_stats": {"episode_reward": [520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [520.0694817562786, 492.3911367680929, 474.0361544174857, 478.0356696671997, 441.6774323930578, 488.69010452520513, 455.97367664481544, 496.106798976915, 485.6517655393516, 437.78148275219866, 500.12562260647434, 490.1620694680473, 436.1727940315766, 445.82341299985296, 472.0604464903615, 474.3835391431084, 467.5691397310323, 508.888851634487, 476.7841586270517, 488.95500203649215, 419.61814136377603, 467.040541888749, 497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4351665772673436, "mean_inference_ms": 4.258504052509834, "mean_action_processing_ms": 0.7935011261698693, "mean_env_wait_ms": 4.124598184100631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019170284271240234, "StateBufferConnector_ms": 0.009732484817504883, "ViewRequirementAgentConnector_ms": 0.38362550735473633}, "num_episodes": 20, "episode_return_max": 575.1927173972871, "episode_return_min": 419.61814136377603, "episode_return_mean": 479.85597942995366, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520, "num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 185.2619840506118, "num_env_steps_trained_throughput_per_sec": 185.2619840506118, "timesteps_total": 235520, "num_env_steps_sampled_lifetime": 235520, "num_agent_steps_sampled_lifetime": 235520, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 235520, "timers": {"training_iteration_time_ms": 3944.869, "restore_workers_time_ms": 0.0, "training_step_time_ms": 3944.869, "sample_time_ms": 1575.649, "learn_time_ms": 2339.394, "learn_throughput": 437.72, "synch_weights_time_ms": 29.523}, "counters": {"num_env_steps_sampled": 235520, "num_env_steps_trained": 235520, "num_agent_steps_sampled": 235520, "num_agent_steps_trained": 235520}, "done": false, "training_iteration": 230, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-40", "timestamp": 1744126480, "time_this_iter_s": 5.537937641143799, "time_total_s": 1064.2982819080353, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCA980>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1064.2982819080353, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 69.94285714285715, "ram_util_percent": 90.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.231921862438321, "cur_kl_coeff": 1.1591269220898191e-70, "cur_lr": 1e-07, "total_loss": 2.172732578217983, "policy_loss": -6.49069028440863e-05, "vf_loss": 10.0, "vf_explained_var": -1.9507110118865965e-05, "kl": 1.0163640344451608e-06, "entropy": 3.2720249205827714, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36880.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "env_runners": {"episode_reward_max": 575.1927173972871, "episode_reward_min": 438.7418023530131, "episode_reward_mean": 481.11495458411815, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.7418023530131}, "policy_reward_max": {"tplp_policy": 575.1927173972871}, "policy_reward_mean": {"tplp_policy": 481.11495458411815}, "custom_metrics": {"mean_episode_reward_mean": 481.11495458411815, "mean_episode_reward_min": 438.7418023530131, "mean_episode_reward_max": 575.1927173972871}, "hist_stats": {"episode_reward": [497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [497.284005128714, 489.42167264186384, 456.19563178356344, 524.0059485492608, 459.3073593833805, 469.98724573817674, 472.2636527308959, 452.998506571241, 504.12010640791823, 467.40642412617603, 485.7093245768076, 497.4993784054741, 485.5542885931748, 471.46172146353587, 461.8155049456845, 459.9164780419698, 521.7470608417643, 464.5020225706596, 443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4346723862779902, "mean_inference_ms": 4.2549205589924375, "mean_action_processing_ms": 0.7930514806181445, "mean_env_wait_ms": 4.121899338380519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019944190979003906, "StateBufferConnector_ms": 0.015707015991210938, "ViewRequirementAgentConnector_ms": 0.38963842391967773}, "num_episodes": 22, "episode_return_max": 575.1927173972871, "episode_return_min": 438.7418023530131, "episode_return_mean": 481.11495458411815, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544, "num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 207.2105425667247, "num_env_steps_trained_throughput_per_sec": 207.2105425667247, "timesteps_total": 236544, "num_env_steps_sampled_lifetime": 236544, "num_agent_steps_sampled_lifetime": 236544, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 236544, "timers": {"training_iteration_time_ms": 4066.282, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4066.282, "sample_time_ms": 1638.545, "learn_time_ms": 2396.71, "learn_throughput": 427.252, "synch_weights_time_ms": 30.723}, "counters": {"num_env_steps_sampled": 236544, "num_env_steps_trained": 236544, "num_agent_steps_sampled": 236544, "num_agent_steps_trained": 236544}, "done": false, "training_iteration": 231, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-45", "timestamp": 1744126485, "time_this_iter_s": 4.951029539108276, "time_total_s": 1069.2493114471436, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9120>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1069.2493114471436, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 56.72857142857142, "ram_util_percent": 91.31428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.303590102866292, "cur_kl_coeff": 5.7956346104490954e-71, "cur_lr": 1e-07, "total_loss": 2.171627604961395, "policy_loss": -5.148263880982995e-05, "vf_loss": 9.996046686172486, "vf_explained_var": -3.72864305973053e-05, "kl": 1.4478778885163023e-06, "entropy": 3.2733259037137032, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37040.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "env_runners": {"episode_reward_max": 575.1927173972871, "episode_reward_min": 438.7418023530131, "episode_reward_mean": 483.0510065246255, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 438.7418023530131}, "policy_reward_max": {"tplp_policy": 575.1927173972871}, "policy_reward_mean": {"tplp_policy": 483.0510065246255}, "custom_metrics": {"mean_episode_reward_mean": 483.0510065246255, "mean_episode_reward_min": 438.7418023530131, "mean_episode_reward_max": 575.1927173972871}, "hist_stats": {"episode_reward": [443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [443.481337879908, 479.0545192527478, 438.7418023530131, 485.6900771042467, 450.7409877233788, 468.8230402344288, 510.8630859852124, 471.4204620067097, 441.9053345909366, 521.4292372032245, 472.01994203197864, 472.2249617403635, 448.31395034048467, 481.47484353502625, 472.5422058324045, 464.91630779580095, 451.85243167015636, 456.0205805233556, 481.94780471690706, 487.64852422673835, 506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4339570247535778, "mean_inference_ms": 4.255146313515629, "mean_action_processing_ms": 0.7931327233287818, "mean_env_wait_ms": 4.122470566194123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02242302894592285, "StateBufferConnector_ms": 0.029593229293823242, "ViewRequirementAgentConnector_ms": 0.3860201835632324}, "num_episodes": 18, "episode_return_max": 575.1927173972871, "episode_return_min": 438.7418023530131, "episode_return_mean": 483.0510065246255, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568, "num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 213.4820533044142, "num_env_steps_trained_throughput_per_sec": 213.4820533044142, "timesteps_total": 237568, "num_env_steps_sampled_lifetime": 237568, "num_agent_steps_sampled_lifetime": 237568, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 237568, "timers": {"training_iteration_time_ms": 4099.302, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4099.302, "sample_time_ms": 1672.088, "learn_time_ms": 2395.544, "learn_throughput": 427.46, "synch_weights_time_ms": 31.367}, "counters": {"num_env_steps_sampled": 237568, "num_env_steps_trained": 237568, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "done": false, "training_iteration": 232, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-50", "timestamp": 1744126490, "time_this_iter_s": 4.806908845901489, "time_total_s": 1074.056220293045, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC0720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1074.056220293045, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 53.52857142857143, "ram_util_percent": 90.94285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.328478092700243, "cur_kl_coeff": 2.8978173052245477e-71, "cur_lr": 1e-07, "total_loss": 2.1680220760405065, "policy_loss": -0.00010810494422912598, "vf_loss": 9.98243589401245, "vf_explained_var": -2.29664146900177e-05, "kl": 1.1311703312089083e-06, "entropy": 3.274787962436676, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37200.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "env_runners": {"episode_reward_max": 575.1927173972871, "episode_reward_min": 441.009188734593, "episode_reward_mean": 485.38359986363946, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 441.009188734593}, "policy_reward_max": {"tplp_policy": 575.1927173972871}, "policy_reward_mean": {"tplp_policy": 485.38359986363946}, "custom_metrics": {"mean_episode_reward_mean": 485.38359986363946, "mean_episode_reward_min": 441.009188734593, "mean_episode_reward_max": 575.1927173972871}, "hist_stats": {"episode_reward": [506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [506.60548984506227, 477.101354222832, 468.3264950360695, 455.5654421864669, 492.18295218706487, 505.57738279442077, 575.1927173972871, 538.1010830094507, 484.91773901369595, 485.70904792739447, 441.009188734593, 445.38198444540075, 497.612915022372, 493.7634850579436, 509.21513169719117, 475.4130829571229, 494.7074472186768, 505.0799197041857, 467.53828052598607, 524.3462204413937, 529.6035765403687, 457.8706992803936, 515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.434077732647421, "mean_inference_ms": 4.2557173474746754, "mean_action_processing_ms": 0.79337863956518, "mean_env_wait_ms": 4.123681664151518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019699573516845703, "StateBufferConnector_ms": 0.02958226203918457, "ViewRequirementAgentConnector_ms": 0.39616847038269043}, "num_episodes": 20, "episode_return_max": 575.1927173972871, "episode_return_min": 441.009188734593, "episode_return_mean": 485.38359986363946, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592, "num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 176.041243559895, "num_env_steps_trained_throughput_per_sec": 176.041243559895, "timesteps_total": 238592, "num_env_steps_sampled_lifetime": 238592, "num_agent_steps_sampled_lifetime": 238592, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 238592, "timers": {"training_iteration_time_ms": 4320.731, "restore_workers_time_ms": 0.0, "training_step_time_ms": 4320.731, "sample_time_ms": 1755.425, "learn_time_ms": 2531.586, "learn_throughput": 404.49, "synch_weights_time_ms": 33.317}, "counters": {"num_env_steps_sampled": 238592, "num_env_steps_trained": 238592, "num_agent_steps_sampled": 238592, "num_agent_steps_trained": 238592}, "done": false, "training_iteration": 233, "trial_id": "3bf18_00000", "date": "2025-04-08_23-34-56", "timestamp": 1744126496, "time_this_iter_s": 5.8428566455841064, "time_total_s": 1079.8990769386292, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCB100>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1079.8990769386292, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 56.725, "ram_util_percent": 90.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.714933043718338, "cur_kl_coeff": 1.4489086526122739e-71, "cur_lr": 1e-07, "total_loss": 2.1721248514950275, "policy_loss": -0.0001228013657964766, "vf_loss": 10.0, "vf_explained_var": -2.1753832697868347e-05, "kl": 4.454514075535876e-06, "entropy": 3.277523472905159, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37360.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "env_runners": {"episode_reward_max": 584.3426204555427, "episode_reward_min": 435.25112607954003, "episode_reward_mean": 484.3013466289043, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 435.25112607954003}, "policy_reward_max": {"tplp_policy": 584.3426204555427}, "policy_reward_mean": {"tplp_policy": 484.3013466289043}, "custom_metrics": {"mean_episode_reward_mean": 484.3013466289043, "mean_episode_reward_min": 435.25112607954003, "mean_episode_reward_max": 584.3426204555427}, "hist_stats": {"episode_reward": [515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [515.4111028712202, 461.8742047094065, 468.4037917021403, 459.6019054225305, 466.89686905380717, 468.06844775595835, 468.84308884348906, 496.43898383979223, 510.0909450651474, 508.40399330660284, 472.07515138081834, 487.18777282524564, 448.1896798668942, 531.5650233214133, 454.7536720043572, 469.16668831785495, 522.2009458400275, 485.29884891439804, 489.60268687525615, 481.63773704584406, 493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4345732553702208, "mean_inference_ms": 4.257772363733583, "mean_action_processing_ms": 0.7938912942773938, "mean_env_wait_ms": 4.126008342866244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026757240295410156, "StateBufferConnector_ms": 0.031984806060791016, "ViewRequirementAgentConnector_ms": 0.3650014400482178}, "num_episodes": 22, "episode_return_max": 584.3426204555427, "episode_return_min": 435.25112607954003, "episode_return_mean": 484.3013466289043, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616, "num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 205.7250087595454, "num_env_steps_trained_throughput_per_sec": 205.7250087595454, "timesteps_total": 239616, "num_env_steps_sampled_lifetime": 239616, "num_agent_steps_sampled_lifetime": 239616, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 239616, "timers": {"training_iteration_time_ms": 4474.648, "restore_workers_time_ms": 0.05, "training_step_time_ms": 4474.597, "sample_time_ms": 1862.728, "learn_time_ms": 2576.801, "learn_throughput": 397.392, "synch_weights_time_ms": 34.665}, "counters": {"num_env_steps_sampled": 239616, "num_env_steps_trained": 239616, "num_agent_steps_sampled": 239616, "num_agent_steps_trained": 239616}, "done": false, "training_iteration": 234, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-01", "timestamp": 1744126501, "time_this_iter_s": 4.990248203277588, "time_total_s": 1084.8893251419067, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCA8E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1084.8893251419067, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 62.43333333333333, "ram_util_percent": 91.09999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.185828823596239, "cur_kl_coeff": 7.244543263061369e-72, "cur_lr": 1e-07, "total_loss": 2.1680026881396772, "policy_loss": -6.568563403561712e-05, "vf_loss": 9.984478318691254, "vf_explained_var": -2.9164180159568786e-05, "kl": 1.1459144909409246e-06, "entropy": 3.2805120259523393, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37520.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "env_runners": {"episode_reward_max": 584.3426204555427, "episode_reward_min": 435.25112607954003, "episode_reward_mean": 483.54084818874964, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 435.25112607954003}, "policy_reward_max": {"tplp_policy": 584.3426204555427}, "policy_reward_mean": {"tplp_policy": 483.54084818874964}, "custom_metrics": {"mean_episode_reward_mean": 483.54084818874964, "mean_episode_reward_min": 435.25112607954003, "mean_episode_reward_max": 584.3426204555427}, "hist_stats": {"episode_reward": [493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [493.55446464907544, 500.10446183763435, 472.4921963905804, 466.63583684730344, 445.48622140507666, 461.5226855717465, 445.36184057258396, 454.71141841347907, 480.0814426763101, 510.07119943290934, 465.7324241450732, 475.6390234882133, 493.03129737248304, 478.74195099604134, 482.3148540265296, 475.5814625380257, 470.9779094844584, 541.4490362164848, 485.9022974921786, 473.26249140078187, 468.5936548974861, 476.0229310236833, 472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4352157641242806, "mean_inference_ms": 4.260180740067876, "mean_action_processing_ms": 0.7942172554954261, "mean_env_wait_ms": 4.128588683305494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0352780818939209, "StateBufferConnector_ms": 0.024222850799560547, "ViewRequirementAgentConnector_ms": 0.3990745544433594}, "num_episodes": 20, "episode_return_max": 584.3426204555427, "episode_return_min": 435.25112607954003, "episode_return_mean": 483.54084818874964, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640, "num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 219.00751341718063, "num_env_steps_trained_throughput_per_sec": 219.00751341718063, "timesteps_total": 240640, "num_env_steps_sampled_lifetime": 240640, "num_agent_steps_sampled_lifetime": 240640, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 240640, "timers": {"training_iteration_time_ms": 4601.599, "restore_workers_time_ms": 0.05, "training_step_time_ms": 4601.549, "sample_time_ms": 1927.275, "learn_time_ms": 2638.524, "learn_throughput": 388.096, "synch_weights_time_ms": 35.196}, "counters": {"num_env_steps_sampled": 240640, "num_env_steps_trained": 240640, "num_agent_steps_sampled": 240640, "num_agent_steps_trained": 240640}, "done": false, "training_iteration": 235, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-06", "timestamp": 1744126506, "time_this_iter_s": 4.685449123382568, "time_total_s": 1089.5747742652893, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC0720>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1089.5747742652893, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 50.87142857142858, "ram_util_percent": 91.25714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.256050555408001, "cur_kl_coeff": 3.6222716315306846e-72, "cur_lr": 1e-07, "total_loss": 2.164579802751541, "policy_loss": -5.1863680710084736e-05, "vf_loss": 9.97120829820633, "vf_explained_var": -1.671724021434784e-05, "kl": 1.7118895661472066e-06, "entropy": 3.281704157590866, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37680.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "env_runners": {"episode_reward_max": 584.3426204555427, "episode_reward_min": 435.25112607954003, "episode_reward_mean": 485.48916612367657, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 435.25112607954003}, "policy_reward_max": {"tplp_policy": 584.3426204555427}, "policy_reward_mean": {"tplp_policy": 485.48916612367657}, "custom_metrics": {"mean_episode_reward_mean": 485.48916612367657, "mean_episode_reward_min": 435.25112607954003, "mean_episode_reward_max": 584.3426204555427}, "hist_stats": {"episode_reward": [472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [472.5369829049903, 485.22013121343485, 489.6663923976499, 487.29673330274176, 469.74997397400375, 498.01130974162464, 548.2245591884654, 505.75194089795474, 559.9792632839459, 451.4953602014856, 452.68732108217233, 462.2519648158692, 499.98825946942316, 475.7815241612225, 512.304492254379, 519.2387317404437, 521.843596030084, 445.9682866290699, 504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.435871465995966, "mean_inference_ms": 4.262195091420085, "mean_action_processing_ms": 0.7946365932515923, "mean_env_wait_ms": 4.130833807452928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03658795356750488, "StateBufferConnector_ms": 0.02472853660583496, "ViewRequirementAgentConnector_ms": 0.4677243232727051}, "num_episodes": 22, "episode_return_max": 584.3426204555427, "episode_return_min": 435.25112607954003, "episode_return_mean": 485.48916612367657, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664, "num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 202.57532008205519, "num_env_steps_trained_throughput_per_sec": 202.57532008205519, "timesteps_total": 241664, "num_env_steps_sampled_lifetime": 241664, "num_agent_steps_sampled_lifetime": 241664, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 241664, "timers": {"training_iteration_time_ms": 4738.208, "restore_workers_time_ms": 0.05, "training_step_time_ms": 4738.158, "sample_time_ms": 1972.21, "learn_time_ms": 2729.731, "learn_throughput": 375.129, "synch_weights_time_ms": 35.766}, "counters": {"num_env_steps_sampled": 241664, "num_env_steps_trained": 241664, "num_agent_steps_sampled": 241664, "num_agent_steps_trained": 241664}, "done": false, "training_iteration": 236, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-11", "timestamp": 1744126511, "time_this_iter_s": 5.069637060165405, "time_total_s": 1094.6444113254547, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCAA20>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1094.6444113254547, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 57.25714285714285, "ram_util_percent": 91.04285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2546205326914786, "cur_kl_coeff": 1.8111358157653423e-72, "cur_lr": 1e-07, "total_loss": 2.1715568572282793, "policy_loss": -3.790343180298805e-06, "vf_loss": 10.0, "vf_explained_var": -2.9065459966659545e-05, "kl": 1.6461097335898621e-06, "entropy": 3.2843933656811712, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37840.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "env_runners": {"episode_reward_max": 584.3426204555427, "episode_reward_min": 435.25112607954003, "episode_reward_mean": 483.24827439654274, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 435.25112607954003}, "policy_reward_max": {"tplp_policy": 584.3426204555427}, "policy_reward_mean": {"tplp_policy": 483.24827439654274}, "custom_metrics": {"mean_episode_reward_mean": 483.24827439654274, "mean_episode_reward_min": 435.25112607954003, "mean_episode_reward_max": 584.3426204555427}, "hist_stats": {"episode_reward": [504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [504.36674929568784, 459.02796584811017, 463.23217115588875, 467.83525423126594, 480.477445058044, 475.7682391754138, 491.5414295039959, 488.669719960901, 485.2450973465019, 508.95007956385604, 482.0762463549823, 465.9822730067659, 479.98942026172057, 494.28252020643544, 468.2656087587467, 479.62734290708755, 450.5654500340396, 520.6558753198277, 484.8916222568499, 473.51641063832074, 485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4366789849542971, "mean_inference_ms": 4.264662177868586, "mean_action_processing_ms": 0.7949625688690753, "mean_env_wait_ms": 4.132942736045637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03780984878540039, "StateBufferConnector_ms": 0.01761007308959961, "ViewRequirementAgentConnector_ms": 0.5263192653656006}, "num_episodes": 18, "episode_return_max": 584.3426204555427, "episode_return_min": 435.25112607954003, "episode_return_mean": 483.24827439654274, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688, "num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 194.28196439876896, "num_env_steps_trained_throughput_per_sec": 194.28196439876896, "timesteps_total": 242688, "num_env_steps_sampled_lifetime": 242688, "num_agent_steps_sampled_lifetime": 242688, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 242688, "timers": {"training_iteration_time_ms": 4907.17, "restore_workers_time_ms": 0.05, "training_step_time_ms": 4907.12, "sample_time_ms": 2094.931, "learn_time_ms": 2775.463, "learn_throughput": 368.947, "synch_weights_time_ms": 36.276}, "counters": {"num_env_steps_sampled": 242688, "num_env_steps_trained": 242688, "num_agent_steps_sampled": 242688, "num_agent_steps_trained": 242688}, "done": false, "training_iteration": 237, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-16", "timestamp": 1744126516, "time_this_iter_s": 5.27905011177063, "time_total_s": 1099.9234614372253, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCC9DA0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1099.9234614372253, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 59.51428571428572, "ram_util_percent": 90.82857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3209291201084854, "cur_kl_coeff": 9.055679078826712e-73, "cur_lr": 1e-07, "total_loss": 2.164782226085663, "policy_loss": 8.555589010939002e-06, "vf_loss": 9.974012607336045, "vf_explained_var": -2.2400543093681337e-05, "kl": 2.0449290122556696e-06, "entropy": 3.287294916808605, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38000.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "env_runners": {"episode_reward_max": 584.3426204555427, "episode_reward_min": 430.12277517428396, "episode_reward_mean": 483.97259486664075, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.12277517428396}, "policy_reward_max": {"tplp_policy": 584.3426204555427}, "policy_reward_mean": {"tplp_policy": 483.97259486664075}, "custom_metrics": {"mean_episode_reward_mean": 483.97259486664075, "mean_episode_reward_min": 430.12277517428396, "mean_episode_reward_max": 584.3426204555427}, "hist_stats": {"episode_reward": [485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [485.5695452679833, 530.1630182750276, 457.8422180868628, 483.0891497430614, 484.97424974866584, 467.0387822910851, 488.4706519566657, 462.9211287186541, 479.94762225719705, 473.35051244734, 473.04402833335934, 443.3833370104371, 534.7107859762293, 508.48705629337064, 466.1065554428615, 497.137532658066, 435.25112607954003, 584.3426204555427, 513.662174420372, 494.6961834143581, 469.9238927656, 469.1048735855181, 467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4374609107087446, "mean_inference_ms": 4.266827438514606, "mean_action_processing_ms": 0.795228575989126, "mean_env_wait_ms": 4.134908835073443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04169464111328125, "StateBufferConnector_ms": 0.017112016677856445, "ViewRequirementAgentConnector_ms": 0.5378837585449219}, "num_episodes": 20, "episode_return_max": 584.3426204555427, "episode_return_min": 430.12277517428396, "episode_return_mean": 483.97259486664075, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712, "num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 199.32942638494745, "num_env_steps_trained_throughput_per_sec": 199.32942638494745, "timesteps_total": 243712, "num_env_steps_sampled_lifetime": 243712, "num_agent_steps_sampled_lifetime": 243712, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 243712, "timers": {"training_iteration_time_ms": 5083.799, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5083.748, "sample_time_ms": 2168.826, "learn_time_ms": 2877.761, "learn_throughput": 355.832, "synch_weights_time_ms": 36.711}, "counters": {"num_env_steps_sampled": 243712, "num_env_steps_trained": 243712, "num_agent_steps_sampled": 243712, "num_agent_steps_trained": 243712}, "done": false, "training_iteration": 238, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-22", "timestamp": 1744126522, "time_this_iter_s": 5.147305965423584, "time_total_s": 1105.070767402649, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC0FE0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1105.070767402649, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 59.25714285714286, "ram_util_percent": 90.72857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.464360958337784, "cur_kl_coeff": 4.527839539413356e-73, "cur_lr": 1e-07, "total_loss": 2.1709335789084436, "policy_loss": -6.1088299844414e-05, "vf_loss": 10.0, "vf_explained_var": -4.004761576652527e-05, "kl": 2.1507040930568435e-06, "entropy": 3.290053252875805, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38160.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "env_runners": {"episode_reward_max": 575.7382005776822, "episode_reward_min": 430.12277517428396, "episode_reward_mean": 483.15754265346135, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 430.12277517428396}, "policy_reward_max": {"tplp_policy": 575.7382005776822}, "policy_reward_mean": {"tplp_policy": 483.15754265346135}, "custom_metrics": {"mean_episode_reward_mean": 483.15754265346135, "mean_episode_reward_min": 430.12277517428396, "mean_episode_reward_max": 575.7382005776822}, "hist_stats": {"episode_reward": [467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [467.9057911903723, 444.91694242176055, 510.651245811457, 475.55796907306967, 449.2050241810212, 484.2813253568285, 471.5554185820727, 518.456089962236, 535.4443375217429, 447.224177181668, 456.79917339378693, 503.6699918649749, 498.4598920953576, 464.6764659094933, 493.79133089195545, 474.4478694007164, 471.9632054357902, 481.6266783213119, 515.3838704839089, 439.97678631673773, 457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4383025901273496, "mean_inference_ms": 4.268879510709895, "mean_action_processing_ms": 0.795573263094574, "mean_env_wait_ms": 4.136703090416632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200078010559082, "StateBufferConnector_ms": 0.020285844802856445, "ViewRequirementAgentConnector_ms": 0.580596923828125}, "num_episodes": 22, "episode_return_max": 575.7382005776822, "episode_return_min": 430.12277517428396, "episode_return_mean": 483.15754265346135, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736, "num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 176.56478996666948, "num_env_steps_trained_throughput_per_sec": 176.56478996666948, "timesteps_total": 244736, "num_env_steps_sampled_lifetime": 244736, "num_agent_steps_sampled_lifetime": 244736, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 244736, "timers": {"training_iteration_time_ms": 5199.817, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5199.766, "sample_time_ms": 2222.793, "learn_time_ms": 2939.308, "learn_throughput": 348.381, "synch_weights_time_ms": 37.113}, "counters": {"num_env_steps_sampled": 244736, "num_env_steps_trained": 244736, "num_agent_steps_sampled": 244736, "num_agent_steps_trained": 244736}, "done": false, "training_iteration": 239, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-28", "timestamp": 1744126528, "time_this_iter_s": 5.80858039855957, "time_total_s": 1110.8793478012085, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCBA60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1110.8793478012085, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 65.9125, "ram_util_percent": 90.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6608137967064978, "cur_kl_coeff": 2.263919769706678e-73, "cur_lr": 1e-07, "total_loss": 2.1682237707078458, "policy_loss": -0.00011802612571045756, "vf_loss": 9.990352404117584, "vf_explained_var": -2.8727203607559203e-05, "kl": 1.837193753084776e-06, "entropy": 3.2924629628658293, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38320.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "env_runners": {"episode_reward_max": 575.7382005776822, "episode_reward_min": 419.5408527522673, "episode_reward_mean": 483.2706118249608, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.5408527522673}, "policy_reward_max": {"tplp_policy": 575.7382005776822}, "policy_reward_mean": {"tplp_policy": 483.2706118249608}, "custom_metrics": {"mean_episode_reward_mean": 483.2706118249608, "mean_episode_reward_min": 419.5408527522673, "mean_episode_reward_max": 575.7382005776822}, "hist_stats": {"episode_reward": [457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [457.8253700772073, 484.87062834918464, 566.9982285890375, 464.6039595480538, 493.41800178157314, 532.5352117127368, 503.06309541148767, 446.85105080721087, 489.62758377266806, 505.0193646803423, 473.52358350690787, 481.02282748581194, 512.7935643527634, 529.3487968750361, 478.6730906360282, 470.96156088521894, 461.2467148128106, 442.0063299467455, 499.7454031030232, 462.60787123634236, 467.1458452654155, 461.49787320947377, 511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4392276415437864, "mean_inference_ms": 4.271074313875643, "mean_action_processing_ms": 0.7958941701573857, "mean_env_wait_ms": 4.138451293471354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030613422393798828, "StateBufferConnector_ms": 0.023404836654663086, "ViewRequirementAgentConnector_ms": 0.5998091697692871}, "num_episodes": 20, "episode_return_max": 575.7382005776822, "episode_return_min": 419.5408527522673, "episode_return_mean": 483.2706118249608, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760, "num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 210.59064216317608, "num_env_steps_trained_throughput_per_sec": 210.59064216317608, "timesteps_total": 245760, "num_env_steps_sampled_lifetime": 245760, "num_agent_steps_sampled_lifetime": 245760, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 245760, "timers": {"training_iteration_time_ms": 5133.337, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5133.287, "sample_time_ms": 2233.384, "learn_time_ms": 2861.496, "learn_throughput": 357.855, "synch_weights_time_ms": 37.855}, "counters": {"num_env_steps_sampled": 245760, "num_env_steps_trained": 245760, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "done": false, "training_iteration": 240, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-33", "timestamp": 1744126533, "time_this_iter_s": 4.876421928405762, "time_total_s": 1115.7557697296143, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC1620>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1115.7557697296143, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 56.85, "ram_util_percent": 91.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3593699138611557, "cur_kl_coeff": 1.131959884853339e-73, "cur_lr": 1e-07, "total_loss": 2.1644562259316444, "policy_loss": -0.00010313589591532945, "vf_loss": 9.975652831792832, "vf_explained_var": -2.228692173957825e-05, "kl": 1.1904266606327374e-06, "entropy": 3.293538361787796, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38480.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "env_runners": {"episode_reward_max": 575.7382005776822, "episode_reward_min": 419.5408527522673, "episode_reward_mean": 482.52700138136214, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.5408527522673}, "policy_reward_max": {"tplp_policy": 575.7382005776822}, "policy_reward_mean": {"tplp_policy": 482.52700138136214}, "custom_metrics": {"mean_episode_reward_mean": 482.52700138136214, "mean_episode_reward_min": 419.5408527522673, "mean_episode_reward_max": 575.7382005776822}, "hist_stats": {"episode_reward": [511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [511.4189388825453, 495.29380801503663, 457.0999663868421, 467.133264701727, 460.0417024426474, 484.5397445417453, 460.6756730268561, 566.8178275071143, 488.30195138047867, 450.25079606090173, 459.52028964632495, 475.8712425832696, 505.90719636462813, 457.7232034409729, 482.2369128147316, 482.4314143048702, 449.4359534841785, 493.5463543294564, 475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.440307044296707, "mean_inference_ms": 4.2744850329945825, "mean_action_processing_ms": 0.7962851882762435, "mean_env_wait_ms": 4.141145181132116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0364842414855957, "StateBufferConnector_ms": 0.023721933364868164, "ViewRequirementAgentConnector_ms": 0.5637197494506836}, "num_episodes": 22, "episode_return_max": 575.7382005776822, "episode_return_min": 419.5408527522673, "episode_return_mean": 482.52700138136214, "episodes_this_iter": 22}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784, "num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 185.84420996116108, "num_env_steps_trained_throughput_per_sec": 185.84420996116108, "timesteps_total": 246784, "num_env_steps_sampled_lifetime": 246784, "num_agent_steps_sampled_lifetime": 246784, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 246784, "timers": {"training_iteration_time_ms": 5190.153, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5190.103, "sample_time_ms": 2268.79, "learn_time_ms": 2883.73, "learn_throughput": 355.096, "synch_weights_time_ms": 37.027}, "counters": {"num_env_steps_sampled": 246784, "num_env_steps_trained": 246784, "num_agent_steps_sampled": 246784, "num_agent_steps_trained": 246784}, "done": false, "training_iteration": 241, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-38", "timestamp": 1744126538, "time_this_iter_s": 5.523176431655884, "time_total_s": 1121.2789461612701, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCA8E0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1121.2789461612701, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 55.75, "ram_util_percent": 90.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4578867673873903, "cur_kl_coeff": 5.659799424266695e-74, "cur_lr": 1e-07, "total_loss": 2.1680603668093683, "policy_loss": -4.8632879042997956e-05, "vf_loss": 9.990350395441055, "vf_explained_var": -2.814866602420807e-05, "kl": 1.081899784272089e-06, "entropy": 3.2947860568761826, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38640.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "env_runners": {"episode_reward_max": 575.7382005776822, "episode_reward_min": 419.5408527522673, "episode_reward_mean": 483.28001554467045, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.5408527522673}, "policy_reward_max": {"tplp_policy": 575.7382005776822}, "policy_reward_mean": {"tplp_policy": 483.28001554467045}, "custom_metrics": {"mean_episode_reward_mean": 483.28001554467045, "mean_episode_reward_min": 419.5408527522673, "mean_episode_reward_max": 575.7382005776822}, "hist_stats": {"episode_reward": [475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [475.2202228001958, 475.1976147245116, 498.9405554268122, 512.1690768122244, 575.7382005776822, 430.12277517428396, 474.10851621354215, 456.6443403891788, 489.53613678278737, 455.00032149526845, 505.0129171983392, 477.32542504626747, 452.4238843484835, 513.9356665631565, 474.1885142211054, 481.95366770262143, 539.7174970071949, 467.181327596957, 433.35490914847423, 544.2365365259494, 481.4385451723557, 444.6589131534333, 447.42998254811386, 459.52794535020854, 525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.44084634408408, "mean_inference_ms": 4.276383276053884, "mean_action_processing_ms": 0.7965605521421001, "mean_env_wait_ms": 4.142996149048254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0376887321472168, "StateBufferConnector_ms": 0.01835179328918457, "ViewRequirementAgentConnector_ms": 0.5252726078033447}, "num_episodes": 18, "episode_return_max": 575.7382005776822, "episode_return_min": 419.5408527522673, "episode_return_mean": 483.28001554467045, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808, "num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 208.24558406906726, "num_env_steps_trained_throughput_per_sec": 208.24558406906726, "timesteps_total": 247808, "num_env_steps_sampled_lifetime": 247808, "num_agent_steps_sampled_lifetime": 247808, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 247808, "timers": {"training_iteration_time_ms": 5202.215, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5202.164, "sample_time_ms": 2273.686, "learn_time_ms": 2890.906, "learn_throughput": 354.214, "synch_weights_time_ms": 37.017}, "counters": {"num_env_steps_sampled": 247808, "num_env_steps_trained": 247808, "num_agent_steps_sampled": 247808, "num_agent_steps_trained": 247808}, "done": false, "training_iteration": 242, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-43", "timestamp": 1744126543, "time_this_iter_s": 4.928797006607056, "time_total_s": 1126.2077431678772, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC1800>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1126.2077431678772, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 55.01666666666667, "ram_util_percent": 90.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.411990264058113, "cur_kl_coeff": 2.8298997121333474e-74, "cur_lr": 1e-07, "total_loss": 2.169511540234089, "policy_loss": -8.97080753929913e-05, "vf_loss": 9.997311890125275, "vf_explained_var": -1.3771653175354005e-05, "kl": 3.0643471743085905e-06, "entropy": 3.297267261147499, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38800.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "env_runners": {"episode_reward_max": 549.1623023694905, "episode_reward_min": 419.5408527522673, "episode_reward_mean": 483.5673509815757, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.5408527522673}, "policy_reward_max": {"tplp_policy": 549.1623023694905}, "policy_reward_mean": {"tplp_policy": 483.5673509815757}, "custom_metrics": {"mean_episode_reward_mean": 483.5673509815757, "mean_episode_reward_min": 419.5408527522673, "mean_episode_reward_max": 549.1623023694905}, "hist_stats": {"episode_reward": [525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881, 466.5686541439732, 549.1623023694905, 497.05895594817287, 498.7311609134869, 462.8187860469389, 486.8783823821094, 470.61571926071866, 506.42480408271206, 507.1519923480086, 477.9858971724229, 490.86685871310505, 445.12530889580324, 484.7087748020915, 471.96719794712874, 480.75181767705595, 457.1857581995487, 483.21353055337613, 442.8594788455854, 465.66074467546196, 495.55623447849706, 473.7651298099232, 517.6128517345169, 485.85799408668606, 475.2687005828727], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [525.2816109594582, 486.6018703323134, 455.44399047794616, 531.3840737014765, 475.2260300313029, 547.6373006621649, 512.5722850676327, 492.7791106358253, 467.919414073426, 477.4766215404955, 513.2144466153202, 441.4531925213212, 474.53409389906494, 465.2936167329029, 488.5762745080896, 455.6710602525755, 426.5247913485016, 519.4415205917549, 453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881, 466.5686541439732, 549.1623023694905, 497.05895594817287, 498.7311609134869, 462.8187860469389, 486.8783823821094, 470.61571926071866, 506.42480408271206, 507.1519923480086, 477.9858971724229, 490.86685871310505, 445.12530889580324, 484.7087748020915, 471.96719794712874, 480.75181767705595, 457.1857581995487, 483.21353055337613, 442.8594788455854, 465.66074467546196, 495.55623447849706, 473.7651298099232, 517.6128517345169, 485.85799408668606, 475.2687005828727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4418249249860913, "mean_inference_ms": 4.277745508981485, "mean_action_processing_ms": 0.7967686131050375, "mean_env_wait_ms": 4.144473715591079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0362696647644043, "StateBufferConnector_ms": 0.02194523811340332, "ViewRequirementAgentConnector_ms": 0.5332541465759277}, "num_episodes": 24, "episode_return_max": 549.1623023694905, "episode_return_min": 419.5408527522673, "episode_return_mean": 483.5673509815757, "episodes_this_iter": 24}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832, "num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 200.03044472578807, "num_env_steps_trained_throughput_per_sec": 200.03044472578807, "timesteps_total": 248832, "num_env_steps_sampled_lifetime": 248832, "num_agent_steps_sampled_lifetime": 248832, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 248832, "timers": {"training_iteration_time_ms": 5132.455, "restore_workers_time_ms": 0.05, "training_step_time_ms": 5132.405, "sample_time_ms": 2217.15, "learn_time_ms": 2878.213, "learn_throughput": 355.776, "synch_weights_time_ms": 36.585}, "counters": {"num_env_steps_sampled": 248832, "num_env_steps_trained": 248832, "num_agent_steps_sampled": 248832, "num_agent_steps_trained": 248832}, "done": false, "training_iteration": 243, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-49", "timestamp": 1744126549, "time_this_iter_s": 5.128195524215698, "time_total_s": 1131.335938692093, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC20C0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1131.335938692093, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 54.224999999999994, "ram_util_percent": 90.76249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.707112713344395, "cur_kl_coeff": 1.4149498560666737e-74, "cur_lr": 1e-07, "total_loss": 2.169789746403694, "policy_loss": -6.11434574238956e-05, "vf_loss": 10.0, "vf_explained_var": -1.25054270029068e-05, "kl": 3.326190087094005e-06, "entropy": 3.301491063833237, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38960.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "env_runners": {"episode_reward_max": 549.1623023694905, "episode_reward_min": 419.5408527522673, "episode_reward_mean": 481.7385063500954, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 419.5408527522673}, "policy_reward_max": {"tplp_policy": 549.1623023694905}, "policy_reward_mean": {"tplp_policy": 481.7385063500954}, "custom_metrics": {"mean_episode_reward_mean": 481.7385063500954, "mean_episode_reward_min": 419.5408527522673, "mean_episode_reward_max": 549.1623023694905}, "hist_stats": {"episode_reward": [453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881, 466.5686541439732, 549.1623023694905, 497.05895594817287, 498.7311609134869, 462.8187860469389, 486.8783823821094, 470.61571926071866, 506.42480408271206, 507.1519923480086, 477.9858971724229, 490.86685871310505, 445.12530889580324, 484.7087748020915, 471.96719794712874, 480.75181767705595, 457.1857581995487, 483.21353055337613, 442.8594788455854, 465.66074467546196, 495.55623447849706, 473.7651298099232, 517.6128517345169, 485.85799408668606, 475.2687005828727, 483.4017926481831, 489.67147185183916, 475.09367058408105, 473.8844882252172, 422.1146638075241, 457.77624779322974, 491.7268805184252, 482.22266749313906, 480.27595592479287, 470.75874678427954, 466.74016686365803, 501.10248861619294, 495.8868350041257, 463.7772341197923, 505.6778031951892, 481.55070066112773, 463.0753342007942, 469.4096925119443], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [453.9722293920407, 504.4168978467884, 495.18909668510753, 525.4827925721864, 504.68102631576625, 447.41228357580087, 458.94912374073175, 530.5317190294372, 490.6888707447469, 468.92904992488576, 460.8933499251751, 455.09142136622114, 508.3826754501991, 501.9261925088894, 500.1336142845388, 510.5341729802103, 419.5408527522673, 434.57882151096726, 522.1004518796879, 459.7746805167079, 512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881, 466.5686541439732, 549.1623023694905, 497.05895594817287, 498.7311609134869, 462.8187860469389, 486.8783823821094, 470.61571926071866, 506.42480408271206, 507.1519923480086, 477.9858971724229, 490.86685871310505, 445.12530889580324, 484.7087748020915, 471.96719794712874, 480.75181767705595, 457.1857581995487, 483.21353055337613, 442.8594788455854, 465.66074467546196, 495.55623447849706, 473.7651298099232, 517.6128517345169, 485.85799408668606, 475.2687005828727, 483.4017926481831, 489.67147185183916, 475.09367058408105, 473.8844882252172, 422.1146638075241, 457.77624779322974, 491.7268805184252, 482.22266749313906, 480.27595592479287, 470.75874678427954, 466.74016686365803, 501.10248861619294, 495.8868350041257, 463.7772341197923, 505.6778031951892, 481.55070066112773, 463.0753342007942, 469.4096925119443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4416713476970617, "mean_inference_ms": 4.279747989902153, "mean_action_processing_ms": 0.7969087713596977, "mean_env_wait_ms": 4.146449293927308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03677487373352051, "StateBufferConnector_ms": 0.020103931427001953, "ViewRequirementAgentConnector_ms": 0.4840075969696045}, "num_episodes": 18, "episode_return_max": 549.1623023694905, "episode_return_min": 419.5408527522673, "episode_return_mean": 481.7385063500954, "episodes_this_iter": 18}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856, "num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 208.99168873382675, "num_env_steps_trained_throughput_per_sec": 208.99168873382675, "timesteps_total": 249856, "num_env_steps_sampled_lifetime": 249856, "num_agent_steps_sampled_lifetime": 249856, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 249856, "timers": {"training_iteration_time_ms": 5124.675, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5124.675, "sample_time_ms": 2157.581, "learn_time_ms": 2928.846, "learn_throughput": 349.626, "synch_weights_time_ms": 37.691}, "counters": {"num_env_steps_sampled": 249856, "num_env_steps_trained": 249856, "num_agent_steps_sampled": 249856, "num_agent_steps_trained": 249856}, "done": false, "training_iteration": 244, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-54", "timestamp": 1744126554, "time_this_iter_s": 4.921318292617798, "time_total_s": 1136.2572569847107, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CDC1940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1136.2572569847107, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 57.35714285714285, "ram_util_percent": 90.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"tplp_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7091465819627047, "cur_kl_coeff": 7.074749280333368e-75, "cur_lr": 1e-07, "total_loss": 2.1694155491888525, "policy_loss": -8.278584282379597e-05, "vf_loss": 10.0, "vf_explained_var": -2.2070854902267457e-05, "kl": 2.9308427079044465e-06, "entropy": 3.305016450583935, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39120.5, "diff_num_grad_updates_vs_sampler_policy": 79.5}}, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "env_runners": {"episode_reward_max": 549.1623023694905, "episode_reward_min": 422.1146638075241, "episode_reward_mean": 481.5189146372524, "episode_len_mean": 50.0, "episode_media": {}, "episodes_timesteps_total": 5000, "policy_reward_min": {"tplp_policy": 422.1146638075241}, "policy_reward_max": {"tplp_policy": 549.1623023694905}, "policy_reward_mean": {"tplp_policy": 481.5189146372524}, "custom_metrics": {"mean_episode_reward_mean": 481.5189146372524, "mean_episode_reward_min": 422.1146638075241, "mean_episode_reward_max": 549.1623023694905}, "hist_stats": {"episode_reward": [512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881, 466.5686541439732, 549.1623023694905, 497.05895594817287, 498.7311609134869, 462.8187860469389, 486.8783823821094, 470.61571926071866, 506.42480408271206, 507.1519923480086, 477.9858971724229, 490.86685871310505, 445.12530889580324, 484.7087748020915, 471.96719794712874, 480.75181767705595, 457.1857581995487, 483.21353055337613, 442.8594788455854, 465.66074467546196, 495.55623447849706, 473.7651298099232, 517.6128517345169, 485.85799408668606, 475.2687005828727, 483.4017926481831, 489.67147185183916, 475.09367058408105, 473.8844882252172, 422.1146638075241, 457.77624779322974, 491.7268805184252, 482.22266749313906, 480.27595592479287, 470.75874678427954, 466.74016686365803, 501.10248861619294, 495.8868350041257, 463.7772341197923, 505.6778031951892, 481.55070066112773, 463.0753342007942, 469.4096925119443, 467.25588097838755, 487.47702216383004, 459.2655204277871, 513.3188321056531, 487.65484453988114, 507.6646255900371, 476.8565549290953, 471.15372677171075, 474.7619435260616, 459.9397688944294, 489.22265982243505, 485.79318834497644, 492.6027990888907, 496.56394794877696, 462.38922666217525, 458.18121410772085, 493.46647484735655, 480.1609051816468, 496.93774919654555, 470.58326659065307], "episode_lengths": [50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50], "policy_tplp_policy_reward": [512.1649003959329, 456.1001591072422, 434.4074295423517, 514.0852629180828, 445.9751358701741, 515.784687012334, 454.3042640086599, 499.394704910878, 519.3429169536267, 448.8301039011042, 482.1489197053923, 512.867612590806, 478.4901767349122, 489.1574080791608, 501.387271657917, 441.0460909842015, 482.43695689116385, 499.3050185467876, 474.11095437834075, 467.809805099745, 476.63124655355466, 445.84431857369583, 475.3840369501101, 497.51807900525966, 488.440779261527, 481.223968925103, 459.56240823261874, 515.2612511824902, 467.72775306773315, 461.58411277878224, 525.2590122808132, 484.7324342461613, 452.37759778223835, 494.05587850994004, 492.7644905081396, 461.1370359731453, 525.782995706146, 518.2602567076881, 466.5686541439732, 549.1623023694905, 497.05895594817287, 498.7311609134869, 462.8187860469389, 486.8783823821094, 470.61571926071866, 506.42480408271206, 507.1519923480086, 477.9858971724229, 490.86685871310505, 445.12530889580324, 484.7087748020915, 471.96719794712874, 480.75181767705595, 457.1857581995487, 483.21353055337613, 442.8594788455854, 465.66074467546196, 495.55623447849706, 473.7651298099232, 517.6128517345169, 485.85799408668606, 475.2687005828727, 483.4017926481831, 489.67147185183916, 475.09367058408105, 473.8844882252172, 422.1146638075241, 457.77624779322974, 491.7268805184252, 482.22266749313906, 480.27595592479287, 470.75874678427954, 466.74016686365803, 501.10248861619294, 495.8868350041257, 463.7772341197923, 505.6778031951892, 481.55070066112773, 463.0753342007942, 469.4096925119443, 467.25588097838755, 487.47702216383004, 459.2655204277871, 513.3188321056531, 487.65484453988114, 507.6646255900371, 476.8565549290953, 471.15372677171075, 474.7619435260616, 459.9397688944294, 489.22265982243505, 485.79318834497644, 492.6027990888907, 496.56394794877696, 462.38922666217525, 458.18121410772085, 493.46647484735655, 480.1609051816468, 496.93774919654555, 470.58326659065307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4418420887255292, "mean_inference_ms": 4.281659329082558, "mean_action_processing_ms": 0.7970866049886302, "mean_env_wait_ms": 4.1482865356845116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029078960418701172, "StateBufferConnector_ms": 0.024662256240844727, "ViewRequirementAgentConnector_ms": 0.5002796649932861}, "num_episodes": 20, "episode_return_max": 549.1623023694905, "episode_return_min": 422.1146638075241, "episode_return_mean": 481.5189146372524, "episodes_this_iter": 20}, "num_healthy_workers": 6, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880, "num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_env_steps_sampled_this_iter": 1024, "num_env_steps_trained_this_iter": 1024, "num_env_steps_sampled_throughput_per_sec": 186.04057404718128, "num_env_steps_trained_throughput_per_sec": 186.04057404718128, "timesteps_total": 250880, "num_env_steps_sampled_lifetime": 250880, "num_agent_steps_sampled_lifetime": 250880, "num_steps_trained_this_iter": 1024, "agent_timesteps_total": 250880, "timers": {"training_iteration_time_ms": 5207.537, "restore_workers_time_ms": 0.0, "training_step_time_ms": 5207.528, "sample_time_ms": 2221.208, "learn_time_ms": 2947.981, "learn_throughput": 347.356, "synch_weights_time_ms": 37.934}, "counters": {"num_env_steps_sampled": 250880, "num_env_steps_trained": 250880, "num_agent_steps_sampled": 250880, "num_agent_steps_trained": 250880}, "done": true, "training_iteration": 245, "trial_id": "3bf18_00000", "date": "2025-04-08_23-35-59", "timestamp": 1744126559, "time_this_iter_s": 5.517851114273071, "time_total_s": 1141.7751080989838, "pid": 8152, "hostname": "Lau-Yong", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "coopetition_env_single", "env_config": {}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 1e-07, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 1024, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function <lambda> at 0x000002060CCCAB60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "ERROR", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 64, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "policies": {"tplp_policy": [null, null, null, null]}, "callbacks": "<class '__main__.CustomCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 6, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1141.7751080989838, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 63.04285714285714, "ram_util_percent": 90.87142857142858}}
